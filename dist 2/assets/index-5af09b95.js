var $R=Object.defineProperty;var WR=(t,e,r)=>e in t?$R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Dr=(t,e,r)=>(WR(t,typeof e!="symbol"?e+"":e,r),r);function HR(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var wee=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dA={exports:{}},Yy={},hA={exports:{}},qt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wp=Symbol.for("react.element"),GR=Symbol.for("react.portal"),KR=Symbol.for("react.fragment"),YR=Symbol.for("react.strict_mode"),QR=Symbol.for("react.profiler"),JR=Symbol.for("react.provider"),XR=Symbol.for("react.context"),ZR=Symbol.for("react.forward_ref"),eD=Symbol.for("react.suspense"),tD=Symbol.for("react.memo"),rD=Symbol.for("react.lazy"),o_=Symbol.iterator;function nD(t){return t===null||typeof t!="object"?null:(t=o_&&t[o_]||t["@@iterator"],typeof t=="function"?t:null)}var fA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},mA=Object.assign,pA={};function lf(t,e,r){this.props=t,this.context=e,this.refs=pA,this.updater=r||fA}lf.prototype.isReactComponent={};lf.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};lf.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function gA(){}gA.prototype=lf.prototype;function Wb(t,e,r){this.props=t,this.context=e,this.refs=pA,this.updater=r||fA}var Hb=Wb.prototype=new gA;Hb.constructor=Wb;mA(Hb,lf.prototype);Hb.isPureReactComponent=!0;var l_=Array.isArray,yA=Object.prototype.hasOwnProperty,Gb={current:null},xA={key:!0,ref:!0,__self:!0,__source:!0};function vA(t,e,r){var n,s={},i=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)yA.call(e,n)&&!xA.hasOwnProperty(n)&&(s[n]=e[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:wp,type:t,key:i,ref:o,props:s,_owner:Gb.current}}function sD(t,e){return{$$typeof:wp,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Kb(t){return typeof t=="object"&&t!==null&&t.$$typeof===wp}function iD(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var c_=/\/+/g;function b1(t,e){return typeof t=="object"&&t!==null&&t.key!=null?iD(""+t.key):e.toString(36)}function s0(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case wp:case GR:o=!0}}if(o)return o=t,s=s(o),t=n===""?"."+b1(o,0):n,l_(s)?(r="",t!=null&&(r=t.replace(c_,"$&/")+"/"),s0(s,e,r,"",function(u){return u})):s!=null&&(Kb(s)&&(s=sD(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(c_,"$&/")+"/")+t)),e.push(s)),1;if(o=0,n=n===""?".":n+":",l_(t))for(var l=0;l<t.length;l++){i=t[l];var c=n+b1(i,l);o+=s0(i,e,r,c,s)}else if(c=nD(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=n+b1(i,l++),o+=s0(i,e,r,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function bg(t,e,r){if(t==null)return t;var n=[],s=0;return s0(t,n,"","",function(i){return e.call(r,i,s++)}),n}function aD(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ts={current:null},i0={transition:null},oD={ReactCurrentDispatcher:Ts,ReactCurrentBatchConfig:i0,ReactCurrentOwner:Gb};function bA(){throw Error("act(...) is not supported in production builds of React.")}qt.Children={map:bg,forEach:function(t,e,r){bg(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return bg(t,function(){e++}),e},toArray:function(t){return bg(t,function(e){return e})||[]},only:function(t){if(!Kb(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};qt.Component=lf;qt.Fragment=KR;qt.Profiler=QR;qt.PureComponent=Wb;qt.StrictMode=YR;qt.Suspense=eD;qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oD;qt.act=bA;qt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=mA({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Gb.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)yA.call(e,c)&&!xA.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:wp,type:t.type,key:s,ref:i,props:n,_owner:o}};qt.createContext=function(t){return t={$$typeof:XR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:JR,_context:t},t.Consumer=t};qt.createElement=vA;qt.createFactory=function(t){var e=vA.bind(null,t);return e.type=t,e};qt.createRef=function(){return{current:null}};qt.forwardRef=function(t){return{$$typeof:ZR,render:t}};qt.isValidElement=Kb;qt.lazy=function(t){return{$$typeof:rD,_payload:{_status:-1,_result:t},_init:aD}};qt.memo=function(t,e){return{$$typeof:tD,type:t,compare:e===void 0?null:e}};qt.startTransition=function(t){var e=i0.transition;i0.transition={};try{t()}finally{i0.transition=e}};qt.unstable_act=bA;qt.useCallback=function(t,e){return Ts.current.useCallback(t,e)};qt.useContext=function(t){return Ts.current.useContext(t)};qt.useDebugValue=function(){};qt.useDeferredValue=function(t){return Ts.current.useDeferredValue(t)};qt.useEffect=function(t,e){return Ts.current.useEffect(t,e)};qt.useId=function(){return Ts.current.useId()};qt.useImperativeHandle=function(t,e,r){return Ts.current.useImperativeHandle(t,e,r)};qt.useInsertionEffect=function(t,e){return Ts.current.useInsertionEffect(t,e)};qt.useLayoutEffect=function(t,e){return Ts.current.useLayoutEffect(t,e)};qt.useMemo=function(t,e){return Ts.current.useMemo(t,e)};qt.useReducer=function(t,e,r){return Ts.current.useReducer(t,e,r)};qt.useRef=function(t){return Ts.current.useRef(t)};qt.useState=function(t){return Ts.current.useState(t)};qt.useSyncExternalStore=function(t,e,r){return Ts.current.useSyncExternalStore(t,e,r)};qt.useTransition=function(){return Ts.current.useTransition()};qt.version="18.3.1";hA.exports=qt;var M=hA.exports;const Lc=uA(M),lD=HR({__proto__:null,default:Lc},[M]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cD=M,uD=Symbol.for("react.element"),dD=Symbol.for("react.fragment"),hD=Object.prototype.hasOwnProperty,fD=cD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,mD={key:!0,ref:!0,__self:!0,__source:!0};function wA(t,e,r){var n,s={},i=null,o=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)hD.call(e,n)&&!mD.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:uD,type:t,key:i,ref:o,props:s,_owner:fD.current}}Yy.Fragment=dD;Yy.jsx=wA;Yy.jsxs=wA;dA.exports=Yy;var a=dA.exports,zv={},NA={exports:{}},Ei={},_A={exports:{}},jA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Y,Q){var se=Y.length;Y.push(Q);e:for(;0<se;){var Se=se-1>>>1,U=Y[Se];if(0<s(U,Q))Y[Se]=Q,Y[se]=U,se=Se;else break e}}function r(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var Q=Y[0],se=Y.pop();if(se!==Q){Y[0]=se;e:for(var Se=0,U=Y.length,J=U>>>1;Se<J;){var te=2*(Se+1)-1,ie=Y[te],ue=te+1,ge=Y[ue];if(0>s(ie,se))ue<U&&0>s(ge,ie)?(Y[Se]=ge,Y[ue]=se,Se=ue):(Y[Se]=ie,Y[te]=se,Se=te);else if(ue<U&&0>s(ge,se))Y[Se]=ge,Y[ue]=se,Se=ue;else break e}}return Q}function s(Y,Q){var se=Y.sortIndex-Q.sortIndex;return se!==0?se:Y.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,g=3,m=!1,w=!1,_=!1,T=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(Y){for(var Q=r(u);Q!==null;){if(Q.callback===null)n(u);else if(Q.startTime<=Y)n(u),Q.sortIndex=Q.expirationTime,e(c,Q);else break;Q=r(u)}}function P(Y){if(_=!1,x(Y),!w)if(r(c)!==null)w=!0,ne(F);else{var Q=r(u);Q!==null&&X(P,Q.startTime-Y)}}function F(Y,Q){w=!1,_&&(_=!1,v(A),A=-1),m=!0;var se=g;try{for(x(Q),h=r(c);h!==null&&(!(h.expirationTime>Q)||Y&&!S());){var Se=h.callback;if(typeof Se=="function"){h.callback=null,g=h.priorityLevel;var U=Se(h.expirationTime<=Q);Q=t.unstable_now(),typeof U=="function"?h.callback=U:h===r(c)&&n(c),x(Q)}else n(c);h=r(c)}if(h!==null)var J=!0;else{var te=r(u);te!==null&&X(P,te.startTime-Q),J=!1}return J}finally{h=null,g=se,m=!1}}var $=!1,k=null,A=-1,I=5,O=-1;function S(){return!(t.unstable_now()-O<I)}function R(){if(k!==null){var Y=t.unstable_now();O=Y;var Q=!0;try{Q=k(!0,Y)}finally{Q?C():($=!1,k=null)}}else $=!1}var C;if(typeof b=="function")C=function(){b(R)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,de=G.port2;G.port1.onmessage=R,C=function(){de.postMessage(null)}}else C=function(){T(R,0)};function ne(Y){k=Y,$||($=!0,C())}function X(Y,Q){A=T(function(){Y(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Y){Y.callback=null},t.unstable_continueExecution=function(){w||m||(w=!0,ne(F))},t.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<Y?Math.floor(1e3/Y):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(Y){switch(g){case 1:case 2:case 3:var Q=3;break;default:Q=g}var se=g;g=Q;try{return Y()}finally{g=se}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Y,Q){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var se=g;g=Y;try{return Q()}finally{g=se}},t.unstable_scheduleCallback=function(Y,Q,se){var Se=t.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?Se+se:Se):se=Se,Y){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=se+U,Y={id:d++,callback:Q,priorityLevel:Y,startTime:se,expirationTime:U,sortIndex:-1},se>Se?(Y.sortIndex=se,e(u,Y),r(c)===null&&Y===r(u)&&(_?(v(A),A=-1):_=!0,X(P,se-Se))):(Y.sortIndex=U,e(c,Y),w||m||(w=!0,ne(F))),Y},t.unstable_shouldYield=S,t.unstable_wrapCallback=function(Y){var Q=g;return function(){var se=g;g=Q;try{return Y.apply(this,arguments)}finally{g=se}}}})(jA);_A.exports=jA;var pD=_A.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gD=M,Ni=pD;function Ue(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var SA=new Set,Bm={};function dd(t,e){zh(t,e),zh(t+"Capture",e)}function zh(t,e){for(Bm[t]=e,t=0;t<e.length;t++)SA.add(e[t])}var sl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qv=Object.prototype.hasOwnProperty,yD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,u_={},d_={};function xD(t){return qv.call(d_,t)?!0:qv.call(u_,t)?!1:yD.test(t)?d_[t]=!0:(u_[t]=!0,!1)}function vD(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function bD(t,e,r,n){if(e===null||typeof e>"u"||vD(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Is(t,e,r,n,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var $n={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){$n[t]=new Is(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];$n[e]=new Is(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){$n[t]=new Is(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){$n[t]=new Is(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){$n[t]=new Is(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){$n[t]=new Is(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){$n[t]=new Is(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){$n[t]=new Is(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){$n[t]=new Is(t,5,!1,t.toLowerCase(),null,!1,!1)});var Yb=/[\-:]([a-z])/g;function Qb(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Yb,Qb);$n[e]=new Is(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Yb,Qb);$n[e]=new Is(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Yb,Qb);$n[e]=new Is(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){$n[t]=new Is(t,1,!1,t.toLowerCase(),null,!1,!1)});$n.xlinkHref=new Is("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){$n[t]=new Is(t,1,!1,t.toLowerCase(),null,!0,!0)});function Jb(t,e,r,n){var s=$n.hasOwnProperty(e)?$n[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(bD(e,r,s,n)&&(r=null),n||s===null?xD(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var xl=gD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wg=Symbol.for("react.element"),sh=Symbol.for("react.portal"),ih=Symbol.for("react.fragment"),Xb=Symbol.for("react.strict_mode"),$v=Symbol.for("react.profiler"),AA=Symbol.for("react.provider"),EA=Symbol.for("react.context"),Zb=Symbol.for("react.forward_ref"),Wv=Symbol.for("react.suspense"),Hv=Symbol.for("react.suspense_list"),ew=Symbol.for("react.memo"),nc=Symbol.for("react.lazy"),kA=Symbol.for("react.offscreen"),h_=Symbol.iterator;function qf(t){return t===null||typeof t!="object"?null:(t=h_&&t[h_]||t["@@iterator"],typeof t=="function"?t:null)}var Ur=Object.assign,w1;function nm(t){if(w1===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);w1=e&&e[1]||""}return`
`+w1+t}var N1=!1;function _1(t,e){if(!t||N1)return"";N1=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{N1=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?nm(t):""}function wD(t){switch(t.tag){case 5:return nm(t.type);case 16:return nm("Lazy");case 13:return nm("Suspense");case 19:return nm("SuspenseList");case 0:case 2:case 15:return t=_1(t.type,!1),t;case 11:return t=_1(t.type.render,!1),t;case 1:return t=_1(t.type,!0),t;default:return""}}function Gv(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ih:return"Fragment";case sh:return"Portal";case $v:return"Profiler";case Xb:return"StrictMode";case Wv:return"Suspense";case Hv:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case EA:return(t.displayName||"Context")+".Consumer";case AA:return(t._context.displayName||"Context")+".Provider";case Zb:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ew:return e=t.displayName||null,e!==null?e:Gv(t.type)||"Memo";case nc:e=t._payload,t=t._init;try{return Gv(t(e))}catch{}}return null}function ND(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Gv(e);case 8:return e===Xb?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Oc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function TA(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function _D(t){var e=TA(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ng(t){t._valueTracker||(t._valueTracker=_D(t))}function IA(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=TA(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function L0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Kv(t,e){var r=e.checked;return Ur({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function f_(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Oc(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function CA(t,e){e=e.checked,e!=null&&Jb(t,"checked",e,!1)}function Yv(t,e){CA(t,e);var r=Oc(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Qv(t,e.type,r):e.hasOwnProperty("defaultValue")&&Qv(t,e.type,Oc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function m_(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Qv(t,e,r){(e!=="number"||L0(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var sm=Array.isArray;function jh(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Oc(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Jv(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ue(91));return Ur({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function p_(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Ue(92));if(sm(r)){if(1<r.length)throw Error(Ue(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Oc(r)}}function PA(t,e){var r=Oc(e.value),n=Oc(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function g_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function RA(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xv(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?RA(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var _g,DA=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(_g=_g||document.createElement("div"),_g.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=_g.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Um(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var pm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jD=["Webkit","ms","Moz","O"];Object.keys(pm).forEach(function(t){jD.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),pm[e]=pm[t]})});function LA(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||pm.hasOwnProperty(t)&&pm[t]?(""+e).trim():e+"px"}function OA(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=LA(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var SD=Ur({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Zv(t,e){if(e){if(SD[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ue(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ue(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ue(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ue(62))}}function e2(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var t2=null;function tw(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var r2=null,Sh=null,Ah=null;function y_(t){if(t=jp(t)){if(typeof r2!="function")throw Error(Ue(280));var e=t.stateNode;e&&(e=ex(e),r2(t.stateNode,t.type,e))}}function MA(t){Sh?Ah?Ah.push(t):Ah=[t]:Sh=t}function FA(){if(Sh){var t=Sh,e=Ah;if(Ah=Sh=null,y_(t),e)for(t=0;t<e.length;t++)y_(e[t])}}function VA(t,e){return t(e)}function BA(){}var j1=!1;function UA(t,e,r){if(j1)return t(e,r);j1=!0;try{return VA(t,e,r)}finally{j1=!1,(Sh!==null||Ah!==null)&&(BA(),FA())}}function zm(t,e){var r=t.stateNode;if(r===null)return null;var n=ex(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Ue(231,e,typeof r));return r}var n2=!1;if(sl)try{var $f={};Object.defineProperty($f,"passive",{get:function(){n2=!0}}),window.addEventListener("test",$f,$f),window.removeEventListener("test",$f,$f)}catch{n2=!1}function AD(t,e,r,n,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var gm=!1,O0=null,M0=!1,s2=null,ED={onError:function(t){gm=!0,O0=t}};function kD(t,e,r,n,s,i,o,l,c){gm=!1,O0=null,AD.apply(ED,arguments)}function TD(t,e,r,n,s,i,o,l,c){if(kD.apply(this,arguments),gm){if(gm){var u=O0;gm=!1,O0=null}else throw Error(Ue(198));M0||(M0=!0,s2=u)}}function hd(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function zA(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function x_(t){if(hd(t)!==t)throw Error(Ue(188))}function ID(t){var e=t.alternate;if(!e){if(e=hd(t),e===null)throw Error(Ue(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return x_(s),t;if(i===n)return x_(s),e;i=i.sibling}throw Error(Ue(188))}if(r.return!==n.return)r=s,n=i;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o)throw Error(Ue(189))}}if(r.alternate!==n)throw Error(Ue(190))}if(r.tag!==3)throw Error(Ue(188));return r.stateNode.current===r?t:e}function qA(t){return t=ID(t),t!==null?$A(t):null}function $A(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=$A(t);if(e!==null)return e;t=t.sibling}return null}var WA=Ni.unstable_scheduleCallback,v_=Ni.unstable_cancelCallback,CD=Ni.unstable_shouldYield,PD=Ni.unstable_requestPaint,nn=Ni.unstable_now,RD=Ni.unstable_getCurrentPriorityLevel,rw=Ni.unstable_ImmediatePriority,HA=Ni.unstable_UserBlockingPriority,F0=Ni.unstable_NormalPriority,DD=Ni.unstable_LowPriority,GA=Ni.unstable_IdlePriority,Qy=null,no=null;function LD(t){if(no&&typeof no.onCommitFiberRoot=="function")try{no.onCommitFiberRoot(Qy,t,void 0,(t.current.flags&128)===128)}catch{}}var Na=Math.clz32?Math.clz32:FD,OD=Math.log,MD=Math.LN2;function FD(t){return t>>>=0,t===0?32:31-(OD(t)/MD|0)|0}var jg=64,Sg=4194304;function im(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function V0(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=im(l):(i&=o,i!==0&&(n=im(i)))}else o=r&~s,o!==0?n=im(o):i!==0&&(n=im(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Na(e),s=1<<r,n|=t[r],e&=~s;return n}function VD(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function BD(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Na(i),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=VD(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function i2(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function KA(){var t=jg;return jg<<=1,!(jg&4194240)&&(jg=64),t}function S1(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Np(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Na(e),t[e]=r}function UD(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Na(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function nw(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Na(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var lr=0;function YA(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var QA,sw,JA,XA,ZA,a2=!1,Ag=[],vc=null,bc=null,wc=null,qm=new Map,$m=new Map,ac=[],zD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function b_(t,e){switch(t){case"focusin":case"focusout":vc=null;break;case"dragenter":case"dragleave":bc=null;break;case"mouseover":case"mouseout":wc=null;break;case"pointerover":case"pointerout":qm.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":$m.delete(e.pointerId)}}function Wf(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=jp(e),e!==null&&sw(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function qD(t,e,r,n,s){switch(e){case"focusin":return vc=Wf(vc,t,e,r,n,s),!0;case"dragenter":return bc=Wf(bc,t,e,r,n,s),!0;case"mouseover":return wc=Wf(wc,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return qm.set(i,Wf(qm.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,$m.set(i,Wf($m.get(i)||null,t,e,r,n,s)),!0}return!1}function eE(t){var e=Vu(t.target);if(e!==null){var r=hd(e);if(r!==null){if(e=r.tag,e===13){if(e=zA(r),e!==null){t.blockedOn=e,ZA(t.priority,function(){JA(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function a0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=o2(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);t2=n,r.target.dispatchEvent(n),t2=null}else return e=jp(r),e!==null&&sw(e),t.blockedOn=r,!1;e.shift()}return!0}function w_(t,e,r){a0(t)&&r.delete(e)}function $D(){a2=!1,vc!==null&&a0(vc)&&(vc=null),bc!==null&&a0(bc)&&(bc=null),wc!==null&&a0(wc)&&(wc=null),qm.forEach(w_),$m.forEach(w_)}function Hf(t,e){t.blockedOn===e&&(t.blockedOn=null,a2||(a2=!0,Ni.unstable_scheduleCallback(Ni.unstable_NormalPriority,$D)))}function Wm(t){function e(s){return Hf(s,t)}if(0<Ag.length){Hf(Ag[0],t);for(var r=1;r<Ag.length;r++){var n=Ag[r];n.blockedOn===t&&(n.blockedOn=null)}}for(vc!==null&&Hf(vc,t),bc!==null&&Hf(bc,t),wc!==null&&Hf(wc,t),qm.forEach(e),$m.forEach(e),r=0;r<ac.length;r++)n=ac[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<ac.length&&(r=ac[0],r.blockedOn===null);)eE(r),r.blockedOn===null&&ac.shift()}var Eh=xl.ReactCurrentBatchConfig,B0=!0;function WD(t,e,r,n){var s=lr,i=Eh.transition;Eh.transition=null;try{lr=1,iw(t,e,r,n)}finally{lr=s,Eh.transition=i}}function HD(t,e,r,n){var s=lr,i=Eh.transition;Eh.transition=null;try{lr=4,iw(t,e,r,n)}finally{lr=s,Eh.transition=i}}function iw(t,e,r,n){if(B0){var s=o2(t,e,r,n);if(s===null)L1(t,e,n,U0,r),b_(t,n);else if(qD(s,t,e,r,n))n.stopPropagation();else if(b_(t,n),e&4&&-1<zD.indexOf(t)){for(;s!==null;){var i=jp(s);if(i!==null&&QA(i),i=o2(t,e,r,n),i===null&&L1(t,e,n,U0,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else L1(t,e,n,null,r)}}var U0=null;function o2(t,e,r,n){if(U0=null,t=tw(n),t=Vu(t),t!==null)if(e=hd(t),e===null)t=null;else if(r=e.tag,r===13){if(t=zA(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return U0=t,null}function tE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(RD()){case rw:return 1;case HA:return 4;case F0:case DD:return 16;case GA:return 536870912;default:return 16}default:return 16}}var fc=null,aw=null,o0=null;function rE(){if(o0)return o0;var t,e=aw,r=e.length,n,s="value"in fc?fc.value:fc.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===s[i-n];n++);return o0=s.slice(t,1<n?1-n:void 0)}function l0(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Eg(){return!0}function N_(){return!1}function ki(t){function e(r,n,s,i,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Eg:N_,this.isPropagationStopped=N_,this}return Ur(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Eg)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Eg)},persist:function(){},isPersistent:Eg}),e}var cf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ow=ki(cf),_p=Ur({},cf,{view:0,detail:0}),GD=ki(_p),A1,E1,Gf,Jy=Ur({},_p,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lw,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Gf&&(Gf&&t.type==="mousemove"?(A1=t.screenX-Gf.screenX,E1=t.screenY-Gf.screenY):E1=A1=0,Gf=t),A1)},movementY:function(t){return"movementY"in t?t.movementY:E1}}),__=ki(Jy),KD=Ur({},Jy,{dataTransfer:0}),YD=ki(KD),QD=Ur({},_p,{relatedTarget:0}),k1=ki(QD),JD=Ur({},cf,{animationName:0,elapsedTime:0,pseudoElement:0}),XD=ki(JD),ZD=Ur({},cf,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),eL=ki(ZD),tL=Ur({},cf,{data:0}),j_=ki(tL),rL={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nL={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sL={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iL(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=sL[t])?!!e[t]:!1}function lw(){return iL}var aL=Ur({},_p,{key:function(t){if(t.key){var e=rL[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=l0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?nL[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lw,charCode:function(t){return t.type==="keypress"?l0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?l0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),oL=ki(aL),lL=Ur({},Jy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),S_=ki(lL),cL=Ur({},_p,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lw}),uL=ki(cL),dL=Ur({},cf,{propertyName:0,elapsedTime:0,pseudoElement:0}),hL=ki(dL),fL=Ur({},Jy,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),mL=ki(fL),pL=[9,13,27,32],cw=sl&&"CompositionEvent"in window,ym=null;sl&&"documentMode"in document&&(ym=document.documentMode);var gL=sl&&"TextEvent"in window&&!ym,nE=sl&&(!cw||ym&&8<ym&&11>=ym),A_=String.fromCharCode(32),E_=!1;function sE(t,e){switch(t){case"keyup":return pL.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function iE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ah=!1;function yL(t,e){switch(t){case"compositionend":return iE(e);case"keypress":return e.which!==32?null:(E_=!0,A_);case"textInput":return t=e.data,t===A_&&E_?null:t;default:return null}}function xL(t,e){if(ah)return t==="compositionend"||!cw&&sE(t,e)?(t=rE(),o0=aw=fc=null,ah=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return nE&&e.locale!=="ko"?null:e.data;default:return null}}var vL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function k_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!vL[t.type]:e==="textarea"}function aE(t,e,r,n){MA(n),e=z0(e,"onChange"),0<e.length&&(r=new ow("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var xm=null,Hm=null;function bL(t){yE(t,0)}function Xy(t){var e=ch(t);if(IA(e))return t}function wL(t,e){if(t==="change")return e}var oE=!1;if(sl){var T1;if(sl){var I1="oninput"in document;if(!I1){var T_=document.createElement("div");T_.setAttribute("oninput","return;"),I1=typeof T_.oninput=="function"}T1=I1}else T1=!1;oE=T1&&(!document.documentMode||9<document.documentMode)}function I_(){xm&&(xm.detachEvent("onpropertychange",lE),Hm=xm=null)}function lE(t){if(t.propertyName==="value"&&Xy(Hm)){var e=[];aE(e,Hm,t,tw(t)),UA(bL,e)}}function NL(t,e,r){t==="focusin"?(I_(),xm=e,Hm=r,xm.attachEvent("onpropertychange",lE)):t==="focusout"&&I_()}function _L(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Xy(Hm)}function jL(t,e){if(t==="click")return Xy(e)}function SL(t,e){if(t==="input"||t==="change")return Xy(e)}function AL(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ea=typeof Object.is=="function"?Object.is:AL;function Gm(t,e){if(Ea(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!qv.call(e,s)||!Ea(t[s],e[s]))return!1}return!0}function C_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function P_(t,e){var r=C_(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=C_(r)}}function cE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?cE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function uE(){for(var t=window,e=L0();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=L0(t.document)}return e}function uw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function EL(t){var e=uE(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&cE(r.ownerDocument.documentElement,r)){if(n!==null&&uw(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=P_(r,i);var o=P_(r,n);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var kL=sl&&"documentMode"in document&&11>=document.documentMode,oh=null,l2=null,vm=null,c2=!1;function R_(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;c2||oh==null||oh!==L0(n)||(n=oh,"selectionStart"in n&&uw(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),vm&&Gm(vm,n)||(vm=n,n=z0(l2,"onSelect"),0<n.length&&(e=new ow("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=oh)))}function kg(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var lh={animationend:kg("Animation","AnimationEnd"),animationiteration:kg("Animation","AnimationIteration"),animationstart:kg("Animation","AnimationStart"),transitionend:kg("Transition","TransitionEnd")},C1={},dE={};sl&&(dE=document.createElement("div").style,"AnimationEvent"in window||(delete lh.animationend.animation,delete lh.animationiteration.animation,delete lh.animationstart.animation),"TransitionEvent"in window||delete lh.transitionend.transition);function Zy(t){if(C1[t])return C1[t];if(!lh[t])return t;var e=lh[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in dE)return C1[t]=e[r];return t}var hE=Zy("animationend"),fE=Zy("animationiteration"),mE=Zy("animationstart"),pE=Zy("transitionend"),gE=new Map,D_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xc(t,e){gE.set(t,e),dd(e,[t])}for(var P1=0;P1<D_.length;P1++){var R1=D_[P1],TL=R1.toLowerCase(),IL=R1[0].toUpperCase()+R1.slice(1);Xc(TL,"on"+IL)}Xc(hE,"onAnimationEnd");Xc(fE,"onAnimationIteration");Xc(mE,"onAnimationStart");Xc("dblclick","onDoubleClick");Xc("focusin","onFocus");Xc("focusout","onBlur");Xc(pE,"onTransitionEnd");zh("onMouseEnter",["mouseout","mouseover"]);zh("onMouseLeave",["mouseout","mouseover"]);zh("onPointerEnter",["pointerout","pointerover"]);zh("onPointerLeave",["pointerout","pointerover"]);dd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));dd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));dd("onBeforeInput",["compositionend","keypress","textInput","paste"]);dd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));dd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));dd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var am="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),CL=new Set("cancel close invalid load scroll toggle".split(" ").concat(am));function L_(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,TD(n,e,void 0,t),t.currentTarget=null}function yE(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;L_(s,l,u),i=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;L_(s,l,u),i=c}}}if(M0)throw t=s2,M0=!1,s2=null,t}function kr(t,e){var r=e[m2];r===void 0&&(r=e[m2]=new Set);var n=t+"__bubble";r.has(n)||(xE(e,t,2,!1),r.add(n))}function D1(t,e,r){var n=0;e&&(n|=4),xE(r,t,n,e)}var Tg="_reactListening"+Math.random().toString(36).slice(2);function Km(t){if(!t[Tg]){t[Tg]=!0,SA.forEach(function(r){r!=="selectionchange"&&(CL.has(r)||D1(r,!1,t),D1(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Tg]||(e[Tg]=!0,D1("selectionchange",!1,e))}}function xE(t,e,r,n){switch(tE(e)){case 1:var s=WD;break;case 4:s=HD;break;default:s=iw}r=s.bind(null,e,r,t),s=void 0,!n2||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function L1(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Vu(l),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}l=l.parentNode}}n=n.return}UA(function(){var u=i,d=tw(r),h=[];e:{var g=gE.get(t);if(g!==void 0){var m=ow,w=t;switch(t){case"keypress":if(l0(r)===0)break e;case"keydown":case"keyup":m=oL;break;case"focusin":w="focus",m=k1;break;case"focusout":w="blur",m=k1;break;case"beforeblur":case"afterblur":m=k1;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=__;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=YD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=uL;break;case hE:case fE:case mE:m=XD;break;case pE:m=hL;break;case"scroll":m=GD;break;case"wheel":m=mL;break;case"copy":case"cut":case"paste":m=eL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=S_}var _=(e&4)!==0,T=!_&&t==="scroll",v=_?g!==null?g+"Capture":null:g;_=[];for(var b=u,x;b!==null;){x=b;var P=x.stateNode;if(x.tag===5&&P!==null&&(x=P,v!==null&&(P=zm(b,v),P!=null&&_.push(Ym(b,P,x)))),T)break;b=b.return}0<_.length&&(g=new m(g,w,null,r,d),h.push({event:g,listeners:_}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",g&&r!==t2&&(w=r.relatedTarget||r.fromElement)&&(Vu(w)||w[il]))break e;if((m||g)&&(g=d.window===d?d:(g=d.ownerDocument)?g.defaultView||g.parentWindow:window,m?(w=r.relatedTarget||r.toElement,m=u,w=w?Vu(w):null,w!==null&&(T=hd(w),w!==T||w.tag!==5&&w.tag!==6)&&(w=null)):(m=null,w=u),m!==w)){if(_=__,P="onMouseLeave",v="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(_=S_,P="onPointerLeave",v="onPointerEnter",b="pointer"),T=m==null?g:ch(m),x=w==null?g:ch(w),g=new _(P,b+"leave",m,r,d),g.target=T,g.relatedTarget=x,P=null,Vu(d)===u&&(_=new _(v,b+"enter",w,r,d),_.target=x,_.relatedTarget=T,P=_),T=P,m&&w)t:{for(_=m,v=w,b=0,x=_;x;x=Gd(x))b++;for(x=0,P=v;P;P=Gd(P))x++;for(;0<b-x;)_=Gd(_),b--;for(;0<x-b;)v=Gd(v),x--;for(;b--;){if(_===v||v!==null&&_===v.alternate)break t;_=Gd(_),v=Gd(v)}_=null}else _=null;m!==null&&O_(h,g,m,_,!1),w!==null&&T!==null&&O_(h,T,w,_,!0)}}e:{if(g=u?ch(u):window,m=g.nodeName&&g.nodeName.toLowerCase(),m==="select"||m==="input"&&g.type==="file")var F=wL;else if(k_(g))if(oE)F=SL;else{F=_L;var $=NL}else(m=g.nodeName)&&m.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(F=jL);if(F&&(F=F(t,u))){aE(h,F,r,d);break e}$&&$(t,g,u),t==="focusout"&&($=g._wrapperState)&&$.controlled&&g.type==="number"&&Qv(g,"number",g.value)}switch($=u?ch(u):window,t){case"focusin":(k_($)||$.contentEditable==="true")&&(oh=$,l2=u,vm=null);break;case"focusout":vm=l2=oh=null;break;case"mousedown":c2=!0;break;case"contextmenu":case"mouseup":case"dragend":c2=!1,R_(h,r,d);break;case"selectionchange":if(kL)break;case"keydown":case"keyup":R_(h,r,d)}var k;if(cw)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else ah?sE(t,r)&&(A="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(nE&&r.locale!=="ko"&&(ah||A!=="onCompositionStart"?A==="onCompositionEnd"&&ah&&(k=rE()):(fc=d,aw="value"in fc?fc.value:fc.textContent,ah=!0)),$=z0(u,A),0<$.length&&(A=new j_(A,t,null,r,d),h.push({event:A,listeners:$}),k?A.data=k:(k=iE(r),k!==null&&(A.data=k)))),(k=gL?yL(t,r):xL(t,r))&&(u=z0(u,"onBeforeInput"),0<u.length&&(d=new j_("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:u}),d.data=k))}yE(h,e)})}function Ym(t,e,r){return{instance:t,listener:e,currentTarget:r}}function z0(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=zm(t,r),i!=null&&n.unshift(Ym(t,i,s)),i=zm(t,e),i!=null&&n.push(Ym(t,i,s))),t=t.return}return n}function Gd(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function O_(t,e,r,n,s){for(var i=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,s?(c=zm(r,i),c!=null&&o.unshift(Ym(r,c,l))):s||(c=zm(r,i),c!=null&&o.push(Ym(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var PL=/\r\n?/g,RL=/\u0000|\uFFFD/g;function M_(t){return(typeof t=="string"?t:""+t).replace(PL,`
`).replace(RL,"")}function Ig(t,e,r){if(e=M_(e),M_(t)!==e&&r)throw Error(Ue(425))}function q0(){}var u2=null,d2=null;function h2(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var f2=typeof setTimeout=="function"?setTimeout:void 0,DL=typeof clearTimeout=="function"?clearTimeout:void 0,F_=typeof Promise=="function"?Promise:void 0,LL=typeof queueMicrotask=="function"?queueMicrotask:typeof F_<"u"?function(t){return F_.resolve(null).then(t).catch(OL)}:f2;function OL(t){setTimeout(function(){throw t})}function O1(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),Wm(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Wm(e)}function Nc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function V_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var uf=Math.random().toString(36).slice(2),Ya="__reactFiber$"+uf,Qm="__reactProps$"+uf,il="__reactContainer$"+uf,m2="__reactEvents$"+uf,ML="__reactListeners$"+uf,FL="__reactHandles$"+uf;function Vu(t){var e=t[Ya];if(e)return e;for(var r=t.parentNode;r;){if(e=r[il]||r[Ya]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=V_(t);t!==null;){if(r=t[Ya])return r;t=V_(t)}return e}t=r,r=t.parentNode}return null}function jp(t){return t=t[Ya]||t[il],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ch(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Ue(33))}function ex(t){return t[Qm]||null}var p2=[],uh=-1;function Zc(t){return{current:t}}function Ir(t){0>uh||(t.current=p2[uh],p2[uh]=null,uh--)}function _r(t,e){uh++,p2[uh]=t.current,t.current=e}var Mc={},hs=Zc(Mc),Gs=Zc(!1),Zu=Mc;function qh(t,e){var r=t.type.contextTypes;if(!r)return Mc;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ks(t){return t=t.childContextTypes,t!=null}function $0(){Ir(Gs),Ir(hs)}function B_(t,e,r){if(hs.current!==Mc)throw Error(Ue(168));_r(hs,e),_r(Gs,r)}function vE(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(Ue(108,ND(t)||"Unknown",s));return Ur({},r,n)}function W0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Mc,Zu=hs.current,_r(hs,t),_r(Gs,Gs.current),!0}function U_(t,e,r){var n=t.stateNode;if(!n)throw Error(Ue(169));r?(t=vE(t,e,Zu),n.__reactInternalMemoizedMergedChildContext=t,Ir(Gs),Ir(hs),_r(hs,t)):Ir(Gs),_r(Gs,r)}var $o=null,tx=!1,M1=!1;function bE(t){$o===null?$o=[t]:$o.push(t)}function VL(t){tx=!0,bE(t)}function eu(){if(!M1&&$o!==null){M1=!0;var t=0,e=lr;try{var r=$o;for(lr=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}$o=null,tx=!1}catch(s){throw $o!==null&&($o=$o.slice(t+1)),WA(rw,eu),s}finally{lr=e,M1=!1}}return null}var dh=[],hh=0,H0=null,G0=0,Wi=[],Hi=0,ed=null,Ho=1,Go="";function ku(t,e){dh[hh++]=G0,dh[hh++]=H0,H0=t,G0=e}function wE(t,e,r){Wi[Hi++]=Ho,Wi[Hi++]=Go,Wi[Hi++]=ed,ed=t;var n=Ho;t=Go;var s=32-Na(n)-1;n&=~(1<<s),r+=1;var i=32-Na(e)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Ho=1<<32-Na(e)+s|r<<s|n,Go=i+t}else Ho=1<<i|r<<s|n,Go=t}function dw(t){t.return!==null&&(ku(t,1),wE(t,1,0))}function hw(t){for(;t===H0;)H0=dh[--hh],dh[hh]=null,G0=dh[--hh],dh[hh]=null;for(;t===ed;)ed=Wi[--Hi],Wi[Hi]=null,Go=Wi[--Hi],Wi[Hi]=null,Ho=Wi[--Hi],Wi[Hi]=null}var vi=null,pi=null,Pr=!1,va=null;function NE(t,e){var r=Gi(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function z_(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,vi=t,pi=Nc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,vi=t,pi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=ed!==null?{id:Ho,overflow:Go}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Gi(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,vi=t,pi=null,!0):!1;default:return!1}}function g2(t){return(t.mode&1)!==0&&(t.flags&128)===0}function y2(t){if(Pr){var e=pi;if(e){var r=e;if(!z_(t,e)){if(g2(t))throw Error(Ue(418));e=Nc(r.nextSibling);var n=vi;e&&z_(t,e)?NE(n,r):(t.flags=t.flags&-4097|2,Pr=!1,vi=t)}}else{if(g2(t))throw Error(Ue(418));t.flags=t.flags&-4097|2,Pr=!1,vi=t}}}function q_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;vi=t}function Cg(t){if(t!==vi)return!1;if(!Pr)return q_(t),Pr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!h2(t.type,t.memoizedProps)),e&&(e=pi)){if(g2(t))throw _E(),Error(Ue(418));for(;e;)NE(t,e),e=Nc(e.nextSibling)}if(q_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ue(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){pi=Nc(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}pi=null}}else pi=vi?Nc(t.stateNode.nextSibling):null;return!0}function _E(){for(var t=pi;t;)t=Nc(t.nextSibling)}function $h(){pi=vi=null,Pr=!1}function fw(t){va===null?va=[t]:va.push(t)}var BL=xl.ReactCurrentBatchConfig;function Kf(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ue(309));var n=r.stateNode}if(!n)throw Error(Ue(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Ue(284));if(!r._owner)throw Error(Ue(290,t))}return t}function Pg(t,e){throw t=Object.prototype.toString.call(e),Error(Ue(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function $_(t){var e=t._init;return e(t._payload)}function jE(t){function e(v,b){if(t){var x=v.deletions;x===null?(v.deletions=[b],v.flags|=16):x.push(b)}}function r(v,b){if(!t)return null;for(;b!==null;)e(v,b),b=b.sibling;return null}function n(v,b){for(v=new Map;b!==null;)b.key!==null?v.set(b.key,b):v.set(b.index,b),b=b.sibling;return v}function s(v,b){return v=Ac(v,b),v.index=0,v.sibling=null,v}function i(v,b,x){return v.index=x,t?(x=v.alternate,x!==null?(x=x.index,x<b?(v.flags|=2,b):x):(v.flags|=2,b)):(v.flags|=1048576,b)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function l(v,b,x,P){return b===null||b.tag!==6?(b=$1(x,v.mode,P),b.return=v,b):(b=s(b,x),b.return=v,b)}function c(v,b,x,P){var F=x.type;return F===ih?d(v,b,x.props.children,P,x.key):b!==null&&(b.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===nc&&$_(F)===b.type)?(P=s(b,x.props),P.ref=Kf(v,b,x),P.return=v,P):(P=p0(x.type,x.key,x.props,null,v.mode,P),P.ref=Kf(v,b,x),P.return=v,P)}function u(v,b,x,P){return b===null||b.tag!==4||b.stateNode.containerInfo!==x.containerInfo||b.stateNode.implementation!==x.implementation?(b=W1(x,v.mode,P),b.return=v,b):(b=s(b,x.children||[]),b.return=v,b)}function d(v,b,x,P,F){return b===null||b.tag!==7?(b=Gu(x,v.mode,P,F),b.return=v,b):(b=s(b,x),b.return=v,b)}function h(v,b,x){if(typeof b=="string"&&b!==""||typeof b=="number")return b=$1(""+b,v.mode,x),b.return=v,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case wg:return x=p0(b.type,b.key,b.props,null,v.mode,x),x.ref=Kf(v,null,b),x.return=v,x;case sh:return b=W1(b,v.mode,x),b.return=v,b;case nc:var P=b._init;return h(v,P(b._payload),x)}if(sm(b)||qf(b))return b=Gu(b,v.mode,x,null),b.return=v,b;Pg(v,b)}return null}function g(v,b,x,P){var F=b!==null?b.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return F!==null?null:l(v,b,""+x,P);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case wg:return x.key===F?c(v,b,x,P):null;case sh:return x.key===F?u(v,b,x,P):null;case nc:return F=x._init,g(v,b,F(x._payload),P)}if(sm(x)||qf(x))return F!==null?null:d(v,b,x,P,null);Pg(v,x)}return null}function m(v,b,x,P,F){if(typeof P=="string"&&P!==""||typeof P=="number")return v=v.get(x)||null,l(b,v,""+P,F);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case wg:return v=v.get(P.key===null?x:P.key)||null,c(b,v,P,F);case sh:return v=v.get(P.key===null?x:P.key)||null,u(b,v,P,F);case nc:var $=P._init;return m(v,b,x,$(P._payload),F)}if(sm(P)||qf(P))return v=v.get(x)||null,d(b,v,P,F,null);Pg(b,P)}return null}function w(v,b,x,P){for(var F=null,$=null,k=b,A=b=0,I=null;k!==null&&A<x.length;A++){k.index>A?(I=k,k=null):I=k.sibling;var O=g(v,k,x[A],P);if(O===null){k===null&&(k=I);break}t&&k&&O.alternate===null&&e(v,k),b=i(O,b,A),$===null?F=O:$.sibling=O,$=O,k=I}if(A===x.length)return r(v,k),Pr&&ku(v,A),F;if(k===null){for(;A<x.length;A++)k=h(v,x[A],P),k!==null&&(b=i(k,b,A),$===null?F=k:$.sibling=k,$=k);return Pr&&ku(v,A),F}for(k=n(v,k);A<x.length;A++)I=m(k,v,A,x[A],P),I!==null&&(t&&I.alternate!==null&&k.delete(I.key===null?A:I.key),b=i(I,b,A),$===null?F=I:$.sibling=I,$=I);return t&&k.forEach(function(S){return e(v,S)}),Pr&&ku(v,A),F}function _(v,b,x,P){var F=qf(x);if(typeof F!="function")throw Error(Ue(150));if(x=F.call(x),x==null)throw Error(Ue(151));for(var $=F=null,k=b,A=b=0,I=null,O=x.next();k!==null&&!O.done;A++,O=x.next()){k.index>A?(I=k,k=null):I=k.sibling;var S=g(v,k,O.value,P);if(S===null){k===null&&(k=I);break}t&&k&&S.alternate===null&&e(v,k),b=i(S,b,A),$===null?F=S:$.sibling=S,$=S,k=I}if(O.done)return r(v,k),Pr&&ku(v,A),F;if(k===null){for(;!O.done;A++,O=x.next())O=h(v,O.value,P),O!==null&&(b=i(O,b,A),$===null?F=O:$.sibling=O,$=O);return Pr&&ku(v,A),F}for(k=n(v,k);!O.done;A++,O=x.next())O=m(k,v,A,O.value,P),O!==null&&(t&&O.alternate!==null&&k.delete(O.key===null?A:O.key),b=i(O,b,A),$===null?F=O:$.sibling=O,$=O);return t&&k.forEach(function(R){return e(v,R)}),Pr&&ku(v,A),F}function T(v,b,x,P){if(typeof x=="object"&&x!==null&&x.type===ih&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case wg:e:{for(var F=x.key,$=b;$!==null;){if($.key===F){if(F=x.type,F===ih){if($.tag===7){r(v,$.sibling),b=s($,x.props.children),b.return=v,v=b;break e}}else if($.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===nc&&$_(F)===$.type){r(v,$.sibling),b=s($,x.props),b.ref=Kf(v,$,x),b.return=v,v=b;break e}r(v,$);break}else e(v,$);$=$.sibling}x.type===ih?(b=Gu(x.props.children,v.mode,P,x.key),b.return=v,v=b):(P=p0(x.type,x.key,x.props,null,v.mode,P),P.ref=Kf(v,b,x),P.return=v,v=P)}return o(v);case sh:e:{for($=x.key;b!==null;){if(b.key===$)if(b.tag===4&&b.stateNode.containerInfo===x.containerInfo&&b.stateNode.implementation===x.implementation){r(v,b.sibling),b=s(b,x.children||[]),b.return=v,v=b;break e}else{r(v,b);break}else e(v,b);b=b.sibling}b=W1(x,v.mode,P),b.return=v,v=b}return o(v);case nc:return $=x._init,T(v,b,$(x._payload),P)}if(sm(x))return w(v,b,x,P);if(qf(x))return _(v,b,x,P);Pg(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,b!==null&&b.tag===6?(r(v,b.sibling),b=s(b,x),b.return=v,v=b):(r(v,b),b=$1(x,v.mode,P),b.return=v,v=b),o(v)):r(v,b)}return T}var Wh=jE(!0),SE=jE(!1),K0=Zc(null),Y0=null,fh=null,mw=null;function pw(){mw=fh=Y0=null}function gw(t){var e=K0.current;Ir(K0),t._currentValue=e}function x2(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function kh(t,e){Y0=t,mw=fh=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Hs=!0),t.firstContext=null)}function Qi(t){var e=t._currentValue;if(mw!==t)if(t={context:t,memoizedValue:e,next:null},fh===null){if(Y0===null)throw Error(Ue(308));fh=t,Y0.dependencies={lanes:0,firstContext:t}}else fh=fh.next=t;return e}var Bu=null;function yw(t){Bu===null?Bu=[t]:Bu.push(t)}function AE(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,yw(e)):(r.next=s.next,s.next=r),e.interleaved=r,al(t,n)}function al(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var sc=!1;function xw(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function EE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Zo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function _c(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Jt&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,al(t,r)}return s=n.interleaved,s===null?(e.next=e,yw(n)):(e.next=s.next,s.next=e),n.interleaved=e,al(t,r)}function c0(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,nw(t,r)}}function W_(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Q0(t,e,r,n){var s=t.updateQueue;sc=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,d=u=c=null,l=i;do{var g=l.lane,m=l.eventTime;if((n&g)===g){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var w=t,_=l;switch(g=e,m=r,_.tag){case 1:if(w=_.payload,typeof w=="function"){h=w.call(m,h,g);break e}h=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=_.payload,g=typeof w=="function"?w.call(m,h,g):w,g==null)break e;h=Ur({},h,g);break e;case 2:sc=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[l]:g.push(l))}else m={eventTime:m,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=h):d=d.next=m,o|=g;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;g=l,l=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(1);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);rd|=o,t.lanes=o,t.memoizedState=h}}function H_(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(Ue(191,s));s.call(n)}}}var Sp={},so=Zc(Sp),Jm=Zc(Sp),Xm=Zc(Sp);function Uu(t){if(t===Sp)throw Error(Ue(174));return t}function vw(t,e){switch(_r(Xm,e),_r(Jm,t),_r(so,Sp),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Xv(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Xv(e,t)}Ir(so),_r(so,e)}function Hh(){Ir(so),Ir(Jm),Ir(Xm)}function kE(t){Uu(Xm.current);var e=Uu(so.current),r=Xv(e,t.type);e!==r&&(_r(Jm,t),_r(so,r))}function bw(t){Jm.current===t&&(Ir(so),Ir(Jm))}var Or=Zc(0);function J0(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var F1=[];function ww(){for(var t=0;t<F1.length;t++)F1[t]._workInProgressVersionPrimary=null;F1.length=0}var u0=xl.ReactCurrentDispatcher,V1=xl.ReactCurrentBatchConfig,td=0,Vr=null,bn=null,Tn=null,X0=!1,bm=!1,Zm=0,UL=0;function Jn(){throw Error(Ue(321))}function Nw(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Ea(t[r],e[r]))return!1;return!0}function _w(t,e,r,n,s,i){if(td=i,Vr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,u0.current=t===null||t.memoizedState===null?WL:HL,t=r(n,s),bm){i=0;do{if(bm=!1,Zm=0,25<=i)throw Error(Ue(301));i+=1,Tn=bn=null,e.updateQueue=null,u0.current=GL,t=r(n,s)}while(bm)}if(u0.current=Z0,e=bn!==null&&bn.next!==null,td=0,Tn=bn=Vr=null,X0=!1,e)throw Error(Ue(300));return t}function jw(){var t=Zm!==0;return Zm=0,t}function $a(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tn===null?Vr.memoizedState=Tn=t:Tn=Tn.next=t,Tn}function Ji(){if(bn===null){var t=Vr.alternate;t=t!==null?t.memoizedState:null}else t=bn.next;var e=Tn===null?Vr.memoizedState:Tn.next;if(e!==null)Tn=e,bn=t;else{if(t===null)throw Error(Ue(310));bn=t,t={memoizedState:bn.memoizedState,baseState:bn.baseState,baseQueue:bn.baseQueue,queue:bn.queue,next:null},Tn===null?Vr.memoizedState=Tn=t:Tn=Tn.next=t}return Tn}function ep(t,e){return typeof e=="function"?e(t):e}function B1(t){var e=Ji(),r=e.queue;if(r===null)throw Error(Ue(311));r.lastRenderedReducer=t;var n=bn,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((td&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=n):c=c.next=h,Vr.lanes|=d,rd|=d}u=u.next}while(u!==null&&u!==i);c===null?o=n:c.next=l,Ea(n,e.memoizedState)||(Hs=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,Vr.lanes|=i,rd|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function U1(t){var e=Ji(),r=e.queue;if(r===null)throw Error(Ue(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Ea(i,e.memoizedState)||(Hs=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function TE(){}function IE(t,e){var r=Vr,n=Ji(),s=e(),i=!Ea(n.memoizedState,s);if(i&&(n.memoizedState=s,Hs=!0),n=n.queue,Sw(RE.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||Tn!==null&&Tn.memoizedState.tag&1){if(r.flags|=2048,tp(9,PE.bind(null,r,n,s,e),void 0,null),Pn===null)throw Error(Ue(349));td&30||CE(r,e,s)}return s}function CE(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Vr.updateQueue,e===null?(e={lastEffect:null,stores:null},Vr.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function PE(t,e,r,n){e.value=r,e.getSnapshot=n,DE(e)&&LE(t)}function RE(t,e,r){return r(function(){DE(e)&&LE(t)})}function DE(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Ea(t,r)}catch{return!0}}function LE(t){var e=al(t,1);e!==null&&_a(e,t,1,-1)}function G_(t){var e=$a();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ep,lastRenderedState:t},e.queue=t,t=t.dispatch=$L.bind(null,Vr,t),[e.memoizedState,t]}function tp(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Vr.updateQueue,e===null?(e={lastEffect:null,stores:null},Vr.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function OE(){return Ji().memoizedState}function d0(t,e,r,n){var s=$a();Vr.flags|=t,s.memoizedState=tp(1|e,r,void 0,n===void 0?null:n)}function rx(t,e,r,n){var s=Ji();n=n===void 0?null:n;var i=void 0;if(bn!==null){var o=bn.memoizedState;if(i=o.destroy,n!==null&&Nw(n,o.deps)){s.memoizedState=tp(e,r,i,n);return}}Vr.flags|=t,s.memoizedState=tp(1|e,r,i,n)}function K_(t,e){return d0(8390656,8,t,e)}function Sw(t,e){return rx(2048,8,t,e)}function ME(t,e){return rx(4,2,t,e)}function FE(t,e){return rx(4,4,t,e)}function VE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function BE(t,e,r){return r=r!=null?r.concat([t]):null,rx(4,4,VE.bind(null,e,t),r)}function Aw(){}function UE(t,e){var r=Ji();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Nw(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function zE(t,e){var r=Ji();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Nw(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function qE(t,e,r){return td&21?(Ea(r,e)||(r=KA(),Vr.lanes|=r,rd|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Hs=!0),t.memoizedState=r)}function zL(t,e){var r=lr;lr=r!==0&&4>r?r:4,t(!0);var n=V1.transition;V1.transition={};try{t(!1),e()}finally{lr=r,V1.transition=n}}function $E(){return Ji().memoizedState}function qL(t,e,r){var n=Sc(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},WE(t))HE(e,r);else if(r=AE(t,e,r,n),r!==null){var s=Es();_a(r,t,n,s),GE(r,e,n)}}function $L(t,e,r){var n=Sc(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(WE(t))HE(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,r);if(s.hasEagerState=!0,s.eagerState=l,Ea(l,o)){var c=e.interleaved;c===null?(s.next=s,yw(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}r=AE(t,e,s,n),r!==null&&(s=Es(),_a(r,t,n,s),GE(r,e,n))}}function WE(t){var e=t.alternate;return t===Vr||e!==null&&e===Vr}function HE(t,e){bm=X0=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function GE(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,nw(t,r)}}var Z0={readContext:Qi,useCallback:Jn,useContext:Jn,useEffect:Jn,useImperativeHandle:Jn,useInsertionEffect:Jn,useLayoutEffect:Jn,useMemo:Jn,useReducer:Jn,useRef:Jn,useState:Jn,useDebugValue:Jn,useDeferredValue:Jn,useTransition:Jn,useMutableSource:Jn,useSyncExternalStore:Jn,useId:Jn,unstable_isNewReconciler:!1},WL={readContext:Qi,useCallback:function(t,e){return $a().memoizedState=[t,e===void 0?null:e],t},useContext:Qi,useEffect:K_,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,d0(4194308,4,VE.bind(null,e,t),r)},useLayoutEffect:function(t,e){return d0(4194308,4,t,e)},useInsertionEffect:function(t,e){return d0(4,2,t,e)},useMemo:function(t,e){var r=$a();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=$a();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=qL.bind(null,Vr,t),[n.memoizedState,t]},useRef:function(t){var e=$a();return t={current:t},e.memoizedState=t},useState:G_,useDebugValue:Aw,useDeferredValue:function(t){return $a().memoizedState=t},useTransition:function(){var t=G_(!1),e=t[0];return t=zL.bind(null,t[1]),$a().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Vr,s=$a();if(Pr){if(r===void 0)throw Error(Ue(407));r=r()}else{if(r=e(),Pn===null)throw Error(Ue(349));td&30||CE(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,K_(RE.bind(null,n,i,t),[t]),n.flags|=2048,tp(9,PE.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=$a(),e=Pn.identifierPrefix;if(Pr){var r=Go,n=Ho;r=(n&~(1<<32-Na(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Zm++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=UL++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},HL={readContext:Qi,useCallback:UE,useContext:Qi,useEffect:Sw,useImperativeHandle:BE,useInsertionEffect:ME,useLayoutEffect:FE,useMemo:zE,useReducer:B1,useRef:OE,useState:function(){return B1(ep)},useDebugValue:Aw,useDeferredValue:function(t){var e=Ji();return qE(e,bn.memoizedState,t)},useTransition:function(){var t=B1(ep)[0],e=Ji().memoizedState;return[t,e]},useMutableSource:TE,useSyncExternalStore:IE,useId:$E,unstable_isNewReconciler:!1},GL={readContext:Qi,useCallback:UE,useContext:Qi,useEffect:Sw,useImperativeHandle:BE,useInsertionEffect:ME,useLayoutEffect:FE,useMemo:zE,useReducer:U1,useRef:OE,useState:function(){return U1(ep)},useDebugValue:Aw,useDeferredValue:function(t){var e=Ji();return bn===null?e.memoizedState=t:qE(e,bn.memoizedState,t)},useTransition:function(){var t=U1(ep)[0],e=Ji().memoizedState;return[t,e]},useMutableSource:TE,useSyncExternalStore:IE,useId:$E,unstable_isNewReconciler:!1};function pa(t,e){if(t&&t.defaultProps){e=Ur({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function v2(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Ur({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var nx={isMounted:function(t){return(t=t._reactInternals)?hd(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Es(),s=Sc(t),i=Zo(n,s);i.payload=e,r!=null&&(i.callback=r),e=_c(t,i,s),e!==null&&(_a(e,t,s,n),c0(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Es(),s=Sc(t),i=Zo(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=_c(t,i,s),e!==null&&(_a(e,t,s,n),c0(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Es(),n=Sc(t),s=Zo(r,n);s.tag=2,e!=null&&(s.callback=e),e=_c(t,s,n),e!==null&&(_a(e,t,n,r),c0(e,t,n))}};function Y_(t,e,r,n,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,o):e.prototype&&e.prototype.isPureReactComponent?!Gm(r,n)||!Gm(s,i):!0}function KE(t,e,r){var n=!1,s=Mc,i=e.contextType;return typeof i=="object"&&i!==null?i=Qi(i):(s=Ks(e)?Zu:hs.current,n=e.contextTypes,i=(n=n!=null)?qh(t,s):Mc),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=nx,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Q_(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&nx.enqueueReplaceState(e,e.state,null)}function b2(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},xw(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Qi(i):(i=Ks(e)?Zu:hs.current,s.context=qh(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(v2(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&nx.enqueueReplaceState(s,s.state,null),Q0(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Gh(t,e){try{var r="",n=e;do r+=wD(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function z1(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function w2(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var KL=typeof WeakMap=="function"?WeakMap:Map;function YE(t,e,r){r=Zo(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){ty||(ty=!0,C2=n),w2(t,e)},r}function QE(t,e,r){r=Zo(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){w2(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){w2(t,e),typeof n!="function"&&(jc===null?jc=new Set([this]):jc.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function J_(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new KL;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=l8.bind(null,t,e,r),e.then(t,t))}function X_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Z_(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Zo(-1,1),e.tag=2,_c(r,e,1))),r.lanes|=1),t)}var YL=xl.ReactCurrentOwner,Hs=!1;function js(t,e,r,n){e.child=t===null?SE(e,null,r,n):Wh(e,t.child,r,n)}function ej(t,e,r,n,s){r=r.render;var i=e.ref;return kh(e,s),n=_w(t,e,r,n,i,s),r=jw(),t!==null&&!Hs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ol(t,e,s)):(Pr&&r&&dw(e),e.flags|=1,js(t,e,n,s),e.child)}function tj(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!Dw(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,JE(t,e,i,n,s)):(t=p0(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Gm,r(o,n)&&t.ref===e.ref)return ol(t,e,s)}return e.flags|=1,t=Ac(i,n),t.ref=e.ref,t.return=e,e.child=t}function JE(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(Gm(i,n)&&t.ref===e.ref)if(Hs=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(Hs=!0);else return e.lanes=t.lanes,ol(t,e,s)}return N2(t,e,r,n,s)}function XE(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_r(ph,fi),fi|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,_r(ph,fi),fi|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,_r(ph,fi),fi|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,_r(ph,fi),fi|=n;return js(t,e,s,r),e.child}function ZE(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function N2(t,e,r,n,s){var i=Ks(r)?Zu:hs.current;return i=qh(e,i),kh(e,s),r=_w(t,e,r,n,i,s),n=jw(),t!==null&&!Hs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ol(t,e,s)):(Pr&&n&&dw(e),e.flags|=1,js(t,e,r,s),e.child)}function rj(t,e,r,n,s){if(Ks(r)){var i=!0;W0(e)}else i=!1;if(kh(e,s),e.stateNode===null)h0(t,e),KE(e,r,n),b2(e,r,n,s),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Qi(u):(u=Ks(r)?Zu:hs.current,u=qh(e,u));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&Q_(e,o,n,u),sc=!1;var g=e.memoizedState;o.state=g,Q0(e,n,o,s),c=e.memoizedState,l!==n||g!==c||Gs.current||sc?(typeof d=="function"&&(v2(e,r,d,n),c=e.memoizedState),(l=sc||Y_(e,r,l,n,g,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,EE(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:pa(e.type,l),o.props=u,h=e.pendingProps,g=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Qi(c):(c=Ks(r)?Zu:hs.current,c=qh(e,c));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||g!==c)&&Q_(e,o,n,c),sc=!1,g=e.memoizedState,o.state=g,Q0(e,n,o,s);var w=e.memoizedState;l!==h||g!==w||Gs.current||sc?(typeof m=="function"&&(v2(e,r,m,n),w=e.memoizedState),(u=sc||Y_(e,r,u,n,g,w,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,w,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,w,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=w),o.props=n,o.state=w,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),n=!1)}return _2(t,e,r,n,i,s)}function _2(t,e,r,n,s,i){ZE(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return s&&U_(e,r,!1),ol(t,e,i);n=e.stateNode,YL.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=Wh(e,t.child,null,i),e.child=Wh(e,null,l,i)):js(t,e,l,i),e.memoizedState=n.state,s&&U_(e,r,!0),e.child}function ek(t){var e=t.stateNode;e.pendingContext?B_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&B_(t,e.context,!1),vw(t,e.containerInfo)}function nj(t,e,r,n,s){return $h(),fw(s),e.flags|=256,js(t,e,r,n),e.child}var j2={dehydrated:null,treeContext:null,retryLane:0};function S2(t){return{baseLanes:t,cachePool:null,transitions:null}}function tk(t,e,r){var n=e.pendingProps,s=Or.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),_r(Or,s&1),t===null)return y2(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,i?(n=e.mode,i=e.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=ax(o,n,0,null),t=Gu(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=S2(r),e.memoizedState=j2,t):Ew(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return QL(t,e,o,n,l,s,r);if(i){i=n.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Ac(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Ac(l,i):(i=Gu(i,o,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,o=t.child.memoizedState,o=o===null?S2(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~r,e.memoizedState=j2,n}return i=t.child,t=i.sibling,n=Ac(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Ew(t,e){return e=ax({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Rg(t,e,r,n){return n!==null&&fw(n),Wh(e,t.child,null,r),t=Ew(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function QL(t,e,r,n,s,i,o){if(r)return e.flags&256?(e.flags&=-257,n=z1(Error(Ue(422))),Rg(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=ax({mode:"visible",children:n.children},s,0,null),i=Gu(i,s,o,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&Wh(e,t.child,null,o),e.child.memoizedState=S2(o),e.memoizedState=j2,i);if(!(e.mode&1))return Rg(t,e,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(Ue(419)),n=z1(i,n,void 0),Rg(t,e,o,n)}if(l=(o&t.childLanes)!==0,Hs||l){if(n=Pn,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,al(t,s),_a(n,t,s,-1))}return Rw(),n=z1(Error(Ue(421))),Rg(t,e,o,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=c8.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,pi=Nc(s.nextSibling),vi=e,Pr=!0,va=null,t!==null&&(Wi[Hi++]=Ho,Wi[Hi++]=Go,Wi[Hi++]=ed,Ho=t.id,Go=t.overflow,ed=e),e=Ew(e,n.children),e.flags|=4096,e)}function sj(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),x2(t.return,e,r)}function q1(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function rk(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(js(t,e,n.children,r),n=Or.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&sj(t,r,e);else if(t.tag===19)sj(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(_r(Or,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&J0(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),q1(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&J0(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}q1(e,!0,r,null,i);break;case"together":q1(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function h0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ol(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),rd|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Ue(153));if(e.child!==null){for(t=e.child,r=Ac(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Ac(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function JL(t,e,r){switch(e.tag){case 3:ek(e),$h();break;case 5:kE(e);break;case 1:Ks(e.type)&&W0(e);break;case 4:vw(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;_r(K0,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(_r(Or,Or.current&1),e.flags|=128,null):r&e.child.childLanes?tk(t,e,r):(_r(Or,Or.current&1),t=ol(t,e,r),t!==null?t.sibling:null);_r(Or,Or.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return rk(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),_r(Or,Or.current),n)break;return null;case 22:case 23:return e.lanes=0,XE(t,e,r)}return ol(t,e,r)}var nk,A2,sk,ik;nk=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};A2=function(){};sk=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,Uu(so.current);var i=null;switch(r){case"input":s=Kv(t,s),n=Kv(t,n),i=[];break;case"select":s=Ur({},s,{value:void 0}),n=Ur({},n,{value:void 0}),i=[];break;case"textarea":s=Jv(t,s),n=Jv(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=q0)}Zv(r,n);var o;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Bm.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(l=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Bm.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&kr("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};ik=function(t,e,r,n){r!==n&&(e.flags|=4)};function Yf(t,e){if(!Pr)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Xn(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function XL(t,e,r){var n=e.pendingProps;switch(hw(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xn(e),null;case 1:return Ks(e.type)&&$0(),Xn(e),null;case 3:return n=e.stateNode,Hh(),Ir(Gs),Ir(hs),ww(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Cg(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,va!==null&&(D2(va),va=null))),A2(t,e),Xn(e),null;case 5:bw(e);var s=Uu(Xm.current);if(r=e.type,t!==null&&e.stateNode!=null)sk(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Ue(166));return Xn(e),null}if(t=Uu(so.current),Cg(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[Ya]=e,n[Qm]=i,t=(e.mode&1)!==0,r){case"dialog":kr("cancel",n),kr("close",n);break;case"iframe":case"object":case"embed":kr("load",n);break;case"video":case"audio":for(s=0;s<am.length;s++)kr(am[s],n);break;case"source":kr("error",n);break;case"img":case"image":case"link":kr("error",n),kr("load",n);break;case"details":kr("toggle",n);break;case"input":f_(n,i),kr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},kr("invalid",n);break;case"textarea":p_(n,i),kr("invalid",n)}Zv(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&Ig(n.textContent,l,t),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Ig(n.textContent,l,t),s=["children",""+l]):Bm.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&kr("scroll",n)}switch(r){case"input":Ng(n),m_(n,i,!0);break;case"textarea":Ng(n),g_(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=q0)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=RA(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[Ya]=e,t[Qm]=n,nk(t,e,!1,!1),e.stateNode=t;e:{switch(o=e2(r,n),r){case"dialog":kr("cancel",t),kr("close",t),s=n;break;case"iframe":case"object":case"embed":kr("load",t),s=n;break;case"video":case"audio":for(s=0;s<am.length;s++)kr(am[s],t);s=n;break;case"source":kr("error",t),s=n;break;case"img":case"image":case"link":kr("error",t),kr("load",t),s=n;break;case"details":kr("toggle",t),s=n;break;case"input":f_(t,n),s=Kv(t,n),kr("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=Ur({},n,{value:void 0}),kr("invalid",t);break;case"textarea":p_(t,n),s=Jv(t,n),kr("invalid",t);break;default:s=n}Zv(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?OA(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&DA(t,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Um(t,c):typeof c=="number"&&Um(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Bm.hasOwnProperty(i)?c!=null&&i==="onScroll"&&kr("scroll",t):c!=null&&Jb(t,i,c,o))}switch(r){case"input":Ng(t),m_(t,n,!1);break;case"textarea":Ng(t),g_(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Oc(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?jh(t,!!n.multiple,i,!1):n.defaultValue!=null&&jh(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=q0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Xn(e),null;case 6:if(t&&e.stateNode!=null)ik(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Ue(166));if(r=Uu(Xm.current),Uu(so.current),Cg(e)){if(n=e.stateNode,r=e.memoizedProps,n[Ya]=e,(i=n.nodeValue!==r)&&(t=vi,t!==null))switch(t.tag){case 3:Ig(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ig(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ya]=e,e.stateNode=n}return Xn(e),null;case 13:if(Ir(Or),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Pr&&pi!==null&&e.mode&1&&!(e.flags&128))_E(),$h(),e.flags|=98560,i=!1;else if(i=Cg(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(Ue(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ue(317));i[Ya]=e}else $h(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Xn(e),i=!1}else va!==null&&(D2(va),va=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Or.current&1?wn===0&&(wn=3):Rw())),e.updateQueue!==null&&(e.flags|=4),Xn(e),null);case 4:return Hh(),A2(t,e),t===null&&Km(e.stateNode.containerInfo),Xn(e),null;case 10:return gw(e.type._context),Xn(e),null;case 17:return Ks(e.type)&&$0(),Xn(e),null;case 19:if(Ir(Or),i=e.memoizedState,i===null)return Xn(e),null;if(n=(e.flags&128)!==0,o=i.rendering,o===null)if(n)Yf(i,!1);else{if(wn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=J0(t),o!==null){for(e.flags|=128,Yf(i,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return _r(Or,Or.current&1|2),e.child}t=t.sibling}i.tail!==null&&nn()>Kh&&(e.flags|=128,n=!0,Yf(i,!1),e.lanes=4194304)}else{if(!n)if(t=J0(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Yf(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Pr)return Xn(e),null}else 2*nn()-i.renderingStartTime>Kh&&r!==1073741824&&(e.flags|=128,n=!0,Yf(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(r=i.last,r!==null?r.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=nn(),e.sibling=null,r=Or.current,_r(Or,n?r&1|2:r&1),e):(Xn(e),null);case 22:case 23:return Pw(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?fi&1073741824&&(Xn(e),e.subtreeFlags&6&&(e.flags|=8192)):Xn(e),null;case 24:return null;case 25:return null}throw Error(Ue(156,e.tag))}function ZL(t,e){switch(hw(e),e.tag){case 1:return Ks(e.type)&&$0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Hh(),Ir(Gs),Ir(hs),ww(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return bw(e),null;case 13:if(Ir(Or),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Ue(340));$h()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ir(Or),null;case 4:return Hh(),null;case 10:return gw(e.type._context),null;case 22:case 23:return Pw(),null;case 24:return null;default:return null}}var Dg=!1,as=!1,e8=typeof WeakSet=="function"?WeakSet:Set,rt=null;function mh(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Yr(t,e,n)}else r.current=null}function E2(t,e,r){try{r()}catch(n){Yr(t,e,n)}}var ij=!1;function t8(t,e){if(u2=B0,t=uE(),uw(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=t,g=null;t:for(;;){for(var m;h!==r||s!==0&&h.nodeType!==3||(l=o+s),h!==i||n!==0&&h.nodeType!==3||(c=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)g=h,h=m;for(;;){if(h===t)break t;if(g===r&&++u===s&&(l=o),g===i&&++d===n&&(c=o),(m=h.nextSibling)!==null)break;h=g,g=h.parentNode}h=m}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(d2={focusedElem:t,selectionRange:r},B0=!1,rt=e;rt!==null;)if(e=rt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,rt=t;else for(;rt!==null;){e=rt;try{var w=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var _=w.memoizedProps,T=w.memoizedState,v=e.stateNode,b=v.getSnapshotBeforeUpdate(e.elementType===e.type?_:pa(e.type,_),T);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ue(163))}}catch(P){Yr(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,rt=t;break}rt=e.return}return w=ij,ij=!1,w}function wm(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&E2(e,r,i)}s=s.next}while(s!==n)}}function sx(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function k2(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function ak(t){var e=t.alternate;e!==null&&(t.alternate=null,ak(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ya],delete e[Qm],delete e[m2],delete e[ML],delete e[FL])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ok(t){return t.tag===5||t.tag===3||t.tag===4}function aj(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ok(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function T2(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=q0));else if(n!==4&&(t=t.child,t!==null))for(T2(t,e,r),t=t.sibling;t!==null;)T2(t,e,r),t=t.sibling}function I2(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(I2(t,e,r),t=t.sibling;t!==null;)I2(t,e,r),t=t.sibling}var Mn=null,ya=!1;function Yl(t,e,r){for(r=r.child;r!==null;)lk(t,e,r),r=r.sibling}function lk(t,e,r){if(no&&typeof no.onCommitFiberUnmount=="function")try{no.onCommitFiberUnmount(Qy,r)}catch{}switch(r.tag){case 5:as||mh(r,e);case 6:var n=Mn,s=ya;Mn=null,Yl(t,e,r),Mn=n,ya=s,Mn!==null&&(ya?(t=Mn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Mn.removeChild(r.stateNode));break;case 18:Mn!==null&&(ya?(t=Mn,r=r.stateNode,t.nodeType===8?O1(t.parentNode,r):t.nodeType===1&&O1(t,r),Wm(t)):O1(Mn,r.stateNode));break;case 4:n=Mn,s=ya,Mn=r.stateNode.containerInfo,ya=!0,Yl(t,e,r),Mn=n,ya=s;break;case 0:case 11:case 14:case 15:if(!as&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&E2(r,e,o),s=s.next}while(s!==n)}Yl(t,e,r);break;case 1:if(!as&&(mh(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Yr(r,e,l)}Yl(t,e,r);break;case 21:Yl(t,e,r);break;case 22:r.mode&1?(as=(n=as)||r.memoizedState!==null,Yl(t,e,r),as=n):Yl(t,e,r);break;default:Yl(t,e,r)}}function oj(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new e8),e.forEach(function(n){var s=u8.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function ha(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Mn=l.stateNode,ya=!1;break e;case 3:Mn=l.stateNode.containerInfo,ya=!0;break e;case 4:Mn=l.stateNode.containerInfo,ya=!0;break e}l=l.return}if(Mn===null)throw Error(Ue(160));lk(i,o,s),Mn=null,ya=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Yr(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ck(e,t),e=e.sibling}function ck(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ha(e,t),za(t),n&4){try{wm(3,t,t.return),sx(3,t)}catch(_){Yr(t,t.return,_)}try{wm(5,t,t.return)}catch(_){Yr(t,t.return,_)}}break;case 1:ha(e,t),za(t),n&512&&r!==null&&mh(r,r.return);break;case 5:if(ha(e,t),za(t),n&512&&r!==null&&mh(r,r.return),t.flags&32){var s=t.stateNode;try{Um(s,"")}catch(_){Yr(t,t.return,_)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=r!==null?r.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&CA(s,i),e2(l,o);var u=e2(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?OA(s,h):d==="dangerouslySetInnerHTML"?DA(s,h):d==="children"?Um(s,h):Jb(s,d,h,u)}switch(l){case"input":Yv(s,i);break;case"textarea":PA(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?jh(s,!!i.multiple,m,!1):g!==!!i.multiple&&(i.defaultValue!=null?jh(s,!!i.multiple,i.defaultValue,!0):jh(s,!!i.multiple,i.multiple?[]:"",!1))}s[Qm]=i}catch(_){Yr(t,t.return,_)}}break;case 6:if(ha(e,t),za(t),n&4){if(t.stateNode===null)throw Error(Ue(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(_){Yr(t,t.return,_)}}break;case 3:if(ha(e,t),za(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Wm(e.containerInfo)}catch(_){Yr(t,t.return,_)}break;case 4:ha(e,t),za(t);break;case 13:ha(e,t),za(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Iw=nn())),n&4&&oj(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(as=(u=as)||d,ha(e,t),as=u):ha(e,t),za(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(rt=t,d=t.child;d!==null;){for(h=rt=d;rt!==null;){switch(g=rt,m=g.child,g.tag){case 0:case 11:case 14:case 15:wm(4,g,g.return);break;case 1:mh(g,g.return);var w=g.stateNode;if(typeof w.componentWillUnmount=="function"){n=g,r=g.return;try{e=n,w.props=e.memoizedProps,w.state=e.memoizedState,w.componentWillUnmount()}catch(_){Yr(n,r,_)}}break;case 5:mh(g,g.return);break;case 22:if(g.memoizedState!==null){cj(h);continue}}m!==null?(m.return=g,rt=m):cj(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=LA("display",o))}catch(_){Yr(t,t.return,_)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(_){Yr(t,t.return,_)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ha(e,t),za(t),n&4&&oj(t);break;case 21:break;default:ha(e,t),za(t)}}function za(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(ok(r)){var n=r;break e}r=r.return}throw Error(Ue(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Um(s,""),n.flags&=-33);var i=aj(t);I2(t,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=aj(t);T2(t,l,o);break;default:throw Error(Ue(161))}}catch(c){Yr(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function r8(t,e,r){rt=t,uk(t)}function uk(t,e,r){for(var n=(t.mode&1)!==0;rt!==null;){var s=rt,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||Dg;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||as;l=Dg;var u=as;if(Dg=o,(as=c)&&!u)for(rt=s;rt!==null;)o=rt,c=o.child,o.tag===22&&o.memoizedState!==null?uj(s):c!==null?(c.return=o,rt=c):uj(s);for(;i!==null;)rt=i,uk(i),i=i.sibling;rt=s,Dg=l,as=u}lj(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,rt=i):lj(t)}}function lj(t){for(;rt!==null;){var e=rt;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:as||sx(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!as)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:pa(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&H_(e,i,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}H_(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Wm(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ue(163))}as||e.flags&512&&k2(e)}catch(g){Yr(e,e.return,g)}}if(e===t){rt=null;break}if(r=e.sibling,r!==null){r.return=e.return,rt=r;break}rt=e.return}}function cj(t){for(;rt!==null;){var e=rt;if(e===t){rt=null;break}var r=e.sibling;if(r!==null){r.return=e.return,rt=r;break}rt=e.return}}function uj(t){for(;rt!==null;){var e=rt;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{sx(4,e)}catch(c){Yr(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(c){Yr(e,s,c)}}var i=e.return;try{k2(e)}catch(c){Yr(e,i,c)}break;case 5:var o=e.return;try{k2(e)}catch(c){Yr(e,o,c)}}}catch(c){Yr(e,e.return,c)}if(e===t){rt=null;break}var l=e.sibling;if(l!==null){l.return=e.return,rt=l;break}rt=e.return}}var n8=Math.ceil,ey=xl.ReactCurrentDispatcher,kw=xl.ReactCurrentOwner,Yi=xl.ReactCurrentBatchConfig,Jt=0,Pn=null,fn=null,Bn=0,fi=0,ph=Zc(0),wn=0,rp=null,rd=0,ix=0,Tw=0,Nm=null,$s=null,Iw=0,Kh=1/0,zo=null,ty=!1,C2=null,jc=null,Lg=!1,mc=null,ry=0,_m=0,P2=null,f0=-1,m0=0;function Es(){return Jt&6?nn():f0!==-1?f0:f0=nn()}function Sc(t){return t.mode&1?Jt&2&&Bn!==0?Bn&-Bn:BL.transition!==null?(m0===0&&(m0=KA()),m0):(t=lr,t!==0||(t=window.event,t=t===void 0?16:tE(t.type)),t):1}function _a(t,e,r,n){if(50<_m)throw _m=0,P2=null,Error(Ue(185));Np(t,r,n),(!(Jt&2)||t!==Pn)&&(t===Pn&&(!(Jt&2)&&(ix|=r),wn===4&&oc(t,Bn)),Ys(t,n),r===1&&Jt===0&&!(e.mode&1)&&(Kh=nn()+500,tx&&eu()))}function Ys(t,e){var r=t.callbackNode;BD(t,e);var n=V0(t,t===Pn?Bn:0);if(n===0)r!==null&&v_(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&v_(r),e===1)t.tag===0?VL(dj.bind(null,t)):bE(dj.bind(null,t)),LL(function(){!(Jt&6)&&eu()}),r=null;else{switch(YA(n)){case 1:r=rw;break;case 4:r=HA;break;case 16:r=F0;break;case 536870912:r=GA;break;default:r=F0}r=xk(r,dk.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function dk(t,e){if(f0=-1,m0=0,Jt&6)throw Error(Ue(327));var r=t.callbackNode;if(Th()&&t.callbackNode!==r)return null;var n=V0(t,t===Pn?Bn:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=ny(t,n);else{e=n;var s=Jt;Jt|=2;var i=fk();(Pn!==t||Bn!==e)&&(zo=null,Kh=nn()+500,Hu(t,e));do try{a8();break}catch(l){hk(t,l)}while(1);pw(),ey.current=i,Jt=s,fn!==null?e=0:(Pn=null,Bn=0,e=wn)}if(e!==0){if(e===2&&(s=i2(t),s!==0&&(n=s,e=R2(t,s))),e===1)throw r=rp,Hu(t,0),oc(t,n),Ys(t,nn()),r;if(e===6)oc(t,n);else{if(s=t.current.alternate,!(n&30)&&!s8(s)&&(e=ny(t,n),e===2&&(i=i2(t),i!==0&&(n=i,e=R2(t,i))),e===1))throw r=rp,Hu(t,0),oc(t,n),Ys(t,nn()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(Ue(345));case 2:Tu(t,$s,zo);break;case 3:if(oc(t,n),(n&130023424)===n&&(e=Iw+500-nn(),10<e)){if(V0(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){Es(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=f2(Tu.bind(null,t,$s,zo),e);break}Tu(t,$s,zo);break;case 4:if(oc(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var o=31-Na(n);i=1<<o,o=e[o],o>s&&(s=o),n&=~i}if(n=s,n=nn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*n8(n/1960))-n,10<n){t.timeoutHandle=f2(Tu.bind(null,t,$s,zo),n);break}Tu(t,$s,zo);break;case 5:Tu(t,$s,zo);break;default:throw Error(Ue(329))}}}return Ys(t,nn()),t.callbackNode===r?dk.bind(null,t):null}function R2(t,e){var r=Nm;return t.current.memoizedState.isDehydrated&&(Hu(t,e).flags|=256),t=ny(t,e),t!==2&&(e=$s,$s=r,e!==null&&D2(e)),t}function D2(t){$s===null?$s=t:$s.push.apply($s,t)}function s8(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Ea(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function oc(t,e){for(e&=~Tw,e&=~ix,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Na(e),n=1<<r;t[r]=-1,e&=~n}}function dj(t){if(Jt&6)throw Error(Ue(327));Th();var e=V0(t,0);if(!(e&1))return Ys(t,nn()),null;var r=ny(t,e);if(t.tag!==0&&r===2){var n=i2(t);n!==0&&(e=n,r=R2(t,n))}if(r===1)throw r=rp,Hu(t,0),oc(t,e),Ys(t,nn()),r;if(r===6)throw Error(Ue(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Tu(t,$s,zo),Ys(t,nn()),null}function Cw(t,e){var r=Jt;Jt|=1;try{return t(e)}finally{Jt=r,Jt===0&&(Kh=nn()+500,tx&&eu())}}function nd(t){mc!==null&&mc.tag===0&&!(Jt&6)&&Th();var e=Jt;Jt|=1;var r=Yi.transition,n=lr;try{if(Yi.transition=null,lr=1,t)return t()}finally{lr=n,Yi.transition=r,Jt=e,!(Jt&6)&&eu()}}function Pw(){fi=ph.current,Ir(ph)}function Hu(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,DL(r)),fn!==null)for(r=fn.return;r!==null;){var n=r;switch(hw(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&$0();break;case 3:Hh(),Ir(Gs),Ir(hs),ww();break;case 5:bw(n);break;case 4:Hh();break;case 13:Ir(Or);break;case 19:Ir(Or);break;case 10:gw(n.type._context);break;case 22:case 23:Pw()}r=r.return}if(Pn=t,fn=t=Ac(t.current,null),Bn=fi=e,wn=0,rp=null,Tw=ix=rd=0,$s=Nm=null,Bu!==null){for(e=0;e<Bu.length;e++)if(r=Bu[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}r.pending=n}Bu=null}return t}function hk(t,e){do{var r=fn;try{if(pw(),u0.current=Z0,X0){for(var n=Vr.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}X0=!1}if(td=0,Tn=bn=Vr=null,bm=!1,Zm=0,kw.current=null,r===null||r.return===null){wn=1,rp=e,fn=null;break}e:{var i=t,o=r.return,l=r,c=e;if(e=Bn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var g=d.alternate;g?(d.updateQueue=g.updateQueue,d.memoizedState=g.memoizedState,d.lanes=g.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=X_(o);if(m!==null){m.flags&=-257,Z_(m,o,l,i,e),m.mode&1&&J_(i,u,e),e=m,c=u;var w=e.updateQueue;if(w===null){var _=new Set;_.add(c),e.updateQueue=_}else w.add(c);break e}else{if(!(e&1)){J_(i,u,e),Rw();break e}c=Error(Ue(426))}}else if(Pr&&l.mode&1){var T=X_(o);if(T!==null){!(T.flags&65536)&&(T.flags|=256),Z_(T,o,l,i,e),fw(Gh(c,l));break e}}i=c=Gh(c,l),wn!==4&&(wn=2),Nm===null?Nm=[i]:Nm.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var v=YE(i,c,e);W_(i,v);break e;case 1:l=c;var b=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(jc===null||!jc.has(x)))){i.flags|=65536,e&=-e,i.lanes|=e;var P=QE(i,l,e);W_(i,P);break e}}i=i.return}while(i!==null)}pk(r)}catch(F){e=F,fn===r&&r!==null&&(fn=r=r.return);continue}break}while(1)}function fk(){var t=ey.current;return ey.current=Z0,t===null?Z0:t}function Rw(){(wn===0||wn===3||wn===2)&&(wn=4),Pn===null||!(rd&268435455)&&!(ix&268435455)||oc(Pn,Bn)}function ny(t,e){var r=Jt;Jt|=2;var n=fk();(Pn!==t||Bn!==e)&&(zo=null,Hu(t,e));do try{i8();break}catch(s){hk(t,s)}while(1);if(pw(),Jt=r,ey.current=n,fn!==null)throw Error(Ue(261));return Pn=null,Bn=0,wn}function i8(){for(;fn!==null;)mk(fn)}function a8(){for(;fn!==null&&!CD();)mk(fn)}function mk(t){var e=yk(t.alternate,t,fi);t.memoizedProps=t.pendingProps,e===null?pk(t):fn=e,kw.current=null}function pk(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=ZL(r,e),r!==null){r.flags&=32767,fn=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{wn=6,fn=null;return}}else if(r=XL(r,e,fi),r!==null){fn=r;return}if(e=e.sibling,e!==null){fn=e;return}fn=e=t}while(e!==null);wn===0&&(wn=5)}function Tu(t,e,r){var n=lr,s=Yi.transition;try{Yi.transition=null,lr=1,o8(t,e,r,n)}finally{Yi.transition=s,lr=n}return null}function o8(t,e,r,n){do Th();while(mc!==null);if(Jt&6)throw Error(Ue(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Ue(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(UD(t,i),t===Pn&&(fn=Pn=null,Bn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Lg||(Lg=!0,xk(F0,function(){return Th(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Yi.transition,Yi.transition=null;var o=lr;lr=1;var l=Jt;Jt|=4,kw.current=null,t8(t,r),ck(r,t),EL(d2),B0=!!u2,d2=u2=null,t.current=r,r8(r),PD(),Jt=l,lr=o,Yi.transition=i}else t.current=r;if(Lg&&(Lg=!1,mc=t,ry=s),i=t.pendingLanes,i===0&&(jc=null),LD(r.stateNode),Ys(t,nn()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(ty)throw ty=!1,t=C2,C2=null,t;return ry&1&&t.tag!==0&&Th(),i=t.pendingLanes,i&1?t===P2?_m++:(_m=0,P2=t):_m=0,eu(),null}function Th(){if(mc!==null){var t=YA(ry),e=Yi.transition,r=lr;try{if(Yi.transition=null,lr=16>t?16:t,mc===null)var n=!1;else{if(t=mc,mc=null,ry=0,Jt&6)throw Error(Ue(331));var s=Jt;for(Jt|=4,rt=t.current;rt!==null;){var i=rt,o=i.child;if(rt.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(rt=u;rt!==null;){var d=rt;switch(d.tag){case 0:case 11:case 15:wm(8,d,i)}var h=d.child;if(h!==null)h.return=d,rt=h;else for(;rt!==null;){d=rt;var g=d.sibling,m=d.return;if(ak(d),d===u){rt=null;break}if(g!==null){g.return=m,rt=g;break}rt=m}}}var w=i.alternate;if(w!==null){var _=w.child;if(_!==null){w.child=null;do{var T=_.sibling;_.sibling=null,_=T}while(_!==null)}}rt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,rt=o;else e:for(;rt!==null;){if(i=rt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:wm(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,rt=v;break e}rt=i.return}}var b=t.current;for(rt=b;rt!==null;){o=rt;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,rt=x;else e:for(o=b;rt!==null;){if(l=rt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:sx(9,l)}}catch(F){Yr(l,l.return,F)}if(l===o){rt=null;break e}var P=l.sibling;if(P!==null){P.return=l.return,rt=P;break e}rt=l.return}}if(Jt=s,eu(),no&&typeof no.onPostCommitFiberRoot=="function")try{no.onPostCommitFiberRoot(Qy,t)}catch{}n=!0}return n}finally{lr=r,Yi.transition=e}}return!1}function hj(t,e,r){e=Gh(r,e),e=YE(t,e,1),t=_c(t,e,1),e=Es(),t!==null&&(Np(t,1,e),Ys(t,e))}function Yr(t,e,r){if(t.tag===3)hj(t,t,r);else for(;e!==null;){if(e.tag===3){hj(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(jc===null||!jc.has(n))){t=Gh(r,t),t=QE(e,t,1),e=_c(e,t,1),t=Es(),e!==null&&(Np(e,1,t),Ys(e,t));break}}e=e.return}}function l8(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Es(),t.pingedLanes|=t.suspendedLanes&r,Pn===t&&(Bn&r)===r&&(wn===4||wn===3&&(Bn&130023424)===Bn&&500>nn()-Iw?Hu(t,0):Tw|=r),Ys(t,e)}function gk(t,e){e===0&&(t.mode&1?(e=Sg,Sg<<=1,!(Sg&130023424)&&(Sg=4194304)):e=1);var r=Es();t=al(t,e),t!==null&&(Np(t,e,r),Ys(t,r))}function c8(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),gk(t,r)}function u8(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Ue(314))}n!==null&&n.delete(e),gk(t,r)}var yk;yk=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Gs.current)Hs=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Hs=!1,JL(t,e,r);Hs=!!(t.flags&131072)}else Hs=!1,Pr&&e.flags&1048576&&wE(e,G0,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;h0(t,e),t=e.pendingProps;var s=qh(e,hs.current);kh(e,r),s=_w(null,e,n,t,s,r);var i=jw();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ks(n)?(i=!0,W0(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,xw(e),s.updater=nx,e.stateNode=s,s._reactInternals=e,b2(e,n,t,r),e=_2(null,e,n,!0,i,r)):(e.tag=0,Pr&&i&&dw(e),js(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(h0(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=h8(n),t=pa(n,t),s){case 0:e=N2(null,e,n,t,r);break e;case 1:e=rj(null,e,n,t,r);break e;case 11:e=ej(null,e,n,t,r);break e;case 14:e=tj(null,e,n,pa(n.type,t),r);break e}throw Error(Ue(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:pa(n,s),N2(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:pa(n,s),rj(t,e,n,s,r);case 3:e:{if(ek(e),t===null)throw Error(Ue(387));n=e.pendingProps,i=e.memoizedState,s=i.element,EE(t,e),Q0(e,n,null,r);var o=e.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Gh(Error(Ue(423)),e),e=nj(t,e,n,r,s);break e}else if(n!==s){s=Gh(Error(Ue(424)),e),e=nj(t,e,n,r,s);break e}else for(pi=Nc(e.stateNode.containerInfo.firstChild),vi=e,Pr=!0,va=null,r=SE(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if($h(),n===s){e=ol(t,e,r);break e}js(t,e,n,r)}e=e.child}return e;case 5:return kE(e),t===null&&y2(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,h2(n,s)?o=null:i!==null&&h2(n,i)&&(e.flags|=32),ZE(t,e),js(t,e,o,r),e.child;case 6:return t===null&&y2(e),null;case 13:return tk(t,e,r);case 4:return vw(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Wh(e,null,n,r):js(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:pa(n,s),ej(t,e,n,s,r);case 7:return js(t,e,e.pendingProps,r),e.child;case 8:return js(t,e,e.pendingProps.children,r),e.child;case 12:return js(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,_r(K0,n._currentValue),n._currentValue=o,i!==null)if(Ea(i.value,o)){if(i.children===s.children&&!Gs.current){e=ol(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=Zo(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),x2(i.return,r,e),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Ue(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),x2(o,r,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}js(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,kh(e,r),s=Qi(s),n=n(s),e.flags|=1,js(t,e,n,r),e.child;case 14:return n=e.type,s=pa(n,e.pendingProps),s=pa(n.type,s),tj(t,e,n,s,r);case 15:return JE(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:pa(n,s),h0(t,e),e.tag=1,Ks(n)?(t=!0,W0(e)):t=!1,kh(e,r),KE(e,n,s),b2(e,n,s,r),_2(null,e,n,!0,t,r);case 19:return rk(t,e,r);case 22:return XE(t,e,r)}throw Error(Ue(156,e.tag))};function xk(t,e){return WA(t,e)}function d8(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gi(t,e,r,n){return new d8(t,e,r,n)}function Dw(t){return t=t.prototype,!(!t||!t.isReactComponent)}function h8(t){if(typeof t=="function")return Dw(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Zb)return 11;if(t===ew)return 14}return 2}function Ac(t,e){var r=t.alternate;return r===null?(r=Gi(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function p0(t,e,r,n,s,i){var o=2;if(n=t,typeof t=="function")Dw(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ih:return Gu(r.children,s,i,e);case Xb:o=8,s|=8;break;case $v:return t=Gi(12,r,e,s|2),t.elementType=$v,t.lanes=i,t;case Wv:return t=Gi(13,r,e,s),t.elementType=Wv,t.lanes=i,t;case Hv:return t=Gi(19,r,e,s),t.elementType=Hv,t.lanes=i,t;case kA:return ax(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case AA:o=10;break e;case EA:o=9;break e;case Zb:o=11;break e;case ew:o=14;break e;case nc:o=16,n=null;break e}throw Error(Ue(130,t==null?t:typeof t,""))}return e=Gi(o,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function Gu(t,e,r,n){return t=Gi(7,t,n,e),t.lanes=r,t}function ax(t,e,r,n){return t=Gi(22,t,n,e),t.elementType=kA,t.lanes=r,t.stateNode={isHidden:!1},t}function $1(t,e,r){return t=Gi(6,t,null,e),t.lanes=r,t}function W1(t,e,r){return e=Gi(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function f8(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=S1(0),this.expirationTimes=S1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=S1(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Lw(t,e,r,n,s,i,o,l,c){return t=new f8(t,e,r,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Gi(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},xw(i),t}function m8(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:sh,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function vk(t){if(!t)return Mc;t=t._reactInternals;e:{if(hd(t)!==t||t.tag!==1)throw Error(Ue(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ks(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ue(171))}if(t.tag===1){var r=t.type;if(Ks(r))return vE(t,r,e)}return e}function bk(t,e,r,n,s,i,o,l,c){return t=Lw(r,n,!0,t,s,i,o,l,c),t.context=vk(null),r=t.current,n=Es(),s=Sc(r),i=Zo(n,s),i.callback=e??null,_c(r,i,s),t.current.lanes=s,Np(t,s,n),Ys(t,n),t}function ox(t,e,r,n){var s=e.current,i=Es(),o=Sc(s);return r=vk(r),e.context===null?e.context=r:e.pendingContext=r,e=Zo(i,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=_c(s,e,o),t!==null&&(_a(t,s,o,i),c0(t,s,o)),o}function sy(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function fj(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Ow(t,e){fj(t,e),(t=t.alternate)&&fj(t,e)}function p8(){return null}var wk=typeof reportError=="function"?reportError:function(t){console.error(t)};function Mw(t){this._internalRoot=t}lx.prototype.render=Mw.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Ue(409));ox(t,e,null,null)};lx.prototype.unmount=Mw.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;nd(function(){ox(null,t,null,null)}),e[il]=null}};function lx(t){this._internalRoot=t}lx.prototype.unstable_scheduleHydration=function(t){if(t){var e=XA();t={blockedOn:null,target:t,priority:e};for(var r=0;r<ac.length&&e!==0&&e<ac[r].priority;r++);ac.splice(r,0,t),r===0&&eE(t)}};function Fw(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function cx(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function mj(){}function g8(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var u=sy(o);i.call(u)}}var o=bk(e,n,t,0,null,!1,!1,"",mj);return t._reactRootContainer=o,t[il]=o.current,Km(t.nodeType===8?t.parentNode:t),nd(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=sy(c);l.call(u)}}var c=Lw(t,0,!1,null,null,!1,!1,"",mj);return t._reactRootContainer=c,t[il]=c.current,Km(t.nodeType===8?t.parentNode:t),nd(function(){ox(e,c,r,n)}),c}function ux(t,e,r,n,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=sy(o);l.call(c)}}ox(e,o,t,s)}else o=g8(r,e,t,s,n);return sy(o)}QA=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=im(e.pendingLanes);r!==0&&(nw(e,r|1),Ys(e,nn()),!(Jt&6)&&(Kh=nn()+500,eu()))}break;case 13:nd(function(){var n=al(t,1);if(n!==null){var s=Es();_a(n,t,1,s)}}),Ow(t,1)}};sw=function(t){if(t.tag===13){var e=al(t,134217728);if(e!==null){var r=Es();_a(e,t,134217728,r)}Ow(t,134217728)}};JA=function(t){if(t.tag===13){var e=Sc(t),r=al(t,e);if(r!==null){var n=Es();_a(r,t,e,n)}Ow(t,e)}};XA=function(){return lr};ZA=function(t,e){var r=lr;try{return lr=t,e()}finally{lr=r}};r2=function(t,e,r){switch(e){case"input":if(Yv(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=ex(n);if(!s)throw Error(Ue(90));IA(n),Yv(n,s)}}}break;case"textarea":PA(t,r);break;case"select":e=r.value,e!=null&&jh(t,!!r.multiple,e,!1)}};VA=Cw;BA=nd;var y8={usingClientEntryPoint:!1,Events:[jp,ch,ex,MA,FA,Cw]},Qf={findFiberByHostInstance:Vu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},x8={bundleType:Qf.bundleType,version:Qf.version,rendererPackageName:Qf.rendererPackageName,rendererConfig:Qf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=qA(t),t===null?null:t.stateNode},findFiberByHostInstance:Qf.findFiberByHostInstance||p8,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Og=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Og.isDisabled&&Og.supportsFiber)try{Qy=Og.inject(x8),no=Og}catch{}}Ei.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=y8;Ei.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fw(e))throw Error(Ue(200));return m8(t,e,null,r)};Ei.createRoot=function(t,e){if(!Fw(t))throw Error(Ue(299));var r=!1,n="",s=wk;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Lw(t,1,!1,null,null,r,!1,n,s),t[il]=e.current,Km(t.nodeType===8?t.parentNode:t),new Mw(e)};Ei.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Ue(188)):(t=Object.keys(t).join(","),Error(Ue(268,t)));return t=qA(e),t=t===null?null:t.stateNode,t};Ei.flushSync=function(t){return nd(t)};Ei.hydrate=function(t,e,r){if(!cx(e))throw Error(Ue(200));return ux(null,t,e,!0,r)};Ei.hydrateRoot=function(t,e,r){if(!Fw(t))throw Error(Ue(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",o=wk;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=bk(e,null,t,1,r??null,s,!1,i,o),t[il]=e.current,Km(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new lx(e)};Ei.render=function(t,e,r){if(!cx(e))throw Error(Ue(200));return ux(null,t,e,!1,r)};Ei.unmountComponentAtNode=function(t){if(!cx(t))throw Error(Ue(40));return t._reactRootContainer?(nd(function(){ux(null,null,t,!1,function(){t._reactRootContainer=null,t[il]=null})}),!0):!1};Ei.unstable_batchedUpdates=Cw;Ei.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!cx(r))throw Error(Ue(200));if(t==null||t._reactInternals===void 0)throw Error(Ue(38));return ux(t,e,r,!1,n)};Ei.version="18.3.1-next-f1338f8080-20240426";function Nk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Nk)}catch(t){console.error(t)}}Nk(),NA.exports=Ei;var v8=NA.exports,pj=v8;zv.createRoot=pj.createRoot,zv.hydrateRoot=pj.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function np(){return np=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},np.apply(this,arguments)}var pc;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(pc||(pc={}));const gj="popstate";function b8(t){t===void 0&&(t={});function e(n,s){let{pathname:i,search:o,hash:l}=n.location;return L2("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:iy(s)}return N8(e,r,null,t)}function Br(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function _k(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function w8(){return Math.random().toString(36).substr(2,8)}function yj(t,e){return{usr:t.state,key:t.key,idx:e}}function L2(t,e,r,n){return r===void 0&&(r=null),np({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?df(e):e,{state:r,key:e&&e.key||n||w8()})}function iy(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function df(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function N8(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,o=s.history,l=pc.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(np({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function h(){l=pc.Pop;let T=d(),v=T==null?null:T-u;u=T,c&&c({action:l,location:_.location,delta:v})}function g(T,v){l=pc.Push;let b=L2(_.location,T,v);r&&r(b,T),u=d()+1;let x=yj(b,u),P=_.createHref(b);try{o.pushState(x,"",P)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;s.location.assign(P)}i&&c&&c({action:l,location:_.location,delta:1})}function m(T,v){l=pc.Replace;let b=L2(_.location,T,v);r&&r(b,T),u=d();let x=yj(b,u),P=_.createHref(b);o.replaceState(x,"",P),i&&c&&c({action:l,location:_.location,delta:0})}function w(T){let v=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof T=="string"?T:iy(T);return b=b.replace(/ $/,"%20"),Br(v,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,v)}let _={get action(){return l},get location(){return t(s,o)},listen(T){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(gj,h),c=T,()=>{s.removeEventListener(gj,h),c=null}},createHref(T){return e(s,T)},createURL:w,encodeLocation(T){let v=w(T);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:g,replace:m,go(T){return o.go(T)}};return _}var xj;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(xj||(xj={}));function _8(t,e,r){return r===void 0&&(r="/"),j8(t,e,r,!1)}function j8(t,e,r,n){let s=typeof e=="string"?df(e):e,i=Yh(s.pathname||"/",r);if(i==null)return null;let o=jk(t);S8(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=O8(i);l=D8(o[c],u,n)}return l}function jk(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(Br(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=Ec([n,c.relativePath]),d=r.concat(c);i.children&&i.children.length>0&&(Br(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),jk(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:P8(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of Sk(i.path))s(i,o,c)}),e}function Sk(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let o=Sk(n.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function S8(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:R8(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const A8=/^:[\w-]+$/,E8=3,k8=2,T8=1,I8=10,C8=-2,vj=t=>t==="*";function P8(t,e){let r=t.split("/"),n=r.length;return r.some(vj)&&(n+=C8),e&&(n+=k8),r.filter(s=>!vj(s)).reduce((s,i)=>s+(A8.test(i)?E8:i===""?T8:I8),n)}function R8(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function D8(t,e,r){r===void 0&&(r=!1);let{routesMeta:n}=t,s={},i="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=i==="/"?e:e.slice(i.length)||"/",h=ay({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),g=c.route;if(!h&&u&&r&&!n[n.length-1].route.index&&(h=ay({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:Ec([i,h.pathname]),pathnameBase:B8(Ec([i,h.pathnameBase])),route:g}),h.pathnameBase!=="/"&&(i=Ec([i,h.pathnameBase]))}return o}function ay(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=L8(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((u,d,h)=>{let{paramName:g,isOptional:m}=d;if(g==="*"){let _=l[h]||"";o=i.slice(0,i.length-_.length).replace(/(.)\/+$/,"$1")}const w=l[h];return m&&!w?u[g]=void 0:u[g]=(w||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function L8(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),_k(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function O8(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return _k(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Yh(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function M8(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?df(t):t;return{pathname:r?r.startsWith("/")?r:F8(r,e):e,search:U8(n),hash:z8(s)}}function F8(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function H1(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function V8(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function Vw(t,e){let r=V8(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Bw(t,e,r,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=df(t):(s=np({},t),Br(!s.pathname||!s.pathname.includes("?"),H1("?","pathname","search",s)),Br(!s.pathname||!s.pathname.includes("#"),H1("#","pathname","hash",s)),Br(!s.search||!s.search.includes("#"),H1("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=r;else{let h=e.length-1;if(!n&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),h-=1;s.pathname=g.join("/")}l=h>=0?e[h]:"/"}let c=M8(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Ec=t=>t.join("/").replace(/\/\/+/g,"/"),B8=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),U8=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,z8=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function q8(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Ak=["post","put","patch","delete"];new Set(Ak);const $8=["get",...Ak];new Set($8);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sp(){return sp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},sp.apply(this,arguments)}const dx=M.createContext(null),Ek=M.createContext(null),vl=M.createContext(null),hx=M.createContext(null),tu=M.createContext({outlet:null,matches:[],isDataRoute:!1}),kk=M.createContext(null);function W8(t,e){let{relative:r}=e===void 0?{}:e;hf()||Br(!1);let{basename:n,navigator:s}=M.useContext(vl),{hash:i,pathname:o,search:l}=fx(t,{relative:r}),c=o;return n!=="/"&&(c=o==="/"?n:Ec([n,o])),s.createHref({pathname:c,search:l,hash:i})}function hf(){return M.useContext(hx)!=null}function fd(){return hf()||Br(!1),M.useContext(hx).location}function Tk(t){M.useContext(vl).static||M.useLayoutEffect(t)}function Ap(){let{isDataRoute:t}=M.useContext(tu);return t?sO():H8()}function H8(){hf()||Br(!1);let t=M.useContext(dx),{basename:e,future:r,navigator:n}=M.useContext(vl),{matches:s}=M.useContext(tu),{pathname:i}=fd(),o=JSON.stringify(Vw(s,r.v7_relativeSplatPath)),l=M.useRef(!1);return Tk(()=>{l.current=!0}),M.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){n.go(u);return}let h=Bw(u,JSON.parse(o),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ec([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,o,i,t])}function fx(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=M.useContext(vl),{matches:s}=M.useContext(tu),{pathname:i}=fd(),o=JSON.stringify(Vw(s,n.v7_relativeSplatPath));return M.useMemo(()=>Bw(t,JSON.parse(o),i,r==="path"),[t,o,i,r])}function G8(t,e){return K8(t,e)}function K8(t,e,r,n){hf()||Br(!1);let{navigator:s}=M.useContext(vl),{matches:i}=M.useContext(tu),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=fd(),d;if(e){var h;let T=typeof e=="string"?df(e):e;c==="/"||(h=T.pathname)!=null&&h.startsWith(c)||Br(!1),d=T}else d=u;let g=d.pathname||"/",m=g;if(c!=="/"){let T=c.replace(/^\//,"").split("/");m="/"+g.replace(/^\//,"").split("/").slice(T.length).join("/")}let w=_8(t,{pathname:m}),_=Z8(w&&w.map(T=>Object.assign({},T,{params:Object.assign({},l,T.params),pathname:Ec([c,s.encodeLocation?s.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?c:Ec([c,s.encodeLocation?s.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),i,r,n);return e&&_?M.createElement(hx.Provider,{value:{location:sp({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:pc.Pop}},_):_}function Y8(){let t=nO(),e=q8(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return M.createElement(M.Fragment,null,M.createElement("h2",null,"Unexpected Application Error!"),M.createElement("h3",{style:{fontStyle:"italic"}},e),r?M.createElement("pre",{style:s},r):null,i)}const Q8=M.createElement(Y8,null);class J8 extends M.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?M.createElement(tu.Provider,{value:this.props.routeContext},M.createElement(kk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function X8(t){let{routeContext:e,match:r,children:n}=t,s=M.useContext(dx);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),M.createElement(tu.Provider,{value:e},n)}function Z8(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var i;if(!r)return null;if(r.errors)t=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,l=(s=r)==null?void 0:s.errors;if(l!=null){let d=o.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);d>=0||Br(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<o.length;d++){let h=o[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:g,errors:m}=r,w=h.route.loader&&g[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||w){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,h,g)=>{let m,w=!1,_=null,T=null;r&&(m=l&&h.route.id?l[h.route.id]:void 0,_=h.route.errorElement||Q8,c&&(u<0&&g===0?(iO("route-fallback",!1),w=!0,T=null):u===g&&(w=!0,T=h.route.hydrateFallbackElement||null)));let v=e.concat(o.slice(0,g+1)),b=()=>{let x;return m?x=_:w?x=T:h.route.Component?x=M.createElement(h.route.Component,null):h.route.element?x=h.route.element:x=d,M.createElement(X8,{match:h,routeContext:{outlet:d,matches:v,isDataRoute:r!=null},children:x})};return r&&(h.route.ErrorBoundary||h.route.errorElement||g===0)?M.createElement(J8,{location:r.location,revalidation:r.revalidation,component:_,error:m,children:b(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):b()},null)}var Ik=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Ik||{}),oy=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(oy||{});function eO(t){let e=M.useContext(dx);return e||Br(!1),e}function tO(t){let e=M.useContext(Ek);return e||Br(!1),e}function rO(t){let e=M.useContext(tu);return e||Br(!1),e}function Ck(t){let e=rO(),r=e.matches[e.matches.length-1];return r.route.id||Br(!1),r.route.id}function nO(){var t;let e=M.useContext(kk),r=tO(oy.UseRouteError),n=Ck(oy.UseRouteError);return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function sO(){let{router:t}=eO(Ik.UseNavigateStable),e=Ck(oy.UseNavigateStable),r=M.useRef(!1);return Tk(()=>{r.current=!0}),M.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,sp({fromRouteId:e},i)))},[t,e])}const bj={};function iO(t,e,r){!e&&!bj[t]&&(bj[t]=!0)}function aO(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function G1(t){let{to:e,replace:r,state:n,relative:s}=t;hf()||Br(!1);let{future:i,static:o}=M.useContext(vl),{matches:l}=M.useContext(tu),{pathname:c}=fd(),u=Ap(),d=Bw(e,Vw(l,i.v7_relativeSplatPath),c,s==="path"),h=JSON.stringify(d);return M.useEffect(()=>u(JSON.parse(h),{replace:r,state:n,relative:s}),[u,h,s,r,n]),null}function hi(t){Br(!1)}function oO(t){let{basename:e="/",children:r=null,location:n,navigationType:s=pc.Pop,navigator:i,static:o=!1,future:l}=t;hf()&&Br(!1);let c=e.replace(/^\/*/,"/"),u=M.useMemo(()=>({basename:c,navigator:i,static:o,future:sp({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof n=="string"&&(n=df(n));let{pathname:d="/",search:h="",hash:g="",state:m=null,key:w="default"}=n,_=M.useMemo(()=>{let T=Yh(d,c);return T==null?null:{location:{pathname:T,search:h,hash:g,state:m,key:w},navigationType:s}},[c,d,h,g,m,w,s]);return _==null?null:M.createElement(vl.Provider,{value:u},M.createElement(hx.Provider,{children:r,value:_}))}function lO(t){let{children:e,location:r}=t;return G8(O2(e),r)}new Promise(()=>{});function O2(t,e){e===void 0&&(e=[]);let r=[];return M.Children.forEach(t,(n,s)=>{if(!M.isValidElement(n))return;let i=[...e,s];if(n.type===M.Fragment){r.push.apply(r,O2(n.props.children,i));return}n.type!==hi&&Br(!1),!n.props.index||!n.props.children||Br(!1);let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=O2(n.props.children,i)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ly(){return ly=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ly.apply(this,arguments)}function Pk(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function cO(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function uO(t,e){return t.button===0&&(!e||e==="_self")&&!cO(t)}const dO=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],hO=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],fO="6";try{window.__reactRouterVersion=fO}catch{}const mO=M.createContext({isTransitioning:!1}),pO="startTransition",wj=lD[pO];function gO(t){let{basename:e,children:r,future:n,window:s}=t,i=M.useRef();i.current==null&&(i.current=b8({window:s,v5Compat:!0}));let o=i.current,[l,c]=M.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},d=M.useCallback(h=>{u&&wj?wj(()=>c(h)):c(h)},[c,u]);return M.useLayoutEffect(()=>o.listen(d),[o,d]),M.useEffect(()=>aO(n),[n]),M.createElement(oO,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}const yO=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",xO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Jr=M.forwardRef(function(e,r){let{onClick:n,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:h}=e,g=Pk(e,dO),{basename:m}=M.useContext(vl),w,_=!1;if(typeof u=="string"&&xO.test(u)&&(w=u,yO))try{let x=new URL(window.location.href),P=u.startsWith("//")?new URL(x.protocol+u):new URL(u),F=Yh(P.pathname,m);P.origin===x.origin&&F!=null?u=F+P.search+P.hash:_=!0}catch{}let T=W8(u,{relative:s}),v=wO(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:h});function b(x){n&&n(x),x.defaultPrevented||v(x)}return M.createElement("a",ly({},g,{href:w||T,onClick:_||i?n:b,ref:r,target:c}))}),vO=M.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:s=!1,className:i="",end:o=!1,style:l,to:c,viewTransition:u,children:d}=e,h=Pk(e,hO),g=fx(c,{relative:h.relative}),m=fd(),w=M.useContext(Ek),{navigator:_,basename:T}=M.useContext(vl),v=w!=null&&NO(g)&&u===!0,b=_.encodeLocation?_.encodeLocation(g).pathname:g.pathname,x=m.pathname,P=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;s||(x=x.toLowerCase(),P=P?P.toLowerCase():null,b=b.toLowerCase()),P&&T&&(P=Yh(P,T)||P);const F=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let $=x===b||!o&&x.startsWith(b)&&x.charAt(F)==="/",k=P!=null&&(P===b||!o&&P.startsWith(b)&&P.charAt(b.length)==="/"),A={isActive:$,isPending:k,isTransitioning:v},I=$?n:void 0,O;typeof i=="function"?O=i(A):O=[i,$?"active":null,k?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let S=typeof l=="function"?l(A):l;return M.createElement(Jr,ly({},h,{"aria-current":I,className:O,ref:r,style:S,to:c,viewTransition:u}),typeof d=="function"?d(A):d)});var M2;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(M2||(M2={}));var Nj;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Nj||(Nj={}));function bO(t){let e=M.useContext(dx);return e||Br(!1),e}function wO(t,e){let{target:r,replace:n,state:s,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,c=Ap(),u=fd(),d=fx(t,{relative:o});return M.useCallback(h=>{if(uO(h,r)){h.preventDefault();let g=n!==void 0?n:iy(u)===iy(d);c(t,{replace:g,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[u,c,d,n,s,r,t,i,o,l])}function NO(t,e){e===void 0&&(e={});let r=M.useContext(mO);r==null&&Br(!1);let{basename:n}=bO(M2.useViewTransitionState),s=fx(t,{relative:e.relative});if(!r.isTransitioning)return!1;let i=Yh(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=Yh(r.nextLocation.pathname,n)||r.nextLocation.pathname;return ay(s.pathname,o)!=null||ay(s.pathname,i)!=null}const _O=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},jO=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],o=t[r++],l=t[r++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const i=t[r++],o=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Dk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,h=(i&3)<<4|l>>4;let g=(l&15)<<2|u>>6,m=u&63;c||(m=64,o||(g=64)),n.push(r[d],r[h],r[g],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Rk(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):jO(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],l=s<t.length?r[t.charAt(s)]:0;++s;const u=s<t.length?r[t.charAt(s)]:64;++s;const h=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||h==null)throw new SO;const g=i<<2|l>>4;if(n.push(g),u!==64){const m=l<<4&240|u>>2;if(n.push(m),h!==64){const w=u<<6&192|h;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class SO extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const AO=function(t){const e=Rk(t);return Dk.encodeByteArray(e,!0)},cy=function(t){return AO(t).replace(/\./g,"")},Lk=function(t){try{return Dk.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EO(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kO=()=>EO().__FIREBASE_DEFAULTS__,TO=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},IO=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Lk(t[1]);return e&&JSON.parse(e)},mx=()=>{try{return _O()||kO()||TO()||IO()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Ok=t=>{var e,r;return(r=(e=mx())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},Mk=t=>{const e=Ok(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Fk=()=>{var t;return(t=mx())===null||t===void 0?void 0:t.config},Vk=t=>{var e;return(e=mx())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CO{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ru(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Uw(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bk(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[cy(JSON.stringify(r)),cy(JSON.stringify(o)),l].join(".")}const jm={};function PO(){const t={prod:[],emulator:[]};for(const e of Object.keys(jm))jm[e]?t.emulator.push(e):t.prod.push(e);return t}function RO(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let _j=!1;function zw(t,e){if(typeof window>"u"||typeof document>"u"||!ru(window.location.host)||jm[t]===e||jm[t]||_j)return;jm[t]=e;function r(g){return`__firebase__banner__${g}`}const n="__firebase__banner",i=PO().prod.length>0;function o(){const g=document.getElementById(n);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,m){g.setAttribute("width","24"),g.setAttribute("id",m),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{_j=!0,o()},g}function d(g,m){g.setAttribute("id",m),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function h(){const g=RO(n),m=r("text"),w=document.getElementById(m)||document.createElement("span"),_=r("learnmore"),T=document.getElementById(_)||document.createElement("a"),v=r("preprendIcon"),b=document.getElementById(v)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const x=g.element;l(x),d(T,_);const P=u();c(b,v),x.append(b,w,T,P),document.body.appendChild(x)}i?(w.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fs(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function DO(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(fs())}function LO(){var t;const e=(t=mx())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function OO(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function MO(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function FO(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function VO(){const t=fs();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function BO(){return!LO()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function UO(){try{return typeof indexedDB=="object"}catch{return!1}}function zO(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qO="FirebaseError";class go extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=qO,Object.setPrototypeOf(this,go.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ep.prototype.create)}}class Ep{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?$O(i,n):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new go(s,l,n)}}function $O(t,e){return t.replace(WO,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const WO=/\{\$([^}]+)}/g;function HO(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Fc(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],o=e[s];if(jj(i)&&jj(o)){if(!Fc(i,o))return!1}else if(i!==o)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function jj(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kp(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function om(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,i]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function lm(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function GO(t,e){const r=new KO(t,e);return r.subscribe.bind(r)}class KO{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");YO(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=K1),s.error===void 0&&(s.error=K1),s.complete===void 0&&(s.complete=K1);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function YO(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function K1(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fr(t){return t&&t._delegate?t._delegate:t}class Vc{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iu="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QO{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new CO;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(XO(e))try{this.getOrInitializeService({instanceIdentifier:Iu})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=Iu){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Iu){return this.instances.has(e)}getOptions(e=Iu){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);n===l&&o.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),i=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:JO(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Iu){return this.component?this.component.multipleInstances?e:Iu:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function JO(t){return t===Iu?void 0:t}function XO(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new QO(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Wt||(Wt={}));const e7={debug:Wt.DEBUG,verbose:Wt.VERBOSE,info:Wt.INFO,warn:Wt.WARN,error:Wt.ERROR,silent:Wt.SILENT},t7=Wt.INFO,r7={[Wt.DEBUG]:"log",[Wt.VERBOSE]:"log",[Wt.INFO]:"info",[Wt.WARN]:"warn",[Wt.ERROR]:"error"},n7=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=r7[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class qw{constructor(e){this.name=e,this._logLevel=t7,this._logHandler=n7,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Wt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?e7[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Wt.DEBUG,...e),this._logHandler(this,Wt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Wt.VERBOSE,...e),this._logHandler(this,Wt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Wt.INFO,...e),this._logHandler(this,Wt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Wt.WARN,...e),this._logHandler(this,Wt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Wt.ERROR,...e),this._logHandler(this,Wt.ERROR,...e)}}const s7=(t,e)=>e.some(r=>t instanceof r);let Sj,Aj;function i7(){return Sj||(Sj=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function a7(){return Aj||(Aj=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Uk=new WeakMap,F2=new WeakMap,zk=new WeakMap,Y1=new WeakMap,$w=new WeakMap;function o7(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{r(kc(t.result)),s()},o=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&Uk.set(r,t)}).catch(()=>{}),$w.set(e,t),e}function l7(t){if(F2.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{r(),s()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});F2.set(t,e)}let V2={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return F2.get(t);if(e==="objectStoreNames")return t.objectStoreNames||zk.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return kc(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function c7(t){V2=t(V2)}function u7(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Q1(this),e,...r);return zk.set(n,e.sort?e.sort():[e]),kc(n)}:a7().includes(t)?function(...e){return t.apply(Q1(this),e),kc(Uk.get(this))}:function(...e){return kc(t.apply(Q1(this),e))}}function d7(t){return typeof t=="function"?u7(t):(t instanceof IDBTransaction&&l7(t),s7(t,i7())?new Proxy(t,V2):t)}function kc(t){if(t instanceof IDBRequest)return o7(t);if(Y1.has(t))return Y1.get(t);const e=d7(t);return e!==t&&(Y1.set(t,e),$w.set(e,t)),e}const Q1=t=>$w.get(t);function h7(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=kc(o);return n&&o.addEventListener("upgradeneeded",c=>{n(kc(o.result),c.oldVersion,c.newVersion,kc(o.transaction),c)}),r&&o.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const f7=["get","getKey","getAll","getAllKeys","count"],m7=["put","add","delete","clear"],J1=new Map;function Ej(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(J1.get(e))return J1.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=m7.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||f7.includes(r)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(l.shift())),(await Promise.all([u[r](...l),s&&c.done]))[0]};return J1.set(e,i),i}c7(t=>({...t,get:(e,r,n)=>Ej(e,r)||t.get(e,r,n),has:(e,r)=>!!Ej(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(g7(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function g7(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const B2="@firebase/app",kj="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ll=new qw("@firebase/app"),y7="@firebase/app-compat",x7="@firebase/analytics-compat",v7="@firebase/analytics",b7="@firebase/app-check-compat",w7="@firebase/app-check",N7="@firebase/auth",_7="@firebase/auth-compat",j7="@firebase/database",S7="@firebase/data-connect",A7="@firebase/database-compat",E7="@firebase/functions",k7="@firebase/functions-compat",T7="@firebase/installations",I7="@firebase/installations-compat",C7="@firebase/messaging",P7="@firebase/messaging-compat",R7="@firebase/performance",D7="@firebase/performance-compat",L7="@firebase/remote-config",O7="@firebase/remote-config-compat",M7="@firebase/storage",F7="@firebase/storage-compat",V7="@firebase/firestore",B7="@firebase/ai",U7="@firebase/firestore-compat",z7="firebase",q7="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U2="[DEFAULT]",$7={[B2]:"fire-core",[y7]:"fire-core-compat",[v7]:"fire-analytics",[x7]:"fire-analytics-compat",[w7]:"fire-app-check",[b7]:"fire-app-check-compat",[N7]:"fire-auth",[_7]:"fire-auth-compat",[j7]:"fire-rtdb",[S7]:"fire-data-connect",[A7]:"fire-rtdb-compat",[E7]:"fire-fn",[k7]:"fire-fn-compat",[T7]:"fire-iid",[I7]:"fire-iid-compat",[C7]:"fire-fcm",[P7]:"fire-fcm-compat",[R7]:"fire-perf",[D7]:"fire-perf-compat",[L7]:"fire-rc",[O7]:"fire-rc-compat",[M7]:"fire-gcs",[F7]:"fire-gcs-compat",[V7]:"fire-fst",[U7]:"fire-fst-compat",[B7]:"fire-vertex","fire-js":"fire-js",[z7]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy=new Map,W7=new Map,z2=new Map;function Tj(t,e){try{t.container.addComponent(e)}catch(r){ll.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function sd(t){const e=t.name;if(z2.has(e))return ll.debug(`There were multiple attempts to register component ${e}.`),!1;z2.set(e,t);for(const r of uy.values())Tj(r,t);for(const r of W7.values())Tj(r,t);return!0}function px(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Ws(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Tc=new Ep("app","Firebase",H7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G7{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Vc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Tc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const md=q7;function qk(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:U2,automaticDataCollectionEnabled:!0},e),s=n.name;if(typeof s!="string"||!s)throw Tc.create("bad-app-name",{appName:String(s)});if(r||(r=Fk()),!r)throw Tc.create("no-options");const i=uy.get(s);if(i){if(Fc(r,i.options)&&Fc(n,i.config))return i;throw Tc.create("duplicate-app",{appName:s})}const o=new ZO(s);for(const c of z2.values())o.addComponent(c);const l=new G7(r,n,o);return uy.set(s,l),l}function Ww(t=U2){const e=uy.get(t);if(!e&&t===U2&&Fk())return qk();if(!e)throw Tc.create("no-app",{appName:t});return e}function io(t,e,r){var n;let s=(n=$7[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ll.warn(l.join(" "));return}sd(new Vc(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K7="firebase-heartbeat-database",Y7=1,ip="firebase-heartbeat-store";let X1=null;function $k(){return X1||(X1=h7(K7,Y7,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ip)}catch(r){console.warn(r)}}}}).catch(t=>{throw Tc.create("idb-open",{originalErrorMessage:t.message})})),X1}async function Q7(t){try{const r=(await $k()).transaction(ip),n=await r.objectStore(ip).get(Wk(t));return await r.done,n}catch(e){if(e instanceof go)ll.warn(e.message);else{const r=Tc.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ll.warn(r.message)}}}async function Ij(t,e){try{const n=(await $k()).transaction(ip,"readwrite");await n.objectStore(ip).put(e,Wk(t)),await n.done}catch(r){if(r instanceof go)ll.warn(r.message);else{const n=Tc.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ll.warn(n.message)}}}function Wk(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J7=1024,X7=30;class Z7{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new tM(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Cj();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>X7){const o=rM(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){ll.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Cj(),{heartbeatsToSend:n,unsentEntries:s}=eM(this._heartbeatsCache.heartbeats),i=cy(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return ll.warn(r),""}}}function Cj(){return new Date().toISOString().substring(0,10)}function eM(t,e=J7){const r=[];let n=t.slice();for(const s of t){const i=r.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Pj(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),Pj(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class tM{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return UO()?zO().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Q7(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ij(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ij(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Pj(t){return cy(JSON.stringify({version:2,heartbeats:t})).length}function rM(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nM(t){sd(new Vc("platform-logger",e=>new p7(e),"PRIVATE")),sd(new Vc("heartbeat",e=>new Z7(e),"PRIVATE")),io(B2,kj,t),io(B2,kj,"esm2017"),io("fire-js","")}nM("");function Hw(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function Hk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const sM=Hk,Gk=new Ep("auth","Firebase",Hk());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dy=new qw("@firebase/auth");function iM(t,...e){dy.logLevel<=Wt.WARN&&dy.warn(`Auth (${md}): ${t}`,...e)}function g0(t,...e){dy.logLevel<=Wt.ERROR&&dy.error(`Auth (${md}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(t,...e){throw Kw(t,...e)}function ja(t,...e){return Kw(t,...e)}function Gw(t,e,r){const n=Object.assign(Object.assign({},sM()),{[e]:r});return new Ep("auth","Firebase",n).create(e,{appName:t.name})}function el(t){return Gw(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function aM(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&Xi(t,"argument-error"),Gw(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Kw(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return Gk.create(t,...e)}function ut(t,e,...r){if(!t)throw Kw(e,...r)}function Ko(t){const e="INTERNAL ASSERTION FAILED: "+t;throw g0(e),new Error(e)}function cl(t,e){t||Ko(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q2(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function oM(){return Rj()==="http:"||Rj()==="https:"}function Rj(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lM(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(oM()||MO()||"connection"in navigator)?navigator.onLine:!0}function cM(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(e,r){this.shortDelay=e,this.longDelay=r,cl(r>e,"Short delay should be less than long delay!"),this.isMobile=DO()||FO()}get(){return lM()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yw(t,e){cl(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ko("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ko("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ko("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uM={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dM=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],hM=new Tp(3e4,6e4);function bl(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function yo(t,e,r,n,s={}){return Yk(t,s,async()=>{let i={},o={};n&&(e==="GET"?o=n:i={body:JSON.stringify(n)});const l=kp(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},i);return OO()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&ru(t.emulatorConfig.host)&&(u.credentials="include"),Kk.fetch()(await Qk(t,t.config.apiHost,r,l),u)})}async function Yk(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},uM),e);try{const s=new mM(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Mg(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Mg(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Mg(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Mg(t,"user-disabled",o);const d=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Gw(t,d,u);Xi(t,d)}}catch(s){if(s instanceof go)throw s;Xi(t,"network-request-failed",{message:String(s)})}}async function Ip(t,e,r,n,s={}){const i=await yo(t,e,r,n,s);return"mfaPendingCredential"in i&&Xi(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function Qk(t,e,r,n){const s=`${e}${r}?${n}`,i=t,o=i.config.emulator?Yw(t.config,s):`${t.config.apiScheme}://${s}`;return dM.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function fM(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class mM{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ja(this.auth,"network-request-failed")),hM.get())})}}function Mg(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=ja(t,e,n);return s.customData._tokenResponse=r,s}function Dj(t){return t!==void 0&&t.enterprise!==void 0}class pM{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return fM(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function gM(t,e){return yo(t,"GET","/v2/recaptchaConfig",bl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yM(t,e){return yo(t,"POST","/v1/accounts:delete",e)}async function hy(t,e){return yo(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sm(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function xM(t,e=!1){const r=fr(t),n=await r.getIdToken(e),s=Qw(n);ut(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:Sm(Z1(s.auth_time)),issuedAtTime:Sm(Z1(s.iat)),expirationTime:Sm(Z1(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Z1(t){return Number(t)*1e3}function Qw(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return g0("JWT malformed, contained fewer than 3 sections"),null;try{const s=Lk(r);return s?JSON.parse(s):(g0("Failed to decode base64 JWT payload"),null)}catch(s){return g0("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Lj(t){const e=Qw(t);return ut(e,"internal-error"),ut(typeof e.exp<"u","internal-error"),ut(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qh(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof go&&vM(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function vM({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bM{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Sm(this.lastLoginAt),this.creationTime=Sm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fy(t){var e;const r=t.auth,n=await t.getIdToken(),s=await Qh(t,hy(r,{idToken:n}));ut(s==null?void 0:s.users.length,r,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?Jk(i.providerUserInfo):[],l=NM(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new $2(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function wM(t){const e=fr(t);await fy(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function NM(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function Jk(t){return t.map(e=>{var{providerId:r}=e,n=Hw(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _M(t,e){const r=await Yk(t,{},async()=>{const n=kp({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await Qk(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:n};return t.emulatorConfig&&ru(t.emulatorConfig.host)&&(c.credentials="include"),Kk.fetch()(o,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function jM(t,e){return yo(t,"POST","/v2/accounts:revokeToken",bl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ut(e.idToken,"internal-error"),ut(typeof e.idToken<"u","internal-error"),ut(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Lj(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ut(e.length!==0,"internal-error");const r=Lj(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ut(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await _M(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,o=new Ih;return n&&(ut(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(ut(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ut(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ih,this.toJSON())}_performRefresh(){return Ko("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ql(t,e){ut(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class wa{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,i=Hw(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new bM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new $2(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Qh(this,this.stsTokenManager.getToken(this.auth,e));return ut(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return xM(this,e)}reload(){return wM(this)}_assign(e){this!==e&&(ut(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new wa(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){ut(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await fy(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ws(this.auth.app))return Promise.reject(el(this.auth));const e=await this.getIdToken();return await Qh(this,yM(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,i,o,l,c,u,d;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,g=(s=r.email)!==null&&s!==void 0?s:void 0,m=(i=r.phoneNumber)!==null&&i!==void 0?i:void 0,w=(o=r.photoURL)!==null&&o!==void 0?o:void 0,_=(l=r.tenantId)!==null&&l!==void 0?l:void 0,T=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,v=(u=r.createdAt)!==null&&u!==void 0?u:void 0,b=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:x,emailVerified:P,isAnonymous:F,providerData:$,stsTokenManager:k}=r;ut(x&&k,e,"internal-error");const A=Ih.fromJSON(this.name,k);ut(typeof x=="string",e,"internal-error"),Ql(h,e.name),Ql(g,e.name),ut(typeof P=="boolean",e,"internal-error"),ut(typeof F=="boolean",e,"internal-error"),Ql(m,e.name),Ql(w,e.name),Ql(_,e.name),Ql(T,e.name),Ql(v,e.name),Ql(b,e.name);const I=new wa({uid:x,auth:e,email:g,emailVerified:P,displayName:h,isAnonymous:F,photoURL:w,phoneNumber:m,tenantId:_,stsTokenManager:A,createdAt:v,lastLoginAt:b});return $&&Array.isArray($)&&(I.providerData=$.map(O=>Object.assign({},O))),T&&(I._redirectEventId=T),I}static async _fromIdTokenResponse(e,r,n=!1){const s=new Ih;s.updateFromServerResponse(r);const i=new wa({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await fy(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];ut(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Jk(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new Ih;l.updateFromIdToken(n);const c=new wa({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new $2(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oj=new Map;function Yo(t){cl(t instanceof Function,"Expected a class definition");let e=Oj.get(t);return e?(cl(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Oj.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Xk.type="NONE";const Mj=Xk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y0(t,e,r){return`firebase:${t}:${e}:${r}`}class Ch{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=y0(this.userKey,s.apiKey,i),this.fullPersistenceKey=y0("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await hy(this.auth,{idToken:e}).catch(()=>{});return r?wa._fromGetAccountInfoResponse(this.auth,r,e):null}return wa._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Ch(Yo(Mj),e,n);const s=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Yo(Mj);const o=y0(n,e.config.apiKey,e.name);let l=null;for(const u of r)try{const d=await u._get(o);if(d){let h;if(typeof d=="string"){const g=await hy(e,{idToken:d}).catch(()=>{});if(!g)break;h=await wa._fromGetAccountInfoResponse(e,g,d)}else h=wa._fromJSON(e,d);u!==i&&(l=h),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Ch(i,e,n):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(r.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new Ch(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fj(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(rT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Zk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(sT(e))return"Blackberry";if(iT(e))return"Webos";if(eT(e))return"Safari";if((e.includes("chrome/")||tT(e))&&!e.includes("edge/"))return"Chrome";if(nT(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function Zk(t=fs()){return/firefox\//i.test(t)}function eT(t=fs()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function tT(t=fs()){return/crios\//i.test(t)}function rT(t=fs()){return/iemobile/i.test(t)}function nT(t=fs()){return/android/i.test(t)}function sT(t=fs()){return/blackberry/i.test(t)}function iT(t=fs()){return/webos/i.test(t)}function Jw(t=fs()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function SM(t=fs()){var e;return Jw(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function AM(){return VO()&&document.documentMode===10}function aT(t=fs()){return Jw(t)||nT(t)||iT(t)||sT(t)||/windows phone/i.test(t)||rT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oT(t,e=[]){let r;switch(t){case"Browser":r=Fj(fs());break;case"Worker":r=`${Fj(fs())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${md}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kM(t,e={}){return yo(t,"GET","/v2/passwordPolicy",bl(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TM=6;class IM{constructor(e){var r,n,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:TM,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CM{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Vj(this),this.idTokenSubscription=new Vj(this),this.beforeStateQueue=new EM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Gk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Yo(r)),this._initializationPromise=this.queue(async()=>{var n,s,i;if(!this._deleted&&(this.persistenceManager=await Ch.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await hy(this,{idToken:e}),n=await wa._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Ws(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ut(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await fy(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=cM()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ws(this.app))return Promise.reject(el(this));const r=e?fr(e):null;return r&&ut(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&ut(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ws(this.app)?Promise.reject(el(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ws(this.app)?Promise.reject(el(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Yo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await kM(this),r=new IM(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ep("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await jM(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Yo(e)||this._popupRedirectResolver;ut(r,this,"argument-error"),this.redirectPersistenceManager=await Ch.create(this,[Yo(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ut(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,s);return()=>{o=!0,c()}}else{const c=e.addObserver(r);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ut(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=oT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;if(Ws(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&iM(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function wl(t){return fr(t)}class Vj{constructor(e){this.auth=e,this.observer=null,this.addObserver=GO(r=>this.observer=r)}get next(){return ut(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gx={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function PM(t){gx=t}function lT(t){return gx.loadJS(t)}function RM(){return gx.recaptchaEnterpriseScript}function DM(){return gx.gapiScript}function LM(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class OM{constructor(){this.enterprise=new MM}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class MM{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const FM="recaptcha-enterprise",cT="NO_RECAPTCHA";class VM{constructor(e){this.type=FM,this.auth=wl(e)}async verify(e="verify",r=!1){async function n(i){if(!r){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{gM(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new pM(c);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function s(i,o,l){const c=window.grecaptcha;Dj(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(cT)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new OM().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{n(this.auth).then(l=>{if(!r&&Dj(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=RM();c.length!==0&&(c+=l),lT(c).then(()=>{s(l,i,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function Jf(t,e,r,n=!1,s=!1){const i=new VM(t);let o;if(s)o=cT;else try{o=await i.verify(r)}catch{o=await i.verify(r,!0)}const l=Object.assign({},e);if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const c=l.phoneEnrollmentInfo.phoneNumber,u=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const c=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return n?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function my(t,e,r,n,s){var i,o;if(s==="EMAIL_PASSWORD_PROVIDER")if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await Jf(t,e,r,r==="getOobCode");return n(t,l)}else return n(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await Jf(t,e,r,r==="getOobCode");return n(t,c)}else return Promise.reject(l)});else if(s==="PHONE_PROVIDER")if(!((o=t._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("PHONE_PROVIDER")){const l=await Jf(t,e,r);return n(t,l).catch(async c=>{var u;if(((u=t._getRecaptchaConfig())===null||u===void 0?void 0:u.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(c.code==="auth/missing-recaptcha-token"||c.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${r} flow.`);const d=await Jf(t,e,r,!1,!0);return n(t,d)}return Promise.reject(c)})}else{const l=await Jf(t,e,r,!1,!0);return n(t,l)}else return Promise.reject(s+" provider is not supported.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BM(t,e){const r=px(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(Fc(i,e??{}))return s;Xi(s,"already-initialized")}return r.initialize({options:e})}function UM(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Yo);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function zM(t,e,r){const n=wl(t);ut(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!!(r!=null&&r.disableWarnings),i=uT(e),{host:o,port:l}=qM(e),c=l===null?"":`:${l}`,u={url:`${i}//${o}${c}/`},d=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){ut(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ut(Fc(u,n.config.emulator)&&Fc(d,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=u,n.emulatorConfig=d,n.settings.appVerificationDisabledForTesting=!0,ru(o)?(Uw(`${i}//${o}${c}`),zw("Auth",!0)):s||$M()}function uT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function qM(t){const e=uT(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:Bj(n.substr(i.length+1))}}else{const[i,o]=n.split(":");return{host:i,port:Bj(o)}}}function Bj(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function $M(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ko("not implemented")}_getIdTokenResponse(e){return Ko("not implemented")}_linkToIdToken(e,r){return Ko("not implemented")}_getReauthenticationResolver(e){return Ko("not implemented")}}async function WM(t,e){return yo(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HM(t,e){return Ip(t,"POST","/v1/accounts:signInWithPassword",bl(t,e))}async function GM(t,e){return yo(t,"POST","/v1/accounts:sendOobCode",bl(t,e))}async function KM(t,e){return GM(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YM(t,e){return Ip(t,"POST","/v1/accounts:signInWithEmailLink",bl(t,e))}async function QM(t,e){return Ip(t,"POST","/v1/accounts:signInWithEmailLink",bl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap extends Xw{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new ap(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new ap(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return my(e,r,"signInWithPassword",HM,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return YM(e,{email:this._email,oobCode:this._password});default:Xi(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return my(e,n,"signUpPassword",WM,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return QM(e,{idToken:r,email:this._email,oobCode:this._password});default:Xi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ph(t,e){return Ip(t,"POST","/v1/accounts:signInWithIdp",bl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JM="http://localhost";class id extends Xw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new id(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Xi("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,i=Hw(r,["providerId","signInMethod"]);if(!n||!s)return null;const o=new id(n,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return Ph(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Ph(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Ph(e,r)}buildRequest(){const e={requestUri:JM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=kp(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function ZM(t){const e=om(lm(t)).link,r=e?om(lm(e)).deep_link_id:null,n=om(lm(t)).deep_link_id;return(n?om(lm(n)).link:null)||n||r||e||t}class Zw{constructor(e){var r,n,s,i,o,l;const c=om(lm(e)),u=(r=c.apiKey)!==null&&r!==void 0?r:null,d=(n=c.oobCode)!==null&&n!==void 0?n:null,h=XM((s=c.mode)!==null&&s!==void 0?s:null);ut(u&&d&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=d,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.lang)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const r=ZM(e);try{return new Zw(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(){this.providerId=ff.PROVIDER_ID}static credential(e,r){return ap._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=Zw.parseLink(r);return ut(n,"argument-error"),ap._fromEmailAndCode(e,n.code,n.tenantId)}}ff.PROVIDER_ID="password";ff.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ff.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e5{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cp extends e5{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lc extends Cp{constructor(){super("facebook.com")}static credential(e){return id._fromParams({providerId:lc.PROVIDER_ID,signInMethod:lc.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return lc.credentialFromTaggedObject(e)}static credentialFromError(e){return lc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return lc.credential(e.oauthAccessToken)}catch{return null}}}lc.FACEBOOK_SIGN_IN_METHOD="facebook.com";lc.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa extends Cp{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return id._fromParams({providerId:Qa.PROVIDER_ID,signInMethod:Qa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Qa.credentialFromTaggedObject(e)}static credentialFromError(e){return Qa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Qa.credential(r,n)}catch{return null}}}Qa.GOOGLE_SIGN_IN_METHOD="google.com";Qa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc extends Cp{constructor(){super("github.com")}static credential(e){return id._fromParams({providerId:cc.PROVIDER_ID,signInMethod:cc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return cc.credentialFromTaggedObject(e)}static credentialFromError(e){return cc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return cc.credential(e.oauthAccessToken)}catch{return null}}}cc.GITHUB_SIGN_IN_METHOD="github.com";cc.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc extends Cp{constructor(){super("twitter.com")}static credential(e,r){return id._fromParams({providerId:uc.PROVIDER_ID,signInMethod:uc.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return uc.credentialFromTaggedObject(e)}static credentialFromError(e){return uc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return uc.credential(r,n)}catch{return null}}}uc.TWITTER_SIGN_IN_METHOD="twitter.com";uc.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eF(t,e){return Ip(t,"POST","/v1/accounts:signUp",bl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await wa._fromIdTokenResponse(e,n,s),o=Uj(n);return new ad({user:i,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=Uj(n);return new ad({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function Uj(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py extends go{constructor(e,r,n,s){var i;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,py.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new py(e,r,n,s)}}function dT(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?py._fromErrorAndOperation(t,i,e,n):i})}async function tF(t,e,r=!1){const n=await Qh(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return ad._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rF(t,e,r=!1){const{auth:n}=t;if(Ws(n.app))return Promise.reject(el(n));const s="reauthenticate";try{const i=await Qh(t,dT(n,s,e,t),r);ut(i.idToken,n,"internal-error");const o=Qw(i.idToken);ut(o,n,"internal-error");const{sub:l}=o;return ut(t.uid===l,n,"user-mismatch"),ad._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Xi(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hT(t,e,r=!1){if(Ws(t.app))return Promise.reject(el(t));const n="signIn",s=await dT(t,n,e),i=await ad._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}async function nF(t,e){return hT(wl(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sF(t,e,r){var n;ut(((n=r.url)===null||n===void 0?void 0:n.length)>0,t,"invalid-continue-uri"),ut(typeof r.dynamicLinkDomain>"u"||r.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),ut(typeof r.linkDomain>"u"||r.linkDomain.length>0,t,"invalid-hosting-link-domain"),e.continueUrl=r.url,e.dynamicLinkDomain=r.dynamicLinkDomain,e.linkDomain=r.linkDomain,e.canHandleCodeInApp=r.handleCodeInApp,r.iOS&&(ut(r.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=r.iOS.bundleId),r.android&&(ut(r.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=r.android.installApp,e.androidMinimumVersionCode=r.android.minimumVersion,e.androidPackageName=r.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fT(t){const e=wl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function iF(t,e,r){const n=wl(t),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};r&&sF(n,s,r),await my(n,s,"getOobCode",KM,"EMAIL_PASSWORD_PROVIDER")}async function aF(t,e,r){if(Ws(t.app))return Promise.reject(el(t));const n=wl(t),o=await my(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",eF,"EMAIL_PASSWORD_PROVIDER").catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&fT(t),c}),l=await ad._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function oF(t,e,r){return Ws(t.app)?Promise.reject(el(t)):nF(fr(t),ff.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&fT(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lF(t,e){return yo(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cF(t,{displayName:e,photoURL:r}){if(e===void 0&&r===void 0)return;const n=fr(t),i={idToken:await n.getIdToken(),displayName:e,photoUrl:r,returnSecureToken:!0},o=await Qh(n,lF(n.auth,i));n.displayName=o.displayName||null,n.photoURL=o.photoUrl||null;const l=n.providerData.find(({providerId:c})=>c==="password");l&&(l.displayName=n.displayName,l.photoURL=n.photoURL),await n._updateTokensIfNecessary(o)}function uF(t,e,r,n){return fr(t).onIdTokenChanged(e,r,n)}function dF(t,e,r){return fr(t).beforeAuthStateChanged(e,r)}function t5(t,e,r,n){return fr(t).onAuthStateChanged(e,r,n)}function hF(t){return fr(t).signOut()}const gy="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(gy,"1"),this.storage.removeItem(gy),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fF=1e3,mF=10;class pT extends mT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=aT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},i=this.storage.getItem(n);AM()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,mF):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},fF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}pT.type="LOCAL";const pF=pT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT extends mT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}gT.type="SESSION";const yT=gT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gF(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yx{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new yx(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const l=Array.from(o).map(async u=>u(r.origin,i)),c=await gF(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}yx.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r5(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=r5("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(h){const g=h;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(g.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ao(){return window}function xF(t){ao().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xT(){return typeof ao().WorkerGlobalScope<"u"&&typeof ao().importScripts=="function"}async function vF(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function bF(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function wF(){return xT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vT="firebaseLocalStorageDb",NF=1,yy="firebaseLocalStorage",bT="fbase_key";class Pp{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function xx(t,e){return t.transaction([yy],e?"readwrite":"readonly").objectStore(yy)}function _F(){const t=indexedDB.deleteDatabase(vT);return new Pp(t).toPromise()}function W2(){const t=indexedDB.open(vT,NF);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(yy,{keyPath:bT})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(yy)?e(n):(n.close(),await _F(),e(await W2()))})})}async function zj(t,e,r){const n=xx(t,!0).put({[bT]:e,value:r});return new Pp(n).toPromise()}async function jF(t,e){const r=xx(t,!1).get(e),n=await new Pp(r).toPromise();return n===void 0?null:n.value}function qj(t,e){const r=xx(t,!0).delete(e);return new Pp(r).toPromise()}const SF=800,AF=3;class wT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await W2(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>AF)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return xT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=yx._getInstance(wF()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await vF(),!this.activeServiceWorker)return;this.sender=new yF(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||bF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await W2();return await zj(e,gy,"1"),await qj(e,gy),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>zj(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>jF(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>qj(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=xx(s,!1).getAll();return new Pp(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),SF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}wT.type="LOCAL";const EF=wT;new Tp(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(t,e){return e?Yo(e):(ut(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n5 extends Xw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ph(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Ph(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Ph(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function kF(t){return hT(t.auth,new n5(t),t.bypassAuthState)}function TF(t){const{auth:e,user:r}=t;return ut(r,e,"internal-error"),rF(r,new n5(t),t.bypassAuthState)}async function IF(t){const{auth:e,user:r}=t;return ut(r,e,"internal-error"),tF(r,new n5(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _T{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return kF;case"linkViaPopup":case"linkViaRedirect":return IF;case"reauthViaPopup":case"reauthViaRedirect":return TF;default:Xi(this.auth,"internal-error")}}resolve(e){cl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){cl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CF=new Tp(2e3,1e4);async function jT(t,e,r){if(Ws(t.app))return Promise.reject(ja(t,"operation-not-supported-in-this-environment"));const n=wl(t);aM(t,e,e5);const s=NT(n,r);return new zu(n,"signInViaPopup",e,s).executeNotNull()}class zu extends _T{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,zu.currentPopupAction&&zu.currentPopupAction.cancel(),zu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ut(e,this.auth,"internal-error"),e}async onExecution(){cl(this.filter.length===1,"Popup operations only handle one event");const e=r5();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ja(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ja(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,zu.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ja(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,CF.get())};e()}}zu.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PF="pendingRedirect",x0=new Map;class RF extends _T{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=x0.get(this.auth._key());if(!e){try{const n=await DF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}x0.set(this.auth._key(),e)}return this.bypassAuthState||x0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function DF(t,e){const r=MF(e),n=OF(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function LF(t,e){x0.set(t._key(),e)}function OF(t){return Yo(t._redirectPersistence)}function MF(t){return y0(PF,t.config.apiKey,t.name)}async function FF(t,e,r=!1){if(Ws(t.app))return Promise.reject(el(t));const n=wl(t),s=NT(n,e),o=await new RF(n,s,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VF=10*60*1e3;class BF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!UF(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!ST(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ja(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=VF&&this.cachedEventUids.clear(),this.cachedEventUids.has($j(e))}saveEventToCache(e){this.cachedEventUids.add($j(e)),this.lastProcessedEventTime=Date.now()}}function $j(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function ST({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function UF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ST(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zF(t,e={}){return yo(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$F=/^https?/;async function WF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await zF(t);for(const r of e)try{if(HF(r))return}catch{}Xi(t,"unauthorized-domain")}function HF(t){const e=q2(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!$F.test(r))return!1;if(qF.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GF=new Tp(3e4,6e4);function Wj(){const t=ao().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function KF(t){return new Promise((e,r)=>{var n,s,i;function o(){Wj(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Wj(),r(ja(t,"network-request-failed"))},timeout:GF.get()})}if(!((s=(n=ao().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=ao().gapi)===null||i===void 0)&&i.load)o();else{const l=LM("iframefcb");return ao()[l]=()=>{gapi.load?o():r(ja(t,"network-request-failed"))},lT(`${DM()}?onload=${l}`).catch(c=>r(c))}}).catch(e=>{throw v0=null,e})}let v0=null;function YF(t){return v0=v0||KF(t),v0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QF=new Tp(5e3,15e3),JF="__/auth/iframe",XF="emulator/auth/iframe",ZF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},e9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function t9(t){const e=t.config;ut(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Yw(e,XF):`https://${t.config.authDomain}/${JF}`,n={apiKey:e.apiKey,appName:t.name,v:md},s=e9.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${kp(n).slice(1)}`}async function r9(t){const e=await YF(t),r=ao().gapi;return ut(r,t,"internal-error"),e.open({where:document.body,url:t9(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ZF,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const o=ja(t,"network-request-failed"),l=ao().setTimeout(()=>{i(o)},QF.get());function c(){ao().clearTimeout(l),s(n)}n.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},s9=500,i9=600,a9="_blank",o9="http://localhost";class Hj{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function l9(t,e,r,n=s9,s=i9){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c=Object.assign(Object.assign({},n9),{width:n.toString(),height:s.toString(),top:i,left:o}),u=fs().toLowerCase();r&&(l=tT(u)?a9:r),Zk(u)&&(e=e||o9,c.scrollbars="yes");const d=Object.entries(c).reduce((g,[m,w])=>`${g}${m}=${w},`,"");if(SM(u)&&l!=="_self")return c9(e||"",l),new Hj(null);const h=window.open(e||"",l,d);ut(h,t,"popup-blocked");try{h.focus()}catch{}return new Hj(h)}function c9(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u9="__/auth/handler",d9="emulator/auth/handler",h9=encodeURIComponent("fac");async function Gj(t,e,r,n,s,i){ut(t.config.authDomain,t,"auth-domain-config-required"),ut(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:md,eventId:s};if(e instanceof e5){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",HO(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries(i||{}))o[d]=h}if(e instanceof Cp){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${h9}=${encodeURIComponent(c)}`:"";return`${f9(t)}?${kp(l).slice(1)}${u}`}function f9({config:t}){return t.emulator?Yw(t,d9):`https://${t.authDomain}/${u9}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ev="webStorageSupport";class m9{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=yT,this._completeRedirectFn=FF,this._overrideRedirectResult=LF}async _openPopup(e,r,n,s){var i;cl((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await Gj(e,r,n,q2(),s);return l9(e,o,r5())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await Gj(e,r,n,q2(),s);return xF(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(cl(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await r9(e),n=new BF(e);return r.register("authEvent",s=>(ut(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(ev,{type:ev},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[ev];o!==void 0&&r(!!o),Xi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=WF(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return aT()||eT()||Jw()}}const p9=m9;var Kj="@firebase/auth",Yj="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g9{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ut(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y9(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function x9(t){sd(new Vc("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;ut(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:oT(t)},u=new CM(n,s,i,c);return UM(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),sd(new Vc("auth-internal",e=>{const r=wl(e.getProvider("auth").getImmediate());return(n=>new g9(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),io(Kj,Yj,y9(t)),io(Kj,Yj,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v9=5*60,b9=Vk("authIdTokenMaxAge")||v9;let Qj=null;const w9=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>b9)return;const s=r==null?void 0:r.token;Qj!==s&&(Qj=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function N9(t=Ww()){const e=px(t,"auth");if(e.isInitialized())return e.getImmediate();const r=BM(t,{popupRedirectResolver:p9,persistence:[EF,pF,yT]}),n=Vk("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const o=w9(i.toString());dF(r,o,()=>o(r.currentUser)),uF(r,l=>o(l))}}const s=Ok("auth");return s&&zM(r,`http://${s}`),r}function _9(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}PM({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=ja("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",_9().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});x9("Browser");/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function j9(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{u(n.next(d))}catch(h){o(h)}}function c(d){try{u(n.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})}function S9(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,s=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],s=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var gh=function(){return gh=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},gh.apply(this,arguments)},AT=function(t){return{loading:t==null,value:t}},A9=function(){return function(t,e){switch(e.type){case"error":return gh(gh({},t),{error:e.error,loading:!1,value:void 0});case"reset":return AT(e.defaultValue);case"value":return gh(gh({},t),{error:void 0,loading:!1,value:e.value});default:return t}}},E9=function(t){var e=t?t():void 0,r=M.useReducer(A9(),AT(e)),n=r[0],s=r[1],i=M.useCallback(function(){var c=t?t():void 0;s({type:"reset",defaultValue:c})},[t]),o=M.useCallback(function(c){s({type:"error",error:c})},[]),l=M.useCallback(function(c){s({type:"value",value:c})},[]);return M.useMemo(function(){return{error:n.error,loading:n.loading,reset:i,setError:o,setValue:l,value:n.value}},[n.error,n.loading,i,o,l,n.value])},k9=function(t,e){var r=E9(function(){return t.currentUser}),n=r.error,s=r.loading,i=r.setError,o=r.setValue,l=r.value;return M.useEffect(function(){var c=t5(t,function(u){return j9(void 0,void 0,void 0,function(){var d;return S9(this,function(h){switch(h.label){case 0:if(!(e!=null&&e.onUserChanged))return[3,4];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,e.onUserChanged(u)];case 2:return h.sent(),[3,4];case 3:return d=h.sent(),i(d),[3,4];case 4:return o(u),[2]}})})},i);return function(){c()}},[t]),[l,s,n]},T9="firebase",I9="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */io(T9,I9,"app");var Jj=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ic,ET;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,A){function I(){}I.prototype=A.prototype,k.D=A.prototype,k.prototype=new I,k.prototype.constructor=k,k.C=function(O,S,R){for(var C=Array(arguments.length-2),G=2;G<arguments.length;G++)C[G-2]=arguments[G];return A.prototype[S].apply(O,C)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(k,A,I){I||(I=0);var O=Array(16);if(typeof A=="string")for(var S=0;16>S;++S)O[S]=A.charCodeAt(I++)|A.charCodeAt(I++)<<8|A.charCodeAt(I++)<<16|A.charCodeAt(I++)<<24;else for(S=0;16>S;++S)O[S]=A[I++]|A[I++]<<8|A[I++]<<16|A[I++]<<24;A=k.g[0],I=k.g[1],S=k.g[2];var R=k.g[3],C=A+(R^I&(S^R))+O[0]+3614090360&4294967295;A=I+(C<<7&4294967295|C>>>25),C=R+(S^A&(I^S))+O[1]+3905402710&4294967295,R=A+(C<<12&4294967295|C>>>20),C=S+(I^R&(A^I))+O[2]+606105819&4294967295,S=R+(C<<17&4294967295|C>>>15),C=I+(A^S&(R^A))+O[3]+3250441966&4294967295,I=S+(C<<22&4294967295|C>>>10),C=A+(R^I&(S^R))+O[4]+4118548399&4294967295,A=I+(C<<7&4294967295|C>>>25),C=R+(S^A&(I^S))+O[5]+1200080426&4294967295,R=A+(C<<12&4294967295|C>>>20),C=S+(I^R&(A^I))+O[6]+2821735955&4294967295,S=R+(C<<17&4294967295|C>>>15),C=I+(A^S&(R^A))+O[7]+4249261313&4294967295,I=S+(C<<22&4294967295|C>>>10),C=A+(R^I&(S^R))+O[8]+1770035416&4294967295,A=I+(C<<7&4294967295|C>>>25),C=R+(S^A&(I^S))+O[9]+2336552879&4294967295,R=A+(C<<12&4294967295|C>>>20),C=S+(I^R&(A^I))+O[10]+4294925233&4294967295,S=R+(C<<17&4294967295|C>>>15),C=I+(A^S&(R^A))+O[11]+2304563134&4294967295,I=S+(C<<22&4294967295|C>>>10),C=A+(R^I&(S^R))+O[12]+1804603682&4294967295,A=I+(C<<7&4294967295|C>>>25),C=R+(S^A&(I^S))+O[13]+4254626195&4294967295,R=A+(C<<12&4294967295|C>>>20),C=S+(I^R&(A^I))+O[14]+2792965006&4294967295,S=R+(C<<17&4294967295|C>>>15),C=I+(A^S&(R^A))+O[15]+1236535329&4294967295,I=S+(C<<22&4294967295|C>>>10),C=A+(S^R&(I^S))+O[1]+4129170786&4294967295,A=I+(C<<5&4294967295|C>>>27),C=R+(I^S&(A^I))+O[6]+3225465664&4294967295,R=A+(C<<9&4294967295|C>>>23),C=S+(A^I&(R^A))+O[11]+643717713&4294967295,S=R+(C<<14&4294967295|C>>>18),C=I+(R^A&(S^R))+O[0]+3921069994&4294967295,I=S+(C<<20&4294967295|C>>>12),C=A+(S^R&(I^S))+O[5]+3593408605&4294967295,A=I+(C<<5&4294967295|C>>>27),C=R+(I^S&(A^I))+O[10]+38016083&4294967295,R=A+(C<<9&4294967295|C>>>23),C=S+(A^I&(R^A))+O[15]+3634488961&4294967295,S=R+(C<<14&4294967295|C>>>18),C=I+(R^A&(S^R))+O[4]+3889429448&4294967295,I=S+(C<<20&4294967295|C>>>12),C=A+(S^R&(I^S))+O[9]+568446438&4294967295,A=I+(C<<5&4294967295|C>>>27),C=R+(I^S&(A^I))+O[14]+3275163606&4294967295,R=A+(C<<9&4294967295|C>>>23),C=S+(A^I&(R^A))+O[3]+4107603335&4294967295,S=R+(C<<14&4294967295|C>>>18),C=I+(R^A&(S^R))+O[8]+1163531501&4294967295,I=S+(C<<20&4294967295|C>>>12),C=A+(S^R&(I^S))+O[13]+2850285829&4294967295,A=I+(C<<5&4294967295|C>>>27),C=R+(I^S&(A^I))+O[2]+4243563512&4294967295,R=A+(C<<9&4294967295|C>>>23),C=S+(A^I&(R^A))+O[7]+1735328473&4294967295,S=R+(C<<14&4294967295|C>>>18),C=I+(R^A&(S^R))+O[12]+2368359562&4294967295,I=S+(C<<20&4294967295|C>>>12),C=A+(I^S^R)+O[5]+4294588738&4294967295,A=I+(C<<4&4294967295|C>>>28),C=R+(A^I^S)+O[8]+2272392833&4294967295,R=A+(C<<11&4294967295|C>>>21),C=S+(R^A^I)+O[11]+1839030562&4294967295,S=R+(C<<16&4294967295|C>>>16),C=I+(S^R^A)+O[14]+4259657740&4294967295,I=S+(C<<23&4294967295|C>>>9),C=A+(I^S^R)+O[1]+2763975236&4294967295,A=I+(C<<4&4294967295|C>>>28),C=R+(A^I^S)+O[4]+1272893353&4294967295,R=A+(C<<11&4294967295|C>>>21),C=S+(R^A^I)+O[7]+4139469664&4294967295,S=R+(C<<16&4294967295|C>>>16),C=I+(S^R^A)+O[10]+3200236656&4294967295,I=S+(C<<23&4294967295|C>>>9),C=A+(I^S^R)+O[13]+681279174&4294967295,A=I+(C<<4&4294967295|C>>>28),C=R+(A^I^S)+O[0]+3936430074&4294967295,R=A+(C<<11&4294967295|C>>>21),C=S+(R^A^I)+O[3]+3572445317&4294967295,S=R+(C<<16&4294967295|C>>>16),C=I+(S^R^A)+O[6]+76029189&4294967295,I=S+(C<<23&4294967295|C>>>9),C=A+(I^S^R)+O[9]+3654602809&4294967295,A=I+(C<<4&4294967295|C>>>28),C=R+(A^I^S)+O[12]+3873151461&4294967295,R=A+(C<<11&4294967295|C>>>21),C=S+(R^A^I)+O[15]+530742520&4294967295,S=R+(C<<16&4294967295|C>>>16),C=I+(S^R^A)+O[2]+3299628645&4294967295,I=S+(C<<23&4294967295|C>>>9),C=A+(S^(I|~R))+O[0]+4096336452&4294967295,A=I+(C<<6&4294967295|C>>>26),C=R+(I^(A|~S))+O[7]+1126891415&4294967295,R=A+(C<<10&4294967295|C>>>22),C=S+(A^(R|~I))+O[14]+2878612391&4294967295,S=R+(C<<15&4294967295|C>>>17),C=I+(R^(S|~A))+O[5]+4237533241&4294967295,I=S+(C<<21&4294967295|C>>>11),C=A+(S^(I|~R))+O[12]+1700485571&4294967295,A=I+(C<<6&4294967295|C>>>26),C=R+(I^(A|~S))+O[3]+2399980690&4294967295,R=A+(C<<10&4294967295|C>>>22),C=S+(A^(R|~I))+O[10]+4293915773&4294967295,S=R+(C<<15&4294967295|C>>>17),C=I+(R^(S|~A))+O[1]+2240044497&4294967295,I=S+(C<<21&4294967295|C>>>11),C=A+(S^(I|~R))+O[8]+1873313359&4294967295,A=I+(C<<6&4294967295|C>>>26),C=R+(I^(A|~S))+O[15]+4264355552&4294967295,R=A+(C<<10&4294967295|C>>>22),C=S+(A^(R|~I))+O[6]+2734768916&4294967295,S=R+(C<<15&4294967295|C>>>17),C=I+(R^(S|~A))+O[13]+1309151649&4294967295,I=S+(C<<21&4294967295|C>>>11),C=A+(S^(I|~R))+O[4]+4149444226&4294967295,A=I+(C<<6&4294967295|C>>>26),C=R+(I^(A|~S))+O[11]+3174756917&4294967295,R=A+(C<<10&4294967295|C>>>22),C=S+(A^(R|~I))+O[2]+718787259&4294967295,S=R+(C<<15&4294967295|C>>>17),C=I+(R^(S|~A))+O[9]+3951481745&4294967295,k.g[0]=k.g[0]+A&4294967295,k.g[1]=k.g[1]+(S+(C<<21&4294967295|C>>>11))&4294967295,k.g[2]=k.g[2]+S&4294967295,k.g[3]=k.g[3]+R&4294967295}n.prototype.u=function(k,A){A===void 0&&(A=k.length);for(var I=A-this.blockSize,O=this.B,S=this.h,R=0;R<A;){if(S==0)for(;R<=I;)s(this,k,R),R+=this.blockSize;if(typeof k=="string"){for(;R<A;)if(O[S++]=k.charCodeAt(R++),S==this.blockSize){s(this,O),S=0;break}}else for(;R<A;)if(O[S++]=k[R++],S==this.blockSize){s(this,O),S=0;break}}this.h=S,this.o+=A},n.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var A=1;A<k.length-8;++A)k[A]=0;var I=8*this.o;for(A=k.length-8;A<k.length;++A)k[A]=I&255,I/=256;for(this.u(k),k=Array(16),A=I=0;4>A;++A)for(var O=0;32>O;O+=8)k[I++]=this.g[A]>>>O&255;return k};function i(k,A){var I=l;return Object.prototype.hasOwnProperty.call(I,k)?I[k]:I[k]=A(k)}function o(k,A){this.h=A;for(var I=[],O=!0,S=k.length-1;0<=S;S--){var R=k[S]|0;O&&R==A||(I[S]=R,O=!1)}this.g=I}var l={};function c(k){return-128<=k&&128>k?i(k,function(A){return new o([A|0],0>A?-1:0)}):new o([k|0],0>k?-1:0)}function u(k){if(isNaN(k)||!isFinite(k))return h;if(0>k)return T(u(-k));for(var A=[],I=1,O=0;k>=I;O++)A[O]=k/I|0,I*=4294967296;return new o(A,0)}function d(k,A){if(k.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(k.charAt(0)=="-")return T(d(k.substring(1),A));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=u(Math.pow(A,8)),O=h,S=0;S<k.length;S+=8){var R=Math.min(8,k.length-S),C=parseInt(k.substring(S,S+R),A);8>R?(R=u(Math.pow(A,R)),O=O.j(R).add(u(C))):(O=O.j(I),O=O.add(u(C)))}return O}var h=c(0),g=c(1),m=c(16777216);t=o.prototype,t.m=function(){if(_(this))return-T(this).m();for(var k=0,A=1,I=0;I<this.g.length;I++){var O=this.i(I);k+=(0<=O?O:4294967296+O)*A,A*=4294967296}return k},t.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(w(this))return"0";if(_(this))return"-"+T(this).toString(k);for(var A=u(Math.pow(k,6)),I=this,O="";;){var S=P(I,A).g;I=v(I,S.j(A));var R=((0<I.g.length?I.g[0]:I.h)>>>0).toString(k);if(I=S,w(I))return R+O;for(;6>R.length;)R="0"+R;O=R+O}},t.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function w(k){if(k.h!=0)return!1;for(var A=0;A<k.g.length;A++)if(k.g[A]!=0)return!1;return!0}function _(k){return k.h==-1}t.l=function(k){return k=v(this,k),_(k)?-1:w(k)?0:1};function T(k){for(var A=k.g.length,I=[],O=0;O<A;O++)I[O]=~k.g[O];return new o(I,~k.h).add(g)}t.abs=function(){return _(this)?T(this):this},t.add=function(k){for(var A=Math.max(this.g.length,k.g.length),I=[],O=0,S=0;S<=A;S++){var R=O+(this.i(S)&65535)+(k.i(S)&65535),C=(R>>>16)+(this.i(S)>>>16)+(k.i(S)>>>16);O=C>>>16,R&=65535,C&=65535,I[S]=C<<16|R}return new o(I,I[I.length-1]&-2147483648?-1:0)};function v(k,A){return k.add(T(A))}t.j=function(k){if(w(this)||w(k))return h;if(_(this))return _(k)?T(this).j(T(k)):T(T(this).j(k));if(_(k))return T(this.j(T(k)));if(0>this.l(m)&&0>k.l(m))return u(this.m()*k.m());for(var A=this.g.length+k.g.length,I=[],O=0;O<2*A;O++)I[O]=0;for(O=0;O<this.g.length;O++)for(var S=0;S<k.g.length;S++){var R=this.i(O)>>>16,C=this.i(O)&65535,G=k.i(S)>>>16,de=k.i(S)&65535;I[2*O+2*S]+=C*de,b(I,2*O+2*S),I[2*O+2*S+1]+=R*de,b(I,2*O+2*S+1),I[2*O+2*S+1]+=C*G,b(I,2*O+2*S+1),I[2*O+2*S+2]+=R*G,b(I,2*O+2*S+2)}for(O=0;O<A;O++)I[O]=I[2*O+1]<<16|I[2*O];for(O=A;O<2*A;O++)I[O]=0;return new o(I,0)};function b(k,A){for(;(k[A]&65535)!=k[A];)k[A+1]+=k[A]>>>16,k[A]&=65535,A++}function x(k,A){this.g=k,this.h=A}function P(k,A){if(w(A))throw Error("division by zero");if(w(k))return new x(h,h);if(_(k))return A=P(T(k),A),new x(T(A.g),T(A.h));if(_(A))return A=P(k,T(A)),new x(T(A.g),A.h);if(30<k.g.length){if(_(k)||_(A))throw Error("slowDivide_ only works with positive integers.");for(var I=g,O=A;0>=O.l(k);)I=F(I),O=F(O);var S=$(I,1),R=$(O,1);for(O=$(O,2),I=$(I,2);!w(O);){var C=R.add(O);0>=C.l(k)&&(S=S.add(I),R=C),O=$(O,1),I=$(I,1)}return A=v(k,S.j(A)),new x(S,A)}for(S=h;0<=k.l(A);){for(I=Math.max(1,Math.floor(k.m()/A.m())),O=Math.ceil(Math.log(I)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),R=u(I),C=R.j(A);_(C)||0<C.l(k);)I-=O,R=u(I),C=R.j(A);w(R)&&(R=g),S=S.add(R),k=v(k,C)}return new x(S,k)}t.A=function(k){return P(this,k).h},t.and=function(k){for(var A=Math.max(this.g.length,k.g.length),I=[],O=0;O<A;O++)I[O]=this.i(O)&k.i(O);return new o(I,this.h&k.h)},t.or=function(k){for(var A=Math.max(this.g.length,k.g.length),I=[],O=0;O<A;O++)I[O]=this.i(O)|k.i(O);return new o(I,this.h|k.h)},t.xor=function(k){for(var A=Math.max(this.g.length,k.g.length),I=[],O=0;O<A;O++)I[O]=this.i(O)^k.i(O);return new o(I,this.h^k.h)};function F(k){for(var A=k.g.length+1,I=[],O=0;O<A;O++)I[O]=k.i(O)<<1|k.i(O-1)>>>31;return new o(I,k.h)}function $(k,A){var I=A>>5;A%=32;for(var O=k.g.length-I,S=[],R=0;R<O;R++)S[R]=0<A?k.i(R+I)>>>A|k.i(R+I+1)<<32-A:k.i(R+I);return new o(S,k.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,ET=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Ic=o}).apply(typeof Jj<"u"?Jj:typeof self<"u"?self:typeof window<"u"?window:{});var Fg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var kT,cm,TT,b0,H2,IT,CT,PT;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,E,L){return p==Array.prototype||p==Object.prototype||(p[E]=L.value),p};function r(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Fg=="object"&&Fg];for(var E=0;E<p.length;++E){var L=p[E];if(L&&L.Math==Math)return L}throw Error("Cannot find global object")}var n=r(this);function s(p,E){if(E)e:{var L=n;p=p.split(".");for(var W=0;W<p.length-1;W++){var he=p[W];if(!(he in L))break e;L=L[he]}p=p[p.length-1],W=L[p],E=E(W),E!=W&&E!=null&&e(L,p,{configurable:!0,writable:!0,value:E})}}function i(p,E){p instanceof String&&(p+="");var L=0,W=!1,he={next:function(){if(!W&&L<p.length){var ye=L++;return{value:E(ye,p[ye]),done:!1}}return W=!0,{done:!0,value:void 0}}};return he[Symbol.iterator]=function(){return he},he}s("Array.prototype.values",function(p){return p||function(){return i(this,function(E,L){return L})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(p){var E=typeof p;return E=E!="object"?E:p?Array.isArray(p)?"array":E:"null",E=="array"||E=="object"&&typeof p.length=="number"}function u(p){var E=typeof p;return E=="object"&&p!=null||E=="function"}function d(p,E,L){return p.call.apply(p.bind,arguments)}function h(p,E,L){if(!p)throw Error();if(2<arguments.length){var W=Array.prototype.slice.call(arguments,2);return function(){var he=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(he,W),p.apply(E,he)}}return function(){return p.apply(E,arguments)}}function g(p,E,L){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,g.apply(null,arguments)}function m(p,E){var L=Array.prototype.slice.call(arguments,1);return function(){var W=L.slice();return W.push.apply(W,arguments),p.apply(this,W)}}function w(p,E){function L(){}L.prototype=E.prototype,p.aa=E.prototype,p.prototype=new L,p.prototype.constructor=p,p.Qb=function(W,he,ye){for(var Oe=Array(arguments.length-2),Tt=2;Tt<arguments.length;Tt++)Oe[Tt-2]=arguments[Tt];return E.prototype[he].apply(W,Oe)}}function _(p){const E=p.length;if(0<E){const L=Array(E);for(let W=0;W<E;W++)L[W]=p[W];return L}return[]}function T(p,E){for(let L=1;L<arguments.length;L++){const W=arguments[L];if(c(W)){const he=p.length||0,ye=W.length||0;p.length=he+ye;for(let Oe=0;Oe<ye;Oe++)p[he+Oe]=W[Oe]}else p.push(W)}}class v{constructor(E,L){this.i=E,this.j=L,this.h=0,this.g=null}get(){let E;return 0<this.h?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function b(p){return/^[\s\xa0]*$/.test(p)}function x(){var p=l.navigator;return p&&(p=p.userAgent)?p:""}function P(p){return P[" "](p),p}P[" "]=function(){};var F=x().indexOf("Gecko")!=-1&&!(x().toLowerCase().indexOf("webkit")!=-1&&x().indexOf("Edge")==-1)&&!(x().indexOf("Trident")!=-1||x().indexOf("MSIE")!=-1)&&x().indexOf("Edge")==-1;function $(p,E,L){for(const W in p)E.call(L,p[W],W,p)}function k(p,E){for(const L in p)E.call(void 0,p[L],L,p)}function A(p){const E={};for(const L in p)E[L]=p[L];return E}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(p,E){let L,W;for(let he=1;he<arguments.length;he++){W=arguments[he];for(L in W)p[L]=W[L];for(let ye=0;ye<I.length;ye++)L=I[ye],Object.prototype.hasOwnProperty.call(W,L)&&(p[L]=W[L])}}function S(p){var E=1;p=p.split(":");const L=[];for(;0<E&&p.length;)L.push(p.shift()),E--;return p.length&&L.push(p.join(":")),L}function R(p){l.setTimeout(()=>{throw p},0)}function C(){var p=Q;let E=null;return p.g&&(E=p.g,p.g=p.g.next,p.g||(p.h=null),E.next=null),E}class G{constructor(){this.h=this.g=null}add(E,L){const W=de.get();W.set(E,L),this.h?this.h.next=W:this.g=W,this.h=W}}var de=new v(()=>new ne,p=>p.reset());class ne{constructor(){this.next=this.g=this.h=null}set(E,L){this.h=E,this.g=L,this.next=null}reset(){this.next=this.g=this.h=null}}let X,Y=!1,Q=new G,se=()=>{const p=l.Promise.resolve(void 0);X=()=>{p.then(Se)}};var Se=()=>{for(var p;p=C();){try{p.h.call(p.g)}catch(L){R(L)}var E=de;E.j(p),100>E.h&&(E.h++,p.next=E.g,E.g=p)}Y=!1};function U(){this.s=this.s,this.C=this.C}U.prototype.s=!1,U.prototype.ma=function(){this.s||(this.s=!0,this.N())},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function J(p,E){this.type=p,this.g=this.target=E,this.defaultPrevented=!1}J.prototype.h=function(){this.defaultPrevented=!0};var te=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var p=!1,E=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const L=()=>{};l.addEventListener("test",L,E),l.removeEventListener("test",L,E)}catch{}return p}();function ie(p,E){if(J.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var L=this.type=p.type,W=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=E,E=p.relatedTarget){if(F){e:{try{P(E.nodeName);var he=!0;break e}catch{}he=!1}he||(E=null)}}else L=="mouseover"?E=p.fromElement:L=="mouseout"&&(E=p.toElement);this.relatedTarget=E,W?(this.clientX=W.clientX!==void 0?W.clientX:W.pageX,this.clientY=W.clientY!==void 0?W.clientY:W.pageY,this.screenX=W.screenX||0,this.screenY=W.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:ue[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&ie.aa.h.call(this)}}w(ie,J);var ue={2:"touch",3:"pen",4:"mouse"};ie.prototype.h=function(){ie.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var ge="closure_listenable_"+(1e6*Math.random()|0),we=0;function be(p,E,L,W,he){this.listener=p,this.proxy=null,this.src=E,this.type=L,this.capture=!!W,this.ha=he,this.key=++we,this.da=this.fa=!1}function Me(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function De(p){this.src=p,this.g={},this.h=0}De.prototype.add=function(p,E,L,W,he){var ye=p.toString();p=this.g[ye],p||(p=this.g[ye]=[],this.h++);var Oe=$e(p,E,W,he);return-1<Oe?(E=p[Oe],L||(E.fa=!1)):(E=new be(E,this.src,ye,!!W,he),E.fa=L,p.push(E)),E};function He(p,E){var L=E.type;if(L in p.g){var W=p.g[L],he=Array.prototype.indexOf.call(W,E,void 0),ye;(ye=0<=he)&&Array.prototype.splice.call(W,he,1),ye&&(Me(E),p.g[L].length==0&&(delete p.g[L],p.h--))}}function $e(p,E,L,W){for(var he=0;he<p.length;++he){var ye=p[he];if(!ye.da&&ye.listener==E&&ye.capture==!!L&&ye.ha==W)return he}return-1}var dt="closure_lm_"+(1e6*Math.random()|0),je={};function re(p,E,L,W,he){if(W&&W.once)return Fe(p,E,L,W,he);if(Array.isArray(E)){for(var ye=0;ye<E.length;ye++)re(p,E[ye],L,W,he);return null}return L=Lt(L),p&&p[ge]?p.K(E,L,u(W)?!!W.capture:!!W,he):kt(p,E,L,!1,W,he)}function kt(p,E,L,W,he,ye){if(!E)throw Error("Invalid event type");var Oe=u(he)?!!he.capture:!!he,Tt=jt(p);if(Tt||(p[dt]=Tt=new De(p)),L=Tt.add(E,L,W,Oe,ye),L.proxy)return L;if(W=it(),L.proxy=W,W.src=p,W.listener=L,p.addEventListener)te||(he=Oe),he===void 0&&(he=!1),p.addEventListener(E.toString(),W,he);else if(p.attachEvent)p.attachEvent(Ke(E.toString()),W);else if(p.addListener&&p.removeListener)p.addListener(W);else throw Error("addEventListener and attachEvent are unavailable.");return L}function it(){function p(L){return E.call(p.src,p.listener,L)}const E=lt;return p}function Fe(p,E,L,W,he){if(Array.isArray(E)){for(var ye=0;ye<E.length;ye++)Fe(p,E[ye],L,W,he);return null}return L=Lt(L),p&&p[ge]?p.L(E,L,u(W)?!!W.capture:!!W,he):kt(p,E,L,!0,W,he)}function ze(p,E,L,W,he){if(Array.isArray(E))for(var ye=0;ye<E.length;ye++)ze(p,E[ye],L,W,he);else W=u(W)?!!W.capture:!!W,L=Lt(L),p&&p[ge]?(p=p.i,E=String(E).toString(),E in p.g&&(ye=p.g[E],L=$e(ye,L,W,he),-1<L&&(Me(ye[L]),Array.prototype.splice.call(ye,L,1),ye.length==0&&(delete p.g[E],p.h--)))):p&&(p=jt(p))&&(E=p.g[E.toString()],p=-1,E&&(p=$e(E,L,W,he)),(L=-1<p?E[p]:null)&&Ye(L))}function Ye(p){if(typeof p!="number"&&p&&!p.da){var E=p.src;if(E&&E[ge])He(E.i,p);else{var L=p.type,W=p.proxy;E.removeEventListener?E.removeEventListener(L,W,p.capture):E.detachEvent?E.detachEvent(Ke(L),W):E.addListener&&E.removeListener&&E.removeListener(W),(L=jt(E))?(He(L,p),L.h==0&&(L.src=null,E[dt]=null)):Me(p)}}}function Ke(p){return p in je?je[p]:je[p]="on"+p}function lt(p,E){if(p.da)p=!0;else{E=new ie(E,this);var L=p.listener,W=p.ha||p.src;p.fa&&Ye(p),p=L.call(W,E)}return p}function jt(p){return p=p[dt],p instanceof De?p:null}var Pt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Lt(p){return typeof p=="function"?p:(p[Pt]||(p[Pt]=function(E){return p.handleEvent(E)}),p[Pt])}function xt(){U.call(this),this.i=new De(this),this.M=this,this.F=null}w(xt,U),xt.prototype[ge]=!0,xt.prototype.removeEventListener=function(p,E,L,W){ze(this,p,E,L,W)};function Rt(p,E){var L,W=p.F;if(W)for(L=[];W;W=W.F)L.push(W);if(p=p.M,W=E.type||E,typeof E=="string")E=new J(E,p);else if(E instanceof J)E.target=E.target||p;else{var he=E;E=new J(W,p),O(E,he)}if(he=!0,L)for(var ye=L.length-1;0<=ye;ye--){var Oe=E.g=L[ye];he=pt(Oe,W,!0,E)&&he}if(Oe=E.g=p,he=pt(Oe,W,!0,E)&&he,he=pt(Oe,W,!1,E)&&he,L)for(ye=0;ye<L.length;ye++)Oe=E.g=L[ye],he=pt(Oe,W,!1,E)&&he}xt.prototype.N=function(){if(xt.aa.N.call(this),this.i){var p=this.i,E;for(E in p.g){for(var L=p.g[E],W=0;W<L.length;W++)Me(L[W]);delete p.g[E],p.h--}}this.F=null},xt.prototype.K=function(p,E,L,W){return this.i.add(String(p),E,!1,L,W)},xt.prototype.L=function(p,E,L,W){return this.i.add(String(p),E,!0,L,W)};function pt(p,E,L,W){if(E=p.i.g[String(E)],!E)return!0;E=E.concat();for(var he=!0,ye=0;ye<E.length;++ye){var Oe=E[ye];if(Oe&&!Oe.da&&Oe.capture==L){var Tt=Oe.listener,rr=Oe.ha||Oe.src;Oe.fa&&He(p.i,Oe),he=Tt.call(rr,W)!==!1&&he}}return he&&!W.defaultPrevented}function Ft(p,E,L){if(typeof p=="function")L&&(p=g(p,L));else if(p&&typeof p.handleEvent=="function")p=g(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(E)?-1:l.setTimeout(p,E||0)}function Xe(p){p.g=Ft(()=>{p.g=null,p.i&&(p.i=!1,Xe(p))},p.l);const E=p.h;p.h=null,p.m.apply(null,E)}class Sn extends U{constructor(E,L){super(),this.m=E,this.l=L,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:Xe(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ut(p){U.call(this),this.h=p,this.g={}}w(Ut,U);var Cs=[];function er(p){$(p.g,function(E,L){this.g.hasOwnProperty(L)&&Ye(E)},p),p.g={}}Ut.prototype.N=function(){Ut.aa.N.call(this),er(this)},Ut.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var cr=l.JSON.stringify,Ti=l.JSON.parse,Xt=class{stringify(p){return l.JSON.stringify(p,void 0)}parse(p){return l.JSON.parse(p,void 0)}};function ea(){}ea.prototype.h=null;function Sr(p){return p.h||(p.h=p.i())}function Ps(){}var ms={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function vr(){J.call(this,"d")}w(vr,J);function St(){J.call(this,"c")}w(St,J);var zt={},Da=null;function $r(){return Da=Da||new xt}zt.La="serverreachability";function Zs(p){J.call(this,zt.La,p)}w(Zs,J);function Kn(p){const E=$r();Rt(E,new Zs(E))}zt.STAT_EVENT="statevent";function ht(p,E){J.call(this,zt.STAT_EVENT,p),this.stat=E}w(ht,J);function mr(p){const E=$r();Rt(E,new ht(E,p))}zt.Ma="timingevent";function ei(p,E){J.call(this,zt.Ma,p),this.size=E}w(ei,J);function ln(p,E){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){p()},E)}function Ar(){this.g=!0}Ar.prototype.xa=function(){this.g=!1};function Wr(p,E,L,W,he,ye){p.info(function(){if(p.g)if(ye)for(var Oe="",Tt=ye.split("&"),rr=0;rr<Tt.length;rr++){var It=Tt[rr].split("=");if(1<It.length){var pr=It[0];It=It[1];var Zr=pr.split("_");Oe=2<=Zr.length&&Zr[1]=="type"?Oe+(pr+"="+It+"&"):Oe+(pr+"=redacted&")}}else Oe=null;else Oe=ye;return"XMLHTTP REQ ("+W+") [attempt "+he+"]: "+E+`
`+L+`
`+Oe})}function ps(p,E,L,W,he,ye,Oe){p.info(function(){return"XMLHTTP RESP ("+W+") [ attempt "+he+"]: "+E+`
`+L+`
`+ye+" "+Oe})}function ti(p,E,L,W){p.info(function(){return"XMLHTTP TEXT ("+E+"): "+ri(p,L)+(W?" "+W:"")})}function ta(p,E){p.info(function(){return"TIMEOUT: "+E})}Ar.prototype.info=function(){};function ri(p,E){if(!p.g)return E;if(!E)return null;try{var L=JSON.parse(E);if(L){for(p=0;p<L.length;p++)if(Array.isArray(L[p])){var W=L[p];if(!(2>W.length)){var he=W[1];if(Array.isArray(he)&&!(1>he.length)){var ye=he[0];if(ye!="noop"&&ye!="stop"&&ye!="close")for(var Oe=1;Oe<he.length;Oe++)he[Oe]=""}}}}return cr(L)}catch{return E}}var Yn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Rs={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ds;function Rn(){}w(Rn,ea),Rn.prototype.g=function(){return new XMLHttpRequest},Rn.prototype.i=function(){return{}},Ds=new Rn;function xn(p,E,L,W){this.j=p,this.i=E,this.l=L,this.R=W||1,this.U=new Ut(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new La}function La(){this.i=null,this.g="",this.h=!1}var bo={},Oa={};function Ma(p,E,L){p.L=1,p.v=El(Os(E)),p.m=L,p.P=!0,wo(p,null)}function wo(p,E){p.F=Date.now(),_l(p),p.A=Os(p.v);var L=p.A,W=p.R;Array.isArray(W)||(W=[String(W)]),kd(L.i,"t",W),p.C=0,L=p.j.J,p.h=new La,p.g=ee(p.j,L?E:null,!p.m),0<p.O&&(p.M=new Sn(g(p.Y,p,p.g),p.O)),E=p.U,L=p.g,W=p.ca;var he="readystatechange";Array.isArray(he)||(he&&(Cs[0]=he.toString()),he=Cs);for(var ye=0;ye<he.length;ye++){var Oe=re(L,he[ye],W||E.handleEvent,!1,E.h||E);if(!Oe)break;E.g[Oe.key]=Oe}E=p.H?A(p.H):{},p.m?(p.u||(p.u="POST"),E["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,E)):(p.u="GET",p.g.ea(p.A,p.u,null,E)),Kn(),Wr(p.i,p.u,p.A,p.l,p.R,p.m)}xn.prototype.ca=function(p){p=p.target;const E=this.M;E&&ai(p)==3?E.j():this.Y(p)},xn.prototype.Y=function(p){try{if(p==this.g)e:{const Zr=ai(this.g);var E=this.g.Ba();const Li=this.g.Z();if(!(3>Zr)&&(Zr!=3||this.g&&(this.h.h||this.g.oa()||ia(this.g)))){this.J||Zr!=4||E==7||(E==8||0>=Li?Kn(3):Kn(2)),jl(this);var L=this.g.Z();this.X=L;t:if(ou(this)){var W=ia(this.g);p="";var he=W.length,ye=ai(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ni(this),_o(this);var Oe="";break t}this.h.i=new l.TextDecoder}for(E=0;E<he;E++)this.h.h=!0,p+=this.h.i.decode(W[E],{stream:!(ye&&E==he-1)});W.length=0,this.h.g+=p,this.C=0,Oe=this.h.g}else Oe=this.g.oa();if(this.o=L==200,ps(this.i,this.u,this.A,this.l,this.R,Zr,L),this.o){if(this.T&&!this.K){t:{if(this.g){var Tt,rr=this.g;if((Tt=rr.g?rr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(Tt)){var It=Tt;break t}}It=null}if(L=It)ti(this.i,this.l,L,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,lu(this,L);else{this.o=!1,this.s=3,mr(12),ni(this),_o(this);break e}}if(this.P){L=!0;let Dn;for(;!this.J&&this.C<Oe.length;)if(Dn=Af(this,Oe),Dn==Oa){Zr==4&&(this.s=4,mr(14),L=!1),ti(this.i,this.l,null,"[Incomplete Response]");break}else if(Dn==bo){this.s=4,mr(15),ti(this.i,this.l,Oe,"[Invalid Chunk]"),L=!1;break}else ti(this.i,this.l,Dn,null),lu(this,Dn);if(ou(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Zr!=4||Oe.length!=0||this.h.h||(this.s=1,mr(16),L=!1),this.o=this.o&&L,!L)ti(this.i,this.l,Oe,"[Invalid Chunked Response]"),ni(this),_o(this);else if(0<Oe.length&&!this.W){this.W=!0;var pr=this.j;pr.g==this&&pr.ba&&!pr.M&&(pr.j.info("Great, no buffering proxy detected. Bytes received: "+Oe.length),bu(pr),pr.M=!0,mr(11))}}else ti(this.i,this.l,Oe,null),lu(this,Oe);Zr==4&&ni(this),this.o&&!this.J&&(Zr==4?Ml(this.j,this):(this.o=!1,_l(this)))}else oi(this.g),L==400&&0<Oe.indexOf("Unknown SID")?(this.s=3,mr(12)):(this.s=0,mr(13)),ni(this),_o(this)}}}catch{}finally{}};function ou(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function Af(p,E){var L=p.C,W=E.indexOf(`
`,L);return W==-1?Oa:(L=Number(E.substring(L,W)),isNaN(L)?bo:(W+=1,W+L>E.length?Oa:(E=E.slice(W,W+L),p.C=W+L,E)))}xn.prototype.cancel=function(){this.J=!0,ni(this)};function _l(p){p.S=Date.now()+p.I,No(p,p.I)}function No(p,E){if(p.B!=null)throw Error("WatchDog timer not null");p.B=ln(g(p.ba,p),E)}function jl(p){p.B&&(l.clearTimeout(p.B),p.B=null)}xn.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(ta(this.i,this.A),this.L!=2&&(Kn(),mr(17)),ni(this),this.s=2,_o(this)):No(this,this.S-p)};function _o(p){p.j.G==0||p.J||Ml(p.j,p)}function ni(p){jl(p);var E=p.M;E&&typeof E.ma=="function"&&E.ma(),p.M=null,er(p.U),p.g&&(E=p.g,p.g=null,E.abort(),E.ma())}function lu(p,E){try{var L=p.j;if(L.G!=0&&(L.g==p||Er(L.h,p))){if(!p.K&&Er(L.h,p)&&L.G==3){try{var W=L.Da.g.parse(E)}catch{W=null}if(Array.isArray(W)&&W.length==3){var he=W;if(he[0]==0){e:if(!L.u){if(L.g)if(L.g.F+3e3<p.F)Di(L),oa(L);else break e;Ol(L),mr(18)}}else L.za=he[1],0<L.za-L.T&&37500>he[2]&&L.F&&L.v==0&&!L.C&&(L.C=ln(g(L.Za,L),6e3));if(1>=jd(L.h)&&L.ca){try{L.ca()}catch{}L.ca=void 0}}else li(L,11)}else if((p.K||L.g==p)&&Di(L),!b(E))for(he=L.Da.g.parse(E),E=0;E<he.length;E++){let It=he[E];if(L.T=It[0],It=It[1],L.G==2)if(It[0]=="c"){L.K=It[1],L.ia=It[2];const pr=It[3];pr!=null&&(L.la=pr,L.j.info("VER="+L.la));const Zr=It[4];Zr!=null&&(L.Aa=Zr,L.j.info("SVER="+L.Aa));const Li=It[5];Li!=null&&typeof Li=="number"&&0<Li&&(W=1.5*Li,L.L=W,L.j.info("backChannelRequestTimeoutMs_="+W)),W=L;const Dn=p.g;if(Dn){const ca=Dn.g?Dn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ca){var ye=W.h;ye.g||ca.indexOf("spdy")==-1&&ca.indexOf("quic")==-1&&ca.indexOf("h2")==-1||(ye.j=ye.l,ye.g=new Set,ye.h&&(Sl(ye,ye.h),ye.h=null))}if(W.D){const To=Dn.g?Dn.g.getResponseHeader("X-HTTP-Session-Id"):null;To&&(W.ya=To,tr(W.I,W.D,To))}}L.G=3,L.l&&L.l.ua(),L.ba&&(L.R=Date.now()-p.F,L.j.info("Handshake RTT: "+L.R+"ms")),W=L;var Oe=p;if(W.qa=V(W,W.J?W.ia:null,W.W),Oe.K){cu(W.h,Oe);var Tt=Oe,rr=W.L;rr&&(Tt.I=rr),Tt.B&&(jl(Tt),_l(Tt)),W.g=Oe}else Ll(W);0<L.i.length&&Ba(L)}else It[0]!="stop"&&It[0]!="close"||li(L,7);else L.G==3&&(It[0]=="stop"||It[0]=="close"?It[0]=="stop"?li(L,7):yu(L):It[0]!="noop"&&L.l&&L.l.ta(It),L.v=0)}}Kn(4)}catch{}}var Nd=class{constructor(p,E){this.g=p,this.map=E}};function _d(p){this.l=p||10,l.PerformanceNavigationTiming?(p=l.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function jo(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function jd(p){return p.h?1:p.g?p.g.size:0}function Er(p,E){return p.h?p.h==E:p.g?p.g.has(E):!1}function Sl(p,E){p.g?p.g.add(E):p.h=E}function cu(p,E){p.h&&p.h==E?p.h=null:p.g&&p.g.has(E)&&p.g.delete(E)}_d.prototype.cancel=function(){if(this.i=uu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function uu(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let E=p.i;for(const L of p.g.values())E=E.concat(L.D);return E}return _(p.i)}function du(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(c(p)){for(var E=[],L=p.length,W=0;W<L;W++)E.push(p[W]);return E}E=[],L=0;for(W in p)E[L++]=p[W];return E}function Ef(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(c(p)||typeof p=="string"){var E=[];p=p.length;for(var L=0;L<p;L++)E.push(L);return E}E=[],L=0;for(const W in p)E[L++]=W;return E}}}function Ls(p,E){if(p.forEach&&typeof p.forEach=="function")p.forEach(E,void 0);else if(c(p)||typeof p=="string")Array.prototype.forEach.call(p,E,void 0);else for(var L=Ef(p),W=du(p),he=W.length,ye=0;ye<he;ye++)E.call(void 0,W[ye],L&&L[ye],p)}var So=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Qn(p,E){if(p){p=p.split("&");for(var L=0;L<p.length;L++){var W=p[L].indexOf("="),he=null;if(0<=W){var ye=p[L].substring(0,W);he=p[L].substring(W+1)}else ye=p[L];E(ye,he?decodeURIComponent(he.replace(/\+/g," ")):"")}}}function si(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof si){this.h=p.h,Al(this,p.j),this.o=p.o,this.g=p.g,Ao(this,p.s),this.l=p.l;var E=p.i,L=new Hr;L.i=E.i,E.g&&(L.g=new Map(E.g),L.h=E.h),Sd(this,L),this.m=p.m}else p&&(E=String(p).match(So))?(this.h=!1,Al(this,E[1]||"",!0),this.o=ra(E[2]||""),this.g=ra(E[3]||"",!0),Ao(this,E[4]),this.l=ra(E[5]||"",!0),Sd(this,E[6]||"",!0),this.m=ra(E[7]||"")):(this.h=!1,this.i=new Hr(null,this.h))}si.prototype.toString=function(){var p=[],E=this.j;E&&p.push(Eo(E,Ad,!0),":");var L=this.g;return(L||E=="file")&&(p.push("//"),(E=this.o)&&p.push(Eo(E,Ad,!0),"@"),p.push(encodeURIComponent(String(L)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),L=this.s,L!=null&&p.push(":",String(L))),(L=this.l)&&(this.g&&L.charAt(0)!="/"&&p.push("/"),p.push(Eo(L,L.charAt(0)=="/"?kl:na,!0))),(L=this.i.toString())&&p.push("?",L),(L=this.m)&&p.push("#",Eo(L,Ed)),p.join("")};function Os(p){return new si(p)}function Al(p,E,L){p.j=L?ra(E,!0):E,p.j&&(p.j=p.j.replace(/:$/,""))}function Ao(p,E){if(E){if(E=Number(E),isNaN(E)||0>E)throw Error("Bad port number "+E);p.s=E}else p.s=null}function Sd(p,E,L){E instanceof Hr?(p.i=E,Ci(p.i,p.h)):(L||(E=Eo(E,Tl)),p.i=new Hr(E,p.h))}function tr(p,E,L){p.i.set(E,L)}function El(p){return tr(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function ra(p,E){return p?E?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Eo(p,E,L){return typeof p=="string"?(p=encodeURI(p).replace(E,kf),L&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function kf(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Ad=/[#\/\?@]/g,na=/[#\?:]/g,kl=/[#\?]/g,Tl=/[#\?@]/g,Ed=/#/g;function Hr(p,E){this.h=this.g=null,this.i=p||null,this.j=!!E}function Ii(p){p.g||(p.g=new Map,p.h=0,p.i&&Qn(p.i,function(E,L){p.add(decodeURIComponent(E.replace(/\+/g," ")),L)}))}t=Hr.prototype,t.add=function(p,E){Ii(this),this.i=null,p=Fa(this,p);var L=this.g.get(p);return L||this.g.set(p,L=[]),L.push(E),this.h+=1,this};function hu(p,E){Ii(p),E=Fa(p,E),p.g.has(E)&&(p.i=null,p.h-=p.g.get(E).length,p.g.delete(E))}function At(p,E){return Ii(p),E=Fa(p,E),p.g.has(E)}t.forEach=function(p,E){Ii(this),this.g.forEach(function(L,W){L.forEach(function(he){p.call(E,he,W,this)},this)},this)},t.na=function(){Ii(this);const p=Array.from(this.g.values()),E=Array.from(this.g.keys()),L=[];for(let W=0;W<E.length;W++){const he=p[W];for(let ye=0;ye<he.length;ye++)L.push(E[W])}return L},t.V=function(p){Ii(this);let E=[];if(typeof p=="string")At(this,p)&&(E=E.concat(this.g.get(Fa(this,p))));else{p=Array.from(this.g.values());for(let L=0;L<p.length;L++)E=E.concat(p[L])}return E},t.set=function(p,E){return Ii(this),this.i=null,p=Fa(this,p),At(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[E]),this.h+=1,this},t.get=function(p,E){return p?(p=this.V(p),0<p.length?String(p[0]):E):E};function kd(p,E,L){hu(p,E),0<L.length&&(p.i=null,p.g.set(Fa(p,E),_(L)),p.h+=L.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],E=Array.from(this.g.keys());for(var L=0;L<E.length;L++){var W=E[L];const ye=encodeURIComponent(String(W)),Oe=this.V(W);for(W=0;W<Oe.length;W++){var he=ye;Oe[W]!==""&&(he+="="+encodeURIComponent(String(Oe[W]))),p.push(he)}}return this.i=p.join("&")};function Fa(p,E){return E=String(E),p.j&&(E=E.toLowerCase()),E}function Ci(p,E){E&&!p.j&&(Ii(p),p.i=null,p.g.forEach(function(L,W){var he=W.toLowerCase();W!=he&&(hu(this,W),kd(this,he,L))},p)),p.j=E}function Td(p,E){const L=new Ar;if(l.Image){const W=new Image;W.onload=m(gs,L,"TestLoadImage: loaded",!0,E,W),W.onerror=m(gs,L,"TestLoadImage: error",!1,E,W),W.onabort=m(gs,L,"TestLoadImage: abort",!1,E,W),W.ontimeout=m(gs,L,"TestLoadImage: timeout",!1,E,W),l.setTimeout(function(){W.ontimeout&&W.ontimeout()},1e4),W.src=p}else E(!1)}function Id(p,E){const L=new Ar,W=new AbortController,he=setTimeout(()=>{W.abort(),gs(L,"TestPingServer: timeout",!1,E)},1e4);fetch(p,{signal:W.signal}).then(ye=>{clearTimeout(he),ye.ok?gs(L,"TestPingServer: ok",!0,E):gs(L,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(he),gs(L,"TestPingServer: error",!1,E)})}function gs(p,E,L,W,he){try{he&&(he.onload=null,he.onerror=null,he.onabort=null,he.ontimeout=null),W(L)}catch{}}function fu(){this.g=new Xt}function Tf(p,E,L){const W=L||"";try{Ls(p,function(he,ye){let Oe=he;u(he)&&(Oe=cr(he)),E.push(W+ye+"="+encodeURIComponent(Oe))})}catch(he){throw E.push(W+"type="+encodeURIComponent("_badmap")),he}}function Il(p){this.l=p.Ub||null,this.j=p.eb||!1}w(Il,ea),Il.prototype.g=function(){return new Cl(this.l,this.j)},Il.prototype.i=function(p){return function(){return p}}({});function Cl(p,E){xt.call(this),this.D=p,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(Cl,xt),t=Cl.prototype,t.open=function(p,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=E,this.readyState=1,Ms(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const E={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(E.body=p),(this.D||l).fetch(new Request(this.A,E)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ii(this)),this.readyState=0},t.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Ms(this)),this.g&&(this.readyState=3,Ms(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Pl(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function Pl(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}t.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var E=p.value?p.value:new Uint8Array(0);(E=this.v.decode(E,{stream:!p.done}))&&(this.response=this.responseText+=E)}p.done?ii(this):Ms(this),this.readyState==3&&Pl(this)}},t.Ra=function(p){this.g&&(this.response=this.responseText=p,ii(this))},t.Qa=function(p){this.g&&(this.response=p,ii(this))},t.ga=function(){this.g&&ii(this)};function ii(p){p.readyState=4,p.l=null,p.j=null,p.v=null,Ms(p)}t.setRequestHeader=function(p,E){this.u.append(p,E)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],E=this.h.entries();for(var L=E.next();!L.done;)L=L.value,p.push(L[0]+": "+L[1]),L=E.next();return p.join(`\r
`)};function Ms(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Cl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Cd(p){let E="";return $(p,function(L,W){E+=W,E+=":",E+=L,E+=`\r
`}),E}function sa(p,E,L){e:{for(W in L){var W=!1;break e}W=!0}W||(L=Cd(L),typeof p=="string"?L!=null&&encodeURIComponent(String(L)):tr(p,E,L))}function ur(p){xt.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(ur,xt);var Rl=/^https?$/i,Pd=["POST","PUT"];t=ur.prototype,t.Ha=function(p){this.J=p},t.ea=function(p,E,L,W){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);E=E?E.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ds.g(),this.v=this.o?Sr(this.o):Sr(Ds),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(E,String(p),!0),this.B=!1}catch(ye){mu(this,ye);return}if(p=L||"",L=new Map(this.headers),W)if(Object.getPrototypeOf(W)===Object.prototype)for(var he in W)L.set(he,W[he]);else if(typeof W.keys=="function"&&typeof W.get=="function")for(const ye of W.keys())L.set(ye,W.get(ye));else throw Error("Unknown input type for opt_headers: "+String(W));W=Array.from(L.keys()).find(ye=>ye.toLowerCase()=="content-type"),he=l.FormData&&p instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Pd,E,void 0))||W||he||L.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ye,Oe]of L)this.g.setRequestHeader(ye,Oe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Pi(this),this.u=!0,this.g.send(p),this.u=!1}catch(ye){mu(this,ye)}};function mu(p,E){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=E,p.m=5,pu(p),ys(p)}function pu(p){p.A||(p.A=!0,Rt(p,"complete"),Rt(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,Rt(this,"complete"),Rt(this,"abort"),ys(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ys(this,!0)),ur.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?gu(this):this.bb())},t.bb=function(){gu(this)};function gu(p){if(p.h&&typeof o<"u"&&(!p.v[1]||ai(p)!=4||p.Z()!=2)){if(p.u&&ai(p)==4)Ft(p.Ea,0,p);else if(Rt(p,"readystatechange"),ai(p)==4){p.h=!1;try{const Oe=p.Z();e:switch(Oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var L;if(!(L=E)){var W;if(W=Oe===0){var he=String(p.D).match(So)[1]||null;!he&&l.self&&l.self.location&&(he=l.self.location.protocol.slice(0,-1)),W=!Rl.test(he?he.toLowerCase():"")}L=W}if(L)Rt(p,"complete"),Rt(p,"success");else{p.m=6;try{var ye=2<ai(p)?p.g.statusText:""}catch{ye=""}p.l=ye+" ["+p.Z()+"]",pu(p)}}finally{ys(p)}}}}function ys(p,E){if(p.g){Pi(p);const L=p.g,W=p.v[0]?()=>{}:null;p.g=null,p.v=null,E||Rt(p,"ready");try{L.onreadystatechange=W}catch{}}}function Pi(p){p.I&&(l.clearTimeout(p.I),p.I=null)}t.isActive=function(){return!!this.g};function ai(p){return p.g?p.g.readyState:0}t.Z=function(){try{return 2<ai(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(p){if(this.g){var E=this.g.responseText;return p&&E.indexOf(p)==0&&(E=E.substring(p.length)),Ti(E)}};function ia(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function oi(p){const E={};p=(p.g&&2<=ai(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let W=0;W<p.length;W++){if(b(p[W]))continue;var L=S(p[W]);const he=L[0];if(L=L[1],typeof L!="string")continue;L=L.trim();const ye=E[he]||[];E[he]=ye,ye.push(L)}k(E,function(W){return W.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function aa(p,E,L){return L&&L.internalChannelParams&&L.internalChannelParams[p]||E}function Va(p){this.Aa=0,this.i=[],this.j=new Ar,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=aa("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=aa("baseRetryDelayMs",5e3,p),this.cb=aa("retryDelaySeedMs",1e4,p),this.Wa=aa("forwardChannelMaxRetries",2,p),this.wa=aa("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new _d(p&&p.concurrentRequestLimit),this.Da=new fu,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Va.prototype,t.la=8,t.G=1,t.connect=function(p,E,L,W){mr(0),this.W=p,this.H=E||{},L&&W!==void 0&&(this.H.OSID=L,this.H.OAID=W),this.F=this.X,this.I=V(this,null,this.W),Ba(this)};function yu(p){if(Rd(p),p.G==3){var E=p.U++,L=Os(p.I);if(tr(L,"SID",p.K),tr(L,"RID",E),tr(L,"TYPE","terminate"),Ri(p,L),E=new xn(p,p.j,E),E.L=2,E.v=El(Os(L)),L=!1,l.navigator&&l.navigator.sendBeacon)try{L=l.navigator.sendBeacon(E.v.toString(),"")}catch{}!L&&l.Image&&(new Image().src=E.v,L=!0),L||(E.g=ee(E.j,null),E.g.ea(E.v)),E.F=Date.now(),_l(E)}N(p)}function oa(p){p.g&&(bu(p),p.g.cancel(),p.g=null)}function Rd(p){oa(p),p.u&&(l.clearTimeout(p.u),p.u=null),Di(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&l.clearTimeout(p.s),p.s=null)}function Ba(p){if(!jo(p.h)&&!p.s){p.s=!0;var E=p.Ga;X||se(),Y||(X(),Y=!0),Q.add(E,p),p.B=0}}function xu(p,E){return jd(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=E.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=ln(g(p.Ga,p,E),la(p,p.B)),p.B++,!0)}t.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const he=new xn(this,this.j,p);let ye=this.o;if(this.S&&(ye?(ye=A(ye),O(ye,this.S)):ye=this.S),this.m!==null||this.O||(he.H=ye,ye=null),this.P)e:{for(var E=0,L=0;L<this.i.length;L++){t:{var W=this.i[L];if("__data__"in W.map&&(W=W.map.__data__,typeof W=="string")){W=W.length;break t}W=void 0}if(W===void 0)break;if(E+=W,4096<E){E=L;break e}if(E===4096||L===this.i.length-1){E=L+1;break e}}E=1e3}else E=1e3;E=Dl(this,he,E),L=Os(this.I),tr(L,"RID",p),tr(L,"CVER",22),this.D&&tr(L,"X-HTTP-Session-Id",this.D),Ri(this,L),ye&&(this.O?E="headers="+encodeURIComponent(String(Cd(ye)))+"&"+E:this.m&&sa(L,this.m,ye)),Sl(this.h,he),this.Ua&&tr(L,"TYPE","init"),this.P?(tr(L,"$req",E),tr(L,"SID","null"),he.T=!0,Ma(he,L,null)):Ma(he,L,E),this.G=2}}else this.G==3&&(p?vu(this,p):this.i.length==0||jo(this.h)||vu(this))};function vu(p,E){var L;E?L=E.l:L=p.U++;const W=Os(p.I);tr(W,"SID",p.K),tr(W,"RID",L),tr(W,"AID",p.T),Ri(p,W),p.m&&p.o&&sa(W,p.m,p.o),L=new xn(p,p.j,L,p.B+1),p.m===null&&(L.H=p.o),E&&(p.i=E.D.concat(p.i)),E=Dl(p,L,1e3),L.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),Sl(p.h,L),Ma(L,W,E)}function Ri(p,E){p.H&&$(p.H,function(L,W){tr(E,W,L)}),p.l&&Ls({},function(L,W){tr(E,W,L)})}function Dl(p,E,L){L=Math.min(p.i.length,L);var W=p.l?g(p.l.Na,p.l,p):null;e:{var he=p.i;let ye=-1;for(;;){const Oe=["count="+L];ye==-1?0<L?(ye=he[0].g,Oe.push("ofs="+ye)):ye=0:Oe.push("ofs="+ye);let Tt=!0;for(let rr=0;rr<L;rr++){let It=he[rr].g;const pr=he[rr].map;if(It-=ye,0>It)ye=Math.max(0,he[rr].g-100),Tt=!1;else try{Tf(pr,Oe,"req"+It+"_")}catch{W&&W(pr)}}if(Tt){W=Oe.join("&");break e}}}return p=p.i.splice(0,L),E.D=p,W}function Ll(p){if(!p.g&&!p.u){p.Y=1;var E=p.Fa;X||se(),Y||(X(),Y=!0),Q.add(E,p),p.v=0}}function Ol(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=ln(g(p.Fa,p),la(p,p.v)),p.v++,!0)}t.Fa=function(){if(this.u=null,ko(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=ln(g(this.ab,this),p)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,mr(10),oa(this),ko(this))};function bu(p){p.A!=null&&(l.clearTimeout(p.A),p.A=null)}function ko(p){p.g=new xn(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var E=Os(p.qa);tr(E,"RID","rpc"),tr(E,"SID",p.K),tr(E,"AID",p.T),tr(E,"CI",p.F?"0":"1"),!p.F&&p.ja&&tr(E,"TO",p.ja),tr(E,"TYPE","xmlhttp"),Ri(p,E),p.m&&p.o&&sa(E,p.m,p.o),p.L&&(p.g.I=p.L);var L=p.g;p=p.ia,L.L=1,L.v=El(Os(E)),L.m=null,L.P=!0,wo(L,p)}t.Za=function(){this.C!=null&&(this.C=null,oa(this),Ol(this),mr(19))};function Di(p){p.C!=null&&(l.clearTimeout(p.C),p.C=null)}function Ml(p,E){var L=null;if(p.g==E){Di(p),bu(p),p.g=null;var W=2}else if(Er(p.h,E))L=E.D,cu(p.h,E),W=1;else return;if(p.G!=0){if(E.o)if(W==1){L=E.m?E.m.length:0,E=Date.now()-E.F;var he=p.B;W=$r(),Rt(W,new ei(W,L)),Ba(p)}else Ll(p);else if(he=E.s,he==3||he==0&&0<E.X||!(W==1&&xu(p,E)||W==2&&Ol(p)))switch(L&&0<L.length&&(E=p.h,E.i=E.i.concat(L)),he){case 1:li(p,5);break;case 4:li(p,10);break;case 3:li(p,6);break;default:li(p,2)}}}function la(p,E){let L=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(L*=2),L*E}function li(p,E){if(p.j.info("Error code "+E),E==2){var L=g(p.fb,p),W=p.Xa;const he=!W;W=new si(W||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Al(W,"https"),El(W),he?Td(W.toString(),L):Id(W.toString(),L)}else mr(2);p.G=0,p.l&&p.l.sa(E),N(p),Rd(p)}t.fb=function(p){p?(this.j.info("Successfully pinged google.com"),mr(2)):(this.j.info("Failed to ping google.com"),mr(1))};function N(p){if(p.G=0,p.ka=[],p.l){const E=uu(p.h);(E.length!=0||p.i.length!=0)&&(T(p.ka,E),T(p.ka,p.i),p.h.i.length=0,_(p.i),p.i.length=0),p.l.ra()}}function V(p,E,L){var W=L instanceof si?Os(L):new si(L);if(W.g!="")E&&(W.g=E+"."+W.g),Ao(W,W.s);else{var he=l.location;W=he.protocol,E=E?E+"."+he.hostname:he.hostname,he=+he.port;var ye=new si(null);W&&Al(ye,W),E&&(ye.g=E),he&&Ao(ye,he),L&&(ye.l=L),W=ye}return L=p.D,E=p.ya,L&&E&&tr(W,L,E),tr(W,"VER",p.la),Ri(p,W),W}function ee(p,E,L){if(E&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return E=p.Ca&&!p.pa?new ur(new Il({eb:L})):new ur(p.pa),E.Ha(p.J),E}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ae(){}t=ae.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function pe(){}pe.prototype.g=function(p,E){return new Ne(p,E)};function Ne(p,E){xt.call(this),this.g=new Va(E),this.l=p,this.h=E&&E.messageUrlParams||null,p=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(p?p["X-WebChannel-Content-Type"]=E.messageContentType:p={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.va&&(p?p["X-WebChannel-Client-Profile"]=E.va:p={"X-WebChannel-Client-Profile":E.va}),this.g.S=p,(p=E&&E.Sb)&&!b(p)&&(this.g.m=p),this.v=E&&E.supportsCrossDomainXhr||!1,this.u=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!b(E)&&(this.g.D=E,p=this.h,p!==null&&E in p&&(p=this.h,E in p&&delete p[E])),this.j=new at(this)}w(Ne,xt),Ne.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ne.prototype.close=function(){yu(this.g)},Ne.prototype.o=function(p){var E=this.g;if(typeof p=="string"){var L={};L.__data__=p,p=L}else this.u&&(L={},L.__data__=cr(p),p=L);E.i.push(new Nd(E.Ya++,p)),E.G==3&&Ba(E)},Ne.prototype.N=function(){this.g.l=null,delete this.j,yu(this.g),delete this.g,Ne.aa.N.call(this)};function Le(p){vr.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var E=p.__sm__;if(E){e:{for(const L in E){p=L;break e}p=void 0}(this.i=p)&&(p=this.i,E=E!==null&&p in E?E[p]:void 0),this.data=E}else this.data=p}w(Le,vr);function Ze(){St.call(this),this.status=1}w(Ze,St);function at(p){this.g=p}w(at,ae),at.prototype.ua=function(){Rt(this.g,"a")},at.prototype.ta=function(p){Rt(this.g,new Le(p))},at.prototype.sa=function(p){Rt(this.g,new Ze)},at.prototype.ra=function(){Rt(this.g,"b")},pe.prototype.createWebChannel=pe.prototype.g,Ne.prototype.send=Ne.prototype.o,Ne.prototype.open=Ne.prototype.m,Ne.prototype.close=Ne.prototype.close,PT=function(){return new pe},CT=function(){return $r()},IT=zt,H2={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Yn.NO_ERROR=0,Yn.TIMEOUT=8,Yn.HTTP_ERROR=6,b0=Yn,Rs.COMPLETE="complete",TT=Rs,Ps.EventType=ms,ms.OPEN="a",ms.CLOSE="b",ms.ERROR="c",ms.MESSAGE="d",xt.prototype.listen=xt.prototype.K,cm=Ps,ur.prototype.listenOnce=ur.prototype.L,ur.prototype.getLastError=ur.prototype.Ka,ur.prototype.getLastErrorCode=ur.prototype.Ba,ur.prototype.getStatus=ur.prototype.Z,ur.prototype.getResponseJson=ur.prototype.Oa,ur.prototype.getResponseText=ur.prototype.oa,ur.prototype.send=ur.prototype.ea,ur.prototype.setWithCredentials=ur.prototype.Ha,kT=ur}).apply(typeof Fg<"u"?Fg:typeof self<"u"?self:typeof window<"u"?window:{});const Xj="@firebase/firestore",Zj="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let is=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};is.UNAUTHENTICATED=new is(null),is.GOOGLE_CREDENTIALS=new is("google-credentials-uid"),is.FIRST_PARTY=new is("first-party-uid"),is.MOCK_USER=new is("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mf="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const od=new qw("@firebase/firestore");function Xd(){return od.logLevel}function tt(t,...e){if(od.logLevel<=Wt.DEBUG){const r=e.map(s5);od.debug(`Firestore (${mf}): ${t}`,...r)}}function ul(t,...e){if(od.logLevel<=Wt.ERROR){const r=e.map(s5);od.error(`Firestore (${mf}): ${t}`,...r)}}function Bc(t,...e){if(od.logLevel<=Wt.WARN){const r=e.map(s5);od.warn(`Firestore (${mf}): ${t}`,...r)}}function s5(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,RT(t,n,r)}function RT(t,e,r){let n=`FIRESTORE (${mf}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw ul(n),new Error(n)}function Kt(t,e,r,n){let s="Unexpected state";typeof r=="string"?s=r:n=r,t||RT(e,s,n)}function Ct(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class We extends go{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DT{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class C9{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(is.UNAUTHENTICATED))}shutdown(){}}class P9{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class R9{constructor(e){this.t=e,this.currentUser=is.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Kt(this.o===void 0,42304);let n=this.i;const s=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let i=new oo;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new oo,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{tt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(tt("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new oo)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(tt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Kt(typeof n.accessToken=="string",31837,{l:n}),new DT(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Kt(e===null||typeof e=="string",2055,{h:e}),new is(e)}}class D9{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=is.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class L9{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new D9(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(is.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class e4{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class O9{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ws(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Kt(this.o===void 0,3512);const n=i=>{i.error!=null&&tt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,tt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{tt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):tt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new e4(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Kt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new e4(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M9(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LT(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i5{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=M9(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%62))}return n}}function Bt(t,e){return t<e?-1:t>e?1:0}function G2(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=t.codePointAt(r),s=e.codePointAt(r);if(n!==s){if(n<128&&s<128)return Bt(n,s);{const i=LT(),o=F9(i.encode(t4(t,r)),i.encode(t4(e,r)));return o!==0?o:Bt(n,s)}}r+=n>65535?2:1}return Bt(t.length,e.length)}function t4(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function F9(t,e){for(let r=0;r<t.length&&r<e.length;++r)if(t[r]!==e[r])return Bt(t[r],e[r]);return Bt(t.length,e.length)}function Jh(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r4="__name__";class Wa{constructor(e,r,n){r===void 0?r=0:r>e.length&&mt(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&mt(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Wa.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Wa?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=Wa.compareSegments(e.get(s),r.get(s));if(i!==0)return i}return Bt(e.length,r.length)}static compareSegments(e,r){const n=Wa.isNumericId(e),s=Wa.isNumericId(r);return n&&!s?-1:!n&&s?1:n&&s?Wa.extractNumericId(e).compare(Wa.extractNumericId(r)):G2(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ic.fromString(e.substring(4,e.length-2))}}class hr extends Wa{construct(e,r,n){return new hr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new We(Ae.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new hr(r)}static emptyPath(){return new hr([])}}const V9=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Vn extends Wa{construct(e,r,n){return new Vn(e,r,n)}static isValidIdentifier(e){return V9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Vn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===r4}static keyField(){return new Vn([r4])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new We(Ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new We(Ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new We(Ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(n+=l,s++):(i(),s++)}if(i(),o)throw new We(Ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Vn(r)}static emptyPath(){return new Vn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e){this.path=e}static fromPath(e){return new ct(hr.fromString(e))}static fromName(e){return new ct(hr.fromString(e).popFirst(5))}static empty(){return new ct(hr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&hr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return hr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ct(new hr(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OT(t,e,r){if(!r)throw new We(Ae.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function B9(t,e,r,n){if(e===!0&&n===!0)throw new We(Ae.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function n4(t){if(!ct.isDocumentKey(t))throw new We(Ae.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function s4(t){if(ct.isDocumentKey(t))throw new We(Ae.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function MT(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function vx(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":mt(12329,{type:typeof t})}function us(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new We(Ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=vx(t);throw new We(Ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function U9(t,e){if(e<=0)throw new We(Ae.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(t,e){const r={typeString:t};return e&&(r.value=e),r}function Rp(t,e){if(!MT(t))throw new We(Ae.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const s=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const o=t[n];if(s&&typeof o!==s){r=`JSON field '${n}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new We(Ae.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i4=-62135596800,a4=1e6;class yt{static now(){return yt.fromMillis(Date.now())}static fromDate(e){return yt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*a4);return new yt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new We(Ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new We(Ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<i4)throw new We(Ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new We(Ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/a4}_compareTo(e){return this.seconds===e.seconds?Bt(this.nanoseconds,e.nanoseconds):Bt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:yt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Rp(e,yt._jsonSchema))return new yt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-i4;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}yt._jsonSchemaVersion="firestore/timestamp/1.0",yt._jsonSchema={type:gn("string",yt._jsonSchemaVersion),seconds:gn("number"),nanoseconds:gn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{static fromTimestamp(e){return new Nt(e)}static min(){return new Nt(new yt(0,0))}static max(){return new Nt(new yt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const op=-1;function z9(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Nt.fromTimestamp(n===1e9?new yt(r+1,0):new yt(r,n));return new Uc(s,ct.empty(),e)}function q9(t){return new Uc(t.readTime,t.key,op)}class Uc{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Uc(Nt.min(),ct.empty(),op)}static max(){return new Uc(Nt.max(),ct.empty(),op)}}function $9(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=ct.comparator(t.documentKey,e.documentKey),r!==0?r:Bt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W9="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class H9{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pf(t){if(t.code!==Ae.FAILED_PRECONDITION||t.message!==W9)throw t;tt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&mt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Pe((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Pe?r:Pe.resolve(r)}catch(r){return Pe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Pe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Pe.reject(r)}static resolve(e){return new Pe((r,n)=>{r(e)})}static reject(e){return new Pe((r,n)=>{n(e)})}static waitFor(e){return new Pe((r,n)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&r()},c=>n(c))}),o=!0,i===s&&r()})}static or(e){let r=Pe.resolve(!1);for(const n of e)r=r.next(s=>s?Pe.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new Pe((n,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;r(e[u]).next(d=>{o[u]=d,++l,l===i&&n(o)},d=>s(d))}})}static doWhile(e,r){return new Pe((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function G9(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function gf(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this._e(n),this.ae=n=>r.writeSequenceNumber(n))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}bx.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a5=-1;function Dp(t){return t==null}function xy(t){return t===0&&1/t==-1/0}function K9(t){return typeof t=="number"&&Number.isInteger(t)&&!xy(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FT="";function Y9(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=o4(e)),e=Q9(t.get(r),e);return o4(e)}function Q9(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const i=t.charAt(s);switch(i){case"\0":r+="";break;case FT:r+="";break;default:r+=i}}return r}function o4(t){return t+FT+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l4(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function nu(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function VT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(e,r){this.comparator=e,this.root=r||Fn.EMPTY}insert(e,r){return new zr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Fn.BLACK,null,null))}remove(e){return new zr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vg(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vg(this.root,e,this.comparator,!0)}}class Vg{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Fn{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??Fn.RED,this.left=s??Fn.EMPTY,this.right=i??Fn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new Fn(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Fn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return Fn.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Fn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Fn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw mt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw mt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw mt(27949);return e+(this.isRed()?0:1)}}Fn.EMPTY=null,Fn.RED=!0,Fn.BLACK=!1;Fn.EMPTY=new class{constructor(){this.size=0}get key(){throw mt(57766)}get value(){throw mt(16141)}get color(){throw mt(16727)}get left(){throw mt(29726)}get right(){throw mt(36894)}copy(e,r,n,s,i){return this}insert(e,r,n){return new Fn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e){this.comparator=e,this.data=new zr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new c4(this.data.getIterator())}getIteratorFrom(e){return new c4(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Nn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Nn(this.comparator);return r.data=e,r}}class c4{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e){this.fields=e,e.sort(Vn.comparator)}static empty(){return new gi([])}unionWith(e){let r=new Nn(Vn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new gi(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Jh(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new BT("Invalid base64 string: "+i):i}}(e);return new Wn(r)}static fromUint8Array(e){const r=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Wn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Bt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Wn.EMPTY_BYTE_STRING=new Wn("");const J9=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zc(t){if(Kt(!!t,39018),typeof t=="string"){let e=0;const r=J9.exec(t);if(Kt(!!r,46558,{timestamp:t}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:rn(t.seconds),nanos:rn(t.nanos)}}function rn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function qc(t){return typeof t=="string"?Wn.fromBase64String(t):Wn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UT="server_timestamp",zT="__type__",qT="__previous_value__",$T="__local_write_time__";function o5(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[zT])===null||r===void 0?void 0:r.stringValue)===UT}function wx(t){const e=t.mapValue.fields[qT];return o5(e)?wx(e):e}function lp(t){const e=zc(t.mapValue.fields[$T].timestampValue);return new yt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X9{constructor(e,r,n,s,i,o,l,c,u,d){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=d}}const vy="(default)";class cp{constructor(e,r){this.projectId=e,this.database=r||vy}static empty(){return new cp("","")}get isDefaultDatabase(){return this.database===vy}isEqual(e){return e instanceof cp&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT="__type__",HT="__max__",Bg={mapValue:{fields:{__type__:{stringValue:HT}}}},GT="__vector__",by="value";function $c(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?o5(t)?4:eV(t)?9007199254740991:Z9(t)?10:11:mt(28295,{value:t})}function mo(t,e){if(t===e)return!0;const r=$c(t);if(r!==$c(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return lp(t).isEqual(lp(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=zc(s.timestampValue),l=zc(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return qc(s.bytesValue).isEqual(qc(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return rn(s.geoPointValue.latitude)===rn(i.geoPointValue.latitude)&&rn(s.geoPointValue.longitude)===rn(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return rn(s.integerValue)===rn(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=rn(s.doubleValue),l=rn(i.doubleValue);return o===l?xy(o)===xy(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Jh(t.arrayValue.values||[],e.arrayValue.values||[],mo);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(l4(o)!==l4(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!mo(o[c],l[c])))return!1;return!0}(t,e);default:return mt(52216,{left:t})}}function up(t,e){return(t.values||[]).find(r=>mo(r,e))!==void 0}function Xh(t,e){if(t===e)return 0;const r=$c(t),n=$c(e);if(r!==n)return Bt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Bt(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=rn(i.integerValue||i.doubleValue),c=rn(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return u4(t.timestampValue,e.timestampValue);case 4:return u4(lp(t),lp(e));case 5:return G2(t.stringValue,e.stringValue);case 6:return function(i,o){const l=qc(i),c=qc(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=Bt(l[u],c[u]);if(d!==0)return d}return Bt(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Bt(rn(i.latitude),rn(o.latitude));return l!==0?l:Bt(rn(i.longitude),rn(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return d4(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,u,d;const h=i.fields||{},g=o.fields||{},m=(l=h[by])===null||l===void 0?void 0:l.arrayValue,w=(c=g[by])===null||c===void 0?void 0:c.arrayValue,_=Bt(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((d=w==null?void 0:w.values)===null||d===void 0?void 0:d.length)||0);return _!==0?_:d4(m,w)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Bg.mapValue&&o===Bg.mapValue)return 0;if(i===Bg.mapValue)return 1;if(o===Bg.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){const g=G2(c[h],d[h]);if(g!==0)return g;const m=Xh(l[c[h]],u[d[h]]);if(m!==0)return m}return Bt(c.length,d.length)}(t.mapValue,e.mapValue);default:throw mt(23264,{le:r})}}function u4(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Bt(t,e);const r=zc(t),n=zc(e),s=Bt(r.seconds,n.seconds);return s!==0?s:Bt(r.nanos,n.nanos)}function d4(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=Xh(r[s],n[s]);if(i)return i}return Bt(r.length,n.length)}function Zh(t){return K2(t)}function K2(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=zc(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return qc(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return ct.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=K2(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const o of n)i?i=!1:s+=",",s+=`${o}:${K2(r.fields[o])}`;return s+"}"}(t.mapValue):mt(61005,{value:t})}function w0(t){switch($c(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=wx(t);return e?16+w0(e):16;case 5:return 2*t.stringValue.length;case 6:return qc(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((s,i)=>s+w0(i),0)}(t.arrayValue);case 10:case 11:return function(n){let s=0;return nu(n.fields,(i,o)=>{s+=i.length+w0(o)}),s}(t.mapValue);default:throw mt(13486,{value:t})}}function h4(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Y2(t){return!!t&&"integerValue"in t}function l5(t){return!!t&&"arrayValue"in t}function f4(t){return!!t&&"nullValue"in t}function m4(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function N0(t){return!!t&&"mapValue"in t}function Z9(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[WT])===null||r===void 0?void 0:r.stringValue)===GT}function Am(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return nu(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Am(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Am(t.arrayValue.values[r]);return e}return Object.assign({},t)}function eV(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===HT}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e){this.value=e}static empty(){return new As({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!N0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Am(r)}setAll(e){let r=Vn.emptyPath(),n={},s=[];e.forEach((o,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,s),n={},s=[],r=l.popLast()}o?n[l.lastSegment()]=Am(o):s.push(l.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());N0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return mo(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];N0(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){nu(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new As(Am(this.value))}}function KT(t){const e=[];return nu(t.fields,(r,n)=>{const s=new Vn([r]);if(N0(n)){const i=KT(n.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new gi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e,r,n,s,i,o,l){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Cn(e,0,Nt.min(),Nt.min(),Nt.min(),As.empty(),0)}static newFoundDocument(e,r,n,s){return new Cn(e,1,r,Nt.min(),n,s,0)}static newNoDocument(e,r){return new Cn(e,2,r,Nt.min(),Nt.min(),As.empty(),0)}static newUnknownDocument(e,r){return new Cn(e,3,r,Nt.min(),Nt.min(),As.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Nt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=As.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=As.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Nt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Cn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Cn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e,r){this.position=e,this.inclusive=r}}function p4(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?n=ct.comparator(ct.fromName(o.referenceValue),r.key):n=Xh(o,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function g4(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!mo(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dp{constructor(e,r="asc"){this.field=e,this.dir=r}}function tV(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let YT=class{};class mn extends YT{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new nV(e,r,n):r==="array-contains"?new aV(e,n):r==="in"?new oV(e,n):r==="not-in"?new lV(e,n):r==="array-contains-any"?new cV(e,n):new mn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new sV(e,n):new iV(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Xh(r,this.value)):r!==null&&$c(this.value)===$c(r)&&this.matchesComparison(Xh(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return mt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ka extends YT{constructor(e,r){super(),this.filters=e,this.op=r,this.he=null}static create(e,r){return new ka(e,r)}matches(e){return QT(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function QT(t){return t.op==="and"}function JT(t){return rV(t)&&QT(t)}function rV(t){for(const e of t.filters)if(e instanceof ka)return!1;return!0}function Q2(t){if(t instanceof mn)return t.field.canonicalString()+t.op.toString()+Zh(t.value);if(JT(t))return t.filters.map(e=>Q2(e)).join(",");{const e=t.filters.map(r=>Q2(r)).join(",");return`${t.op}(${e})`}}function XT(t,e){return t instanceof mn?function(n,s){return s instanceof mn&&n.op===s.op&&n.field.isEqual(s.field)&&mo(n.value,s.value)}(t,e):t instanceof ka?function(n,s){return s instanceof ka&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,o,l)=>i&&XT(o,s.filters[l]),!0):!1}(t,e):void mt(19439)}function ZT(t){return t instanceof mn?function(r){return`${r.field.canonicalString()} ${r.op} ${Zh(r.value)}`}(t):t instanceof ka?function(r){return r.op.toString()+" {"+r.getFilters().map(ZT).join(" ,")+"}"}(t):"Filter"}class nV extends mn{constructor(e,r,n){super(e,r,n),this.key=ct.fromName(n.referenceValue)}matches(e){const r=ct.comparator(e.key,this.key);return this.matchesComparison(r)}}class sV extends mn{constructor(e,r){super(e,"in",r),this.keys=eI("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class iV extends mn{constructor(e,r){super(e,"not-in",r),this.keys=eI("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function eI(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>ct.fromName(n.referenceValue))}class aV extends mn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return l5(r)&&up(r.arrayValue,this.value)}}class oV extends mn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&up(this.value.arrayValue,r)}}class lV extends mn{constructor(e,r){super(e,"not-in",r)}matches(e){if(up(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!up(this.value.arrayValue,r)}}class cV extends mn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!l5(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>up(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(e,r=null,n=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.Pe=null}}function y4(t,e=null,r=[],n=[],s=null,i=null,o=null){return new uV(t,e,r,n,s,i,o)}function c5(t){const e=Ct(t);if(e.Pe===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Q2(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),Dp(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Zh(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Zh(n)).join(",")),e.Pe=r}return e.Pe}function u5(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!tV(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!XT(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!g4(t.startAt,e.startAt)&&g4(t.endAt,e.endAt)}function J2(t){return ct.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,r=null,n=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function dV(t,e,r,n,s,i,o,l){return new yf(t,e,r,n,s,i,o,l)}function Nx(t){return new yf(t)}function x4(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function tI(t){return t.collectionGroup!==null}function Em(t){const e=Ct(t);if(e.Te===null){e.Te=[];const r=new Set;for(const i of e.explicitOrderBy)e.Te.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Nn(Vn.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.Te.push(new dp(i,n))}),r.has(Vn.keyField().canonicalString())||e.Te.push(new dp(Vn.keyField(),n))}return e.Te}function lo(t){const e=Ct(t);return e.Ie||(e.Ie=hV(e,Em(t))),e.Ie}function hV(t,e){if(t.limitType==="F")return y4(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new dp(s.field,i)});const r=t.endAt?new wy(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new wy(t.startAt.position,t.startAt.inclusive):null;return y4(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function X2(t,e){const r=t.filters.concat([e]);return new yf(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Ny(t,e,r){return new yf(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function _x(t,e){return u5(lo(t),lo(e))&&t.limitType===e.limitType}function rI(t){return`${c5(lo(t))}|lt:${t.limitType}`}function Zd(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>ZT(s)).join(", ")}]`),Dp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>Zh(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>Zh(s)).join(",")),`Target(${n})`}(lo(t))}; limitType=${t.limitType})`}function jx(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):ct.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of Em(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(o,l,c){const u=p4(o,l,c);return o.inclusive?u<=0:u<0}(n.startAt,Em(n),s)||n.endAt&&!function(o,l,c){const u=p4(o,l,c);return o.inclusive?u>=0:u>0}(n.endAt,Em(n),s))}(t,e)}function fV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function nI(t){return(e,r)=>{let n=!1;for(const s of Em(t)){const i=mV(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function mV(t,e,r){const n=t.field.isKeyField()?ct.comparator(e.key,r.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?Xh(c,u):mt(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return mt(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){nu(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return VT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pV=new zr(ct.comparator);function dl(){return pV}const sI=new zr(ct.comparator);function um(...t){let e=sI;for(const r of t)e=e.insert(r.key,r);return e}function iI(t){let e=sI;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function qu(){return km()}function aI(){return km()}function km(){return new pd(t=>t.toString(),(t,e)=>t.isEqual(e))}const gV=new zr(ct.comparator),yV=new Nn(ct.comparator);function Ht(...t){let e=yV;for(const r of t)e=e.add(r);return e}const xV=new Nn(Bt);function vV(){return xV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d5(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xy(e)?"-0":e}}function oI(t){return{integerValue:""+t}}function lI(t,e){return K9(e)?oI(e):d5(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(){this._=void 0}}function bV(t,e,r){return t instanceof hp?function(s,i){const o={fields:{[zT]:{stringValue:UT},[$T]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&o5(i)&&(i=wx(i)),i&&(o.fields[qT]=i),{mapValue:o}}(r,e):t instanceof fp?uI(t,e):t instanceof ef?dI(t,e):function(s,i){const o=cI(s,i),l=v4(o)+v4(s.Ee);return Y2(o)&&Y2(s.Ee)?oI(l):d5(s.serializer,l)}(t,e)}function wV(t,e,r){return t instanceof fp?uI(t,e):t instanceof ef?dI(t,e):r}function cI(t,e){return t instanceof mp?function(n){return Y2(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class hp extends Sx{}class fp extends Sx{constructor(e){super(),this.elements=e}}function uI(t,e){const r=hI(e);for(const n of t.elements)r.some(s=>mo(s,n))||r.push(n);return{arrayValue:{values:r}}}class ef extends Sx{constructor(e){super(),this.elements=e}}function dI(t,e){let r=hI(e);for(const n of t.elements)r=r.filter(s=>!mo(s,n));return{arrayValue:{values:r}}}class mp extends Sx{constructor(e,r){super(),this.serializer=e,this.Ee=r}}function v4(t){return rn(t.integerValue||t.doubleValue)}function hI(t){return l5(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h5{constructor(e,r){this.field=e,this.transform=r}}function NV(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof fp&&s instanceof fp||n instanceof ef&&s instanceof ef?Jh(n.elements,s.elements,mo):n instanceof mp&&s instanceof mp?mo(n.Ee,s.Ee):n instanceof hp&&s instanceof hp}(t.transform,e.transform)}class _V{constructor(e,r){this.version=e,this.transformResults=r}}class pn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new pn}static exists(e){return new pn(void 0,e)}static updateTime(e){return new pn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function _0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ax{}function fI(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Op(t.key,pn.none()):new Lp(t.key,t.data,pn.none());{const r=t.data,n=As.empty();let s=new Nn(Vn.comparator);for(let i of e.fields)if(!s.has(i)){let o=r.field(i);o===null&&i.length>1&&(i=i.popLast(),o=r.field(i)),o===null?n.delete(i):n.set(i,o),s=s.add(i)}return new su(t.key,n,new gi(s.toArray()),pn.none())}}function jV(t,e,r){t instanceof Lp?function(s,i,o){const l=s.value.clone(),c=w4(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,r):t instanceof su?function(s,i,o){if(!_0(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=w4(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(mI(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function Tm(t,e,r,n){return t instanceof Lp?function(i,o,l,c){if(!_0(i.precondition,o))return l;const u=i.value.clone(),d=N4(i.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof su?function(i,o,l,c){if(!_0(i.precondition,o))return l;const u=N4(i.fieldTransforms,c,o),d=o.data;return d.setAll(mI(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(i,o,l){return _0(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,r)}function SV(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=cI(n.transform,s||null);i!=null&&(r===null&&(r=As.empty()),r.set(n.field,i))}return r||null}function b4(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Jh(n,s,(i,o)=>NV(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Lp extends Ax{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class su extends Ax{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function mI(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function w4(t,e,r){const n=new Map;Kt(t.length===r.length,32656,{Ae:r.length,Re:t.length});for(let s=0;s<r.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);n.set(i.field,wV(o,l,r[s]))}return n}function N4(t,e,r){const n=new Map;for(const s of t){const i=s.transform,o=r.data.field(s.field);n.set(s.field,bV(i,o,e))}return n}class Op extends Ax{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class pI extends Ax{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AV{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&jV(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Tm(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Tm(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=aI();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=r.has(s.key)?null:l;const c=fI(o,l);c!==null&&n.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(Nt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Ht())}isEqual(e){return this.batchId===e.batchId&&Jh(this.mutations,e.mutations,(r,n)=>b4(r,n))&&Jh(this.baseMutations,e.baseMutations,(r,n)=>b4(r,n))}}class f5{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){Kt(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let s=function(){return gV}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,n[o].version);return new f5(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EV{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kV{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dn,Gt;function gI(t){switch(t){case Ae.OK:return mt(64938);case Ae.CANCELLED:case Ae.UNKNOWN:case Ae.DEADLINE_EXCEEDED:case Ae.RESOURCE_EXHAUSTED:case Ae.INTERNAL:case Ae.UNAVAILABLE:case Ae.UNAUTHENTICATED:return!1;case Ae.INVALID_ARGUMENT:case Ae.NOT_FOUND:case Ae.ALREADY_EXISTS:case Ae.PERMISSION_DENIED:case Ae.FAILED_PRECONDITION:case Ae.ABORTED:case Ae.OUT_OF_RANGE:case Ae.UNIMPLEMENTED:case Ae.DATA_LOSS:return!0;default:return mt(15467,{code:t})}}function yI(t){if(t===void 0)return ul("GRPC error has no .code"),Ae.UNKNOWN;switch(t){case dn.OK:return Ae.OK;case dn.CANCELLED:return Ae.CANCELLED;case dn.UNKNOWN:return Ae.UNKNOWN;case dn.DEADLINE_EXCEEDED:return Ae.DEADLINE_EXCEEDED;case dn.RESOURCE_EXHAUSTED:return Ae.RESOURCE_EXHAUSTED;case dn.INTERNAL:return Ae.INTERNAL;case dn.UNAVAILABLE:return Ae.UNAVAILABLE;case dn.UNAUTHENTICATED:return Ae.UNAUTHENTICATED;case dn.INVALID_ARGUMENT:return Ae.INVALID_ARGUMENT;case dn.NOT_FOUND:return Ae.NOT_FOUND;case dn.ALREADY_EXISTS:return Ae.ALREADY_EXISTS;case dn.PERMISSION_DENIED:return Ae.PERMISSION_DENIED;case dn.FAILED_PRECONDITION:return Ae.FAILED_PRECONDITION;case dn.ABORTED:return Ae.ABORTED;case dn.OUT_OF_RANGE:return Ae.OUT_OF_RANGE;case dn.UNIMPLEMENTED:return Ae.UNIMPLEMENTED;case dn.DATA_LOSS:return Ae.DATA_LOSS;default:return mt(39323,{code:t})}}(Gt=dn||(dn={}))[Gt.OK=0]="OK",Gt[Gt.CANCELLED=1]="CANCELLED",Gt[Gt.UNKNOWN=2]="UNKNOWN",Gt[Gt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Gt[Gt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Gt[Gt.NOT_FOUND=5]="NOT_FOUND",Gt[Gt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Gt[Gt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Gt[Gt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Gt[Gt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Gt[Gt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Gt[Gt.ABORTED=10]="ABORTED",Gt[Gt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Gt[Gt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Gt[Gt.INTERNAL=13]="INTERNAL",Gt[Gt.UNAVAILABLE=14]="UNAVAILABLE",Gt[Gt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TV=new Ic([4294967295,4294967295],0);function _4(t){const e=LT().encode(t),r=new ET;return r.update(e),new Uint8Array(r.digest())}function j4(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ic([r,n],0),new Ic([s,i],0)]}class m5{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new dm(`Invalid padding: ${r}`);if(n<0)throw new dm(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new dm(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new dm(`Invalid padding when bitmap length is 0: ${r}`);this.fe=8*e.length-r,this.ge=Ic.fromNumber(this.fe)}pe(e,r,n){let s=e.add(r.multiply(Ic.fromNumber(n)));return s.compare(TV)===1&&(s=new Ic([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const r=_4(e),[n,s]=j4(r);for(let i=0;i<this.hashCount;i++){const o=this.pe(n,s,i);if(!this.ye(o))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new m5(i,s,r);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.fe===0)return;const r=_4(e),[n,s]=j4(r);for(let i=0;i<this.hashCount;i++){const o=this.pe(n,s,i);this.we(o)}}we(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class dm extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Mp.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Ex(Nt.min(),s,new zr(Bt),dl(),Ht())}}class Mp{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Mp(n,r,Ht(),Ht(),Ht())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(e,r,n,s){this.Se=e,this.removedTargetIds=r,this.key=n,this.be=s}}class xI{constructor(e,r){this.targetId=e,this.De=r}}class vI{constructor(e,r,n=Wn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class S4{constructor(){this.ve=0,this.Ce=A4(),this.Fe=Wn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Ht(),r=Ht(),n=Ht();return this.Ce.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:mt(38017,{changeType:i})}}),new Mp(this.Fe,this.Me,e,r,n)}ke(){this.xe=!1,this.Ce=A4()}qe(e,r){this.xe=!0,this.Ce=this.Ce.insert(e,r)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Kt(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class IV{constructor(e){this.We=e,this.Ge=new Map,this.ze=dl(),this.je=Ug(),this.Je=Ug(),this.He=new zr(Bt)}Ye(e){for(const r of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(r,e.be):this.Xe(r,e.key,e.be);for(const r of e.removedTargetIds)this.Xe(r,e.key,e.be)}et(e){this.forEachTarget(e,r=>{const n=this.tt(r);switch(e.state){case 0:this.nt(r)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(r);break;case 3:this.nt(r)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(r)&&(this.rt(r),n.Be(e.resumeToken));break;default:mt(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Ge.forEach((n,s)=>{this.nt(s)&&r(s)})}it(e){const r=e.targetId,n=e.De.count,s=this.st(r);if(s){const i=s.target;if(J2(i))if(n===0){const o=new ct(i.path);this.Xe(r,o,Cn.newNoDocument(o,Nt.min()))}else Kt(n===1,20013,{expectedCount:n});else{const o=this.ot(r);if(o!==n){const l=this._t(e),c=l?this.ut(l,e,o):1;if(c!==0){this.rt(r);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(r,u)}}}}}_t(e){const r=e.De.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let o,l;try{o=qc(n).toUint8Array()}catch(c){if(c instanceof BT)return Bc("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new m5(o,s,i)}catch(c){return Bc(c instanceof dm?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.fe===0?null:l}ut(e,r,n){return r.De.count===n-this.ht(e,r.targetId)?0:2}ht(e,r){const n=this.We.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const o=this.We.lt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Xe(r,i,null),s++)}),s}Pt(e){const r=new Map;this.Ge.forEach((i,o)=>{const l=this.st(o);if(l){if(i.current&&J2(l.target)){const c=new ct(l.target.path);this.Tt(c).has(o)||this.It(o,c)||this.Xe(o,c,Cn.newNoDocument(c,e))}i.Ne&&(r.set(o,i.Le()),i.ke())}});let n=Ht();this.Je.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.st(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(i))}),this.ze.forEach((i,o)=>o.setReadTime(e));const s=new Ex(e,r,this.He,this.ze,n);return this.ze=dl(),this.je=Ug(),this.Je=Ug(),this.He=new zr(Bt),s}Ze(e,r){if(!this.nt(e))return;const n=this.It(e,r.key)?2:0;this.tt(e).qe(r.key,n),this.ze=this.ze.insert(r.key,r),this.je=this.je.insert(r.key,this.Tt(r.key).add(e)),this.Je=this.Je.insert(r.key,this.dt(r.key).add(e))}Xe(e,r,n){if(!this.nt(e))return;const s=this.tt(e);this.It(e,r)?s.qe(r,1):s.Qe(r),this.Je=this.Je.insert(r,this.dt(r).delete(e)),this.Je=this.Je.insert(r,this.dt(r).add(e)),n&&(this.ze=this.ze.insert(r,n))}removeTarget(e){this.Ge.delete(e)}ot(e){const r=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let r=this.Ge.get(e);return r||(r=new S4,this.Ge.set(e,r)),r}dt(e){let r=this.Je.get(e);return r||(r=new Nn(Bt),this.Je=this.Je.insert(e,r)),r}Tt(e){let r=this.je.get(e);return r||(r=new Nn(Bt),this.je=this.je.insert(e,r)),r}nt(e){const r=this.st(e)!==null;return r||tt("WatchChangeAggregator","Detected inactive target",e),r}st(e){const r=this.Ge.get(e);return r&&r.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new S4),this.We.getRemoteKeysForTarget(e).forEach(r=>{this.Xe(e,r,null)})}It(e,r){return this.We.getRemoteKeysForTarget(e).has(r)}}function Ug(){return new zr(ct.comparator)}function A4(){return new zr(ct.comparator)}const CV=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),PV=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),RV=(()=>({and:"AND",or:"OR"}))();class DV{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Z2(t,e){return t.useProto3Json||Dp(e)?e:{value:e}}function _y(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function bI(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function LV(t,e){return _y(t,e.toTimestamp())}function bi(t){return Kt(!!t,49232),Nt.fromTimestamp(function(r){const n=zc(r);return new yt(n.seconds,n.nanos)}(t))}function p5(t,e){return eb(t,e).canonicalString()}function eb(t,e){const r=function(s){return new hr(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function wI(t){const e=hr.fromString(t);return Kt(EI(e),10190,{key:e.toString()}),e}function jy(t,e){return p5(t.databaseId,e.path)}function Im(t,e){const r=wI(e);if(r.get(1)!==t.databaseId.projectId)throw new We(Ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new We(Ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new ct(_I(r))}function NI(t,e){return p5(t.databaseId,e)}function OV(t){const e=wI(t);return e.length===4?hr.emptyPath():_I(e)}function tb(t){return new hr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function _I(t){return Kt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function E4(t,e,r){return{name:jy(t,e),fields:r.value.mapValue.fields}}function MV(t,e){return"found"in e?function(n,s){Kt(!!s.found,43571),s.found.name,s.found.updateTime;const i=Im(n,s.found.name),o=bi(s.found.updateTime),l=s.found.createTime?bi(s.found.createTime):Nt.min(),c=new As({mapValue:{fields:s.found.fields}});return Cn.newFoundDocument(i,o,l,c)}(t,e):"missing"in e?function(n,s){Kt(!!s.missing,3894),Kt(!!s.readTime,22933);const i=Im(n,s.missing),o=bi(s.readTime);return Cn.newNoDocument(i,o)}(t,e):mt(7234,{result:e})}function FV(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:mt(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(Kt(d===void 0||typeof d=="string",58123),Wn.fromBase64String(d||"")):(Kt(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Wn.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?Ae.UNKNOWN:yI(u.code);return new We(d,u.message||"")}(o);r=new vI(n,s,i,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=Im(t,n.document.name),i=bi(n.document.updateTime),o=n.document.createTime?bi(n.document.createTime):Nt.min(),l=new As({mapValue:{fields:n.document.fields}}),c=Cn.newFoundDocument(s,i,o,l),u=n.targetIds||[],d=n.removedTargetIds||[];r=new j0(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=Im(t,n.document),i=n.readTime?bi(n.readTime):Nt.min(),o=Cn.newNoDocument(s,i),l=n.removedTargetIds||[];r=new j0([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=Im(t,n.document),i=n.removedTargetIds||[];r=new j0([],i,s,null)}else{if(!("filter"in e))return mt(11601,{At:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,o=new kV(s,i),l=n.targetId;r=new xI(l,o)}}return r}function jI(t,e){let r;if(e instanceof Lp)r={update:E4(t,e.key,e.value)};else if(e instanceof Op)r={delete:jy(t,e.key)};else if(e instanceof su)r={update:E4(t,e.key,e.data),updateMask:GV(e.fieldMask)};else{if(!(e instanceof pI))return mt(16599,{Rt:e.type});r={verify:jy(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,o){const l=o.transform;if(l instanceof hp)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof fp)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ef)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof mp)return{fieldPath:o.field.canonicalString(),increment:l.Ee};throw mt(20930,{transform:o.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:LV(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:mt(27497)}(t,e.precondition)),r}function VV(t,e){return t&&t.length>0?(Kt(e!==void 0,14353),t.map(r=>function(s,i){let o=s.updateTime?bi(s.updateTime):bi(i);return o.isEqual(Nt.min())&&(o=bi(i)),new _V(o,s.transformResults||[])}(r,e))):[]}function BV(t,e){return{documents:[NI(t,e.path)]}}function UV(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=NI(t,s);const i=function(u){if(u.length!==0)return AI(ka.create(u,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(g){return{field:eh(g.field),direction:$V(g.dir)}}(d))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const l=Z2(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{Vt:r,parent:s}}function zV(t){let e=OV(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){Kt(n===1,65062);const d=r.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];r.where&&(i=function(h){const g=SI(h);return g instanceof ka&&JT(g)?g.getFilters():[g]}(r.where));let o=[];r.orderBy&&(o=function(h){return h.map(g=>function(w){return new dp(th(w.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(g))}(r.orderBy));let l=null;r.limit&&(l=function(h){let g;return g=typeof h=="object"?h.value:h,Dp(g)?null:g}(r.limit));let c=null;r.startAt&&(c=function(h){const g=!!h.before,m=h.values||[];return new wy(m,g)}(r.startAt));let u=null;return r.endAt&&(u=function(h){const g=!h.before,m=h.values||[];return new wy(m,g)}(r.endAt)),dV(e,s,o,i,l,"F",c,u)}function qV(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return mt(28987,{purpose:s})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function SI(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=th(r.unaryFilter.field);return mn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=th(r.unaryFilter.field);return mn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=th(r.unaryFilter.field);return mn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=th(r.unaryFilter.field);return mn.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return mt(61313);default:return mt(60726)}}(t):t.fieldFilter!==void 0?function(r){return mn.create(th(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return mt(58110);default:return mt(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ka.create(r.compositeFilter.filters.map(n=>SI(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return mt(1026)}}(r.compositeFilter.op))}(t):mt(30097,{filter:t})}function $V(t){return CV[t]}function WV(t){return PV[t]}function HV(t){return RV[t]}function eh(t){return{fieldPath:t.canonicalString()}}function th(t){return Vn.fromServerFormat(t.fieldPath)}function AI(t){return t instanceof mn?function(r){if(r.op==="=="){if(m4(r.value))return{unaryFilter:{field:eh(r.field),op:"IS_NAN"}};if(f4(r.value))return{unaryFilter:{field:eh(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(m4(r.value))return{unaryFilter:{field:eh(r.field),op:"IS_NOT_NAN"}};if(f4(r.value))return{unaryFilter:{field:eh(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:eh(r.field),op:WV(r.op),value:r.value}}}(t):t instanceof ka?function(r){const n=r.getFilters().map(s=>AI(s));return n.length===1?n[0]:{compositeFilter:{op:HV(r.op),filters:n}}}(t):mt(54877,{filter:t})}function GV(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function EI(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(e,r,n,s,i=Nt.min(),o=Nt.min(),l=Wn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new gc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new gc(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new gc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new gc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(e){this.gt=e}}function YV(t){const e=zV({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ny(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QV{constructor(){this.Dn=new JV}addToCollectionParentIndex(e,r){return this.Dn.add(r),Pe.resolve()}getCollectionParents(e,r){return Pe.resolve(this.Dn.getEntries(r))}addFieldIndex(e,r){return Pe.resolve()}deleteFieldIndex(e,r){return Pe.resolve()}deleteAllFieldIndexes(e){return Pe.resolve()}createTargetIndexes(e,r){return Pe.resolve()}getDocumentsMatchingTarget(e,r){return Pe.resolve(null)}getIndexType(e,r){return Pe.resolve(0)}getFieldIndexes(e,r){return Pe.resolve([])}getNextCollectionGroupToUpdate(e){return Pe.resolve(null)}getMinOffset(e,r){return Pe.resolve(Uc.min())}getMinOffsetFromCollectionGroup(e,r){return Pe.resolve(Uc.min())}updateCollectionGroup(e,r,n){return Pe.resolve()}updateIndexEntries(e,r){return Pe.resolve()}}class JV{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Nn(hr.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Nn(hr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k4={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},kI=41943040;class zs{static withCacheSize(e){return new zs(e,zs.DEFAULT_COLLECTION_PERCENTILE,zs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zs.DEFAULT_COLLECTION_PERCENTILE=10,zs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zs.DEFAULT=new zs(kI,zs.DEFAULT_COLLECTION_PERCENTILE,zs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zs.DISABLED=new zs(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new tf(0)}static ur(){return new tf(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T4="LruGarbageCollector",XV=1048576;function I4([t,e],[r,n]){const s=Bt(t,r);return s===0?Bt(e,n):s}class ZV{constructor(e){this.Tr=e,this.buffer=new Nn(I4),this.Ir=0}dr(){return++this.Ir}Er(e){const r=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();I4(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class eB{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){tt(T4,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){gf(r)?tt(T4,"Ignoring IndexedDB error during garbage collection: ",r):await pf(r)}await this.Rr(3e5)})}}class tB{constructor(e,r){this.Vr=e,this.params=r}calculateTargetCount(e,r){return this.Vr.mr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Pe.resolve(bx.ue);const n=new ZV(r);return this.Vr.forEachTarget(e,s=>n.Er(s.sequenceNumber)).next(()=>this.Vr.gr(e,s=>n.Er(s))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Vr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Vr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(tt("LruGarbageCollector","Garbage collection skipped; disabled"),Pe.resolve(k4)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(tt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),k4):this.pr(e,r))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,r){let n,s,i,o,l,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(tt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(n=h,l=Date.now(),this.removeTargets(e,n,r))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(u=Date.now(),Xd()<=Wt.DEBUG&&tt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${h} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),Pe.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function rB(t,e){return new tB(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nB{constructor(){this.changes=new pd(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Cn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Pe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sB{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iB{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&Tm(n.mutation,s,gi.empty(),yt.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Ht()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Ht()){const s=qu();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let o=um();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=qu();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Ht()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{r.set(o,l)})})}computeViews(e,r,n,s){let i=dl();const o=km(),l=function(){return km()}();return r.forEach((c,u)=>{const d=n.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof su)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),Tm(d.mutation,u,d.mutation.getFieldMask(),yt.now())):o.set(u.key,gi.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>o.set(u,d)),r.forEach((u,d)=>{var h;return l.set(u,new sB(d,(h=o.get(u))!==null&&h!==void 0?h:null))}),l))}recalculateAndSaveOverlays(e,r){const n=km();let s=new zr((o,l)=>o-l),i=Ht();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=r.get(c);if(u===null)return;let d=n.get(c)||gi.empty();d=l.applyToLocalView(u,d),n.set(c,d);const h=(s.get(l.batchId)||Ht()).add(c);s=s.insert(l.batchId,h)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,h=aI();d.forEach(g=>{if(!i.has(g)){const m=fI(r.get(g),n.get(g));m!==null&&h.set(g,m),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return Pe.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(o){return ct.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):tI(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):Pe.resolve(qu());let l=op,c=i;return o.next(u=>Pe.forEach(u,(d,h)=>(l<h.largestBatchId&&(l=h.largestBatchId),i.get(d)?Pe.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{c=c.insert(d,g)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,Ht())).next(d=>({batchId:l,changes:iI(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new ct(r)).next(n=>{let s=um();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let o=um();return this.indexManager.getCollectionParents(e,i).next(l=>Pe.forEach(l,c=>{const u=function(h,g){return new yf(g,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,n,s).next(d=>{d.forEach((h,g)=>{o=o.insert(h,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(o=>{i.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Cn.newInvalidDocument(d)))});let l=um();return o.forEach((c,u)=>{const d=i.get(c);d!==void 0&&Tm(d.mutation,u,gi.empty(),yt.now()),jx(r,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aB{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,r){return Pe.resolve(this.Br.get(r))}saveBundleMetadata(e,r){return this.Br.set(r.id,function(s){return{id:s.id,version:s.version,createTime:bi(s.createTime)}}(r)),Pe.resolve()}getNamedQuery(e,r){return Pe.resolve(this.Lr.get(r))}saveNamedQuery(e,r){return this.Lr.set(r.name,function(s){return{name:s.name,query:YV(s.bundledQuery),readTime:bi(s.readTime)}}(r)),Pe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oB{constructor(){this.overlays=new zr(ct.comparator),this.kr=new Map}getOverlay(e,r){return Pe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=qu();return Pe.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.wt(e,r,i)}),Pe.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.kr.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.kr.delete(n)),Pe.resolve()}getOverlaysForCollection(e,r,n){const s=qu(),i=r.length+1,o=new ct(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>n&&s.set(c.getKey(),c)}return Pe.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new zr((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let d=i.get(u.largestBatchId);d===null&&(d=qu(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=qu(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return Pe.resolve(l)}wt(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.kr.get(s.largestBatchId).delete(n.key);this.kr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new EV(r,n));let i=this.kr.get(r);i===void 0&&(i=Ht(),this.kr.set(r,i)),this.kr.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lB{constructor(){this.sessionToken=Wn.EMPTY_BYTE_STRING}getSessionToken(e){return Pe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Pe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g5{constructor(){this.qr=new Nn(kn.Qr),this.$r=new Nn(kn.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,r){const n=new kn(e,r);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Wr(new kn(e,r))}Gr(e,r){e.forEach(n=>this.removeReference(n,r))}zr(e){const r=new ct(new hr([])),n=new kn(r,e),s=new kn(r,e+1),i=[];return this.$r.forEachInRange([n,s],o=>{this.Wr(o),i.push(o.key)}),i}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const r=new ct(new hr([])),n=new kn(r,e),s=new kn(r,e+1);let i=Ht();return this.$r.forEachInRange([n,s],o=>{i=i.add(o.key)}),i}containsKey(e){const r=new kn(e,0),n=this.qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class kn{constructor(e,r){this.key=e,this.Hr=r}static Qr(e,r){return ct.comparator(e.key,r.key)||Bt(e.Hr,r.Hr)}static Ur(e,r){return Bt(e.Hr,r.Hr)||ct.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cB{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.er=1,this.Yr=new Nn(kn.Qr)}checkEmpty(e){return Pe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new AV(i,r,n,s);this.mutationQueue.push(o);for(const l of s)this.Yr=this.Yr.add(new kn(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Pe.resolve(o)}lookupMutationBatch(e,r){return Pe.resolve(this.Zr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.Xr(n),i=s<0?0:s;return Pe.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Pe.resolve(this.mutationQueue.length===0?a5:this.er-1)}getAllMutationBatches(e){return Pe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new kn(r,0),s=new kn(r,Number.POSITIVE_INFINITY),i=[];return this.Yr.forEachInRange([n,s],o=>{const l=this.Zr(o.Hr);i.push(l)}),Pe.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Nn(Bt);return r.forEach(s=>{const i=new kn(s,0),o=new kn(s,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([i,o],l=>{n=n.add(l.Hr)})}),Pe.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;ct.isDocumentKey(i)||(i=i.child(""));const o=new kn(new ct(i),0);let l=new Nn(Bt);return this.Yr.forEachWhile(c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.Hr)),!0)},o),Pe.resolve(this.ei(l))}ei(e){const r=[];return e.forEach(n=>{const s=this.Zr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){Kt(this.ti(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Yr;return Pe.forEach(r.mutations,s=>{const i=new kn(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,r){const n=new kn(r,0),s=this.Yr.firstAfterOrEqual(n);return Pe.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Pe.resolve()}ti(e,r){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const r=this.Xr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uB{constructor(e){this.ni=e,this.docs=function(){return new zr(ct.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,o=this.ni(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Pe.resolve(n?n.document.mutableCopy():Cn.newInvalidDocument(r))}getEntries(e,r){let n=dl();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():Cn.newInvalidDocument(s))}),Pe.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=dl();const o=r.path,l=new ct(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||$9(q9(d),n)<=0||(s.has(d.key)||jx(r,d))&&(i=i.insert(d.key,d.mutableCopy()))}return Pe.resolve(i)}getAllFromCollectionGroup(e,r,n,s){mt(9500)}ri(e,r){return Pe.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new dB(this)}getSize(e){return Pe.resolve(this.size)}}class dB extends nB{constructor(e){super(),this.Or=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.Or.addEntry(e,s)):this.Or.removeEntry(n)}),Pe.waitFor(r)}getFromCache(e,r){return this.Or.getEntry(e,r)}getAllFromCache(e,r){return this.Or.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hB{constructor(e){this.persistence=e,this.ii=new pd(r=>c5(r),u5),this.lastRemoteSnapshotVersion=Nt.min(),this.highestTargetId=0,this.si=0,this.oi=new g5,this.targetCount=0,this._i=tf.ar()}forEachTarget(e,r){return this.ii.forEach((n,s)=>r(s)),Pe.resolve()}getLastRemoteSnapshotVersion(e){return Pe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Pe.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),Pe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.si&&(this.si=r),Pe.resolve()}hr(e){this.ii.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this._i=new tf(r),this.highestTargetId=r),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,r){return this.hr(r),this.targetCount+=1,Pe.resolve()}updateTargetData(e,r){return this.hr(r),Pe.resolve()}removeTargetData(e,r){return this.ii.delete(r.target),this.oi.zr(r.targetId),this.targetCount-=1,Pe.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.ii.forEach((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.ii.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),Pe.waitFor(i).next(()=>s)}getTargetCount(e){return Pe.resolve(this.targetCount)}getTargetData(e,r){const n=this.ii.get(r)||null;return Pe.resolve(n)}addMatchingKeys(e,r,n){return this.oi.Kr(r,n),Pe.resolve()}removeMatchingKeys(e,r,n){this.oi.Gr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),Pe.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this.oi.zr(r),Pe.resolve()}getMatchingKeysForTargetId(e,r){const n=this.oi.Jr(r);return Pe.resolve(n)}containsKey(e,r){return Pe.resolve(this.oi.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TI{constructor(e,r){this.ai={},this.overlays={},this.ui=new bx(0),this.ci=!1,this.ci=!0,this.li=new lB,this.referenceDelegate=e(this),this.hi=new hB(this),this.indexManager=new QV,this.remoteDocumentCache=function(s){return new uB(s)}(n=>this.referenceDelegate.Pi(n)),this.serializer=new KV(r),this.Ti=new aB(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new oB,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ai[e.toKey()];return n||(n=new cB(r,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,r,n){tt("MemoryPersistence","Starting transaction:",e);const s=new fB(this.ui.next());return this.referenceDelegate.Ii(),n(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ei(e,r){return Pe.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,r)))}}class fB extends H9{constructor(e){super(),this.currentSequenceNumber=e}}class y5{constructor(e){this.persistence=e,this.Ai=new g5,this.Ri=null}static Vi(e){return new y5(e)}get mi(){if(this.Ri)return this.Ri;throw mt(60996)}addReference(e,r,n){return this.Ai.addReference(n,r),this.mi.delete(n.toString()),Pe.resolve()}removeReference(e,r,n){return this.Ai.removeReference(n,r),this.mi.add(n.toString()),Pe.resolve()}markPotentiallyOrphaned(e,r){return this.mi.add(r.toString()),Pe.resolve()}removeTarget(e,r){this.Ai.zr(r.targetId).forEach(s=>this.mi.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.mi.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}Ii(){this.Ri=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Pe.forEach(this.mi,n=>{const s=ct.fromPath(n);return this.fi(e,s).next(i=>{i||r.removeEntry(s,Nt.min())})}).next(()=>(this.Ri=null,r.apply(e)))}updateLimboDocument(e,r){return this.fi(e,r).next(n=>{n?this.mi.delete(r.toString()):this.mi.add(r.toString())})}Pi(e){return 0}fi(e,r){return Pe.or([()=>Pe.resolve(this.Ai.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ei(e,r)])}}class Sy{constructor(e,r){this.persistence=e,this.gi=new pd(n=>Y9(n.path),(n,s)=>n.isEqual(s)),this.garbageCollector=rB(this,r)}static Vi(e,r){return new Sy(e,r)}Ii(){}di(e){return Pe.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}mr(e){const r=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(s=>n+s))}yr(e){let r=0;return this.gr(e,n=>{r++}).next(()=>r)}gr(e,r){return Pe.forEach(this.gi,(n,s)=>this.Sr(e,n,s).next(i=>i?Pe.resolve():r(s)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ri(e,o=>this.Sr(e,o,r).next(l=>{l||(n++,i.removeEntry(o,Nt.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.gi.set(r,e.currentSequenceNumber),Pe.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),Pe.resolve()}removeReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),Pe.resolve()}updateLimboDocument(e,r){return this.gi.set(r,e.currentSequenceNumber),Pe.resolve()}Pi(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=w0(e.data.value)),r}Sr(e,r,n){return Pe.or([()=>this.persistence.Ei(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const s=this.gi.get(r);return Pe.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x5{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.Is=n,this.ds=s}static Es(e,r){let n=Ht(),s=Ht();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new x5(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mB{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pB{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return BO()?8:G9(fs())>0?6:4}()}initialize(e,r){this.gs=e,this.indexManager=r,this.As=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.ps(e,r).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ys(e,r,s,n).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new mB;return this.ws(e,r,o).next(l=>{if(i.result=l,this.Rs)return this.Ss(e,r,o,l.size)})}).next(()=>i.result)}Ss(e,r,n,s){return n.documentReadCount<this.Vs?(Xd()<=Wt.DEBUG&&tt("QueryEngine","SDK will not create cache indexes for query:",Zd(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Pe.resolve()):(Xd()<=Wt.DEBUG&&tt("QueryEngine","Query:",Zd(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.fs*s?(Xd()<=Wt.DEBUG&&tt("QueryEngine","The SDK decides to create cache indexes for query:",Zd(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,lo(r))):Pe.resolve())}ps(e,r){if(x4(r))return Pe.resolve(null);let n=lo(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=Ny(r,null,"F"),n=lo(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const o=Ht(...i);return this.gs.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const u=this.bs(r,l);return this.Ds(r,u,o,c.readTime)?this.ps(e,Ny(r,null,"F")):this.vs(e,u,r,c)}))})))}ys(e,r,n,s){return x4(r)||s.isEqual(Nt.min())?Pe.resolve(null):this.gs.getDocuments(e,n).next(i=>{const o=this.bs(r,i);return this.Ds(r,o,n,s)?Pe.resolve(null):(Xd()<=Wt.DEBUG&&tt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Zd(r)),this.vs(e,o,r,z9(s,op)).next(l=>l))})}bs(e,r){let n=new Nn(nI(e));return r.forEach((s,i)=>{jx(e,i)&&(n=n.add(i))}),n}Ds(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}ws(e,r,n){return Xd()<=Wt.DEBUG&&tt("QueryEngine","Using full collection scan to execute query:",Zd(r)),this.gs.getDocumentsMatchingQuery(e,r,Uc.min(),n)}vs(e,r,n,s){return this.gs.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v5="LocalStore",gB=3e8;class yB{constructor(e,r,n,s){this.persistence=e,this.Cs=r,this.serializer=s,this.Fs=new zr(Bt),this.Ms=new pd(i=>c5(i),u5),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new iB(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Fs))}}function xB(t,e,r,n){return new yB(t,e,r,n)}async function II(t,e){const r=Ct(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.Ns(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const o=[],l=[];let c=Ht();for(const u of s){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return r.localDocuments.getDocuments(n,c).next(u=>({Bs:u,removedBatchIds:o,addedBatchIds:l}))})})}function vB(t,e){const r=Ct(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.Os.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const h=u.batch,g=h.keys();let m=Pe.resolve();return g.forEach(w=>{m=m.next(()=>d.getEntry(c,w)).next(_=>{const T=u.docVersions.get(w);Kt(T!==null,48541),_.version.compareTo(T)<0&&(h.applyToRemoteDocument(_,u),_.isValidDocument()&&(_.setReadTime(u.commitVersion),d.addEntry(_)))})}),m.next(()=>l.mutationQueue.removeMutationBatch(c,h))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=Ht();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function CI(t){const e=Ct(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.hi.getLastRemoteSnapshotVersion(r))}function bB(t,e){const r=Ct(t),n=e.snapshotVersion;let s=r.Fs;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=r.Os.newChangeBuffer({trackRemovals:!0});s=r.Fs;const l=[];e.targetChanges.forEach((d,h)=>{const g=s.get(h);if(!g)return;l.push(r.hi.removeMatchingKeys(i,d.removedDocuments,h).next(()=>r.hi.addMatchingKeys(i,d.addedDocuments,h)));let m=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(Wn.EMPTY_BYTE_STRING,Nt.min()).withLastLimboFreeSnapshotVersion(Nt.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,n)),s=s.insert(h,m),function(_,T,v){return _.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=gB?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(g,m,d)&&l.push(r.hi.updateTargetData(i,m))});let c=dl(),u=Ht();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(wB(i,o,e.documentUpdates).next(d=>{c=d.Ls,u=d.ks})),!n.isEqual(Nt.min())){const d=r.hi.getLastRemoteSnapshotVersion(i).next(h=>r.hi.setTargetsMetadata(i,i.currentSequenceNumber,n));l.push(d)}return Pe.waitFor(l).next(()=>o.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(r.Fs=s,i))}function wB(t,e,r){let n=Ht(),s=Ht();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let o=dl();return r.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(Nt.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):tt(v5,"Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ls:o,ks:s}})}function NB(t,e){const r=Ct(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=a5),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function _B(t,e){const r=Ct(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.hi.getTargetData(n,e).next(i=>i?(s=i,Pe.resolve(s)):r.hi.allocateTargetId(n).next(o=>(s=new gc(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.hi.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.Fs.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.Fs=r.Fs.insert(n.targetId,n),r.Ms.set(e,n.targetId)),n})}async function rb(t,e,r){const n=Ct(t),s=n.Fs.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,o=>n.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!gf(o))throw o;tt(v5,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Fs=n.Fs.remove(e),n.Ms.delete(s.target)}function C4(t,e,r){const n=Ct(t);let s=Nt.min(),i=Ht();return n.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const h=Ct(c),g=h.Ms.get(d);return g!==void 0?Pe.resolve(h.Fs.get(g)):h.hi.getTargetData(u,d)}(n,o,lo(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,n.hi.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>n.Cs.getDocumentsMatchingQuery(o,e,r?s:Nt.min(),r?i:Ht())).next(l=>(jB(n,fV(e),l),{documents:l,qs:i})))}function jB(t,e,r){let n=t.xs.get(e)||Nt.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.xs.set(e,n)}class P4{constructor(){this.activeTargetIds=vV()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class SB{constructor(){this.Fo=new P4,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,r,n){this.Mo[e]=r}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new P4,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AB{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R4="ConnectivityMonitor";class D4{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){tt(R4,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){tt(R4,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zg=null;function nb(){return zg===null?zg=function(){return 268435456+Math.round(2147483648*Math.random())}():zg++,"0x"+zg.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tv="RestConnection",EB={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class kB{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.$o=r+"://"+e.host,this.Uo=`projects/${n}/databases/${s}`,this.Ko=this.databaseId.database===vy?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Wo(e,r,n,s,i){const o=nb(),l=this.Go(e,r.toUriEncodedString());tt(tv,`Sending RPC '${e}' ${o}:`,l,n);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(c,s,i);const{host:u}=new URL(l),d=ru(u);return this.jo(e,l,c,n,d).then(h=>(tt(tv,`Received RPC '${e}' ${o}: `,h),h),h=>{throw Bc(tv,`RPC '${e}' ${o} failed with error: `,h,"url: ",l,"request:",n),h})}Jo(e,r,n,s,i,o){return this.Wo(e,r,n,s,i)}zo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+mf}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,i)=>e[i]=s),n&&n.headers.forEach((s,i)=>e[i]=s)}Go(e,r){const n=EB[e];return`${this.$o}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TB{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zn="WebChannelConnection";class IB extends kB{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,r,n,s,i){const o=nb();return new Promise((l,c)=>{const u=new kT;u.setWithCredentials(!0),u.listenOnce(TT.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case b0.NO_ERROR:const h=u.getResponseJson();tt(Zn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),l(h);break;case b0.TIMEOUT:tt(Zn,`RPC '${e}' ${o} timed out`),c(new We(Ae.DEADLINE_EXCEEDED,"Request time out"));break;case b0.HTTP_ERROR:const g=u.getStatus();if(tt(Zn,`RPC '${e}' ${o} failed with status:`,g,"response text:",u.getResponseText()),g>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const w=m==null?void 0:m.error;if(w&&w.status&&w.message){const _=function(v){const b=v.toLowerCase().replace(/_/g,"-");return Object.values(Ae).indexOf(b)>=0?b:Ae.UNKNOWN}(w.status);c(new We(_,w.message))}else c(new We(Ae.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new We(Ae.UNAVAILABLE,"Connection failed."));break;default:mt(9055,{c_:e,streamId:o,l_:u.getLastErrorCode(),h_:u.getLastError()})}}finally{tt(Zn,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(s);tt(Zn,`RPC '${e}' ${o} sending request:`,s),u.send(r,"POST",d,n,15)})}P_(e,r,n){const s=nb(),i=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=PT(),l=CT(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.zo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const d=i.join("");tt(Zn,`Creating RPC '${e}' stream ${s}: ${d}`,c);const h=o.createWebChannel(d,c);this.T_(h);let g=!1,m=!1;const w=new TB({Ho:T=>{m?tt(Zn,`Not sending because RPC '${e}' stream ${s} is closed:`,T):(g||(tt(Zn,`Opening RPC '${e}' stream ${s} transport.`),h.open(),g=!0),tt(Zn,`RPC '${e}' stream ${s} sending:`,T),h.send(T))},Yo:()=>h.close()}),_=(T,v,b)=>{T.listen(v,x=>{try{b(x)}catch(P){setTimeout(()=>{throw P},0)}})};return _(h,cm.EventType.OPEN,()=>{m||(tt(Zn,`RPC '${e}' stream ${s} transport opened.`),w.s_())}),_(h,cm.EventType.CLOSE,()=>{m||(m=!0,tt(Zn,`RPC '${e}' stream ${s} transport closed`),w.__(),this.I_(h))}),_(h,cm.EventType.ERROR,T=>{m||(m=!0,Bc(Zn,`RPC '${e}' stream ${s} transport errored. Name:`,T.name,"Message:",T.message),w.__(new We(Ae.UNAVAILABLE,"The operation could not be completed")))}),_(h,cm.EventType.MESSAGE,T=>{var v;if(!m){const b=T.data[0];Kt(!!b,16349);const x=b,P=(x==null?void 0:x.error)||((v=x[0])===null||v===void 0?void 0:v.error);if(P){tt(Zn,`RPC '${e}' stream ${s} received error:`,P);const F=P.status;let $=function(I){const O=dn[I];if(O!==void 0)return yI(O)}(F),k=P.message;$===void 0&&($=Ae.INTERNAL,k="Unknown error status: "+F+" with message "+P.message),m=!0,w.__(new We($,k)),h.close()}else tt(Zn,`RPC '${e}' stream ${s} received:`,b),w.a_(b)}}),_(l,IT.STAT_EVENT,T=>{T.stat===H2.PROXY?tt(Zn,`RPC '${e}' stream ${s} detected buffering proxy`):T.stat===H2.NOPROXY&&tt(Zn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{w.o_()},0),w}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(r=>r===e)}}function rv(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kx(t){return new DV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b5{constructor(e,r,n=1e3,s=1.5,i=6e4){this.Fi=e,this.timerId=r,this.d_=n,this.E_=s,this.A_=i,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const r=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),s=Math.max(0,r-n);s>0&&tt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.R_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,s,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L4="PersistentStream";class PI{constructor(e,r,n,s,i,o,l,c){this.Fi=e,this.w_=n,this.S_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new b5(e,r)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():r&&r.code===Ae.RESOURCE_EXHAUSTED?(ul(r.toString()),ul("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):r&&r.code===Ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(r)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),r=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.b_===r&&this.W_(n,s)},n=>{e(()=>{const s=new We(Ae.UNKNOWN,"Fetching auth token failed: "+n.message);return this.G_(s)})})}W_(e,r){const n=this.K_(this.b_);this.stream=this.z_(e,r),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(s=>{n(()=>this.G_(s))}),this.stream.onMessage(s=>{n(()=>++this.C_==1?this.j_(s):this.onNext(s))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return tt(L4,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return r=>{this.Fi.enqueueAndForget(()=>this.b_===e?r():(tt(L4,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class CB extends PI{constructor(e,r,n,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}z_(e,r){return this.connection.P_("Listen",e,r)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const r=FV(this.serializer,e),n=function(i){if(!("targetChange"in i))return Nt.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Nt.min():o.readTime?bi(o.readTime):Nt.min()}(e);return this.listener.J_(r,n)}H_(e){const r={};r.database=tb(this.serializer),r.addTarget=function(i,o){let l;const c=o.target;if(l=J2(c)?{documents:BV(i,c)}:{query:UV(i,c).Vt},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=bI(i,o.resumeToken);const u=Z2(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(Nt.min())>0){l.readTime=_y(i,o.snapshotVersion.toTimestamp());const u=Z2(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const n=qV(this.serializer,e);n&&(r.labels=n),this.k_(r)}Y_(e){const r={};r.database=tb(this.serializer),r.removeTarget=e,this.k_(r)}}class PB extends PI{constructor(e,r,n,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,r){return this.connection.P_("Write",e,r)}j_(e){return Kt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Kt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Kt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const r=VV(e.writeResults,e.commitTime),n=bi(e.commitTime);return this.listener.ta(n,r)}na(){const e={};e.database=tb(this.serializer),this.k_(e)}X_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>jI(this.serializer,n))};this.k_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RB{}class DB extends RB{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.ra=!1}ia(){if(this.ra)throw new We(Ae.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,r,n,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Wo(e,eb(r,n),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new We(Ae.UNKNOWN,i.toString())})}Jo(e,r,n,s,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Jo(e,eb(r,n),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new We(Ae.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class LB{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(ul(r),this._a=!1):tt("OnlineStateTracker",r)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ld="RemoteStore";class OB{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=i,this.Ea.xo(o=>{n.enqueueAndForget(async()=>{gd(this)&&(tt(ld,"Restarting streams for network reachability change."),await async function(c){const u=Ct(c);u.Ia.add(4),await Fp(u),u.Aa.set("Unknown"),u.Ia.delete(4),await Tx(u)}(this))})}),this.Aa=new LB(n,s)}}async function Tx(t){if(gd(t))for(const e of t.da)await e(!0)}async function Fp(t){for(const e of t.da)await e(!1)}function RI(t,e){const r=Ct(t);r.Ta.has(e.targetId)||(r.Ta.set(e.targetId,e),j5(r)?_5(r):xf(r).x_()&&N5(r,e))}function w5(t,e){const r=Ct(t),n=xf(r);r.Ta.delete(e),n.x_()&&DI(r,e),r.Ta.size===0&&(n.x_()?n.B_():gd(r)&&r.Aa.set("Unknown"))}function N5(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Nt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}xf(t).H_(e)}function DI(t,e){t.Ra.$e(e),xf(t).Y_(e)}function _5(t){t.Ra=new IV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),xf(t).start(),t.Aa.aa()}function j5(t){return gd(t)&&!xf(t).M_()&&t.Ta.size>0}function gd(t){return Ct(t).Ia.size===0}function LI(t){t.Ra=void 0}async function MB(t){t.Aa.set("Online")}async function FB(t){t.Ta.forEach((e,r)=>{N5(t,e)})}async function VB(t,e){LI(t),j5(t)?(t.Aa.la(e),_5(t)):t.Aa.set("Unknown")}async function BB(t,e,r){if(t.Aa.set("Online"),e instanceof vI&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.Ta.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Ta.delete(l),s.Ra.removeTarget(l))}(t,e)}catch(n){tt(ld,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Ay(t,n)}else if(e instanceof j0?t.Ra.Ye(e):e instanceof xI?t.Ra.it(e):t.Ra.et(e),!r.isEqual(Nt.min()))try{const n=await CI(t.localStore);r.compareTo(n)>=0&&await function(i,o){const l=i.Ra.Pt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.Ta.get(u);d&&i.Ta.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=i.Ta.get(c);if(!d)return;i.Ta.set(c,d.withResumeToken(Wn.EMPTY_BYTE_STRING,d.snapshotVersion)),DI(i,c);const h=new gc(d.target,c,u,d.sequenceNumber);N5(i,h)}),i.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){tt(ld,"Failed to raise snapshot:",n),await Ay(t,n)}}async function Ay(t,e,r){if(!gf(e))throw e;t.Ia.add(1),await Fp(t),t.Aa.set("Offline"),r||(r=()=>CI(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{tt(ld,"Retrying IndexedDB access"),await r(),t.Ia.delete(1),await Tx(t)})}function OI(t,e){return e().catch(r=>Ay(t,r,e))}async function Ix(t){const e=Ct(t),r=Wc(e);let n=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:a5;for(;UB(e);)try{const s=await NB(e.localStore,n);if(s===null){e.Pa.length===0&&r.B_();break}n=s.batchId,zB(e,s)}catch(s){await Ay(e,s)}MI(e)&&FI(e)}function UB(t){return gd(t)&&t.Pa.length<10}function zB(t,e){t.Pa.push(e);const r=Wc(t);r.x_()&&r.Z_&&r.X_(e.mutations)}function MI(t){return gd(t)&&!Wc(t).M_()&&t.Pa.length>0}function FI(t){Wc(t).start()}async function qB(t){Wc(t).na()}async function $B(t){const e=Wc(t);for(const r of t.Pa)e.X_(r.mutations)}async function WB(t,e,r){const n=t.Pa.shift(),s=f5.from(n,e,r);await OI(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Ix(t)}async function HB(t,e){e&&Wc(t).Z_&&await async function(n,s){if(function(o){return gI(o)&&o!==Ae.ABORTED}(s.code)){const i=n.Pa.shift();Wc(n).N_(),await OI(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Ix(n)}}(t,e),MI(t)&&FI(t)}async function O4(t,e){const r=Ct(t);r.asyncQueue.verifyOperationInProgress(),tt(ld,"RemoteStore received new credentials");const n=gd(r);r.Ia.add(3),await Fp(r),n&&r.Aa.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ia.delete(3),await Tx(r)}async function GB(t,e){const r=Ct(t);e?(r.Ia.delete(2),await Tx(r)):e||(r.Ia.add(2),await Fp(r),r.Aa.set("Unknown"))}function xf(t){return t.Va||(t.Va=function(r,n,s){const i=Ct(r);return i.ia(),new CB(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:MB.bind(null,t),e_:FB.bind(null,t),n_:VB.bind(null,t),J_:BB.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),j5(t)?_5(t):t.Aa.set("Unknown")):(await t.Va.stop(),LI(t))})),t.Va}function Wc(t){return t.ma||(t.ma=function(r,n,s){const i=Ct(r);return i.ia(),new PB(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:qB.bind(null,t),n_:HB.bind(null,t),ea:$B.bind(null,t),ta:WB.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await Ix(t)):(await t.ma.stop(),t.Pa.length>0&&(tt(ld,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S5{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new oo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const o=Date.now()+n,l=new S5(e,r,o,s,i);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new We(Ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function A5(t,e){if(ul("AsyncQueue",`${e}: ${t}`),gf(t))return new We(Ae.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{static emptySet(e){return new Rh(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||ct.comparator(r.key,n.key):(r,n)=>ct.comparator(r.key,n.key),this.keyedMap=um(),this.sortedSet=new zr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Rh)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Rh;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(){this.fa=new zr(ct.comparator)}track(e){const r=e.doc.key,n=this.fa.get(r);n?e.type!==0&&n.type===3?this.fa=this.fa.insert(r,e):e.type===3&&n.type!==1?this.fa=this.fa.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.fa=this.fa.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.fa=this.fa.remove(r):e.type===1&&n.type===2?this.fa=this.fa.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):mt(63341,{At:e,ga:n}):this.fa=this.fa.insert(r,e)}pa(){const e=[];return this.fa.inorderTraversal((r,n)=>{e.push(n)}),e}}class rf{constructor(e,r,n,s,i,o,l,c,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,s,i){const o=[];return r.forEach(l=>{o.push({type:0,doc:l})}),new rf(e,r,Rh.emptySet(r),o,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&_x(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KB{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class YB{constructor(){this.queries=F4(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(r,n){const s=Ct(r),i=s.queries;s.queries=F4(),i.forEach((o,l)=>{for(const c of l.wa)c.onError(n)})})(this,new We(Ae.ABORTED,"Firestore shutting down"))}}function F4(){return new pd(t=>rI(t),_x)}async function E5(t,e){const r=Ct(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.Sa()&&e.ba()&&(n=2):(i=new KB,n=e.ba()?0:1);try{switch(n){case 0:i.ya=await r.onListen(s,!0);break;case 1:i.ya=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(o){const l=A5(o,`Initialization of query '${Zd(e.query)}' failed`);return void e.onError(l)}r.queries.set(s,i),i.wa.push(e),e.va(r.onlineState),i.ya&&e.Ca(i.ya)&&T5(r)}async function k5(t,e){const r=Ct(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const o=i.wa.indexOf(e);o>=0&&(i.wa.splice(o,1),i.wa.length===0?s=e.ba()?0:1:!i.Sa()&&e.ba()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function QB(t,e){const r=Ct(t);let n=!1;for(const s of e){const i=s.query,o=r.queries.get(i);if(o){for(const l of o.wa)l.Ca(s)&&(n=!0);o.ya=s}}n&&T5(r)}function JB(t,e,r){const n=Ct(t),s=n.queries.get(e);if(s)for(const i of s.wa)i.onError(r);n.queries.delete(e)}function T5(t){t.Da.forEach(e=>{e.next()})}var sb,V4;(V4=sb||(sb={})).Fa="default",V4.Cache="cache";class I5{constructor(e,r,n){this.query=e,this.Ma=r,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new rf(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),r=!0):this.Ba(e,this.onlineState)&&(this.La(e),r=!0),this.Oa=e,r}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let r=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),r=!0),r}Ba(e,r){if(!e.fromCache||!this.ba())return!0;const n=r!=="Offline";return(!this.options.ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const r=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}La(e){e=rf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==sb.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e){this.key=e}}class BI{constructor(e){this.key=e}}class XB{constructor(e,r){this.query=e,this.Ha=r,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Ht(),this.mutatedKeys=Ht(),this.Xa=nI(e),this.eu=new Rh(this.Xa)}get tu(){return this.Ha}nu(e,r){const n=r?r.ru:new M4,s=r?r.eu:this.eu;let i=r?r.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,h)=>{const g=s.get(d),m=jx(this.query,h)?h:null,w=!!g&&this.mutatedKeys.has(g.key),_=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let T=!1;g&&m?g.data.isEqual(m.data)?w!==_&&(n.track({type:3,doc:m}),T=!0):this.iu(g,m)||(n.track({type:2,doc:m}),T=!0,(c&&this.Xa(m,c)>0||u&&this.Xa(m,u)<0)&&(l=!0)):!g&&m?(n.track({type:0,doc:m}),T=!0):g&&!m&&(n.track({type:1,doc:g}),T=!0,(c||u)&&(l=!0)),T&&(m?(o=o.add(m),i=_?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),n.track({type:1,doc:d})}return{eu:o,ru:n,Ds:l,mutatedKeys:i}}iu(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const o=e.ru.pa();o.sort((d,h)=>function(m,w){const _=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return mt(20277,{At:T})}};return _(m)-_(w)}(d.type,h.type)||this.Xa(d.doc,h.doc)),this.su(n),s=s!=null&&s;const l=r&&!s?this.ou():[],c=this.Za.size===0&&this.current&&!s?1:0,u=c!==this.Ya;return this.Ya=c,o.length!==0||u?{snapshot:new rf(this.query,e.eu,i,o,e.mutatedKeys,c===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:l}:{_u:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new M4,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(r=>this.Ha=this.Ha.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ha=this.Ha.delete(r)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=Ht(),this.eu.forEach(n=>{this.au(n.key)&&(this.Za=this.Za.add(n.key))});const r=[];return e.forEach(n=>{this.Za.has(n)||r.push(new BI(n))}),this.Za.forEach(n=>{e.has(n)||r.push(new VI(n))}),r}uu(e){this.Ha=e.qs,this.Za=Ht();const r=this.nu(e.documents);return this.applyChanges(r,!0)}cu(){return rf.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const C5="SyncEngine";class ZB{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class eU{constructor(e){this.key=e,this.lu=!1}}class tU{constructor(e,r,n,s,i,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new pd(l=>rI(l),_x),this.Tu=new Map,this.Iu=new Set,this.du=new zr(ct.comparator),this.Eu=new Map,this.Au=new g5,this.Ru={},this.Vu=new Map,this.mu=tf.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function rU(t,e,r=!0){const n=HI(t);let s;const i=n.Pu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.cu()):s=await UI(n,e,r,!0),s}async function nU(t,e){const r=HI(t);await UI(r,e,!0,!1)}async function UI(t,e,r,n){const s=await _B(t.localStore,lo(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,r);let l;return n&&(l=await sU(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&r&&RI(t.remoteStore,s),l}async function sU(t,e,r,n,s){t.gu=(h,g,m)=>async function(_,T,v,b){let x=T.view.nu(v);x.Ds&&(x=await C4(_.localStore,T.query,!1).then(({documents:k})=>T.view.nu(k,x)));const P=b&&b.targetChanges.get(T.targetId),F=b&&b.targetMismatches.get(T.targetId)!=null,$=T.view.applyChanges(x,_.isPrimaryClient,P,F);return U4(_,T.targetId,$._u),$.snapshot}(t,h,g,m);const i=await C4(t.localStore,e,!0),o=new XB(e,i.qs),l=o.nu(i.documents),c=Mp.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);U4(t,r,u._u);const d=new ZB(e,r,o);return t.Pu.set(e,d),t.Tu.has(r)?t.Tu.get(r).push(e):t.Tu.set(r,[e]),u.snapshot}async function iU(t,e,r){const n=Ct(t),s=n.Pu.get(e),i=n.Tu.get(s.targetId);if(i.length>1)return n.Tu.set(s.targetId,i.filter(o=>!_x(o,e))),void n.Pu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await rb(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&w5(n.remoteStore,s.targetId),ib(n,s.targetId)}).catch(pf)):(ib(n,s.targetId),await rb(n.localStore,s.targetId,!0))}async function aU(t,e){const r=Ct(t),n=r.Pu.get(e),s=r.Tu.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),w5(r.remoteStore,n.targetId))}async function oU(t,e,r){const n=mU(t);try{const s=await function(o,l){const c=Ct(o),u=yt.now(),d=l.reduce((m,w)=>m.add(w.key),Ht());let h,g;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let w=dl(),_=Ht();return c.Os.getEntries(m,d).next(T=>{w=T,w.forEach((v,b)=>{b.isValidDocument()||(_=_.add(v))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,w)).next(T=>{h=T;const v=[];for(const b of l){const x=SV(b,h.get(b.key).overlayedDocument);x!=null&&v.push(new su(b.key,x,KT(x.value.mapValue),pn.exists(!0)))}return c.mutationQueue.addMutationBatch(m,u,v,l)}).next(T=>{g=T;const v=T.applyToLocalDocumentSet(h,_);return c.documentOverlayCache.saveOverlays(m,T.batchId,v)})}).then(()=>({batchId:g.batchId,changes:iI(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.Ru[o.currentUser.toKey()];u||(u=new zr(Bt)),u=u.insert(l,c),o.Ru[o.currentUser.toKey()]=u}(n,s.batchId,r),await Vp(n,s.changes),await Ix(n.remoteStore)}catch(s){const i=A5(s,"Failed to persist write");r.reject(i)}}async function zI(t,e){const r=Ct(t);try{const n=await bB(r.localStore,e);e.targetChanges.forEach((s,i)=>{const o=r.Eu.get(i);o&&(Kt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.lu=!0:s.modifiedDocuments.size>0?Kt(o.lu,14607):s.removedDocuments.size>0&&(Kt(o.lu,42227),o.lu=!1))}),await Vp(r,n,e)}catch(n){await pf(n)}}function B4(t,e,r){const n=Ct(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Pu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=Ct(o);c.onlineState=l;let u=!1;c.queries.forEach((d,h)=>{for(const g of h.wa)g.va(l)&&(u=!0)}),u&&T5(c)}(n.eventManager,e),s.length&&n.hu.J_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function lU(t,e,r){const n=Ct(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Eu.get(e),i=s&&s.key;if(i){let o=new zr(ct.comparator);o=o.insert(i,Cn.newNoDocument(i,Nt.min()));const l=Ht().add(i),c=new Ex(Nt.min(),new Map,new zr(Bt),o,l);await zI(n,c),n.du=n.du.remove(i),n.Eu.delete(e),P5(n)}else await rb(n.localStore,e,!1).then(()=>ib(n,e,r)).catch(pf)}async function cU(t,e){const r=Ct(t),n=e.batch.batchId;try{const s=await vB(r.localStore,e);$I(r,n,null),qI(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Vp(r,s)}catch(s){await pf(s)}}async function uU(t,e,r){const n=Ct(t);try{const s=await function(o,l){const c=Ct(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(h=>(Kt(h!==null,37113),d=h.keys(),c.mutationQueue.removeMutationBatch(u,h))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(n.localStore,e);$I(n,e,r),qI(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Vp(n,s)}catch(s){await pf(s)}}function qI(t,e){(t.Vu.get(e)||[]).forEach(r=>{r.resolve()}),t.Vu.delete(e)}function $I(t,e,r){const n=Ct(t);let s=n.Ru[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Ru[n.currentUser.toKey()]=s}}function ib(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Tu.get(e))t.Pu.delete(n),r&&t.hu.pu(n,r);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(n=>{t.Au.containsKey(n)||WI(t,n)})}function WI(t,e){t.Iu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(w5(t.remoteStore,r),t.du=t.du.remove(e),t.Eu.delete(r),P5(t))}function U4(t,e,r){for(const n of r)n instanceof VI?(t.Au.addReference(n.key,e),dU(t,n)):n instanceof BI?(tt(C5,"Document no longer in limbo: "+n.key),t.Au.removeReference(n.key,e),t.Au.containsKey(n.key)||WI(t,n.key)):mt(19791,{yu:n})}function dU(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Iu.has(n)||(tt(C5,"New document in limbo: "+r),t.Iu.add(n),P5(t))}function P5(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const r=new ct(hr.fromString(e)),n=t.mu.next();t.Eu.set(n,new eU(r)),t.du=t.du.insert(r,n),RI(t.remoteStore,new gc(lo(Nx(r.path)),n,"TargetPurposeLimboResolution",bx.ue))}}async function Vp(t,e,r){const n=Ct(t),s=[],i=[],o=[];n.Pu.isEmpty()||(n.Pu.forEach((l,c)=>{o.push(n.gu(c,e,r).then(u=>{var d;if((u||r)&&n.isPrimaryClient){const h=u?!u.fromCache:(d=r==null?void 0:r.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){s.push(u);const h=x5.Es(c.targetId,u);i.push(h)}}))}),await Promise.all(o),n.hu.J_(s),await async function(c,u){const d=Ct(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>Pe.forEach(u,g=>Pe.forEach(g.Is,m=>d.persistence.referenceDelegate.addReference(h,g.targetId,m)).next(()=>Pe.forEach(g.ds,m=>d.persistence.referenceDelegate.removeReference(h,g.targetId,m)))))}catch(h){if(!gf(h))throw h;tt(v5,"Failed to update sequence numbers: "+h)}for(const h of u){const g=h.targetId;if(!h.fromCache){const m=d.Fs.get(g),w=m.snapshotVersion,_=m.withLastLimboFreeSnapshotVersion(w);d.Fs=d.Fs.insert(g,_)}}}(n.localStore,i))}async function hU(t,e){const r=Ct(t);if(!r.currentUser.isEqual(e)){tt(C5,"User change. New user:",e.toKey());const n=await II(r.localStore,e);r.currentUser=e,function(i,o){i.Vu.forEach(l=>{l.forEach(c=>{c.reject(new We(Ae.CANCELLED,o))})}),i.Vu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Vp(r,n.Bs)}}function fU(t,e){const r=Ct(t),n=r.Eu.get(e);if(n&&n.lu)return Ht().add(n.key);{let s=Ht();const i=r.Tu.get(e);if(!i)return s;for(const o of i){const l=r.Pu.get(o);s=s.unionWith(l.view.tu)}return s}}function HI(t){const e=Ct(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=zI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=fU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=lU.bind(null,e),e.hu.J_=QB.bind(null,e.eventManager),e.hu.pu=JB.bind(null,e.eventManager),e}function mU(t){const e=Ct(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=cU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=uU.bind(null,e),e}class Ey{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=kx(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,r){return null}Fu(e,r){return null}vu(e){return xB(this.persistence,new pB,e.initialUser,this.serializer)}Du(e){return new TI(y5.Vi,this.serializer)}bu(e){return new SB}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ey.provider={build:()=>new Ey};class pU extends Ey{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,r){Kt(this.persistence.referenceDelegate instanceof Sy,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new eB(n,e.asyncQueue,r)}Du(e){const r=this.cacheSizeBytes!==void 0?zs.withCacheSize(this.cacheSizeBytes):zs.DEFAULT;return new TI(n=>Sy.Vi(n,r),this.serializer)}}class ab{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>B4(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=hU.bind(null,this.syncEngine),await GB(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new YB}()}createDatastore(e){const r=kx(e.databaseInfo.databaseId),n=function(i){return new IB(i)}(e.databaseInfo);return function(i,o,l,c){return new DB(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,o,l){return new OB(n,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,r=>B4(this.syncEngine,r,0),function(){return D4.C()?new D4:new AB}())}createSyncEngine(e,r){return function(s,i,o,l,c,u,d){const h=new tU(s,i,o,l,c,u);return d&&(h.fu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=Ct(s);tt(ld,"RemoteStore shutting down."),i.Ia.add(5),await Fp(i),i.Ea.shutdown(),i.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}ab.provider={build:()=>new ab};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R5{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ul("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gU{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new We(Ae.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const r=await async function(s,i){const o=Ct(s),l={documents:i.map(h=>jy(o.serializer,h))},c=await o.Jo("BatchGetDocuments",o.serializer.databaseId,hr.emptyPath(),l,i.length),u=new Map;c.forEach(h=>{const g=MV(o.serializer,h);u.set(g.key.toString(),g)});const d=[];return i.forEach(h=>{const g=u.get(h.toString());Kt(!!g,55234,{key:h}),d.push(g)}),d}(this.datastore,e);return r.forEach(n=>this.recordVersion(n)),r}set(e,r){this.write(r.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,r){try{this.write(r.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new Op(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(r=>{e.delete(r.key.toString())}),e.forEach((r,n)=>{const s=ct.fromPath(n);this.mutations.push(new pI(s,this.precondition(s)))}),await async function(n,s){const i=Ct(n),o={writes:s.map(l=>jI(i.serializer,l))};await i.Wo("Commit",i.serializer.databaseId,hr.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let r;if(e.isFoundDocument())r=e.version;else{if(!e.isNoDocument())throw mt(50498,{Wu:e.constructor.name});r=Nt.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!r.isEqual(n))throw new We(Ae.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),r)}precondition(e){const r=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&r?r.isEqual(Nt.min())?pn.exists(!1):pn.updateTime(r):pn.none()}preconditionForUpdate(e){const r=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&r){if(r.isEqual(Nt.min()))throw new We(Ae.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return pn.updateTime(r)}return pn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yU{constructor(e,r,n,s,i){this.asyncQueue=e,this.datastore=r,this.options=n,this.updateFunction=s,this.deferred=i,this.Gu=n.maxAttempts,this.F_=new b5(this.asyncQueue,"transaction_retry")}zu(){this.Gu-=1,this.ju()}ju(){this.F_.g_(async()=>{const e=new gU(this.datastore),r=this.Ju(e);r&&r.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(s=>{this.Hu(s)}))}).catch(n=>{this.Hu(n)})})}Ju(e){try{const r=this.updateFunction(e);return!Dp(r)&&r.catch&&r.then?r:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.deferred.reject(r),null}}Hu(e){this.Gu>0&&this.Yu(e)?(this.Gu-=1,this.asyncQueue.enqueueAndForget(()=>(this.ju(),Promise.resolve()))):this.deferred.reject(e)}Yu(e){if(e.name==="FirebaseError"){const r=e.code;return r==="aborted"||r==="failed-precondition"||r==="already-exists"||!gI(r)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hc="FirestoreClient";class xU{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=is.UNAUTHENTICATED,this.clientId=i5.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async o=>{tt(Hc,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(tt(Hc,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new oo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=A5(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function nv(t,e){t.asyncQueue.verifyOperationInProgress(),tt(Hc,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await II(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>{Bc("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{tt("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(s=>{Bc("Terminating Firestore due to IndexedDb database deletion failed",s)})}),t._offlineComponents=e}async function z4(t,e){t.asyncQueue.verifyOperationInProgress();const r=await vU(t);tt(Hc,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>O4(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>O4(e.remoteStore,s)),t._onlineComponents=e}async function vU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){tt(Hc,"Using user provided OfflineComponentProvider");try{await nv(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===Ae.FAILED_PRECONDITION||s.code===Ae.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;Bc("Error using user provided cache. Falling back to memory cache: "+r),await nv(t,new Ey)}}else tt(Hc,"Using default OfflineComponentProvider"),await nv(t,new pU(void 0));return t._offlineComponents}async function D5(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(tt(Hc,"Using user provided OnlineComponentProvider"),await z4(t,t._uninitializedComponentsProvider._online)):(tt(Hc,"Using default OnlineComponentProvider"),await z4(t,new ab))),t._onlineComponents}function bU(t){return D5(t).then(e=>e.syncEngine)}function wU(t){return D5(t).then(e=>e.datastore)}async function ky(t){const e=await D5(t),r=e.eventManager;return r.onListen=rU.bind(null,e.syncEngine),r.onUnlisten=iU.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=nU.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=aU.bind(null,e.syncEngine),r}function NU(t,e,r={}){const n=new oo;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new R5({next:g=>{d.Ou(),o.enqueueAndForget(()=>k5(i,h));const m=g.docs.has(l);!m&&g.fromCache?u.reject(new We(Ae.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&g.fromCache&&c&&c.source==="server"?u.reject(new We(Ae.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),h=new I5(Nx(l.path),d,{includeMetadataChanges:!0,ka:!0});return E5(i,h)}(await ky(t),t.asyncQueue,e,r,n)),n.promise}function _U(t,e,r={}){const n=new oo;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new R5({next:g=>{d.Ou(),o.enqueueAndForget(()=>k5(i,h)),g.fromCache&&c.source==="server"?u.reject(new We(Ae.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),h=new I5(l,d,{includeMetadataChanges:!0,ka:!0});return E5(i,h)}(await ky(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GI(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q4=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KI="firestore.googleapis.com",$4=!0;class W4{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new We(Ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=KI,this.ssl=$4}else this.host=e.host,this.ssl=(r=e.ssl)!==null&&r!==void 0?r:$4;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=kI;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<XV)throw new We(Ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}B9("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=GI((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new We(Ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new We(Ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new We(Ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Cx{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new W4({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new We(Ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new We(Ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new W4(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new C9;switch(n.type){case"firstParty":return new L9(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new We(Ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=q4.get(r);n&&(tt("ComponentProvider","Removing Datastore"),q4.delete(r),n.terminate())}(this),Promise.resolve()}}function jU(t,e,r,n={}){var s;t=us(t,Cx);const i=ru(e),o=t._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),c=`${e}:${r}`;i&&(Uw(`https://${c}`),zw("Firestore",!0)),o.host!==KI&&o.host!==c&&Bc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=Object.assign(Object.assign({},o),{host:c,ssl:i,emulatorOptions:n});if(!Fc(u,l)&&(t._setSettings(u),n.mockUserToken)){let d,h;if(typeof n.mockUserToken=="string")d=n.mockUserToken,h=is.MOCK_USER;else{d=Bk(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const g=n.mockUserToken.sub||n.mockUserToken.user_id;if(!g)throw new We(Ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new is(g)}t._authCredentials=new P9(new DT(d,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Nl(this.firestore,e,this._query)}}class Fr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Cc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Fr(this.firestore,e,this._key)}toJSON(){return{type:Fr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Rp(r,Fr._jsonSchema))return new Fr(e,n||null,new ct(hr.fromString(r.referencePath)))}}Fr._jsonSchemaVersion="firestore/documentReference/1.0",Fr._jsonSchema={type:gn("string",Fr._jsonSchemaVersion),referencePath:gn("string")};class Cc extends Nl{constructor(e,r,n){super(e,r,Nx(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Fr(this.firestore,null,new ct(e))}withConverter(e){return new Cc(this.firestore,e,this._path)}}function Be(t,e,...r){if(t=fr(t),OT("collection","path",e),t instanceof Cx){const n=hr.fromString(e,...r);return s4(n),new Cc(t,null,n)}{if(!(t instanceof Fr||t instanceof Cc))throw new We(Ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(hr.fromString(e,...r));return s4(n),new Cc(t.firestore,null,n)}}function ot(t,e,...r){if(t=fr(t),arguments.length===1&&(e=i5.newId()),OT("doc","path",e),t instanceof Cx){const n=hr.fromString(e,...r);return n4(n),new Fr(t,null,new ct(n))}{if(!(t instanceof Fr||t instanceof Cc))throw new We(Ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(hr.fromString(e,...r));return n4(n),new Fr(t.firestore,t instanceof Cc?t.converter:null,new ct(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H4="AsyncQueue";class G4{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new b5(this,"async_queue_retry"),this.oc=()=>{const n=rv();n&&tt(H4,"Visibility state changed to "+n.visibilityState),this.F_.y_()},this._c=e;const r=rv();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const r=rv();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const r=new oo;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!gf(e))throw e;tt(H4,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const r=this._c.then(()=>(this.nc=!0,e().catch(n=>{throw this.tc=n,this.nc=!1,ul("INTERNAL UNHANDLED ERROR: ",K4(n)),n}).then(n=>(this.nc=!1,n))));return this._c=r,r}enqueueAfterDelay(e,r,n){this.ac(),this.sc.indexOf(e)>-1&&(r=0);const s=S5.createAndSchedule(this,e,r,n,i=>this.lc(i));return this.ec.push(s),s}ac(){this.tc&&mt(47125,{hc:K4(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const r of this.ec)if(r.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.ec)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const r=this.ec.indexOf(e);this.ec.splice(r,1)}}function K4(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y4(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const i of n)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Ta extends Cx{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new G4,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new G4(e),this._firestoreClient=void 0,await e}}}function SU(t,e){const r=typeof t=="object"?t:Ww(),n=typeof t=="string"?t:e||vy,s=px(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=Mk("firestore");i&&jU(s,...i)}return s}function vf(t){if(t._terminated)throw new We(Ae.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||AU(t),t._firestoreClient}function AU(t){var e,r,n;const s=t._freezeSettings(),i=function(l,c,u,d){return new X9(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,GI(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new xU(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new mi(Wn.fromBase64String(e))}catch(r){throw new We(Ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new mi(Wn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:mi._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Rp(e,mi._jsonSchema))return mi.fromBase64String(e.bytes)}}mi._jsonSchemaVersion="firestore/bytes/1.0",mi._jsonSchema={type:gn("string",mi._jsonSchemaVersion),bytes:gn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new We(Ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Vn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new We(Ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new We(Ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Bt(this._lat,e._lat)||Bt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:co._jsonSchemaVersion}}static fromJSON(e){if(Rp(e,co._jsonSchema))return new co(e.latitude,e.longitude)}}co._jsonSchemaVersion="firestore/geoPoint/1.0",co._jsonSchema={type:gn("string",co._jsonSchemaVersion),latitude:gn("number"),longitude:gn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:uo._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Rp(e,uo._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new uo(e.vectorValues);throw new We(Ae.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}uo._jsonSchemaVersion="firestore/vectorValue/1.0",uo._jsonSchema={type:gn("string",uo._jsonSchemaVersion),vectorValues:gn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EU=/^__.*__$/;class kU{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new su(e,this.data,this.fieldMask,r,this.fieldTransforms):new Lp(e,this.data,r,this.fieldTransforms)}}class YI{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new su(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function QI(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw mt(40011,{Ec:t})}}class Px{constructor(e,r,n,s,i,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.Ac(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Px(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Rc({path:n,mc:!1});return s.fc(e),s}gc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Rc({path:n,mc:!1});return s.Ac(),s}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Ty(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(QI(this.Ec)&&EU.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class TU{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||kx(e)}Dc(e,r,n,s=!1){return new Px({Ec:e,methodName:r,bc:n,path:Vn.emptyPath(),mc:!1,Sc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Nf(t){const e=t._freezeSettings(),r=kx(t._databaseId);return new TU(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Rx(t,e,r,n,s,i={}){const o=t.Dc(i.merge||i.mergeFields?2:0,e,r,s);B5("Data must be an object, but it was:",o,n);const l=JI(n,o);let c,u;if(i.merge)c=new gi(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const h of i.mergeFields){const g=ob(e,h,r);if(!o.contains(g))throw new We(Ae.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);ZI(d,g)||d.push(g)}c=new gi(d),u=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=o.fieldTransforms;return new kU(new As(l),c,u)}class Dx extends wf{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Dx}}function IU(t,e,r){return new Px({Ec:3,bc:e.settings.bc,methodName:t._methodName,mc:r},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class L5 extends wf{_toFieldTransform(e){return new h5(e.path,new hp)}isEqual(e){return e instanceof L5}}class O5 extends wf{constructor(e,r){super(e),this.vc=r}_toFieldTransform(e){const r=IU(this,e,!0),n=this.vc.map(i=>_f(i,r)),s=new ef(n);return new h5(e.path,s)}isEqual(e){return e instanceof O5&&Fc(this.vc,e.vc)}}class M5 extends wf{constructor(e,r){super(e),this.Cc=r}_toFieldTransform(e){const r=new mp(e.serializer,lI(e.serializer,this.Cc));return new h5(e.path,r)}isEqual(e){return e instanceof M5&&this.Cc===e.Cc}}function F5(t,e,r,n){const s=t.Dc(1,e,r);B5("Data must be an object, but it was:",s,n);const i=[],o=As.empty();nu(n,(c,u)=>{const d=U5(e,c,r);u=fr(u);const h=s.gc(d);if(u instanceof Dx)i.push(d);else{const g=_f(u,h);g!=null&&(i.push(d),o.set(d,g))}});const l=new gi(i);return new YI(o,l,s.fieldTransforms)}function V5(t,e,r,n,s,i){const o=t.Dc(1,e,r),l=[ob(e,n,r)],c=[s];if(i.length%2!=0)throw new We(Ae.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)l.push(ob(e,i[g])),c.push(i[g+1]);const u=[],d=As.empty();for(let g=l.length-1;g>=0;--g)if(!ZI(u,l[g])){const m=l[g];let w=c[g];w=fr(w);const _=o.gc(m);if(w instanceof Dx)u.push(m);else{const T=_f(w,_);T!=null&&(u.push(m),d.set(m,T))}}const h=new gi(u);return new YI(d,h,o.fieldTransforms)}function CU(t,e,r,n=!1){return _f(r,t.Dc(n?4:3,e))}function _f(t,e){if(XI(t=fr(t)))return B5("Unsupported field value:",e,t),JI(t,e);if(t instanceof wf)return function(n,s){if(!QI(s.Ec))throw s.wc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.wc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(n,s){const i=[];let o=0;for(const l of n){let c=_f(l,s.yc(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=fr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return lI(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=yt.fromDate(n);return{timestampValue:_y(s.serializer,i)}}if(n instanceof yt){const i=new yt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:_y(s.serializer,i)}}if(n instanceof co)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof mi)return{bytesValue:bI(s.serializer,n._byteString)};if(n instanceof Fr){const i=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw s.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:p5(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof uo)return function(o,l){return{mapValue:{fields:{[WT]:{stringValue:GT},[by]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.wc("VectorValues must only contain numeric values.");return d5(l.serializer,u)})}}}}}}(n,s);throw s.wc(`Unsupported field value: ${vx(n)}`)}(t,e)}function JI(t,e){const r={};return VT(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):nu(t,(n,s)=>{const i=_f(s,e.Vc(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function XI(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof yt||t instanceof co||t instanceof mi||t instanceof Fr||t instanceof wf||t instanceof uo)}function B5(t,e,r){if(!XI(r)||!MT(r)){const n=vx(r);throw n==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+n)}}function ob(t,e,r){if((e=fr(e))instanceof bf)return e._internalPath;if(typeof e=="string")return U5(t,e);throw Ty("Field path arguments must be of type string or ",t,!1,void 0,r)}const PU=new RegExp("[~\\*/\\[\\]]");function U5(t,e,r){if(e.search(PU)>=0)throw Ty(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new bf(...e.split("."))._internalPath}catch{throw Ty(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Ty(t,e,r,n,s){const i=n&&!n.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${n}`),o&&(c+=` in document ${s}`),c+=")"),new We(Ae.INVALID_ARGUMENT,l+t+c)}function ZI(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iy{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Fr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new RU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Lx("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class RU extends Iy{data(){return super.data()}}function Lx(t,e){return typeof e=="string"?U5(t,e):e instanceof bf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eC(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new We(Ae.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class z5{}class q5 extends z5{}function qe(t,e,...r){let n=[];e instanceof z5&&n.push(e),n=n.concat(r),function(i){const o=i.filter(c=>c instanceof $5).length,l=i.filter(c=>c instanceof Ox).length;if(o>1||o>0&&l>0)throw new We(Ae.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class Ox extends q5{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Ox(e,r,n)}_apply(e){const r=this._parse(e);return tC(e._query,r),new Nl(e.firestore,e.converter,X2(e._query,r))}_parse(e){const r=Nf(e.firestore);return function(i,o,l,c,u,d,h){let g;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new We(Ae.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){J4(h,d);const w=[];for(const _ of h)w.push(Q4(c,i,_));g={arrayValue:{values:w}}}else g=Q4(c,i,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||J4(h,d),g=CU(l,o,h,d==="in"||d==="not-in");return mn.create(u,d,g)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Je(t,e,r){const n=e,s=Lx("where",t);return Ox._create(s,n,r)}class $5 extends z5{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new $5(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:ka.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)tC(o,c),o=X2(o,c)}(e._query,r),new Nl(e.firestore,e.converter,X2(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class W5 extends q5{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new W5(e,r)}_apply(e){const r=function(s,i,o){if(s.startAt!==null)throw new We(Ae.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new We(Ae.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new dp(i,o)}(e._query,this._field,this._direction);return new Nl(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new yf(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function Vt(t,e="asc"){const r=e,n=Lx("orderBy",t);return W5._create(n,r)}class H5 extends q5{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new H5(e,r,n)}_apply(e){return new Nl(e.firestore,e.converter,Ny(e._query,this._limit,this._limitType))}}function DU(t){return U9("limit",t),H5._create("limit",t,"F")}function Q4(t,e,r){if(typeof(r=fr(r))=="string"){if(r==="")throw new We(Ae.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!tI(e)&&r.indexOf("/")!==-1)throw new We(Ae.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(hr.fromString(r));if(!ct.isDocumentKey(n))throw new We(Ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return h4(t,new ct(n))}if(r instanceof Fr)return h4(t,r._key);throw new We(Ae.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${vx(r)}.`)}function J4(t,e){if(!Array.isArray(t)||t.length===0)throw new We(Ae.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function tC(t,e){const r=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new We(Ae.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new We(Ae.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class rC{convertValue(e,r="none"){switch($c(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(qc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw mt(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return nu(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var r,n,s;const i=(s=(n=(r=e.fields)===null||r===void 0?void 0:r[by].arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(o=>rn(o.doubleValue));return new uo(i)}convertGeoPoint(e){return new co(rn(e.latitude),rn(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=wx(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(lp(e));default:return null}}convertTimestamp(e){const r=zc(e);return new yt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=hr.fromString(e);Kt(EI(n),9688,{name:e});const s=new cp(n.get(1),n.get(3)),i=new ct(n.popFirst(5));return s.isEqual(r)||ul(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mx(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class LU extends rC{constructor(e){super(),this.firestore=e}convertBytes(e){return new mi(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Fr(this.firestore,null,r)}}class yh{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Pc extends Iy{constructor(e,r,n,s,i,o){super(e,r,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new S0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Lx("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new We(Ae.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Pc._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Pc._jsonSchemaVersion="firestore/documentSnapshot/1.0",Pc._jsonSchema={type:gn("string",Pc._jsonSchemaVersion),bundleSource:gn("string","DocumentSnapshot"),bundleName:gn("string"),bundle:gn("string")};class S0 extends Pc{data(e={}){return super.data(e)}}class Ku{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new yh(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new S0(this._firestore,this._userDataWriter,n.key,n,new yh(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new We(Ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new S0(s._firestore,s._userDataWriter,l.doc.key,l.doc,new yh(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new S0(s._firestore,s._userDataWriter,l.doc.key,l.doc,new yh(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:OU(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new We(Ae.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ku._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=i5.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function OU(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return mt(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function os(t){t=us(t,Fr);const e=us(t.firestore,Ta);return NU(vf(e),t._key).then(r=>nC(e,t,r))}Ku._jsonSchemaVersion="firestore/querySnapshot/1.0",Ku._jsonSchema={type:gn("string",Ku._jsonSchemaVersion),bundleSource:gn("string","QuerySnapshot"),bundleName:gn("string"),bundle:gn("string")};class Fx extends rC{constructor(e){super(),this.firestore=e}convertBytes(e){return new mi(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Fr(this.firestore,null,r)}}function st(t){t=us(t,Nl);const e=us(t.firestore,Ta),r=vf(e),n=new Fx(e);return eC(t._query),_U(r,t._query).then(s=>new Ku(e,n,t,s))}function xa(t,e,r){t=us(t,Fr);const n=us(t.firestore,Ta),s=Mx(t.converter,e,r);return Bp(n,[Rx(Nf(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,pn.none())])}function Qt(t,e,r,...n){t=us(t,Fr);const s=us(t.firestore,Ta),i=Nf(s);let o;return o=typeof(e=fr(e))=="string"||e instanceof bf?V5(i,"updateDoc",t._key,e,r,n):F5(i,"updateDoc",t._key,e),Bp(s,[o.toMutation(t._key,pn.exists(!0))])}function ba(t){return Bp(us(t.firestore,Ta),[new Op(t._key,pn.none())])}function xo(t,e){const r=us(t.firestore,Ta),n=ot(t),s=Mx(t.converter,e);return Bp(r,[Rx(Nf(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,pn.exists(!1))]).then(()=>n)}function wi(t,...e){var r,n,s;t=fr(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Y4(e[o])||(i=e[o++]);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Y4(e[o])){const h=e[o];e[o]=(r=h.next)===null||r===void 0?void 0:r.bind(h),e[o+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[o+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let c,u,d;if(t instanceof Fr)u=us(t.firestore,Ta),d=Nx(t._key.path),c={next:h=>{e[o]&&e[o](nC(u,t,h))},error:e[o+1],complete:e[o+2]};else{const h=us(t,Nl);u=us(h.firestore,Ta),d=h._query;const g=new Fx(u);c={next:m=>{e[o]&&e[o](new Ku(u,g,h,m))},error:e[o+1],complete:e[o+2]},eC(t._query)}return function(g,m,w,_){const T=new R5(_),v=new I5(m,T,w);return g.asyncQueue.enqueueAndForget(async()=>E5(await ky(g),v)),()=>{T.Ou(),g.asyncQueue.enqueueAndForget(async()=>k5(await ky(g),v))}}(vf(u),d,l,c)}function Bp(t,e){return function(n,s){const i=new oo;return n.asyncQueue.enqueueAndForget(async()=>oU(await bU(n),s,i)),i.promise}(vf(t),e)}function nC(t,e,r){const n=r.docs.get(e._key),s=new Fx(t);return new Pc(t,s,e._key,n,new yh(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MU={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FU{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Nf(e)}set(e,r,n){this._verifyNotCommitted();const s=yc(e,this._firestore),i=Mx(s.converter,r,n),o=Rx(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,n);return this._mutations.push(o.toMutation(s._key,pn.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const i=yc(e,this._firestore);let o;return o=typeof(r=fr(r))=="string"||r instanceof bf?V5(this._dataReader,"WriteBatch.update",i._key,r,n,s):F5(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(o.toMutation(i._key,pn.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=yc(e,this._firestore);return this._mutations=this._mutations.concat(new Op(r._key,pn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new We(Ae.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function yc(t,e){if((t=fr(t)).firestore!==e)throw new We(Ae.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VU{constructor(e,r){this._firestore=e,this._transaction=r,this._dataReader=Nf(e)}get(e){const r=yc(e,this._firestore),n=new LU(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return mt(24041);const i=s[0];if(i.isFoundDocument())return new Iy(this._firestore,n,i.key,i,r.converter);if(i.isNoDocument())return new Iy(this._firestore,n,r._key,null,r.converter);throw mt(18433,{doc:i})})}set(e,r,n){const s=yc(e,this._firestore),i=Mx(s.converter,r,n),o=Rx(this._dataReader,"Transaction.set",s._key,i,s.converter!==null,n);return this._transaction.set(s._key,o),this}update(e,r,n,...s){const i=yc(e,this._firestore);let o;return o=typeof(r=fr(r))=="string"||r instanceof bf?V5(this._dataReader,"Transaction.update",i._key,r,n,s):F5(this._dataReader,"Transaction.update",i._key,r),this._transaction.update(i._key,o),this}delete(e){const r=yc(e,this._firestore);return this._transaction.delete(r._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BU extends VU{constructor(e,r){super(e,r),this._firestore=e}get(e){const r=yc(e,this._firestore),n=new Fx(this._firestore);return super.get(e).then(s=>new Pc(this._firestore,n,r._key,s._document,new yh(!1,!1),r.converter))}}function X4(t,e,r){t=us(t,Ta);const n=Object.assign(Object.assign({},MU),r);return function(i){if(i.maxAttempts<1)throw new We(Ae.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(i,o,l){const c=new oo;return i.asyncQueue.enqueueAndForget(async()=>{const u=await wU(i);new yU(i.asyncQueue,u,l,o,c).zu()}),c.promise}(vf(t),s=>e(new BU(t,s)),n)}function ft(){return new L5("serverTimestamp")}function UU(...t){return new O5("arrayRemove",t)}function zU(t){return new M5("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lb(t){return vf(t=us(t,Ta)),new FU(t,e=>Bp(t,e))}(function(e,r=!0){(function(s){mf=s})(md),sd(new Vc("firestore",(n,{instanceIdentifier:s,options:i})=>{const o=n.getProvider("app").getImmediate(),l=new Ta(new R9(n.getProvider("auth-internal")),new O9(o,n.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new We(Ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new cp(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:r},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),io(Xj,Zj,e),io(Xj,Zj,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sC="firebasestorage.googleapis.com",iC="storageBucket",qU=2*60*1e3,$U=10*60*1e3,WU=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr extends go{constructor(e,r,n=0){super(sv(e),`Firebase Storage: ${r} (${sv(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,qr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return sv(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Cr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Cr||(Cr={}));function sv(t){return"storage/"+t}function G5(){const t="An unknown error occurred, please check the error payload for server response.";return new qr(Cr.UNKNOWN,t)}function HU(t){return new qr(Cr.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function GU(t){return new qr(Cr.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function KU(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new qr(Cr.UNAUTHENTICATED,t)}function YU(){return new qr(Cr.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function QU(t){return new qr(Cr.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function aC(){return new qr(Cr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function oC(){return new qr(Cr.CANCELED,"User canceled the upload/download.")}function JU(t){return new qr(Cr.INVALID_URL,"Invalid URL '"+t+"'.")}function XU(t){return new qr(Cr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function ZU(){return new qr(Cr.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+iC+"' property when initializing the app?")}function lC(){return new qr(Cr.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function ez(){return new qr(Cr.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function tz(){return new qr(Cr.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function rz(t){return new qr(Cr.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function cb(t){return new qr(Cr.INVALID_ARGUMENT,t)}function cC(){return new qr(Cr.APP_DELETED,"The Firebase app was deleted.")}function nz(t){return new qr(Cr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Cm(t,e){return new qr(Cr.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Xf(t){throw new qr(Cr.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=yi.makeFromUrl(e,r)}catch{return new yi(e,"")}if(n.path==="")return n;throw XU(e)}static makeFromUrl(e,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function i(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function u(P){P.path_=decodeURIComponent(P.path)}const d="v[A-Za-z0-9_]+",h=r.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",m=new RegExp(`^https?://${h}/${d}/b/${s}/o${g}`,"i"),w={bucket:1,path:3},_=r===sC?"(?:storage.googleapis.com|storage.cloud.google.com)":r,T="([^?#]*)",v=new RegExp(`^https?://${_}/${s}/${T}`,"i"),x=[{regex:l,indices:c,postModify:i},{regex:m,indices:w,postModify:u},{regex:v,indices:{bucket:1,path:2},postModify:u}];for(let P=0;P<x.length;P++){const F=x[P],$=F.regex.exec(e);if($){const k=$[F.indices.bucket];let A=$[F.indices.path];A||(A=""),n=new yi(k,A),F.postModify(n);break}}if(n==null)throw JU(e);return n}}class sz{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iz(t,e,r){let n=1,s=null,i=null,o=!1,l=0;function c(){return l===2}let u=!1;function d(...T){u||(u=!0,e.apply(null,T))}function h(T){s=setTimeout(()=>{s=null,t(m,c())},T)}function g(){i&&clearTimeout(i)}function m(T,...v){if(u){g();return}if(T){g(),d.call(null,T,...v);return}if(c()||o){g(),d.call(null,T,...v);return}n<64&&(n*=2);let x;l===1?(l=2,x=0):x=(n+Math.random())*1e3,h(x)}let w=!1;function _(T){w||(w=!0,g(),!u&&(s!==null?(T||(l=2),clearTimeout(s),h(0)):T||(l=1)))}return h(0),i=setTimeout(()=>{o=!0,_(!0)},r),_}function az(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oz(t){return t!==void 0}function lz(t){return typeof t=="function"}function cz(t){return typeof t=="object"&&!Array.isArray(t)}function Vx(t){return typeof t=="string"||t instanceof String}function Z4(t){return K5()&&t instanceof Blob}function K5(){return typeof Blob<"u"}function eS(t,e,r,n){if(n<e)throw cb(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw cb(`Invalid value for '${t}'. Expected ${r} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jf(t,e,r){let n=e;return r==null&&(n=`https://${e}`),`${r}://${n}/v0${t}`}function uC(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const s=e(n)+"="+e(t[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var Yu;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Yu||(Yu={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dC(t,e){const r=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return r||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uz{constructor(e,r,n,s,i,o,l,c,u,d,h,g=!0,m=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=h,this.retry=g,this.isUsingEmulator=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,_)=>{this.resolve_=w,this.reject_=_,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new qg(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===Yu.NO_ERROR,c=i.getStatus();if(!l||dC(c,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===Yu.ABORT;n(!1,new qg(!1,null,d));return}const u=this.successCodes_.indexOf(c)!==-1;n(!0,new qg(u,i))})},r=(n,s)=>{const i=this.resolve_,o=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());oz(c)?i(c):i()}catch(c){o(c)}else if(l!==null){const c=G5();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(s.canceled){const c=this.appDelete_?cC():oC();o(c)}else{const c=aC();o(c)}};this.canceled_?r(!1,new qg(!1,null,!0)):this.backoffId_=iz(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&az(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class qg{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function dz(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function hz(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function fz(t,e){e&&(t["X-Firebase-GMPID"]=e)}function mz(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function pz(t,e,r,n,s,i,o=!0,l=!1){const c=uC(t.urlParams),u=t.url+c,d=Object.assign({},t.headers);return fz(d,e),dz(d,r),hz(d,i),mz(d,n),new uz(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gz(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function yz(...t){const e=gz();if(e!==void 0){const r=new e;for(let n=0;n<t.length;n++)r.append(t[n]);return r.getBlob()}else{if(K5())return new Blob(t);throw new qr(Cr.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function xz(t,e,r){return t.webkitSlice?t.webkitSlice(e,r):t.mozSlice?t.mozSlice(e,r):t.slice?t.slice(e,r):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vz(t){if(typeof atob>"u")throw rz("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class iv{constructor(e,r){this.data=e,this.contentType=r||null}}function bz(t,e){switch(t){case to.RAW:return new iv(hC(e));case to.BASE64:case to.BASE64URL:return new iv(fC(t,e));case to.DATA_URL:return new iv(Nz(e),_z(e))}throw G5()}function hC(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(r<t.length-1&&(t.charCodeAt(r+1)&64512)===56320))e.push(239,191,189);else{const i=n,o=t.charCodeAt(++r);n=65536|(i&1023)<<10|o&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function wz(t){let e;try{e=decodeURIComponent(t)}catch{throw Cm(to.DATA_URL,"Malformed data URL.")}return hC(e)}function fC(t,e){switch(t){case to.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Cm(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case to.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Cm(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=vz(e)}catch(s){throw s.message.includes("polyfill")?s:Cm(t,"Invalid character found")}const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}class mC{constructor(e){this.base64=!1,this.contentType=null;const r=e.match(/^data:([^,]+)?,/);if(r===null)throw Cm(to.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=r[1]||null;n!=null&&(this.base64=jz(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function Nz(t){const e=new mC(t);return e.base64?fC(to.BASE64,e.rest):wz(e.rest)}function _z(t){return new mC(t).contentType}function jz(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(e,r){let n=0,s="";Z4(e)?(this.data_=e,n=e.size,s=e.type):e instanceof ArrayBuffer?(r?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(r?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,r){if(Z4(this.data_)){const n=this.data_,s=xz(n,e,r);return s===null?null:new dc(s)}else{const n=new Uint8Array(this.data_.buffer,e,r-e);return new dc(n,!0)}}static getBlob(...e){if(K5()){const r=e.map(n=>n instanceof dc?n.data_:n);return new dc(yz.apply(null,r))}else{const r=e.map(o=>Vx(o)?bz(to.RAW,o).data:o.data_);let n=0;r.forEach(o=>{n+=o.byteLength});const s=new Uint8Array(n);let i=0;return r.forEach(o=>{for(let l=0;l<o.length;l++)s[i++]=o[l]}),new dc(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pC(t){let e;try{e=JSON.parse(t)}catch{return null}return cz(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sz(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function Az(t,e){const r=e.split("/").filter(n=>n.length>0).join("/");return t.length===0?r:t+"/"+r}function gC(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ez(t,e){return e}class ws{constructor(e,r,n,s){this.server=e,this.local=r||e,this.writable=!!n,this.xform=s||Ez}}let $g=null;function kz(t){return!Vx(t)||t.length<2?t:gC(t)}function yC(){if($g)return $g;const t=[];t.push(new ws("bucket")),t.push(new ws("generation")),t.push(new ws("metageneration")),t.push(new ws("name","fullPath",!0));function e(i,o){return kz(o)}const r=new ws("name");r.xform=e,t.push(r);function n(i,o){return o!==void 0?Number(o):o}const s=new ws("size");return s.xform=n,t.push(s),t.push(new ws("timeCreated")),t.push(new ws("updated")),t.push(new ws("md5Hash",null,!0)),t.push(new ws("cacheControl",null,!0)),t.push(new ws("contentDisposition",null,!0)),t.push(new ws("contentEncoding",null,!0)),t.push(new ws("contentLanguage",null,!0)),t.push(new ws("contentType",null,!0)),t.push(new ws("metadata","customMetadata",!0)),$g=t,$g}function Tz(t,e){function r(){const n=t.bucket,s=t.fullPath,i=new yi(n,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:r})}function Iz(t,e,r){const n={};n.type="file";const s=r.length;for(let i=0;i<s;i++){const o=r[i];n[o.local]=o.xform(n,e[o.server])}return Tz(n,t),n}function xC(t,e,r){const n=pC(e);return n===null?null:Iz(t,n,r)}function Cz(t,e,r,n){const s=pC(e);if(s===null||!Vx(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(u=>{const d=t.bucket,h=t.fullPath,g="/b/"+o(d)+"/o/"+o(h),m=jf(g,r,n),w=uC({alt:"media",token:u});return m+w})[0]}function vC(t,e){const r={},n=e.length;for(let s=0;s<n;s++){const i=e[s];i.writable&&(r[i.server]=t[i.local])}return JSON.stringify(r)}class yd{constructor(e,r,n,s){this.url=e,this.method=r,this.handler=n,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tl(t){if(!t)throw G5()}function Y5(t,e){function r(n,s){const i=xC(t,s,e);return tl(i!==null),i}return r}function Pz(t,e){function r(n,s){const i=xC(t,s,e);return tl(i!==null),Cz(i,s,t.host,t._protocol)}return r}function Up(t){function e(r,n){let s;return r.getStatus()===401?r.getErrorText().includes("Firebase App Check token is invalid")?s=YU():s=KU():r.getStatus()===402?s=GU(t.bucket):r.getStatus()===403?s=QU(t.path):s=n,s.status=r.getStatus(),s.serverResponse=n.serverResponse,s}return e}function Q5(t){const e=Up(t);function r(n,s){let i=e(n,s);return n.getStatus()===404&&(i=HU(t.path)),i.serverResponse=s.serverResponse,i}return r}function Rz(t,e,r){const n=e.fullServerUrl(),s=jf(n,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new yd(s,i,Y5(t,r),o);return l.errorHandler=Q5(e),l}function Dz(t,e,r){const n=e.fullServerUrl(),s=jf(n,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new yd(s,i,Pz(t,r),o);return l.errorHandler=Q5(e),l}function Lz(t,e){const r=e.fullServerUrl(),n=jf(r,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(c,u){}const l=new yd(n,s,o,i);return l.successCodes=[200,204],l.errorHandler=Q5(e),l}function Oz(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function bC(t,e,r){const n=Object.assign({},r);return n.fullPath=t.path,n.size=e.size(),n.contentType||(n.contentType=Oz(null,e)),n}function Mz(t,e,r,n,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let x="";for(let P=0;P<2;P++)x=x+Math.random().toString().slice(2);return x}const c=l();o["Content-Type"]="multipart/related; boundary="+c;const u=bC(e,n,s),d=vC(u,r),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,g=`\r
--`+c+"--",m=dc.getBlob(h,n,g);if(m===null)throw lC();const w={name:u.fullPath},_=jf(i,t.host,t._protocol),T="POST",v=t.maxUploadRetryTime,b=new yd(_,T,Y5(t,r),v);return b.urlParams=w,b.headers=o,b.body=m.uploadData(),b.errorHandler=Up(e),b}class Cy{constructor(e,r,n,s){this.current=e,this.total=r,this.finalized=!!n,this.metadata=s||null}}function J5(t,e){let r=null;try{r=t.getResponseHeader("X-Goog-Upload-Status")}catch{tl(!1)}return tl(!!r&&(e||["active"]).indexOf(r)!==-1),r}function Fz(t,e,r,n,s){const i=e.bucketOnlyServerUrl(),o=bC(e,n,s),l={name:o.fullPath},c=jf(i,t.host,t._protocol),u="POST",d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=vC(o,r),g=t.maxUploadRetryTime;function m(_){J5(_);let T;try{T=_.getResponseHeader("X-Goog-Upload-URL")}catch{tl(!1)}return tl(Vx(T)),T}const w=new yd(c,u,m,g);return w.urlParams=l,w.headers=d,w.body=h,w.errorHandler=Up(e),w}function Vz(t,e,r,n){const s={"X-Goog-Upload-Command":"query"};function i(u){const d=J5(u,["active","final"]);let h=null;try{h=u.getResponseHeader("X-Goog-Upload-Size-Received")}catch{tl(!1)}h||tl(!1);const g=Number(h);return tl(!isNaN(g)),new Cy(g,n.size(),d==="final")}const o="POST",l=t.maxUploadRetryTime,c=new yd(r,o,i,l);return c.headers=s,c.errorHandler=Up(e),c}const tS=256*1024;function Bz(t,e,r,n,s,i,o,l){const c=new Cy(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=n.size()),n.size()!==c.total)throw ez();const u=c.total-c.current;let d=u;s>0&&(d=Math.min(d,s));const h=c.current,g=h+d;let m="";d===0?m="finalize":u===d?m="upload, finalize":m="upload";const w={"X-Goog-Upload-Command":m,"X-Goog-Upload-Offset":`${c.current}`},_=n.slice(h,g);if(_===null)throw lC();function T(P,F){const $=J5(P,["active","final"]),k=c.current+d,A=n.size();let I;return $==="final"?I=Y5(e,i)(P,F):I=null,new Cy(k,A,$==="final",I)}const v="POST",b=e.maxUploadRetryTime,x=new yd(r,v,T,b);return x.headers=w,x.body=_.uploadData(),x.progressCallback=l||null,x.errorHandler=Up(t),x}const qs={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function av(t){switch(t){case"running":case"pausing":case"canceling":return qs.RUNNING;case"paused":return qs.PAUSED;case"success":return qs.SUCCESS;case"canceled":return qs.CANCELED;case"error":return qs.ERROR;default:return qs.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uz{constructor(e,r,n){if(lz(e)||r!=null||n!=null)this.next=e,this.error=r??void 0,this.complete=n??void 0;else{const i=e;this.next=i.next,this.error=i.error,this.complete=i.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kd(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class zz{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Yu.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Yu.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Yu.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,r,n,s,i){if(this.sent_)throw Xf("cannot .send() more than once");if(ru(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(r,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Xf("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Xf("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Xf("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Xf("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class qz extends zz{initXhr(){this.xhr_.responseType="text"}}function Ou(){return new qz}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $z{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,r,n=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=r,this._metadata=n,this._mappings=yC(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{if(this._request=void 0,this._chunkMultiplier=1,s._codeEquals(Cr.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const i=this.isExponentialBackoffExpired();if(dC(s.status,[]))if(i)s=aC();else{this.sleepTime=Math.max(this.sleepTime*2,WU),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=s,this._transition("error")}},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals(Cr.CANCELED)?this.completeTransitions_():(this._error=s,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((s,i)=>{this._resolve=s,this._reject=i,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return r=>this._updateProgress(e+r)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([r,n])=>{switch(this._state){case"running":e(r,n);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,r)=>{const n=Fz(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(n,Ou,e,r);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._uploadUrl=i,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((r,n)=>{const s=Vz(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(s,Ou,r,n);this._request=i,i.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=tS*this._chunkMultiplier,r=new Cy(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken((s,i)=>{let o;try{o=Bz(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,r,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}const l=this._ref.storage._makeRequest(o,Ou,s,i,!1);this._request=l,l.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){tS*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,r)=>{const n=Rz(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(n,Ou,e,r);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,r)=>{const n=Mz(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(n,Ou,e,r);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const r=this._transferred;this._transferred=e,this._transferred!==r&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const r=this._state==="paused";this._state=e,r&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=oC(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=av(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,r,n,s){const i=new Uz(r||void 0,n||void 0,s||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,r){return this._promise.then(e,r)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const r=this._observers.indexOf(e);r!==-1&&this._observers.splice(r,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(r=>{this._notifyObserver(r)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(av(this._state)){case qs.SUCCESS:Kd(this._resolve.bind(null,this.snapshot))();break;case qs.CANCELED:case qs.ERROR:const r=this._reject;Kd(r.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(av(this._state)){case qs.RUNNING:case qs.PAUSED:e.next&&Kd(e.next.bind(e,this.snapshot))();break;case qs.SUCCESS:e.complete&&Kd(e.complete.bind(e))();break;case qs.CANCELED:case qs.ERROR:e.error&&Kd(e.error.bind(e,this._error))();break;default:e.error&&Kd(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e,r){this._service=e,r instanceof yi?this._location=r:this._location=yi.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new cd(e,r)}get root(){const e=new yi(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return gC(this._location.path)}get storage(){return this._service}get parent(){const e=Sz(this._location.path);if(e===null)return null;const r=new yi(this._location.bucket,e);return new cd(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw nz(e)}}function Wz(t,e,r){return t._throwIfRoot("uploadBytesResumable"),new $z(t,new dc(e),r)}function Hz(t){t._throwIfRoot("getDownloadURL");const e=Dz(t.storage,t._location,yC());return t.storage.makeRequestWithTokens(e,Ou).then(r=>{if(r===null)throw tz();return r})}function Gz(t){t._throwIfRoot("deleteObject");const e=Lz(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Ou)}function Kz(t,e){const r=Az(t._location.path,e),n=new yi(t._location.bucket,r);return new cd(t.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yz(t){return/^[A-Za-z]+:\/\//.test(t)}function Qz(t,e){return new cd(t,e)}function wC(t,e){if(t instanceof X5){const r=t;if(r._bucket==null)throw ZU();const n=new cd(r,r._bucket);return e!=null?wC(n,e):n}else return e!==void 0?Kz(t,e):t}function Jz(t,e){if(e&&Yz(e)){if(t instanceof X5)return Qz(t,e);throw cb("To use ref(service, url), the first argument must be a Storage instance.")}else return wC(t,e)}function rS(t,e){const r=e==null?void 0:e[iC];return r==null?null:yi.makeFromBucketSpec(r,t)}function Xz(t,e,r,n={}){t.host=`${e}:${r}`;const s=ru(e);s&&(Uw(`https://${t.host}/b`),zw("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=n;i&&(t._overrideAuthToken=typeof i=="string"?i:Bk(i,t.app.options.projectId))}class X5{constructor(e,r,n,s,i,o=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=sC,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=qU,this._maxUploadRetryTime=$U,this._requests=new Set,s!=null?this._bucket=yi.makeFromBucketSpec(s,this._host):this._bucket=rS(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=yi.makeFromBucketSpec(this._url,e):this._bucket=rS(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){eS("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){eS("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(Ws(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new cd(this,e)}_makeRequest(e,r,n,s,i=!0){if(this._deleted)return new sz(cC());{const o=pz(e,this._appId,n,s,r,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,s).getPromise()}}const nS="@firebase/storage",sS="0.13.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NC="storage";function Zz(t,e,r){return t=fr(t),Wz(t,e,r)}function eq(t){return t=fr(t),Hz(t)}function tq(t){return t=fr(t),Gz(t)}function iS(t,e){return t=fr(t),Jz(t,e)}function rq(t=Ww(),e){t=fr(t);const n=px(t,NC).getImmediate({identifier:e}),s=Mk("storage");return s&&nq(n,...s),n}function nq(t,e,r,n={}){Xz(t,e,r,n)}function sq(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new X5(r,n,s,e,md)}function iq(){sd(new Vc(NC,sq,"PUBLIC").setMultipleInstances(!0)),io(nS,sS,""),io(nS,sS,"esm2017")}iq();const aq={apiKey:"AIzaSyDQx9jNQr36UIy3macLbAzlrEQO-mX2ub0",authDomain:"royalsb-4a698.firebaseapp.com",projectId:"royalsb-4a698",storageBucket:"royalsb-4a698.appspot.com",messagingSenderId:"950005998146",appId:"1:950005998146:web:8174bc76a1ff2b8bff03db"};let ov=null,lv=null,cv=null,uv=null;const oq=()=>{if(!ov)try{ov=qk(aq),console.log("Firebase initialized successfully")}catch(t){throw console.error("Error initializing Firebase:",t),t}return ov},Bx=()=>oq(),Ha=()=>{if(!lv){const t=Bx();lv=N9(t)}return lv},Ce=()=>{if(!cv){const t=Bx();cv=SU(t)}return cv},lq=()=>{if(!uv){const t=Bx();uv=rq(t)}return uv};Bx();const aS=t=>{let e;const r=new Set,n=(d,h)=>{const g=typeof d=="function"?d(e):d;if(!Object.is(g,e)){const m=e;e=h??(typeof g!="object"||g===null)?g:Object.assign({},e,g),r.forEach(w=>w(e,m))}},s=()=>e,c={setState:n,getState:s,getInitialState:()=>u,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{r.clear()}},u=e=t(n,s,c);return c},cq=t=>t?aS(t):aS;var _C={exports:{}},jC={},SC={exports:{}},AC={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nf=M;function uq(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var dq=typeof Object.is=="function"?Object.is:uq,hq=nf.useState,fq=nf.useEffect,mq=nf.useLayoutEffect,pq=nf.useDebugValue;function gq(t,e){var r=e(),n=hq({inst:{value:r,getSnapshot:e}}),s=n[0].inst,i=n[1];return mq(function(){s.value=r,s.getSnapshot=e,dv(s)&&i({inst:s})},[t,r,e]),fq(function(){return dv(s)&&i({inst:s}),t(function(){dv(s)&&i({inst:s})})},[t]),pq(r),r}function dv(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!dq(t,r)}catch{return!0}}function yq(t,e){return e()}var xq=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?yq:gq;AC.useSyncExternalStore=nf.useSyncExternalStore!==void 0?nf.useSyncExternalStore:xq;SC.exports=AC;var vq=SC.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ux=M,bq=vq;function wq(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Nq=typeof Object.is=="function"?Object.is:wq,_q=bq.useSyncExternalStore,jq=Ux.useRef,Sq=Ux.useEffect,Aq=Ux.useMemo,Eq=Ux.useDebugValue;jC.useSyncExternalStoreWithSelector=function(t,e,r,n,s){var i=jq(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=Aq(function(){function c(m){if(!u){if(u=!0,d=m,m=n(m),s!==void 0&&o.hasValue){var w=o.value;if(s(w,m))return h=w}return h=m}if(w=h,Nq(d,m))return w;var _=n(m);return s!==void 0&&s(w,_)?(d=m,w):(d=m,h=_)}var u=!1,d,h,g=r===void 0?null:r;return[function(){return c(e())},g===null?void 0:function(){return c(g())}]},[e,r,n,s]);var l=_q(t,i[0],i[1]);return Sq(function(){o.hasValue=!0,o.value=l},[l]),Eq(l),l};_C.exports=jC;var kq=_C.exports;const Tq=uA(kq),{useDebugValue:Iq}=Lc,{useSyncExternalStoreWithSelector:Cq}=Tq;const Pq=t=>t;function Rq(t,e=Pq,r){const n=Cq(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,r);return Iq(n),n}const oS=t=>{const e=typeof t=="function"?cq(t):t,r=(n,s)=>Rq(e,n,s);return Object.assign(r,e),r},Dq=t=>t?oS(t):oS;class Ka{static async signIn(e,r){try{const n=Ha();return(await oF(n,e,r)).user}catch(n){throw console.error("Error signing in:",n),n}}static async signUp(e,r,n,s){try{const i=Ha(),o=Ce(),c=(await aF(i,e,r)).user;await cF(c,{displayName:n});const u={email:c.email,name:n,phone:s,role:"user",avatar:c.photoURL||void 0};return await xa(ot(o,"users",c.uid),{...u,createdAt:ft()}),c}catch(i){throw console.error("Error signing up:",i),i}}static async signInWithGoogle(){try{const e=new Qa,r=Ha();return(await jT(r,e)).user}catch(e){throw new Error(this.getErrorMessage(e.code))}}static async signOut(){try{const e=Ha();await hF(e)}catch(e){throw console.error("Error signing out:",e),e}}static getCurrentUser(){return Ha().currentUser}static async resetPassword(e){try{const r=Ha();await iF(r,e)}catch(r){throw new Error(this.getErrorMessage(r.code))}}static async getUserData(e){try{const r=Ce(),n=await os(ot(r,"users",e));if(n.exists()){const s=n.data();return{id:n.id,email:s.email,name:s.name,phone:s.phone,role:s.role,avatar:s.avatar,createdAt:s.createdAt.toDate()}}return null}catch(r){throw console.error("Error getting user data:",r),r}}static async updateUserProfile(e,r){try{const{id:n,...s}=r,i=Ce();await Qt(ot(i,"users",e),s)}catch(n){throw new Error(this.getErrorMessage(n.code))}}static onAuthStateChanged(e){const r=Ha();return t5(r,async n=>{if(n){const s=await this.getUserData(n.uid);s&&e({id:n.uid,email:n.email,name:s.name,phone:s.phone,role:s.role,avatar:n.photoURL||s.avatar,createdAt:s.createdAt})}else e(null)})}static getErrorMessage(e){switch(e){case"auth/user-not-found":return"No account found with this email address.";case"auth/wrong-password":return"Incorrect password.";case"auth/email-already-in-use":return"An account with this email already exists.";case"auth/weak-password":return"Password should be at least 6 characters.";case"auth/invalid-email":return"Please enter a valid email address.";case"auth/too-many-requests":return"Too many failed attempts. Please try again later.";case"auth/popup-closed-by-user":return"Sign-in was cancelled.";default:return"An error occurred. Please try again."}}}const hv=[{id:"google",name:"Google",icon:"🔍",color:"#4285F4",provider:new Qa}];class EC{static async signInWithProvider(e){const r=hv.find(n=>n.id===e);if(!r)throw new Error(`Provider ${e} not supported`);try{const n=Ha(),s=Ce();this.configureProvider(r.provider,e);const o=(await jT(n,r.provider)).user,l=await os(ot(s,"users",o.uid));let c;if(l.exists()){const u=l.data();c={id:o.uid,email:o.email,name:u.name||o.displayName||"",phone:u.phone,role:u.role||"user",avatar:o.photoURL||u.avatar,createdAt:u.createdAt.toDate()}}else{const u={email:o.email,name:o.displayName||"",phone:void 0,role:"user",avatar:o.photoURL||void 0,createdAt:ft(),socialProvider:e};await xa(ot(s,"users",o.uid),u),c={id:o.uid,email:o.email,name:o.displayName||"",phone:void 0,role:"user",avatar:o.photoURL,createdAt:new Date}}return c}catch(n){throw console.error("Social auth error:",n),new Error(this.getSocialErrorMessage(n.code,e))}}static configureProvider(e,r){r==="google"&&(e.addScope("profile"),e.addScope("email"))}static getSocialErrorMessage(e,r){switch(e){case"auth/popup-closed-by-user":return"Sign-in was cancelled.";case"auth/popup-blocked":return"Pop-up was blocked by your browser. Please allow pop-ups and try again.";case"auth/account-exists-with-different-credential":return"An account already exists with the same email address but different sign-in credentials.";case"auth/auth-domain-config-required":return"Authentication configuration error. Please contact support.";case"auth/cancelled-popup-request":return"Another sign-in request is already pending.";case"auth/operation-not-allowed":return`${r} sign-in is not enabled. Please contact support.`;case"auth/operation-not-supported-in-this-environment":return"This operation is not supported in the current environment.";case"auth/timeout":return"The sign-in request timed out. Please try again.";case"auth/user-disabled":return"This account has been disabled. Please contact support.";case"auth/web-storage-unsupported":return"Web storage is not supported in your browser.";default:return`An error occurred during ${r} sign-in. Please try again.`}}static getAvailableProviders(){return hv}static getSupportedProviders(){return hv.map(e=>e.id)}}/*! js-cookie v3.0.5 | MIT */function Wg(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}var Lq={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function ub(t,e){function r(s,i,o){if(!(typeof document>"u")){o=Wg({},e,o),typeof o.expires=="number"&&(o.expires=new Date(Date.now()+o.expires*864e5)),o.expires&&(o.expires=o.expires.toUTCString()),s=encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var l="";for(var c in o)o[c]&&(l+="; "+c,o[c]!==!0&&(l+="="+o[c].split(";")[0]));return document.cookie=s+"="+t.write(i,s)+l}}function n(s){if(!(typeof document>"u"||arguments.length&&!s)){for(var i=document.cookie?document.cookie.split("; "):[],o={},l=0;l<i.length;l++){var c=i[l].split("="),u=c.slice(1).join("=");try{var d=decodeURIComponent(c[0]);if(o[d]=t.read(u,d),s===d)break}catch{}}return s?o[s]:o}}return Object.create({set:r,get:n,remove:function(s,i){r(s,"",Wg({},i,{expires:-1}))},withAttributes:function(s){return ub(this.converter,Wg({},this.attributes,s))},withConverter:function(s){return ub(Wg({},this.converter,s),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(t)}})}var Hg=ub(Lq,{path:"/"});class Mt{static saveSession(e){try{const r={userId:e.id,email:e.email,name:e.name,role:e.role,phone:e.phone,avatar:e.avatar,isAuthenticated:!0,sessionExpiry:Date.now()+this.SESSION_DURATION,lastUpdated:Date.now()};Hg.set(this.COOKIE_NAME,JSON.stringify(r),{expires:7,secure:window.location.protocol==="https:",sameSite:"strict",httpOnly:!1}),console.log("🍪 Session saved to cookie:",{userId:e.id,role:e.role})}catch(r){console.error("❌ Failed to save session to cookie:",r)}}static loadSession(){try{const e=Hg.get(this.COOKIE_NAME);if(!e)return console.log("🍪 No session cookie found"),null;const r=JSON.parse(e);return Date.now()>r.sessionExpiry?(console.log("🍪 Session expired, clearing cookie"),this.clearSession(),null):(console.log("🍪 Session loaded from cookie:",{userId:r.userId,role:r.role,expiresIn:Math.round((r.sessionExpiry-Date.now())/(1e3*60*60))+"h"}),r)}catch(e){return console.error("❌ Failed to load session from cookie:",e),this.clearSession(),null}}static sessionToUser(e){return{id:e.userId,email:e.email,name:e.name,role:e.role,phone:e.phone,avatar:e.avatar,createdAt:new Date(e.lastUpdated)}}static shouldRefreshSession(e){return Date.now()-e.lastUpdated>this.REFRESH_THRESHOLD}static updateSession(e){const r=this.loadSession();if(!r)return;const n={...r,...e,lastUpdated:Date.now()};Hg.set(this.COOKIE_NAME,JSON.stringify(n),{expires:7,secure:window.location.protocol==="https:",sameSite:"strict",httpOnly:!1}),console.log("🍪 Session updated:",e)}static clearSession(){Hg.remove(this.COOKIE_NAME),console.log("🍪 Session cleared")}static getUserRole(){const e=this.loadSession();return(e==null?void 0:e.role)||null}static isAdmin(){return this.getUserRole()==="admin"}static isStaffOrAdmin(){const e=this.getUserRole();return e==="admin"||e==="staff"}static isAuthenticated(){const e=this.loadSession();return(e==null?void 0:e.isAuthenticated)||!1}static getUserId(){const e=this.loadSession();return(e==null?void 0:e.userId)||null}static getUserEmail(){const e=this.loadSession();return(e==null?void 0:e.email)||null}static extendSession(){this.loadSession()&&this.updateSession({sessionExpiry:Date.now()+this.SESSION_DURATION})}static getSessionInfo(){const e=this.loadSession();return e?{userId:e.userId,email:e.email,role:e.role,isAuthenticated:e.isAuthenticated,sessionExpiry:e.sessionExpiry,lastUpdated:e.lastUpdated}:null}}Dr(Mt,"COOKIE_NAME","royal_session"),Dr(Mt,"SESSION_DURATION",7*24*60*60*1e3),Dr(Mt,"REFRESH_THRESHOLD",24*60*60*1e3);const yn=Dq(t=>({user:null,isLoading:!1,isAuthenticated:!1,initializeFromCookie:()=>{const e=Mt.loadSession();if(e){console.log("🍪 Initializing auth state from cookie");const r=Mt.sessionToUser(e);t({user:r,isAuthenticated:!0})}},setUser:e=>{t({user:e,isAuthenticated:!!e}),e?Mt.saveSession(e):Mt.clearSession()},logout:()=>{Ka.signOut(),Mt.clearSession(),t({user:null,isAuthenticated:!1})},signIn:async(e,r)=>{t({isLoading:!0});try{const n=await Ka.signIn(e,r),s=await Ka.getUserData(n.uid);if(s){const i={id:n.uid,email:n.email,name:s.name,phone:s.phone,role:s.role,avatar:n.photoURL||s.avatar,createdAt:s.createdAt};t({user:i,isLoading:!1,isAuthenticated:!0}),Mt.saveSession(i)}else throw new Error("User data not found")}catch(n){throw t({isLoading:!1}),n}},signUp:async(e,r,n,s)=>{t({isLoading:!0});try{const i=await Ka.signUp(e,r,n,s),o=await Ka.getUserData(i.uid);if(o){const l={id:i.uid,email:i.email,name:o.name,phone:o.phone,role:o.role,avatar:i.photoURL||o.avatar,createdAt:o.createdAt};t({user:l,isLoading:!1,isAuthenticated:!0}),Mt.saveSession(l)}else throw new Error("User data not found")}catch(i){throw t({isLoading:!1}),i}},signInWithSocial:async e=>{t({isLoading:!0});try{const r=await EC.signInWithProvider(e);t({user:r,isLoading:!1,isAuthenticated:!0}),Mt.saveSession(r)}catch(r){throw t({isLoading:!1}),r}},resetPassword:async e=>{await Ka.resetPassword(e)}})),lS=async(t,e,r=3)=>{for(let n=1;n<=r;n++)try{console.log(`🔧 Ensuring admin user exists (attempt ${n}/${r})...`);const s=Ce(),i=ot(s,"users",t),o=await os(i);if(o.exists()){const l=o.data();if(console.log("📄 Existing user data:",l),l.role!=="admin"){console.log("🔧 Updating user role to admin...");const c={...l,role:"admin",updatedAt:ft(),name:e==="jacob-s@live.de"?"Jacob (Admin)":l.name||"Admin User",phone:e==="jacob-s@live.de"?"+49 15122029769":l.phone||""};await xa(i,c,{merge:!0}),console.log("✅ User role updated to admin");const u=await os(i);if(u.exists()&&u.data().role==="admin")return console.log("✅ Verified admin role update"),!0;throw new Error("Failed to verify role update")}else return console.log("✅ Admin user already exists with correct role"),!0}else{console.log("🔧 Creating admin user in Firestore...");const l={email:e,name:e==="jacob-s@live.de"?"Jacob (Admin)":"Admin User",role:"admin",phone:e==="jacob-s@live.de"?"+49 15122029769":"",avatar:"",createdAt:ft(),updatedAt:ft()};if(await xa(i,l),console.log("✅ Admin user created successfully in Firestore"),(await os(i)).exists())return console.log("✅ Verified admin user document exists"),!0;throw new Error("Failed to verify user document creation")}}catch(s){if(console.error(`❌ Error ensuring admin user (attempt ${n}):`,s),n===r)return console.error("❌ All retries failed. Admin user setup incomplete."),!1;console.log("🔄 Retrying in 2 seconds..."),await new Promise(i=>setTimeout(i,2e3))}return!1},Oq=M.createContext(void 0),Mq=({children:t})=>{const[e,r,n]=k9(Ha()),{setUser:s,logout:i}=yn();M.useEffect(()=>{if(e){console.log("🔍 User authenticated, managing session:",e.uid);const l=async()=>{const u=Mt.loadSession();if(u&&u.userId===e.uid){console.log("🍪 Using cached session for instant load");const d=Mt.sessionToUser(u);if(s(d),!Mt.shouldRefreshSession(u)){console.log("🍪 Session is fresh, skipping Firestore fetch"),Mt.extendSession();return}console.log("🔄 Session needs refresh, fetching from Firestore...")}await c()},c=async()=>{var d,h,g;console.log("🔍 Fetching user data for:",e.uid);const u=e.email==="admin@royal-shishabar.com"||e.email==="royal.waldkraiburg@gmail.com"||e.email==="jacob-s@live.de"||((d=e.email)==null?void 0:d.includes("admin"));try{const m=new Promise((v,b)=>setTimeout(()=>b(new Error("Timeout fetching user data")),8e3));let w=null,_=0;const T=2;for(;_<=T&&!w;)try{const v=Ka.getUserData(e.uid);if(w=await Promise.race([v,m]),w&&typeof w=="object"&&"role"in w)break}catch(v){console.warn(`🔄 Retry ${_+1}/${T+1} failed:`,v),_++,_<=T&&await new Promise(b=>setTimeout(b,1e3))}if(w&&typeof w=="object"&&"name"in w){console.log("✅ User data loaded successfully:",w);const v=w.role||(u?"admin":"user"),b={id:e.uid,email:e.email,name:w.name,phone:w.phone,role:v,avatar:e.photoURL||w.avatar,createdAt:w.createdAt};s(b),Mt.saveSession(b)}else{console.warn("⚠️ No user data found in Firestore, using known admin status");const v=u?"admin":"user";console.log(`Setting fallback role: ${v} for email: ${e.email}`),u&&lS(e.uid,e.email,3).then(x=>{x?console.log("✅ Admin user document ensured in Firestore"):console.warn("⚠️ Could not ensure admin user document")});const b={id:e.uid,email:e.email,name:e.displayName||((h=e.email)==null?void 0:h.split("@")[0])||"User",role:v,avatar:e.photoURL||"",createdAt:new Date};s(b),Mt.saveSession(b)}}catch(m){console.error("❌ Failed to fetch user data from Firestore:",m);const w=u?"admin":"user";console.log(`Setting emergency fallback role: ${w} for email: ${e.email}`),u&&lS(e.uid,e.email,3).then(T=>{T?console.log("✅ Admin user document ensured in Firestore (fallback)"):console.warn("⚠️ Could not ensure admin user document (fallback)")});const _={id:e.uid,email:e.email,name:e.displayName||((g=e.email)==null?void 0:g.split("@")[0])||"User",role:w,avatar:e.photoURL||"",createdAt:new Date};s(_),Mt.saveSession(_)}};l()}else if(e===null)console.log("🔓 User signed out, clearing session"),i(),Mt.clearSession();else{const l=Mt.loadSession();if(l){console.log("🍪 Loading cached session while Firebase Auth initializes");const c=Mt.sessionToUser(l);s(c)}}},[e,s,i]);const o={user:e,loading:r,error:n};return a.jsx(Oq.Provider,{value:o,children:t})},kC={items:[],tableNumber:null,customerName:"",customerPhone:"",specialInstructions:""},Fq=()=>{try{const t=localStorage.getItem("royal-shisha-cart");if(t){const e=JSON.parse(t);return{...e,items:e.items.map(r=>({...r,createdAt:r.createdAt?new Date(r.createdAt):new Date}))}}}catch(t){console.error("Error loading cart from localStorage:",t)}return kC},Vq=t=>{try{localStorage.setItem("royal-shisha-cart",JSON.stringify(t))}catch(e){console.error("Error saving cart to localStorage:",e)}},Bq=(t,e)=>{let r;switch(e.type){case"ADD_ITEM":{t.items.find(s=>s.id===e.payload.id)?r={...t,items:t.items.map(s=>s.id===e.payload.id?{...s,quantity:s.quantity+e.payload.quantity}:s)}:r={...t,items:[...t.items,e.payload]};break}case"REMOVE_ITEM":r={...t,items:t.items.filter(n=>n.id!==e.payload)};break;case"UPDATE_QUANTITY":r={...t,items:t.items.map(n=>n.id===e.payload.id?{...n,quantity:e.payload.quantity}:n)};break;case"CLEAR_CART":r={...t,items:[],tableNumber:null,customerName:"",customerPhone:"",specialInstructions:""};break;case"SET_TABLE_NUMBER":r={...t,tableNumber:e.payload};break;case"SET_CUSTOMER_INFO":r={...t,customerName:e.payload.name,customerPhone:e.payload.phone};break;case"SET_SPECIAL_INSTRUCTIONS":r={...t,specialInstructions:e.payload};break;case"UPDATE_ITEM_INSTRUCTIONS":r={...t,items:t.items.map(n=>n.id===e.payload.id?{...n,specialInstructions:e.payload.instructions}:n)};break;case"LOAD_CART":r=e.payload;break;default:return t}return Vq(r),r},TC=M.createContext(void 0),Z5=()=>{const t=M.useContext(TC);if(t===void 0)throw new Error("useCart must be used within a CartProvider");return t},Uq=({children:t})=>{const[e,r]=M.useReducer(Bq,kC);M.useEffect(()=>{const w=Fq();(w.items.length>0||w.tableNumber||w.customerName||w.customerPhone||w.specialInstructions)&&r({type:"LOAD_CART",payload:w})},[]);const n=w=>{r({type:"ADD_ITEM",payload:w})},s=w=>{r({type:"REMOVE_ITEM",payload:w})},m={state:e,addItem:n,removeItem:s,updateQuantity:(w,_)=>{_<=0?s(w):r({type:"UPDATE_QUANTITY",payload:{id:w,quantity:_}})},clearCart:()=>{r({type:"CLEAR_CART"})},setTableNumber:w=>{r({type:"SET_TABLE_NUMBER",payload:w})},setCustomerInfo:(w,_)=>{r({type:"SET_CUSTOMER_INFO",payload:{name:w,phone:_}})},setSpecialInstructions:w=>{r({type:"SET_SPECIAL_INSTRUCTIONS",payload:w})},updateItemInstructions:(w,_)=>{r({type:"UPDATE_ITEM_INSTRUCTIONS",payload:{id:w,instructions:_}})},getTotalItems:()=>e.items.reduce((w,_)=>w+_.quantity,0),getTotalAmount:()=>e.items.reduce((w,_)=>w+_.price*_.quantity,0)};return a.jsx(TC.Provider,{value:m,children:t})};let zq={data:""},qq=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||zq,$q=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Wq=/\/\*[^]*?\*\/|  +/g,cS=/\n+/g,hc=(t,e)=>{let r="",n="",s="";for(let i in t){let o=t[i];i[0]=="@"?i[1]=="i"?r=i+" "+o+";":n+=i[1]=="f"?hc(o,i):i+"{"+hc(o,i[1]=="k"?"":e)+"}":typeof o=="object"?n+=hc(o,e?e.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,l):l?l+" "+c:c)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=hc.p?hc.p(i,o):i+":"+o+";")}return r+(e&&s?e+"{"+s+"}":s)+n},Mo={},IC=t=>{if(typeof t=="object"){let e="";for(let r in t)e+=r+IC(t[r]);return e}return t},Hq=(t,e,r,n,s)=>{let i=IC(t),o=Mo[i]||(Mo[i]=(c=>{let u=0,d=11;for(;u<c.length;)d=101*d+c.charCodeAt(u++)>>>0;return"go"+d})(i));if(!Mo[o]){let c=i!==t?t:(u=>{let d,h,g=[{}];for(;d=$q.exec(u.replace(Wq,""));)d[4]?g.shift():d[3]?(h=d[3].replace(cS," ").trim(),g.unshift(g[0][h]=g[0][h]||{})):g[0][d[1]]=d[2].replace(cS," ").trim();return g[0]})(t);Mo[o]=hc(s?{["@keyframes "+o]:c}:c,r?"":"."+o)}let l=r&&Mo.g?Mo.g:null;return r&&(Mo.g=Mo[o]),((c,u,d,h)=>{h?u.data=u.data.replace(h,c):u.data.indexOf(c)===-1&&(u.data=d?c+u.data:u.data+c)})(Mo[o],e,n,l),o},Gq=(t,e,r)=>t.reduce((n,s,i)=>{let o=e[i];if(o&&o.call){let l=o(r),c=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=c?"."+c:l&&typeof l=="object"?l.props?"":hc(l,""):l===!1?"":l}return n+s+(o??"")},"");function zx(t){let e=this||{},r=t.call?t(e.p):t;return Hq(r.unshift?r.raw?Gq(r,[].slice.call(arguments,1),e.p):r.reduce((n,s)=>Object.assign(n,s&&s.call?s(e.p):s),{}):r,qq(e.target),e.g,e.o,e.k)}let CC,db,hb;zx.bind({g:1});let hl=zx.bind({k:1});function Kq(t,e,r,n){hc.p=e,CC=t,db=r,hb=n}function iu(t,e){let r=this||{};return function(){let n=arguments;function s(i,o){let l=Object.assign({},i),c=l.className||s.className;r.p=Object.assign({theme:db&&db()},l),r.o=/ *go\d+/.test(c),l.className=zx.apply(r,n)+(c?" "+c:""),e&&(l.ref=o);let u=t;return t[0]&&(u=l.as||t,delete l.as),hb&&u[0]&&hb(l),CC(u,l)}return e?e(s):s}}var Yq=t=>typeof t=="function",Py=(t,e)=>Yq(t)?t(e):t,Qq=(()=>{let t=0;return()=>(++t).toString()})(),PC=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),Jq=20,RC=(t,e)=>{switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,Jq)};case 1:return{...t,toasts:t.toasts.map(i=>i.id===e.toast.id?{...i,...e.toast}:i)};case 2:let{toast:r}=e;return RC(t,{type:t.toasts.find(i=>i.id===r.id)?1:0,toast:r});case 3:let{toastId:n}=e;return{...t,toasts:t.toasts.map(i=>i.id===n||n===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(i=>i.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let s=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+s}))}}},A0=[],$u={toasts:[],pausedAt:void 0},xd=t=>{$u=RC($u,t),A0.forEach(e=>{e($u)})},Xq={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Zq=(t={})=>{let[e,r]=M.useState($u),n=M.useRef($u);M.useEffect(()=>(n.current!==$u&&r($u),A0.push(r),()=>{let i=A0.indexOf(r);i>-1&&A0.splice(i,1)}),[]);let s=e.toasts.map(i=>{var o,l,c;return{...t,...t[i.type],...i,removeDelay:i.removeDelay||((o=t[i.type])==null?void 0:o.removeDelay)||(t==null?void 0:t.removeDelay),duration:i.duration||((l=t[i.type])==null?void 0:l.duration)||(t==null?void 0:t.duration)||Xq[i.type],style:{...t.style,...(c=t[i.type])==null?void 0:c.style,...i.style}}});return{...e,toasts:s}},e$=(t,e="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...r,id:(r==null?void 0:r.id)||Qq()}),zp=t=>(e,r)=>{let n=e$(e,t,r);return xd({type:2,toast:n}),n.id},Ee=(t,e)=>zp("blank")(t,e);Ee.error=zp("error");Ee.success=zp("success");Ee.loading=zp("loading");Ee.custom=zp("custom");Ee.dismiss=t=>{xd({type:3,toastId:t})};Ee.remove=t=>xd({type:4,toastId:t});Ee.promise=(t,e,r)=>{let n=Ee.loading(e.loading,{...r,...r==null?void 0:r.loading});return typeof t=="function"&&(t=t()),t.then(s=>{let i=e.success?Py(e.success,s):void 0;return i?Ee.success(i,{id:n,...r,...r==null?void 0:r.success}):Ee.dismiss(n),s}).catch(s=>{let i=e.error?Py(e.error,s):void 0;i?Ee.error(i,{id:n,...r,...r==null?void 0:r.error}):Ee.dismiss(n)}),t};var t$=(t,e)=>{xd({type:1,toast:{id:t,height:e}})},r$=()=>{xd({type:5,time:Date.now()})},Pm=new Map,n$=1e3,s$=(t,e=n$)=>{if(Pm.has(t))return;let r=setTimeout(()=>{Pm.delete(t),xd({type:4,toastId:t})},e);Pm.set(t,r)},i$=t=>{let{toasts:e,pausedAt:r}=Zq(t);M.useEffect(()=>{if(r)return;let i=Date.now(),o=e.map(l=>{if(l.duration===1/0)return;let c=(l.duration||0)+l.pauseDuration-(i-l.createdAt);if(c<0){l.visible&&Ee.dismiss(l.id);return}return setTimeout(()=>Ee.dismiss(l.id),c)});return()=>{o.forEach(l=>l&&clearTimeout(l))}},[e,r]);let n=M.useCallback(()=>{r&&xd({type:6,time:Date.now()})},[r]),s=M.useCallback((i,o)=>{let{reverseOrder:l=!1,gutter:c=8,defaultPosition:u}=o||{},d=e.filter(m=>(m.position||u)===(i.position||u)&&m.height),h=d.findIndex(m=>m.id===i.id),g=d.filter((m,w)=>w<h&&m.visible).length;return d.filter(m=>m.visible).slice(...l?[g+1]:[0,g]).reduce((m,w)=>m+(w.height||0)+c,0)},[e]);return M.useEffect(()=>{e.forEach(i=>{if(i.dismissed)s$(i.id,i.removeDelay);else{let o=Pm.get(i.id);o&&(clearTimeout(o),Pm.delete(i.id))}})},[e]),{toasts:e,handlers:{updateHeight:t$,startPause:r$,endPause:n,calculateOffset:s}}},a$=hl`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,o$=hl`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,l$=hl`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,c$=iu("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${a$} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${o$} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${l$} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,u$=hl`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,d$=iu("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${u$} 1s linear infinite;
`,h$=hl`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,f$=hl`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,m$=iu("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${h$} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${f$} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,p$=iu("div")`
  position: absolute;
`,g$=iu("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,y$=hl`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,x$=iu("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${y$} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,v$=({toast:t})=>{let{icon:e,type:r,iconTheme:n}=t;return e!==void 0?typeof e=="string"?M.createElement(x$,null,e):e:r==="blank"?null:M.createElement(g$,null,M.createElement(d$,{...n}),r!=="loading"&&M.createElement(p$,null,r==="error"?M.createElement(c$,{...n}):M.createElement(m$,{...n})))},b$=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,w$=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,N$="0%{opacity:0;} 100%{opacity:1;}",_$="0%{opacity:1;} 100%{opacity:0;}",j$=iu("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,S$=iu("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,A$=(t,e)=>{let r=t.includes("top")?1:-1,[n,s]=PC()?[N$,_$]:[b$(r),w$(r)];return{animation:e?`${hl(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${hl(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},E$=M.memo(({toast:t,position:e,style:r,children:n})=>{let s=t.height?A$(t.position||e||"top-center",t.visible):{opacity:0},i=M.createElement(v$,{toast:t}),o=M.createElement(S$,{...t.ariaProps},Py(t.message,t));return M.createElement(j$,{className:t.className,style:{...s,...r,...t.style}},typeof n=="function"?n({icon:i,message:o}):M.createElement(M.Fragment,null,i,o))});Kq(M.createElement);var k$=({id:t,className:e,style:r,onHeightUpdate:n,children:s})=>{let i=M.useCallback(o=>{if(o){let l=()=>{let c=o.getBoundingClientRect().height;n(t,c)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[t,n]);return M.createElement("div",{ref:i,className:e,style:r},s)},T$=(t,e)=>{let r=t.includes("top"),n=r?{top:0}:{bottom:0},s=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:PC()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(r?1:-1)}px)`,...n,...s}},I$=zx`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Gg=16,C$=({reverseOrder:t,position:e="top-center",toastOptions:r,gutter:n,children:s,containerStyle:i,containerClassName:o})=>{let{toasts:l,handlers:c}=i$(r);return M.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:Gg,left:Gg,right:Gg,bottom:Gg,pointerEvents:"none",...i},className:o,onMouseEnter:c.startPause,onMouseLeave:c.endPause},l.map(u=>{let d=u.position||e,h=c.calculateOffset(u,{reverseOrder:t,gutter:n,defaultPosition:e}),g=T$(d,h);return M.createElement(k$,{id:u.id,key:u.id,onHeightUpdate:c.updateHeight,className:u.visible?I$:"",style:g},u.type==="custom"?Py(u.message,u):s?s(u):M.createElement(E$,{toast:u,position:d}))}))},_t=Ee;const DC=M.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),qx=M.createContext({}),$x=M.createContext(null),Wx=typeof document<"u",eN=Wx?M.useLayoutEffect:M.useEffect,LC=M.createContext({strict:!1}),tN=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),P$="framerAppearId",OC="data-"+tN(P$);function R$(t,e,r,n){const{visualElement:s}=M.useContext(qx),i=M.useContext(LC),o=M.useContext($x),l=M.useContext(DC).reducedMotion,c=M.useRef();n=n||i.renderer,!c.current&&n&&(c.current=n(t,{visualState:e,parent:s,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current;M.useInsertionEffect(()=>{u&&u.update(r,o)});const d=M.useRef(!!(r[OC]&&!window.HandoffComplete));return eN(()=>{u&&(u.render(),d.current&&u.animationState&&u.animationState.animateChanges())}),M.useEffect(()=>{u&&(u.updateFeatures(),!d.current&&u.animationState&&u.animationState.animateChanges(),d.current&&(d.current=!1,window.HandoffComplete=!0))}),u}function xh(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function D$(t,e,r){return M.useCallback(n=>{n&&t.mount&&t.mount(n),e&&(n?e.mount(n):e.unmount()),r&&(typeof r=="function"?r(n):xh(r)&&(r.current=n))},[e])}function pp(t){return typeof t=="string"||Array.isArray(t)}function Hx(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const rN=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],nN=["initial",...rN];function Gx(t){return Hx(t.animate)||nN.some(e=>pp(t[e]))}function MC(t){return!!(Gx(t)||t.variants)}function L$(t,e){if(Gx(t)){const{initial:r,animate:n}=t;return{initial:r===!1||pp(r)?r:void 0,animate:pp(n)?n:void 0}}return t.inherit!==!1?e:{}}function O$(t){const{initial:e,animate:r}=L$(t,M.useContext(qx));return M.useMemo(()=>({initial:e,animate:r}),[uS(e),uS(r)])}function uS(t){return Array.isArray(t)?t.join(" "):t}const dS={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},gp={};for(const t in dS)gp[t]={isEnabled:e=>dS[t].some(r=>!!e[r])};function M$(t){for(const e in t)gp[e]={...gp[e],...t[e]}}const sN=M.createContext({}),FC=M.createContext({}),F$=Symbol.for("motionComponentSymbol");function V$({preloadedFeatures:t,createVisualElement:e,useRender:r,useVisualState:n,Component:s}){t&&M$(t);function i(l,c){let u;const d={...M.useContext(DC),...l,layoutId:B$(l)},{isStatic:h}=d,g=O$(l),m=n(l,h);if(!h&&Wx){g.visualElement=R$(s,m,d,e);const w=M.useContext(FC),_=M.useContext(LC).strict;g.visualElement&&(u=g.visualElement.loadFeatures(d,_,t,w))}return M.createElement(qx.Provider,{value:g},u&&g.visualElement?M.createElement(u,{visualElement:g.visualElement,...d}):null,r(s,l,D$(m,g.visualElement,c),m,h,g.visualElement))}const o=M.forwardRef(i);return o[F$]=s,o}function B$({layoutId:t}){const e=M.useContext(sN).id;return e&&t!==void 0?e+"-"+t:t}function U$(t){function e(n,s={}){return V$(t(n,s))}if(typeof Proxy>"u")return e;const r=new Map;return new Proxy(e,{get:(n,s)=>(r.has(s)||r.set(s,e(s)),r.get(s))})}const z$=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function iN(t){return typeof t!="string"||t.includes("-")?!1:!!(z$.indexOf(t)>-1||/[A-Z]/.test(t))}const Ry={};function q$(t){Object.assign(Ry,t)}const qp=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],vd=new Set(qp);function VC(t,{layout:e,layoutId:r}){return vd.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!Ry[t]||t==="opacity")}const Js=t=>!!(t&&t.getVelocity),$$={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},W$=qp.length;function H$(t,{enableHardwareAcceleration:e=!0,allowTransformNone:r=!0},n,s){let i="";for(let o=0;o<W$;o++){const l=qp[o];if(t[l]!==void 0){const c=$$[l]||l;i+=`${c}(${t[l]}) `}}return e&&!t.z&&(i+="translateZ(0)"),i=i.trim(),s?i=s(t,n?"":i):r&&n&&(i="none"),i}const BC=t=>e=>typeof e=="string"&&e.startsWith(t),UC=BC("--"),fb=BC("var(--"),G$=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,K$=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Gc=(t,e,r)=>Math.min(Math.max(r,t),e),bd={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Rm={...bd,transform:t=>Gc(0,1,t)},Kg={...bd,default:1},Dm=t=>Math.round(t*1e5)/1e5,Kx=/(-)?([\d]*\.?[\d])+/g,zC=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,Y$=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function $p(t){return typeof t=="string"}const Wp=t=>({test:e=>$p(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),rc=Wp("deg"),ho=Wp("%"),vt=Wp("px"),Q$=Wp("vh"),J$=Wp("vw"),hS={...ho,parse:t=>ho.parse(t)/100,transform:t=>ho.transform(t*100)},fS={...bd,transform:Math.round},qC={borderWidth:vt,borderTopWidth:vt,borderRightWidth:vt,borderBottomWidth:vt,borderLeftWidth:vt,borderRadius:vt,radius:vt,borderTopLeftRadius:vt,borderTopRightRadius:vt,borderBottomRightRadius:vt,borderBottomLeftRadius:vt,width:vt,maxWidth:vt,height:vt,maxHeight:vt,size:vt,top:vt,right:vt,bottom:vt,left:vt,padding:vt,paddingTop:vt,paddingRight:vt,paddingBottom:vt,paddingLeft:vt,margin:vt,marginTop:vt,marginRight:vt,marginBottom:vt,marginLeft:vt,rotate:rc,rotateX:rc,rotateY:rc,rotateZ:rc,scale:Kg,scaleX:Kg,scaleY:Kg,scaleZ:Kg,skew:rc,skewX:rc,skewY:rc,distance:vt,translateX:vt,translateY:vt,translateZ:vt,x:vt,y:vt,z:vt,perspective:vt,transformPerspective:vt,opacity:Rm,originX:hS,originY:hS,originZ:vt,zIndex:fS,fillOpacity:Rm,strokeOpacity:Rm,numOctaves:fS};function aN(t,e,r,n){const{style:s,vars:i,transform:o,transformOrigin:l}=t;let c=!1,u=!1,d=!0;for(const h in e){const g=e[h];if(UC(h)){i[h]=g;continue}const m=qC[h],w=K$(g,m);if(vd.has(h)){if(c=!0,o[h]=w,!d)continue;g!==(m.default||0)&&(d=!1)}else h.startsWith("origin")?(u=!0,l[h]=w):s[h]=w}if(e.transform||(c||n?s.transform=H$(t.transform,r,d,n):s.transform&&(s.transform="none")),u){const{originX:h="50%",originY:g="50%",originZ:m=0}=l;s.transformOrigin=`${h} ${g} ${m}`}}const oN=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function $C(t,e,r){for(const n in e)!Js(e[n])&&!VC(n,r)&&(t[n]=e[n])}function X$({transformTemplate:t},e,r){return M.useMemo(()=>{const n=oN();return aN(n,e,{enableHardwareAcceleration:!r},t),Object.assign({},n.vars,n.style)},[e])}function Z$(t,e,r){const n=t.style||{},s={};return $C(s,n,t),Object.assign(s,X$(t,e,r)),t.transformValues?t.transformValues(s):s}function eW(t,e,r){const n={},s=Z$(t,e,r);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=s,n}const tW=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Dy(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||tW.has(t)}let WC=t=>!Dy(t);function rW(t){t&&(WC=e=>e.startsWith("on")?!Dy(e):t(e))}try{rW(require("@emotion/is-prop-valid").default)}catch{}function nW(t,e,r){const n={};for(const s in t)s==="values"&&typeof t.values=="object"||(WC(s)||r===!0&&Dy(s)||!e&&!Dy(s)||t.draggable&&s.startsWith("onDrag"))&&(n[s]=t[s]);return n}function mS(t,e,r){return typeof t=="string"?t:vt.transform(e+r*t)}function sW(t,e,r){const n=mS(e,t.x,t.width),s=mS(r,t.y,t.height);return`${n} ${s}`}const iW={offset:"stroke-dashoffset",array:"stroke-dasharray"},aW={offset:"strokeDashoffset",array:"strokeDasharray"};function oW(t,e,r=1,n=0,s=!0){t.pathLength=1;const i=s?iW:aW;t[i.offset]=vt.transform(-n);const o=vt.transform(e),l=vt.transform(r);t[i.array]=`${o} ${l}`}function lN(t,{attrX:e,attrY:r,attrScale:n,originX:s,originY:i,pathLength:o,pathSpacing:l=1,pathOffset:c=0,...u},d,h,g){if(aN(t,u,d,g),h){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:m,style:w,dimensions:_}=t;m.transform&&(_&&(w.transform=m.transform),delete m.transform),_&&(s!==void 0||i!==void 0||w.transform)&&(w.transformOrigin=sW(_,s!==void 0?s:.5,i!==void 0?i:.5)),e!==void 0&&(m.x=e),r!==void 0&&(m.y=r),n!==void 0&&(m.scale=n),o!==void 0&&oW(m,o,l,c,!1)}const HC=()=>({...oN(),attrs:{}}),cN=t=>typeof t=="string"&&t.toLowerCase()==="svg";function lW(t,e,r,n){const s=M.useMemo(()=>{const i=HC();return lN(i,e,{enableHardwareAcceleration:!1},cN(n),t.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};$C(i,t.style,t),s.style={...i,...s.style}}return s}function cW(t=!1){return(r,n,s,{latestValues:i},o)=>{const c=(iN(r)?lW:eW)(n,i,o,r),d={...nW(n,typeof r=="string",t),...c,ref:s},{children:h}=n,g=M.useMemo(()=>Js(h)?h.get():h,[h]);return M.createElement(r,{...d,children:g})}}function GC(t,{style:e,vars:r},n,s){Object.assign(t.style,e,s&&s.getProjectionStyles(n));for(const i in r)t.style.setProperty(i,r[i])}const KC=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function YC(t,e,r,n){GC(t,e,void 0,n);for(const s in e.attrs)t.setAttribute(KC.has(s)?s:tN(s),e.attrs[s])}function uN(t,e){const{style:r}=t,n={};for(const s in r)(Js(r[s])||e.style&&Js(e.style[s])||VC(s,t))&&(n[s]=r[s]);return n}function QC(t,e){const r=uN(t,e);for(const n in t)if(Js(t[n])||Js(e[n])){const s=qp.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;r[s]=t[n]}return r}function dN(t,e,r,n={},s={}){return typeof e=="function"&&(e=e(r!==void 0?r:t.custom,n,s)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(r!==void 0?r:t.custom,n,s)),e}function JC(t){const e=M.useRef(null);return e.current===null&&(e.current=t()),e.current}const Ly=t=>Array.isArray(t),uW=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),dW=t=>Ly(t)?t[t.length-1]||0:t;function E0(t){const e=Js(t)?t.get():t;return uW(e)?e.toValue():e}function hW({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:r},n,s,i){const o={latestValues:fW(n,s,i,t),renderState:e()};return r&&(o.mount=l=>r(n,l,o)),o}const XC=t=>(e,r)=>{const n=M.useContext(qx),s=M.useContext($x),i=()=>hW(t,e,n,s);return r?i():JC(i)};function fW(t,e,r,n){const s={},i=n(t,{});for(const g in i)s[g]=E0(i[g]);let{initial:o,animate:l}=t;const c=Gx(t),u=MC(t);e&&u&&!c&&t.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let d=r?r.initial===!1:!1;d=d||o===!1;const h=d?l:o;return h&&typeof h!="boolean"&&!Hx(h)&&(Array.isArray(h)?h:[h]).forEach(m=>{const w=dN(t,m);if(!w)return;const{transitionEnd:_,transition:T,...v}=w;for(const b in v){let x=v[b];if(Array.isArray(x)){const P=d?x.length-1:0;x=x[P]}x!==null&&(s[b]=x)}for(const b in _)s[b]=_[b]}),s}const Xr=t=>t;class pS{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const r=this.order.indexOf(e);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function mW(t){let e=new pS,r=new pS,n=0,s=!1,i=!1;const o=new WeakSet,l={schedule:(c,u=!1,d=!1)=>{const h=d&&s,g=h?e:r;return u&&o.add(c),g.add(c)&&h&&s&&(n=e.order.length),c},cancel:c=>{r.remove(c),o.delete(c)},process:c=>{if(s){i=!0;return}if(s=!0,[e,r]=[r,e],r.clear(),n=e.order.length,n)for(let u=0;u<n;u++){const d=e.order[u];d(c),o.has(d)&&(l.schedule(d),t())}s=!1,i&&(i=!1,l.process(c))}};return l}const Yg=["prepare","read","update","preRender","render","postRender"],pW=40;function gW(t,e){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=Yg.reduce((h,g)=>(h[g]=mW(()=>r=!0),h),{}),o=h=>i[h].process(s),l=()=>{const h=performance.now();r=!1,s.delta=n?1e3/60:Math.max(Math.min(h-s.timestamp,pW),1),s.timestamp=h,s.isProcessing=!0,Yg.forEach(o),s.isProcessing=!1,r&&e&&(n=!1,t(l))},c=()=>{r=!0,n=!0,s.isProcessing||t(l)};return{schedule:Yg.reduce((h,g)=>{const m=i[g];return h[g]=(w,_=!1,T=!1)=>(r||c(),m.schedule(w,_,T)),h},{}),cancel:h=>Yg.forEach(g=>i[g].cancel(h)),state:s,steps:i}}const{schedule:jr,cancel:fl,state:ss,steps:fv}=gW(typeof requestAnimationFrame<"u"?requestAnimationFrame:Xr,!0),yW={useVisualState:XC({scrapeMotionValuesFromProps:QC,createRenderState:HC,onMount:(t,e,{renderState:r,latestValues:n})=>{jr.read(()=>{try{r.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),jr.render(()=>{lN(r,n,{enableHardwareAcceleration:!1},cN(e.tagName),t.transformTemplate),YC(e,r)})}})},xW={useVisualState:XC({scrapeMotionValuesFromProps:uN,createRenderState:oN})};function vW(t,{forwardMotionProps:e=!1},r,n){return{...iN(t)?yW:xW,preloadedFeatures:r,useRender:cW(e),createVisualElement:n,Component:t}}function Qo(t,e,r,n={passive:!0}){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r)}const ZC=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function Yx(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const bW=t=>e=>ZC(e)&&t(e,Yx(e));function rl(t,e,r,n){return Qo(t,e,bW(r),n)}const wW=(t,e)=>r=>e(t(r)),Rc=(...t)=>t.reduce(wW);function e6(t){let e=null;return()=>{const r=()=>{e=null};return e===null?(e=t,r):!1}}const gS=e6("dragHorizontal"),yS=e6("dragVertical");function t6(t){let e=!1;if(t==="y")e=yS();else if(t==="x")e=gS();else{const r=gS(),n=yS();r&&n?e=()=>{r(),n()}:(r&&r(),n&&n())}return e}function r6(){const t=t6(!0);return t?(t(),!1):!0}class au{constructor(e){this.isMounted=!1,this.node=e}update(){}}function xS(t,e){const r="pointer"+(e?"enter":"leave"),n="onHover"+(e?"Start":"End"),s=(i,o)=>{if(i.pointerType==="touch"||r6())return;const l=t.getProps();t.animationState&&l.whileHover&&t.animationState.setActive("whileHover",e),l[n]&&jr.update(()=>l[n](i,o))};return rl(t.current,r,s,{passive:!t.getProps()[n]})}class NW extends au{mount(){this.unmount=Rc(xS(this.node,!0),xS(this.node,!1))}unmount(){}}class _W extends au{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Rc(Qo(this.node.current,"focus",()=>this.onFocus()),Qo(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const n6=(t,e)=>e?t===e?!0:n6(t,e.parentElement):!1;function mv(t,e){if(!e)return;const r=new PointerEvent("pointer"+t);e(r,Yx(r))}class jW extends au{constructor(){super(...arguments),this.removeStartListeners=Xr,this.removeEndListeners=Xr,this.removeAccessibleListeners=Xr,this.startPointerPress=(e,r)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),i=rl(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:u,onTapCancel:d,globalTapTarget:h}=this.node.getProps();jr.update(()=>{!h&&!n6(this.node.current,l.target)?d&&d(l,c):u&&u(l,c)})},{passive:!(n.onTap||n.onPointerUp)}),o=rl(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=Rc(i,o),this.startPress(e,r)},this.startAccessiblePress=()=>{const e=i=>{if(i.key!=="Enter"||this.isPressing)return;const o=l=>{l.key!=="Enter"||!this.checkPressEnd()||mv("up",(c,u)=>{const{onTap:d}=this.node.getProps();d&&jr.update(()=>d(c,u))})};this.removeEndListeners(),this.removeEndListeners=Qo(this.node.current,"keyup",o),mv("down",(l,c)=>{this.startPress(l,c)})},r=Qo(this.node.current,"keydown",e),n=()=>{this.isPressing&&mv("cancel",(i,o)=>this.cancelPress(i,o))},s=Qo(this.node.current,"blur",n);this.removeAccessibleListeners=Rc(r,s)}}startPress(e,r){this.isPressing=!0;const{onTapStart:n,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&jr.update(()=>n(e,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!r6()}cancelPress(e,r){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&jr.update(()=>n(e,r))}mount(){const e=this.node.getProps(),r=rl(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),n=Qo(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Rc(r,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const mb=new WeakMap,pv=new WeakMap,SW=t=>{const e=mb.get(t.target);e&&e(t)},AW=t=>{t.forEach(SW)};function EW({root:t,...e}){const r=t||document;pv.has(r)||pv.set(r,{});const n=pv.get(r),s=JSON.stringify(e);return n[s]||(n[s]=new IntersectionObserver(AW,{root:t,...e})),n[s]}function kW(t,e,r){const n=EW(e);return mb.set(t,r),n.observe(t),()=>{mb.delete(t),n.unobserve(t)}}const TW={some:0,all:1};class IW extends au{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:i}=e,o={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:TW[s]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,i&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:h}=this.node.getProps(),g=u?d:h;g&&g(c)};return kW(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(CW(e,r))&&this.startObserver()}unmount(){}}function CW({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const PW={inView:{Feature:IW},tap:{Feature:jW},focus:{Feature:_W},hover:{Feature:NW}};function s6(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}function RW(t){const e={};return t.values.forEach((r,n)=>e[n]=r.get()),e}function DW(t){const e={};return t.values.forEach((r,n)=>e[n]=r.getVelocity()),e}function Qx(t,e,r){const n=t.getProps();return dN(n,e,r!==void 0?r:n.custom,RW(t),DW(t))}let LW=Xr,Jx=Xr;const Dc=t=>t*1e3,nl=t=>t/1e3,OW={current:!1},i6=t=>Array.isArray(t)&&typeof t[0]=="number";function a6(t){return!!(!t||typeof t=="string"&&o6[t]||i6(t)||Array.isArray(t)&&t.every(a6))}const hm=([t,e,r,n])=>`cubic-bezier(${t}, ${e}, ${r}, ${n})`,o6={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:hm([0,.65,.55,1]),circOut:hm([.55,0,1,.45]),backIn:hm([.31,.01,.66,-.59]),backOut:hm([.33,1.53,.69,.99])};function l6(t){if(t)return i6(t)?hm(t):Array.isArray(t)?t.map(l6):o6[t]}function MW(t,e,r,{delay:n=0,duration:s,repeat:i=0,repeatType:o="loop",ease:l,times:c}={}){const u={[e]:r};c&&(u.offset=c);const d=l6(l);return Array.isArray(d)&&(u.easing=d),t.animate(u,{delay:n,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}function FW(t,{repeat:e,repeatType:r="loop"}){const n=e&&r!=="loop"&&e%2===1?0:t.length-1;return t[n]}const c6=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,VW=1e-7,BW=12;function UW(t,e,r,n,s){let i,o,l=0;do o=e+(r-e)/2,i=c6(o,n,s)-t,i>0?r=o:e=o;while(Math.abs(i)>VW&&++l<BW);return o}function Hp(t,e,r,n){if(t===e&&r===n)return Xr;const s=i=>UW(i,0,1,t,r);return i=>i===0||i===1?i:c6(s(i),e,n)}const zW=Hp(.42,0,1,1),qW=Hp(0,0,.58,1),u6=Hp(.42,0,.58,1),$W=t=>Array.isArray(t)&&typeof t[0]!="number",d6=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,h6=t=>e=>1-t(1-e),hN=t=>1-Math.sin(Math.acos(t)),f6=h6(hN),WW=d6(hN),m6=Hp(.33,1.53,.69,.99),fN=h6(m6),HW=d6(fN),GW=t=>(t*=2)<1?.5*fN(t):.5*(2-Math.pow(2,-10*(t-1))),KW={linear:Xr,easeIn:zW,easeInOut:u6,easeOut:qW,circIn:hN,circInOut:WW,circOut:f6,backIn:fN,backInOut:HW,backOut:m6,anticipate:GW},vS=t=>{if(Array.isArray(t)){Jx(t.length===4);const[e,r,n,s]=t;return Hp(e,r,n,s)}else if(typeof t=="string")return KW[t];return t},mN=(t,e)=>r=>!!($p(r)&&Y$.test(r)&&r.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(r,e)),p6=(t,e,r)=>n=>{if(!$p(n))return n;const[s,i,o,l]=n.match(Kx);return{[t]:parseFloat(s),[e]:parseFloat(i),[r]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},YW=t=>Gc(0,255,t),gv={...bd,transform:t=>Math.round(YW(t))},Wu={test:mN("rgb","red"),parse:p6("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:n=1})=>"rgba("+gv.transform(t)+", "+gv.transform(e)+", "+gv.transform(r)+", "+Dm(Rm.transform(n))+")"};function QW(t){let e="",r="",n="",s="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),n=t.substring(3,4),s=t.substring(4,5),e+=e,r+=r,n+=n,s+=s),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const pb={test:mN("#"),parse:QW,transform:Wu.transform},vh={test:mN("hsl","hue"),parse:p6("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:n=1})=>"hsla("+Math.round(t)+", "+ho.transform(Dm(e))+", "+ho.transform(Dm(r))+", "+Dm(Rm.transform(n))+")"},Ns={test:t=>Wu.test(t)||pb.test(t)||vh.test(t),parse:t=>Wu.test(t)?Wu.parse(t):vh.test(t)?vh.parse(t):pb.parse(t),transform:t=>$p(t)?t:t.hasOwnProperty("red")?Wu.transform(t):vh.transform(t)},Mr=(t,e,r)=>-r*t+r*e+t;function yv(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function JW({hue:t,saturation:e,lightness:r,alpha:n}){t/=360,e/=100,r/=100;let s=0,i=0,o=0;if(!e)s=i=o=r;else{const l=r<.5?r*(1+e):r+e-r*e,c=2*r-l;s=yv(c,l,t+1/3),i=yv(c,l,t),o=yv(c,l,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:n}}const xv=(t,e,r)=>{const n=t*t;return Math.sqrt(Math.max(0,r*(e*e-n)+n))},XW=[pb,Wu,vh],ZW=t=>XW.find(e=>e.test(t));function bS(t){const e=ZW(t);let r=e.parse(t);return e===vh&&(r=JW(r)),r}const g6=(t,e)=>{const r=bS(t),n=bS(e),s={...r};return i=>(s.red=xv(r.red,n.red,i),s.green=xv(r.green,n.green,i),s.blue=xv(r.blue,n.blue,i),s.alpha=Mr(r.alpha,n.alpha,i),Wu.transform(s))};function eH(t){var e,r;return isNaN(t)&&$p(t)&&(((e=t.match(Kx))===null||e===void 0?void 0:e.length)||0)+(((r=t.match(zC))===null||r===void 0?void 0:r.length)||0)>0}const y6={regex:G$,countKey:"Vars",token:"${v}",parse:Xr},x6={regex:zC,countKey:"Colors",token:"${c}",parse:Ns.parse},v6={regex:Kx,countKey:"Numbers",token:"${n}",parse:bd.parse};function vv(t,{regex:e,countKey:r,token:n,parse:s}){const i=t.tokenised.match(e);i&&(t["num"+r]=i.length,t.tokenised=t.tokenised.replace(e,n),t.values.push(...i.map(s)))}function Oy(t){const e=t.toString(),r={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&vv(r,y6),vv(r,x6),vv(r,v6),r}function b6(t){return Oy(t).values}function w6(t){const{values:e,numColors:r,numVars:n,tokenised:s}=Oy(t),i=e.length;return o=>{let l=s;for(let c=0;c<i;c++)c<n?l=l.replace(y6.token,o[c]):c<n+r?l=l.replace(x6.token,Ns.transform(o[c])):l=l.replace(v6.token,Dm(o[c]));return l}}const tH=t=>typeof t=="number"?0:t;function rH(t){const e=b6(t);return w6(t)(e.map(tH))}const Kc={test:eH,parse:b6,createTransformer:w6,getAnimatableNone:rH},N6=(t,e)=>r=>`${r>0?e:t}`;function _6(t,e){return typeof t=="number"?r=>Mr(t,e,r):Ns.test(t)?g6(t,e):t.startsWith("var(")?N6(t,e):S6(t,e)}const j6=(t,e)=>{const r=[...t],n=r.length,s=t.map((i,o)=>_6(i,e[o]));return i=>{for(let o=0;o<n;o++)r[o]=s[o](i);return r}},nH=(t,e)=>{const r={...t,...e},n={};for(const s in r)t[s]!==void 0&&e[s]!==void 0&&(n[s]=_6(t[s],e[s]));return s=>{for(const i in n)r[i]=n[i](s);return r}},S6=(t,e)=>{const r=Kc.createTransformer(e),n=Oy(t),s=Oy(e);return n.numVars===s.numVars&&n.numColors===s.numColors&&n.numNumbers>=s.numNumbers?Rc(j6(n.values,s.values),r):N6(t,e)},yp=(t,e,r)=>{const n=e-t;return n===0?1:(r-t)/n},wS=(t,e)=>r=>Mr(t,e,r);function sH(t){return typeof t=="number"?wS:typeof t=="string"?Ns.test(t)?g6:S6:Array.isArray(t)?j6:typeof t=="object"?nH:wS}function iH(t,e,r){const n=[],s=r||sH(t[0]),i=t.length-1;for(let o=0;o<i;o++){let l=s(t[o],t[o+1]);if(e){const c=Array.isArray(e)?e[o]||Xr:e;l=Rc(c,l)}n.push(l)}return n}function A6(t,e,{clamp:r=!0,ease:n,mixer:s}={}){const i=t.length;if(Jx(i===e.length),i===1)return()=>e[0];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=iH(e,n,s),l=o.length,c=u=>{let d=0;if(l>1)for(;d<t.length-2&&!(u<t[d+1]);d++);const h=yp(t[d],t[d+1],u);return o[d](h)};return r?u=>c(Gc(t[0],t[i-1],u)):c}function aH(t,e){const r=t[t.length-1];for(let n=1;n<=e;n++){const s=yp(0,e,n);t.push(Mr(r,1,s))}}function oH(t){const e=[0];return aH(e,t.length-1),e}function lH(t,e){return t.map(r=>r*e)}function cH(t,e){return t.map(()=>e||u6).splice(0,t.length-1)}function My({duration:t=300,keyframes:e,times:r,ease:n="easeInOut"}){const s=$W(n)?n.map(vS):vS(n),i={done:!1,value:e[0]},o=lH(r&&r.length===e.length?r:oH(e),t),l=A6(o,e,{ease:Array.isArray(s)?s:cH(e,s)});return{calculatedDuration:t,next:c=>(i.value=l(c),i.done=c>=t,i)}}function E6(t,e){return e?t*(1e3/e):0}const uH=5;function k6(t,e,r){const n=Math.max(e-uH,0);return E6(r-t(n),e-n)}const bv=.001,dH=.01,NS=10,hH=.05,fH=1;function mH({duration:t=800,bounce:e=.25,velocity:r=0,mass:n=1}){let s,i;LW(t<=Dc(NS));let o=1-e;o=Gc(hH,fH,o),t=Gc(dH,NS,nl(t)),o<1?(s=u=>{const d=u*o,h=d*t,g=d-r,m=gb(u,o),w=Math.exp(-h);return bv-g/m*w},i=u=>{const h=u*o*t,g=h*r+r,m=Math.pow(o,2)*Math.pow(u,2)*t,w=Math.exp(-h),_=gb(Math.pow(u,2),o);return(-s(u)+bv>0?-1:1)*((g-m)*w)/_}):(s=u=>{const d=Math.exp(-u*t),h=(u-r)*t+1;return-bv+d*h},i=u=>{const d=Math.exp(-u*t),h=(r-u)*(t*t);return d*h});const l=5/t,c=gH(s,i,l);if(t=Dc(t),isNaN(c))return{stiffness:100,damping:10,duration:t};{const u=Math.pow(c,2)*n;return{stiffness:u,damping:o*2*Math.sqrt(n*u),duration:t}}}const pH=12;function gH(t,e,r){let n=r;for(let s=1;s<pH;s++)n=n-t(n)/e(n);return n}function gb(t,e){return t*Math.sqrt(1-e*e)}const yH=["duration","bounce"],xH=["stiffness","damping","mass"];function _S(t,e){return e.some(r=>t[r]!==void 0)}function vH(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!_S(t,xH)&&_S(t,yH)){const r=mH(t);e={...e,...r,mass:1},e.isResolvedFromDuration=!0}return e}function T6({keyframes:t,restDelta:e,restSpeed:r,...n}){const s=t[0],i=t[t.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:g}=vH({...n,velocity:-nl(n.velocity||0)}),m=h||0,w=c/(2*Math.sqrt(l*u)),_=i-s,T=nl(Math.sqrt(l/u)),v=Math.abs(_)<5;r||(r=v?.01:2),e||(e=v?.005:.5);let b;if(w<1){const x=gb(T,w);b=P=>{const F=Math.exp(-w*T*P);return i-F*((m+w*T*_)/x*Math.sin(x*P)+_*Math.cos(x*P))}}else if(w===1)b=x=>i-Math.exp(-T*x)*(_+(m+T*_)*x);else{const x=T*Math.sqrt(w*w-1);b=P=>{const F=Math.exp(-w*T*P),$=Math.min(x*P,300);return i-F*((m+w*T*_)*Math.sinh($)+x*_*Math.cosh($))/x}}return{calculatedDuration:g&&d||null,next:x=>{const P=b(x);if(g)o.done=x>=d;else{let F=m;x!==0&&(w<1?F=k6(b,x,P):F=0);const $=Math.abs(F)<=r,k=Math.abs(i-P)<=e;o.done=$&&k}return o.value=o.done?i:P,o}}}function jS({keyframes:t,velocity:e=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:l,max:c,restDelta:u=.5,restSpeed:d}){const h=t[0],g={done:!1,value:h},m=A=>l!==void 0&&A<l||c!==void 0&&A>c,w=A=>l===void 0?c:c===void 0||Math.abs(l-A)<Math.abs(c-A)?l:c;let _=r*e;const T=h+_,v=o===void 0?T:o(T);v!==T&&(_=v-h);const b=A=>-_*Math.exp(-A/n),x=A=>v+b(A),P=A=>{const I=b(A),O=x(A);g.done=Math.abs(I)<=u,g.value=g.done?v:O};let F,$;const k=A=>{m(g.value)&&(F=A,$=T6({keyframes:[g.value,w(g.value)],velocity:k6(x,A,g.value),damping:s,stiffness:i,restDelta:u,restSpeed:d}))};return k(0),{calculatedDuration:null,next:A=>{let I=!1;return!$&&F===void 0&&(I=!0,P(A),k(A)),F!==void 0&&A>F?$.next(A-F):(!I&&P(A),g)}}}const bH=t=>{const e=({timestamp:r})=>t(r);return{start:()=>jr.update(e,!0),stop:()=>fl(e),now:()=>ss.isProcessing?ss.timestamp:performance.now()}},SS=2e4;function AS(t){let e=0;const r=50;let n=t.next(e);for(;!n.done&&e<SS;)e+=r,n=t.next(e);return e>=SS?1/0:e}const wH={decay:jS,inertia:jS,tween:My,keyframes:My,spring:T6};function Fy({autoplay:t=!0,delay:e=0,driver:r=bH,keyframes:n,type:s="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:l="loop",onPlay:c,onStop:u,onComplete:d,onUpdate:h,...g}){let m=1,w=!1,_,T;const v=()=>{T=new Promise(Se=>{_=Se})};v();let b;const x=wH[s]||My;let P;x!==My&&typeof n[0]!="number"&&(P=A6([0,100],n,{clamp:!1}),n=[0,100]);const F=x({...g,keyframes:n});let $;l==="mirror"&&($=x({...g,keyframes:[...n].reverse(),velocity:-(g.velocity||0)}));let k="idle",A=null,I=null,O=null;F.calculatedDuration===null&&i&&(F.calculatedDuration=AS(F));const{calculatedDuration:S}=F;let R=1/0,C=1/0;S!==null&&(R=S+o,C=R*(i+1)-o);let G=0;const de=Se=>{if(I===null)return;m>0&&(I=Math.min(I,Se)),m<0&&(I=Math.min(Se-C/m,I)),A!==null?G=A:G=Math.round(Se-I)*m;const U=G-e*(m>=0?1:-1),J=m>=0?U<0:U>C;G=Math.max(U,0),k==="finished"&&A===null&&(G=C);let te=G,ie=F;if(i){const be=Math.min(G,C)/R;let Me=Math.floor(be),De=be%1;!De&&be>=1&&(De=1),De===1&&Me--,Me=Math.min(Me,i+1),!!(Me%2)&&(l==="reverse"?(De=1-De,o&&(De-=o/R)):l==="mirror"&&(ie=$)),te=Gc(0,1,De)*R}const ue=J?{done:!1,value:n[0]}:ie.next(te);P&&(ue.value=P(ue.value));let{done:ge}=ue;!J&&S!==null&&(ge=m>=0?G>=C:G<=0);const we=A===null&&(k==="finished"||k==="running"&&ge);return h&&h(ue.value),we&&Y(),ue},ne=()=>{b&&b.stop(),b=void 0},X=()=>{k="idle",ne(),_(),v(),I=O=null},Y=()=>{k="finished",d&&d(),ne(),_()},Q=()=>{if(w)return;b||(b=r(de));const Se=b.now();c&&c(),A!==null?I=Se-A:(!I||k==="finished")&&(I=Se),k==="finished"&&v(),O=I,A=null,k="running",b.start()};t&&Q();const se={then(Se,U){return T.then(Se,U)},get time(){return nl(G)},set time(Se){Se=Dc(Se),G=Se,A!==null||!b||m===0?A=Se:I=b.now()-Se/m},get duration(){const Se=F.calculatedDuration===null?AS(F):F.calculatedDuration;return nl(Se)},get speed(){return m},set speed(Se){Se===m||!b||(m=Se,se.time=nl(G))},get state(){return k},play:Q,pause:()=>{k="paused",A=G},stop:()=>{w=!0,k!=="idle"&&(k="idle",u&&u(),X())},cancel:()=>{O!==null&&de(O),X()},complete:()=>{k="finished"},sample:Se=>(I=0,de(Se))};return se}function NH(t){let e;return()=>(e===void 0&&(e=t()),e)}const _H=NH(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),jH=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Qg=10,SH=2e4,AH=(t,e)=>e.type==="spring"||t==="backgroundColor"||!a6(e.ease);function EH(t,e,{onUpdate:r,onComplete:n,...s}){if(!(_H()&&jH.has(e)&&!s.repeatDelay&&s.repeatType!=="mirror"&&s.damping!==0&&s.type!=="inertia"))return!1;let o=!1,l,c,u=!1;const d=()=>{c=new Promise(x=>{l=x})};d();let{keyframes:h,duration:g=300,ease:m,times:w}=s;if(AH(e,s)){const x=Fy({...s,repeat:0,delay:0});let P={done:!1,value:h[0]};const F=[];let $=0;for(;!P.done&&$<SH;)P=x.sample($),F.push(P.value),$+=Qg;w=void 0,h=F,g=$-Qg,m="linear"}const _=MW(t.owner.current,e,h,{...s,duration:g,ease:m,times:w}),T=()=>{u=!1,_.cancel()},v=()=>{u=!0,jr.update(T),l(),d()};return _.onfinish=()=>{u||(t.set(FW(h,s)),n&&n(),v())},{then(x,P){return c.then(x,P)},attachTimeline(x){return _.timeline=x,_.onfinish=null,Xr},get time(){return nl(_.currentTime||0)},set time(x){_.currentTime=Dc(x)},get speed(){return _.playbackRate},set speed(x){_.playbackRate=x},get duration(){return nl(g)},play:()=>{o||(_.play(),fl(T))},pause:()=>_.pause(),stop:()=>{if(o=!0,_.playState==="idle")return;const{currentTime:x}=_;if(x){const P=Fy({...s,autoplay:!1});t.setWithVelocity(P.sample(x-Qg).value,P.sample(x).value,Qg)}v()},complete:()=>{u||_.finish()},cancel:v}}function kH({keyframes:t,delay:e,onUpdate:r,onComplete:n}){const s=()=>(r&&r(t[t.length-1]),n&&n(),{time:0,speed:1,duration:0,play:Xr,pause:Xr,stop:Xr,then:i=>(i(),Promise.resolve()),cancel:Xr,complete:Xr});return e?Fy({keyframes:[0,1],duration:0,delay:e,onComplete:s}):s()}const TH={type:"spring",stiffness:500,damping:25,restSpeed:10},IH=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),CH={type:"keyframes",duration:.8},PH={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},RH=(t,{keyframes:e})=>e.length>2?CH:vd.has(t)?t.startsWith("scale")?IH(e[1]):TH:PH,yb=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Kc.test(e)||e==="0")&&!e.startsWith("url(")),DH=new Set(["brightness","contrast","saturate","opacity"]);function LH(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=r.match(Kx)||[];if(!n)return t;const s=r.replace(n,"");let i=DH.has(e)?1:0;return n!==r&&(i*=100),e+"("+i+s+")"}const OH=/([a-z-]*)\(.*?\)/g,xb={...Kc,getAnimatableNone:t=>{const e=t.match(OH);return e?e.map(LH).join(" "):t}},MH={...qC,color:Ns,backgroundColor:Ns,outlineColor:Ns,fill:Ns,stroke:Ns,borderColor:Ns,borderTopColor:Ns,borderRightColor:Ns,borderBottomColor:Ns,borderLeftColor:Ns,filter:xb,WebkitFilter:xb},pN=t=>MH[t];function I6(t,e){let r=pN(t);return r!==xb&&(r=Kc),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const C6=t=>/^0[^.\s]+$/.test(t);function FH(t){if(typeof t=="number")return t===0;if(t!==null)return t==="none"||t==="0"||C6(t)}function VH(t,e,r,n){const s=yb(e,r);let i;Array.isArray(r)?i=[...r]:i=[null,r];const o=n.from!==void 0?n.from:t.get();let l;const c=[];for(let u=0;u<i.length;u++)i[u]===null&&(i[u]=u===0?o:i[u-1]),FH(i[u])&&c.push(u),typeof i[u]=="string"&&i[u]!=="none"&&i[u]!=="0"&&(l=i[u]);if(s&&c.length&&l)for(let u=0;u<c.length;u++){const d=c[u];i[d]=I6(e,l)}return i}function BH({when:t,delay:e,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:l,from:c,elapsed:u,...d}){return!!Object.keys(d).length}function gN(t,e){return t[e]||t.default||t}const UH={skipAnimations:!1},yN=(t,e,r,n={})=>s=>{const i=gN(n,t)||{},o=i.delay||n.delay||0;let{elapsed:l=0}=n;l=l-Dc(o);const c=VH(e,t,r,i),u=c[0],d=c[c.length-1],h=yb(t,u),g=yb(t,d);let m={keyframes:c,velocity:e.getVelocity(),ease:"easeOut",...i,delay:-l,onUpdate:w=>{e.set(w),i.onUpdate&&i.onUpdate(w)},onComplete:()=>{s(),i.onComplete&&i.onComplete()}};if(BH(i)||(m={...m,...RH(t,m)}),m.duration&&(m.duration=Dc(m.duration)),m.repeatDelay&&(m.repeatDelay=Dc(m.repeatDelay)),!h||!g||OW.current||i.type===!1||UH.skipAnimations)return kH(m);if(!n.isHandoff&&e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const w=EH(e,t,m);if(w)return w}return Fy(m)};function Vy(t){return!!(Js(t)&&t.add)}const P6=t=>/^\-?\d*\.?\d+$/.test(t);function xN(t,e){t.indexOf(e)===-1&&t.push(e)}function vN(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}class bN{constructor(){this.subscriptions=[]}add(e){return xN(this.subscriptions,e),()=>vN(this.subscriptions,e)}notify(e,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,r,n);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(e,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const zH=t=>!isNaN(parseFloat(t));class qH{constructor(e,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,s=!0)=>{this.prev=this.current,this.current=n;const{delta:i,timestamp:o}=ss;this.lastUpdated!==o&&(this.timeDelta=i,this.lastUpdated=o,jr.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>jr.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=zH(this.current),this.owner=r.owner}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new bN);const n=this.events[e].add(r);return e==="change"?()=>{n(),jr.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e,r=!0){!r||!this.passiveEffect?this.updateAndNotify(e,r):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,r,n){this.set(r),this.prev=e,this.timeDelta=n}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?E6(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function sf(t,e){return new qH(t,e)}const R6=t=>e=>e.test(t),$H={test:t=>t==="auto",parse:t=>t},D6=[bd,vt,ho,rc,J$,Q$,$H],Zf=t=>D6.find(R6(t)),WH=[...D6,Ns,Kc],HH=t=>WH.find(R6(t));function GH(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,sf(r))}function KH(t,e){const r=Qx(t,e);let{transitionEnd:n={},transition:s={},...i}=r?t.makeTargetAnimatable(r,!1):{};i={...i,...n};for(const o in i){const l=dW(i[o]);GH(t,o,l)}}function YH(t,e,r){var n,s;const i=Object.keys(e).filter(l=>!t.hasValue(l)),o=i.length;if(o)for(let l=0;l<o;l++){const c=i[l],u=e[c];let d=null;Array.isArray(u)&&(d=u[0]),d===null&&(d=(s=(n=r[c])!==null&&n!==void 0?n:t.readValue(c))!==null&&s!==void 0?s:e[c]),d!=null&&(typeof d=="string"&&(P6(d)||C6(d))?d=parseFloat(d):!HH(d)&&Kc.test(u)&&(d=I6(c,u)),t.addValue(c,sf(d,{owner:t})),r[c]===void 0&&(r[c]=d),d!==null&&t.setBaseTarget(c,d))}}function QH(t,e){return e?(e[t]||e.default||e).from:void 0}function JH(t,e,r){const n={};for(const s in t){const i=QH(s,e);if(i!==void 0)n[s]=i;else{const o=r.getValue(s);o&&(n[s]=o.get())}}return n}function XH({protectedKeys:t,needsAnimating:e},r){const n=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,n}function ZH(t,e){const r=t.get();if(Array.isArray(e)){for(let n=0;n<e.length;n++)if(e[n]!==r)return!0}else return r!==e}function L6(t,e,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:o,...l}=t.makeTargetAnimatable(e);const c=t.getValue("willChange");n&&(i=n);const u=[],d=s&&t.animationState&&t.animationState.getState()[s];for(const h in l){const g=t.getValue(h),m=l[h];if(!g||m===void 0||d&&XH(d,h))continue;const w={delay:r,elapsed:0,...gN(i||{},h)};if(window.HandoffAppearAnimations){const v=t.getProps()[OC];if(v){const b=window.HandoffAppearAnimations(v,h,g,jr);b!==null&&(w.elapsed=b,w.isHandoff=!0)}}let _=!w.isHandoff&&!ZH(g,m);if(w.type==="spring"&&(g.getVelocity()||w.velocity)&&(_=!1),g.animation&&(_=!1),_)continue;g.start(yN(h,g,m,t.shouldReduceMotion&&vd.has(h)?{type:!1}:w));const T=g.animation;Vy(c)&&(c.add(h),T.then(()=>c.remove(h))),u.push(T)}return o&&Promise.all(u).then(()=>{o&&KH(t,o)}),u}function vb(t,e,r={}){const n=Qx(t,e,r.custom);let{transition:s=t.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const i=n?()=>Promise.all(L6(t,n,r)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return eG(t,e,u+c,d,h,r)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,u]=l==="beforeChildren"?[i,o]:[o,i];return c().then(()=>u())}else return Promise.all([i(),o(r.delay)])}function eG(t,e,r=0,n=0,s=1,i){const o=[],l=(t.variantChildren.size-1)*n,c=s===1?(u=0)=>u*n:(u=0)=>l-u*n;return Array.from(t.variantChildren).sort(tG).forEach((u,d)=>{u.notify("AnimationStart",e),o.push(vb(u,e,{...i,delay:r+c(d)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(o)}function tG(t,e){return t.sortNodePosition(e)}function rG(t,e,r={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const s=e.map(i=>vb(t,i,r));n=Promise.all(s)}else if(typeof e=="string")n=vb(t,e,r);else{const s=typeof e=="function"?Qx(t,e,r.custom):e;n=Promise.all(L6(t,s,r))}return n.then(()=>t.notify("AnimationComplete",e))}const nG=[...rN].reverse(),sG=rN.length;function iG(t){return e=>Promise.all(e.map(({animation:r,options:n})=>rG(t,r,n)))}function aG(t){let e=iG(t);const r=lG();let n=!0;const s=(c,u)=>{const d=Qx(t,u);if(d){const{transition:h,transitionEnd:g,...m}=d;c={...c,...m,...g}}return c};function i(c){e=c(t)}function o(c,u){const d=t.getProps(),h=t.getVariantContext(!0)||{},g=[],m=new Set;let w={},_=1/0;for(let v=0;v<sG;v++){const b=nG[v],x=r[b],P=d[b]!==void 0?d[b]:h[b],F=pp(P),$=b===u?x.isActive:null;$===!1&&(_=v);let k=P===h[b]&&P!==d[b]&&F;if(k&&n&&t.manuallyAnimateOnMount&&(k=!1),x.protectedKeys={...w},!x.isActive&&$===null||!P&&!x.prevProp||Hx(P)||typeof P=="boolean")continue;let I=oG(x.prevProp,P)||b===u&&x.isActive&&!k&&F||v>_&&F,O=!1;const S=Array.isArray(P)?P:[P];let R=S.reduce(s,{});$===!1&&(R={});const{prevResolvedValues:C={}}=x,G={...C,...R},de=ne=>{I=!0,m.has(ne)&&(O=!0,m.delete(ne)),x.needsAnimating[ne]=!0};for(const ne in G){const X=R[ne],Y=C[ne];if(w.hasOwnProperty(ne))continue;let Q=!1;Ly(X)&&Ly(Y)?Q=!s6(X,Y):Q=X!==Y,Q?X!==void 0?de(ne):m.add(ne):X!==void 0&&m.has(ne)?de(ne):x.protectedKeys[ne]=!0}x.prevProp=P,x.prevResolvedValues=R,x.isActive&&(w={...w,...R}),n&&t.blockInitialAnimation&&(I=!1),I&&(!k||O)&&g.push(...S.map(ne=>({animation:ne,options:{type:b,...c}})))}if(m.size){const v={};m.forEach(b=>{const x=t.getBaseTarget(b);x!==void 0&&(v[b]=x)}),g.push({animation:v})}let T=!!g.length;return n&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(T=!1),n=!1,T?e(g):Promise.resolve()}function l(c,u,d){var h;if(r[c].isActive===u)return Promise.resolve();(h=t.variantChildren)===null||h===void 0||h.forEach(m=>{var w;return(w=m.animationState)===null||w===void 0?void 0:w.setActive(c,u)}),r[c].isActive=u;const g=o(d,c);for(const m in r)r[m].protectedKeys={};return g}return{animateChanges:o,setActive:l,setAnimateFunction:i,getState:()=>r}}function oG(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!s6(e,t):!1}function Eu(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function lG(){return{animate:Eu(!0),whileInView:Eu(),whileHover:Eu(),whileTap:Eu(),whileDrag:Eu(),whileFocus:Eu(),exit:Eu()}}class cG extends au{constructor(e){super(e),e.animationState||(e.animationState=aG(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),Hx(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let uG=0;class dG extends au{constructor(){super(...arguments),this.id=uG++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r,custom:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const i=this.node.animationState.setActive("exit",!e,{custom:n??this.node.getProps().custom});r&&!e&&i.then(()=>r(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const hG={animation:{Feature:cG},exit:{Feature:dG}},ES=(t,e)=>Math.abs(t-e);function fG(t,e){const r=ES(t.x,e.x),n=ES(t.y,e.y);return Math.sqrt(r**2+n**2)}class O6{constructor(e,r,{transformPagePoint:n,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=Nv(this.lastMoveEventInfo,this.history),g=this.startEvent!==null,m=fG(h.offset,{x:0,y:0})>=3;if(!g&&!m)return;const{point:w}=h,{timestamp:_}=ss;this.history.push({...w,timestamp:_});const{onStart:T,onMove:v}=this.handlers;g||(T&&T(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,h)},this.handlePointerMove=(h,g)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=wv(g,this.transformPagePoint),jr.update(this.updatePoint,!0)},this.handlePointerUp=(h,g)=>{this.end();const{onEnd:m,onSessionEnd:w,resumeAnimation:_}=this.handlers;if(this.dragSnapToOrigin&&_&&_(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=Nv(h.type==="pointercancel"?this.lastMoveEventInfo:wv(g,this.transformPagePoint),this.history);this.startEvent&&m&&m(h,T),w&&w(h,T)},!ZC(e))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=n,this.contextWindow=s||window;const o=Yx(e),l=wv(o,this.transformPagePoint),{point:c}=l,{timestamp:u}=ss;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=r;d&&d(e,Nv(l,this.history)),this.removeListeners=Rc(rl(this.contextWindow,"pointermove",this.handlePointerMove),rl(this.contextWindow,"pointerup",this.handlePointerUp),rl(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),fl(this.updatePoint)}}function wv(t,e){return e?{point:e(t.point)}:t}function kS(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Nv({point:t},e){return{point:t,delta:kS(t,M6(e)),offset:kS(t,mG(e)),velocity:pG(e,.1)}}function mG(t){return t[0]}function M6(t){return t[t.length-1]}function pG(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,n=null;const s=M6(t);for(;r>=0&&(n=t[r],!(s.timestamp-n.timestamp>Dc(e)));)r--;if(!n)return{x:0,y:0};const i=nl(s.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-n.x)/i,y:(s.y-n.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function _i(t){return t.max-t.min}function bb(t,e=0,r=.01){return Math.abs(t-e)<=r}function TS(t,e,r,n=.5){t.origin=n,t.originPoint=Mr(e.min,e.max,t.origin),t.scale=_i(r)/_i(e),(bb(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=Mr(r.min,r.max,t.origin)-t.originPoint,(bb(t.translate)||isNaN(t.translate))&&(t.translate=0)}function Lm(t,e,r,n){TS(t.x,e.x,r.x,n?n.originX:void 0),TS(t.y,e.y,r.y,n?n.originY:void 0)}function IS(t,e,r){t.min=r.min+e.min,t.max=t.min+_i(e)}function gG(t,e,r){IS(t.x,e.x,r.x),IS(t.y,e.y,r.y)}function CS(t,e,r){t.min=e.min-r.min,t.max=t.min+_i(e)}function Om(t,e,r){CS(t.x,e.x,r.x),CS(t.y,e.y,r.y)}function yG(t,{min:e,max:r},n){return e!==void 0&&t<e?t=n?Mr(e,t,n.min):Math.max(t,e):r!==void 0&&t>r&&(t=n?Mr(r,t,n.max):Math.min(t,r)),t}function PS(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function xG(t,{top:e,left:r,bottom:n,right:s}){return{x:PS(t.x,r,s),y:PS(t.y,e,n)}}function RS(t,e){let r=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,n]=[n,r]),{min:r,max:n}}function vG(t,e){return{x:RS(t.x,e.x),y:RS(t.y,e.y)}}function bG(t,e){let r=.5;const n=_i(t),s=_i(e);return s>n?r=yp(e.min,e.max-n,t.min):n>s&&(r=yp(t.min,t.max-s,e.min)),Gc(0,1,r)}function wG(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const wb=.35;function NG(t=wb){return t===!1?t=0:t===!0&&(t=wb),{x:DS(t,"left","right"),y:DS(t,"top","bottom")}}function DS(t,e,r){return{min:LS(t,e),max:LS(t,r)}}function LS(t,e){return typeof t=="number"?t:t[e]||0}const OS=()=>({translate:0,scale:1,origin:0,originPoint:0}),bh=()=>({x:OS(),y:OS()}),MS=()=>({min:0,max:0}),hn=()=>({x:MS(),y:MS()});function $i(t){return[t("x"),t("y")]}function F6({top:t,left:e,right:r,bottom:n}){return{x:{min:e,max:r},y:{min:t,max:n}}}function _G({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function jG(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function _v(t){return t===void 0||t===1}function Nb({scale:t,scaleX:e,scaleY:r}){return!_v(t)||!_v(e)||!_v(r)}function Cu(t){return Nb(t)||V6(t)||t.z||t.rotate||t.rotateX||t.rotateY}function V6(t){return FS(t.x)||FS(t.y)}function FS(t){return t&&t!=="0%"}function By(t,e,r){const n=t-r,s=e*n;return r+s}function VS(t,e,r,n,s){return s!==void 0&&(t=By(t,s,n)),By(t,r,n)+e}function _b(t,e=0,r=1,n,s){t.min=VS(t.min,e,r,n,s),t.max=VS(t.max,e,r,n,s)}function B6(t,{x:e,y:r}){_b(t.x,e.translate,e.scale,e.originPoint),_b(t.y,r.translate,r.scale,r.originPoint)}function SG(t,e,r,n=!1){const s=r.length;if(!s)return;e.x=e.y=1;let i,o;for(let l=0;l<s;l++){i=r[l],o=i.projectionDelta;const c=i.instance;c&&c.style&&c.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&wh(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,B6(t,o)),n&&Cu(i.latestValues)&&wh(t,i.latestValues))}e.x=BS(e.x),e.y=BS(e.y)}function BS(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function ic(t,e){t.min=t.min+e,t.max=t.max+e}function US(t,e,[r,n,s]){const i=e[s]!==void 0?e[s]:.5,o=Mr(t.min,t.max,i);_b(t,e[r],e[n],o,e.scale)}const AG=["x","scaleX","originX"],EG=["y","scaleY","originY"];function wh(t,e){US(t.x,e,AG),US(t.y,e,EG)}function U6(t,e){return F6(jG(t.getBoundingClientRect(),e))}function kG(t,e,r){const n=U6(t,r),{scroll:s}=e;return s&&(ic(n.x,s.offset.x),ic(n.y,s.offset.y)),n}const z6=({current:t})=>t?t.ownerDocument.defaultView:null,TG=new WeakMap;class IG{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=hn(),this.visualElement=e}start(e,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const s=d=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Yx(d,"page").point)},i=(d,h)=>{const{drag:g,dragPropagation:m,onDragStart:w}=this.getProps();if(g&&!m&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=t6(g),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),$i(T=>{let v=this.getAxisMotionValue(T).get()||0;if(ho.test(v)){const{projection:b}=this.visualElement;if(b&&b.layout){const x=b.layout.layoutBox[T];x&&(v=_i(x)*(parseFloat(v)/100))}}this.originPoint[T]=v}),w&&jr.update(()=>w(d,h),!1,!0);const{animationState:_}=this.visualElement;_&&_.setActive("whileDrag",!0)},o=(d,h)=>{const{dragPropagation:g,dragDirectionLock:m,onDirectionLock:w,onDrag:_}=this.getProps();if(!g&&!this.openGlobalLock)return;const{offset:T}=h;if(m&&this.currentDirection===null){this.currentDirection=CG(T),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",h.point,T),this.updateAxis("y",h.point,T),this.visualElement.render(),_&&_(d,h)},l=(d,h)=>this.stop(d,h),c=()=>$i(d=>{var h;return this.getAnimationState(d)==="paused"&&((h=this.getAxisMotionValue(d).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new O6(e,{onSessionStart:s,onStart:i,onMove:o,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:z6(this.visualElement)})}stop(e,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:s}=r;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&jr.update(()=>i(e,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,n){const{drag:s}=this.getProps();if(!n||!Jg(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(o=yG(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:r,dragElastic:n}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;r&&xh(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&s?this.constraints=xG(s.layoutBox,r):this.constraints=!1,this.elastic=NG(n),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&$i(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=wG(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!xh(e))return!1;const n=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=kG(n,s.root,this.visualElement.getTransformPagePoint());let o=vG(s.layout.layoutBox,i);if(r){const l=r(_G(o));this.hasMutatedConstraints=!!l,l&&(o=F6(l))}return o}startAnimation(e){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=$i(d=>{if(!Jg(d,r,this.currentDirection))return;let h=c&&c[d]||{};o&&(h={min:0,max:0});const g=s?200:1e6,m=s?40:1e7,w={type:"inertia",velocity:n?e[d]:0,bounceStiffness:g,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(d,w)});return Promise.all(u).then(l)}startAxisValueAnimation(e,r){const n=this.getAxisMotionValue(e);return n.start(yN(e,n,0,r))}stopAnimation(){$i(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){$i(e=>{var r;return(r=this.getAxisMotionValue(e).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(e){var r;return(r=this.getAxisMotionValue(e).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(e){const r="_drag"+e.toUpperCase(),n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){$i(r=>{const{drag:n}=this.getProps();if(!Jg(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(r);if(s&&s.layout){const{min:o,max:l}=s.layout.layoutBox[r];i.set(e[r]-Mr(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!xh(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};$i(o=>{const l=this.getAxisMotionValue(o);if(l){const c=l.get();s[o]=bG({min:c,max:c},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),$i(o=>{if(!Jg(o,e,null))return;const l=this.getAxisMotionValue(o),{min:c,max:u}=this.constraints[o];l.set(Mr(c,u,s[o]))})}addListeners(){if(!this.visualElement.current)return;TG.set(this.visualElement,this);const e=this.visualElement.current,r=rl(e,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();xh(c)&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),n();const o=Qo(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&($i(d=>{const h=this.getAxisMotionValue(d);h&&(this.originPoint[d]+=c[d].translate,h.set(h.get()+c[d].translate))}),this.visualElement.render())});return()=>{o(),r(),i(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=wb,dragMomentum:l=!0}=e;return{...e,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:l}}}function Jg(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function CG(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class PG extends au{constructor(e){super(e),this.removeGroupControls=Xr,this.removeListeners=Xr,this.controls=new IG(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Xr}unmount(){this.removeGroupControls(),this.removeListeners()}}const zS=t=>(e,r)=>{t&&jr.update(()=>t(e,r))};class RG extends au{constructor(){super(...arguments),this.removePointerDownListener=Xr}onPointerDown(e){this.session=new O6(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:z6(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:zS(e),onStart:zS(r),onMove:n,onEnd:(i,o)=>{delete this.session,s&&jr.update(()=>s(i,o))}}}mount(){this.removePointerDownListener=rl(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function DG(){const t=M.useContext($x);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:r,register:n}=t,s=M.useId();return M.useEffect(()=>n(s),[]),!e&&r?[!1,()=>r&&r(s)]:[!0]}const k0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function qS(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const em={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(vt.test(t))t=parseFloat(t);else return t;const r=qS(t,e.target.x),n=qS(t,e.target.y);return`${r}% ${n}%`}},LG={correct:(t,{treeScale:e,projectionDelta:r})=>{const n=t,s=Kc.parse(t);if(s.length>5)return n;const i=Kc.createTransformer(t),o=typeof s[0]!="number"?1:0,l=r.x.scale*e.x,c=r.y.scale*e.y;s[0+o]/=l,s[1+o]/=c;const u=Mr(l,c,.5);return typeof s[2+o]=="number"&&(s[2+o]/=u),typeof s[3+o]=="number"&&(s[3+o]/=u),i(s)}};class OG extends Lc.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:i}=e;q$(MG),i&&(r.group&&r.group.add(i),n&&n.register&&s&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),k0.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:n,drag:s,isPresent:i}=this.props,o=n.projection;return o&&(o.isPresent=i,s||e.layoutDependency!==r||r===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||jr.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function q6(t){const[e,r]=DG(),n=M.useContext(sN);return Lc.createElement(OG,{...t,layoutGroup:n,switchLayoutGroup:M.useContext(FC),isPresent:e,safeToRemove:r})}const MG={borderRadius:{...em,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:em,borderTopRightRadius:em,borderBottomLeftRadius:em,borderBottomRightRadius:em,boxShadow:LG},$6=["TopLeft","TopRight","BottomLeft","BottomRight"],FG=$6.length,$S=t=>typeof t=="string"?parseFloat(t):t,WS=t=>typeof t=="number"||vt.test(t);function VG(t,e,r,n,s,i){s?(t.opacity=Mr(0,r.opacity!==void 0?r.opacity:1,BG(n)),t.opacityExit=Mr(e.opacity!==void 0?e.opacity:1,0,UG(n))):i&&(t.opacity=Mr(e.opacity!==void 0?e.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let o=0;o<FG;o++){const l=`border${$6[o]}Radius`;let c=HS(e,l),u=HS(r,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||WS(c)===WS(u)?(t[l]=Math.max(Mr($S(c),$S(u),n),0),(ho.test(u)||ho.test(c))&&(t[l]+="%")):t[l]=u}(e.rotate||r.rotate)&&(t.rotate=Mr(e.rotate||0,r.rotate||0,n))}function HS(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const BG=W6(0,.5,f6),UG=W6(.5,.95,Xr);function W6(t,e,r){return n=>n<t?0:n>e?1:r(yp(t,e,n))}function GS(t,e){t.min=e.min,t.max=e.max}function qi(t,e){GS(t.x,e.x),GS(t.y,e.y)}function KS(t,e,r,n,s){return t-=e,t=By(t,1/r,n),s!==void 0&&(t=By(t,1/s,n)),t}function zG(t,e=0,r=1,n=.5,s,i=t,o=t){if(ho.test(e)&&(e=parseFloat(e),e=Mr(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=Mr(i.min,i.max,n);t===i&&(l-=e),t.min=KS(t.min,e,r,l,s),t.max=KS(t.max,e,r,l,s)}function YS(t,e,[r,n,s],i,o){zG(t,e[r],e[n],e[s],e.scale,i,o)}const qG=["x","scaleX","originX"],$G=["y","scaleY","originY"];function QS(t,e,r,n){YS(t.x,e,qG,r?r.x:void 0,n?n.x:void 0),YS(t.y,e,$G,r?r.y:void 0,n?n.y:void 0)}function JS(t){return t.translate===0&&t.scale===1}function H6(t){return JS(t.x)&&JS(t.y)}function WG(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function G6(t,e){return Math.round(t.x.min)===Math.round(e.x.min)&&Math.round(t.x.max)===Math.round(e.x.max)&&Math.round(t.y.min)===Math.round(e.y.min)&&Math.round(t.y.max)===Math.round(e.y.max)}function XS(t){return _i(t.x)/_i(t.y)}class HG{constructor(){this.members=[]}add(e){xN(this.members,e),e.scheduleRender()}remove(e){if(vN(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(s=>e===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(e,r){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,r&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:n}=e;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function ZS(t,e,r){let n="";const s=t.x.translate/e.x,i=t.y.translate/e.y;if((s||i)&&(n=`translate3d(${s}px, ${i}px, 0) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),r){const{rotate:c,rotateX:u,rotateY:d}=r;c&&(n+=`rotate(${c}deg) `),u&&(n+=`rotateX(${u}deg) `),d&&(n+=`rotateY(${d}deg) `)}const o=t.x.scale*e.x,l=t.y.scale*e.y;return(o!==1||l!==1)&&(n+=`scale(${o}, ${l})`),n||"none"}const GG=(t,e)=>t.depth-e.depth;class KG{constructor(){this.children=[],this.isDirty=!1}add(e){xN(this.children,e),this.isDirty=!0}remove(e){vN(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(GG),this.isDirty=!1,this.children.forEach(e)}}function YG(t,e){const r=performance.now(),n=({timestamp:s})=>{const i=s-r;i>=e&&(fl(n),t(i-e))};return jr.read(n,!0),()=>fl(n)}function QG(t){window.MotionDebug&&window.MotionDebug.record(t)}function JG(t){return t instanceof SVGElement&&t.tagName!=="svg"}function XG(t,e,r){const n=Js(t)?t:sf(t);return n.start(yN("",n,e,r)),n.animation}const e3=["","X","Y","Z"],ZG={visibility:"hidden"},t3=1e3;let eK=0;const Pu={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function K6({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(o={},l=e==null?void 0:e()){this.id=eK++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Pu.totalNodes=Pu.resolvedTargetDeltas=Pu.recalculatedProjection=0,this.nodes.forEach(nK),this.nodes.forEach(lK),this.nodes.forEach(cK),this.nodes.forEach(sK),QG(Pu)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new KG)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new bN),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=JG(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(u||c)&&(this.isLayoutDirty=!0),t){let h;const g=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=YG(g,250),k0.hasAnimatedSinceResize&&(k0.hasAnimatedSinceResize=!1,this.nodes.forEach(n3))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:g,hasRelativeTargetChanged:m,layout:w})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||d.getDefaultTransition()||mK,{onLayoutAnimationStart:T,onLayoutAnimationComplete:v}=d.getProps(),b=!this.targetLayout||!G6(this.targetLayout,w)||m,x=!g&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||x||g&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,x);const P={...gN(_,"layout"),onPlay:T,onComplete:v};(d.shouldReduceMotion||this.options.layoutRoot)&&(P.delay=0,P.type=!1),this.startAnimation(P)}else g||n3(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=w})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,fl(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(uK),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const h=this.path[d];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(r3);return}this.isUpdating||this.nodes.forEach(aK),this.isUpdating=!1,this.nodes.forEach(oK),this.nodes.forEach(tK),this.nodes.forEach(rK),this.clearAllSnapshots();const l=performance.now();ss.delta=Gc(0,1e3/60,l-ss.timestamp),ss.timestamp=l,ss.isProcessing=!0,fv.update.process(ss),fv.preRender.process(ss),fv.render.process(ss),ss.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(iK),this.sharedNodes.forEach(dK)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,jr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){jr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=hn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:n(this.instance),offset:r(this.instance)})}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!H6(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;o&&(l||Cu(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),pK(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return hn();const l=o.measureViewportBox(),{scroll:c}=this.root;return c&&(ic(l.x,c.offset.x),ic(l.y,c.offset.y)),l}removeElementScroll(o){const l=hn();qi(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;if(u!==this.root&&d&&h.layoutScroll){if(d.isRoot){qi(l,o);const{scroll:g}=this.root;g&&(ic(l.x,-g.offset.x),ic(l.y,-g.offset.y))}ic(l.x,d.offset.x),ic(l.y,d.offset.y)}}return l}applyTransform(o,l=!1){const c=hn();qi(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];!l&&d.options.layoutScroll&&d.scroll&&d!==d.root&&wh(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Cu(d.latestValues)&&wh(c,d.latestValues)}return Cu(this.latestValues)&&wh(c,this.latestValues),c}removeTransform(o){const l=hn();qi(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!Cu(u.latestValues))continue;Nb(u.latestValues)&&u.updateSnapshot();const d=hn(),h=u.measurePageBox();qi(d,h),QS(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Cu(this.latestValues)&&QS(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ss.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:g}=this.options;if(!(!this.layout||!(h||g))){if(this.resolvedRelativeTargetAt=ss.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=hn(),this.relativeTargetOrigin=hn(),Om(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),qi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=hn(),this.targetWithTransforms=hn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),gG(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):qi(this.target,this.layout.layoutBox),B6(this.target,this.targetDelta)):qi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=hn(),this.relativeTargetOrigin=hn(),Om(this.relativeTargetOrigin,this.target,m.target),qi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Pu.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Nb(this.parent.latestValues)||V6(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let u=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===ss.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;qi(this.layoutCorrected,this.layout.layoutBox);const g=this.treeScale.x,m=this.treeScale.y;SG(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:w}=l;if(!w){this.projectionTransform&&(this.projectionDelta=bh(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=bh(),this.projectionDeltaWithTransform=bh());const _=this.projectionTransform;Lm(this.projectionDelta,this.layoutCorrected,w,this.latestValues),this.projectionTransform=ZS(this.projectionDelta,this.treeScale),(this.projectionTransform!==_||this.treeScale.x!==g||this.treeScale.y!==m)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",w)),Pu.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,l=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},h=bh();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const g=hn(),m=c?c.source:void 0,w=this.layout?this.layout.source:void 0,_=m!==w,T=this.getStack(),v=!T||T.members.length<=1,b=!!(_&&!v&&this.options.crossfade===!0&&!this.path.some(fK));this.animationProgress=0;let x;this.mixTargetDelta=P=>{const F=P/1e3;s3(h.x,o.x,F),s3(h.y,o.y,F),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Om(g,this.layout.layoutBox,this.relativeParent.layout.layoutBox),hK(this.relativeTarget,this.relativeTargetOrigin,g,F),x&&WG(this.relativeTarget,x)&&(this.isProjectionDirty=!1),x||(x=hn()),qi(x,this.relativeTarget)),_&&(this.animationValues=d,VG(d,u,this.latestValues,F,b,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(fl(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=jr.update(()=>{k0.hasAnimatedSinceResize=!0,this.currentAnimation=XG(0,t3,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(t3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:d}=o;if(!(!l||!c||!u)){if(this!==o&&this.layout&&u&&Y6(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||hn();const h=_i(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+h;const g=_i(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+g}qi(l,c),wh(l,d),Lm(this.projectionDeltaWithTransform,this.layoutCorrected,l,d)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new HG),this.sharedNodes.get(o).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const u={};for(let d=0;d<e3.length;d++){const h="rotate"+e3[d];c[h]&&(u[h]=c[h],o.setStaticValue(h,0))}o.render();for(const d in u)o.setStaticValue(d,u[d]);o.scheduleRender()}getProjectionStyles(o){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return ZG;const u={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=E0(o==null?void 0:o.pointerEvents)||"",u.transform=d?d(this.latestValues,""):"none",u;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const _={};return this.options.layoutId&&(_.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,_.pointerEvents=E0(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Cu(this.latestValues)&&(_.transform=d?d({},""):"none",this.hasProjected=!1),_}const g=h.animationValues||h.latestValues;this.applyTransformsToTarget(),u.transform=ZS(this.projectionDeltaWithTransform,this.treeScale,g),d&&(u.transform=d(g,u.transform));const{x:m,y:w}=this.projectionDelta;u.transformOrigin=`${m.origin*100}% ${w.origin*100}% 0`,h.animationValues?u.opacity=h===this?(c=(l=g.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:g.opacityExit:u.opacity=h===this?g.opacity!==void 0?g.opacity:"":g.opacityExit!==void 0?g.opacityExit:0;for(const _ in Ry){if(g[_]===void 0)continue;const{correct:T,applyTo:v}=Ry[_],b=u.transform==="none"?g[_]:T(g[_],h);if(v){const x=v.length;for(let P=0;P<x;P++)u[v[P]]=b}else u[_]=b}return this.options.layoutId&&(u.pointerEvents=h===this?E0(o==null?void 0:o.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(r3),this.root.sharedNodes.clear()}}}function tK(t){t.updateLayout()}function rK(t){var e;const r=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&r&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=t.layout,{animationType:i}=t.options,o=r.source!==t.layout.source;i==="size"?$i(h=>{const g=o?r.measuredBox[h]:r.layoutBox[h],m=_i(g);g.min=n[h].min,g.max=g.min+m}):Y6(i,r.layoutBox,n)&&$i(h=>{const g=o?r.measuredBox[h]:r.layoutBox[h],m=_i(n[h]);g.max=g.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+m)});const l=bh();Lm(l,n,r.layoutBox);const c=bh();o?Lm(c,t.applyTransform(s,!0),r.measuredBox):Lm(c,n,r.layoutBox);const u=!H6(l);let d=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:g,layout:m}=h;if(g&&m){const w=hn();Om(w,r.layoutBox,g.layoutBox);const _=hn();Om(_,n,m.layoutBox),G6(w,_)||(d=!0),h.options.layoutRoot&&(t.relativeTarget=_,t.relativeTargetOrigin=w,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:c,layoutDelta:l,hasLayoutChanged:u,hasRelativeTargetChanged:d})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function nK(t){Pu.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function sK(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function iK(t){t.clearSnapshot()}function r3(t){t.clearMeasurements()}function aK(t){t.isLayoutDirty=!1}function oK(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function n3(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function lK(t){t.resolveTargetDelta()}function cK(t){t.calcProjection()}function uK(t){t.resetRotation()}function dK(t){t.removeLeadSnapshot()}function s3(t,e,r){t.translate=Mr(e.translate,0,r),t.scale=Mr(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function i3(t,e,r,n){t.min=Mr(e.min,r.min,n),t.max=Mr(e.max,r.max,n)}function hK(t,e,r,n){i3(t.x,e.x,r.x,n),i3(t.y,e.y,r.y,n)}function fK(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const mK={duration:.45,ease:[.4,0,.1,1]},a3=t=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(t),o3=a3("applewebkit/")&&!a3("chrome/")?Math.round:Xr;function l3(t){t.min=o3(t.min),t.max=o3(t.max)}function pK(t){l3(t.x),l3(t.y)}function Y6(t,e,r){return t==="position"||t==="preserve-aspect"&&!bb(XS(e),XS(r),.2)}const gK=K6({attachResizeListener:(t,e)=>Qo(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),jv={current:void 0},Q6=K6({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!jv.current){const t=new gK({});t.mount(window),t.setOptions({layoutScroll:!0}),jv.current=t}return jv.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),yK={pan:{Feature:RG},drag:{Feature:PG,ProjectionNode:Q6,MeasureLayout:q6}},xK=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function vK(t){const e=xK.exec(t);if(!e)return[,];const[,r,n]=e;return[r,n]}function jb(t,e,r=1){const[n,s]=vK(t);if(!n)return;const i=window.getComputedStyle(e).getPropertyValue(n);if(i){const o=i.trim();return P6(o)?parseFloat(o):o}else return fb(s)?jb(s,e,r+1):s}function bK(t,{...e},r){const n=t.current;if(!(n instanceof Element))return{target:e,transitionEnd:r};r&&(r={...r}),t.values.forEach(s=>{const i=s.get();if(!fb(i))return;const o=jb(i,n);o&&s.set(o)});for(const s in e){const i=e[s];if(!fb(i))continue;const o=jb(i,n);o&&(e[s]=o,r||(r={}),r[s]===void 0&&(r[s]=i))}return{target:e,transitionEnd:r}}const wK=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),J6=t=>wK.has(t),NK=t=>Object.keys(t).some(J6),c3=t=>t===bd||t===vt,u3=(t,e)=>parseFloat(t.split(", ")[e]),d3=(t,e)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const s=n.match(/^matrix3d\((.+)\)$/);if(s)return u3(s[1],e);{const i=n.match(/^matrix\((.+)\)$/);return i?u3(i[1],t):0}},_K=new Set(["x","y","z"]),jK=qp.filter(t=>!_K.has(t));function SK(t){const e=[];return jK.forEach(r=>{const n=t.getValue(r);n!==void 0&&(e.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),e.length&&t.render(),e}const af={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:d3(4,13),y:d3(5,14)};af.translateX=af.x;af.translateY=af.y;const AK=(t,e,r)=>{const n=e.measureViewportBox(),s=e.current,i=getComputedStyle(s),{display:o}=i,l={};o==="none"&&e.setStaticValue("display",t.display||"block"),r.forEach(u=>{l[u]=af[u](n,i)}),e.render();const c=e.measureViewportBox();return r.forEach(u=>{const d=e.getValue(u);d&&d.jump(l[u]),t[u]=af[u](c,i)}),t},EK=(t,e,r={},n={})=>{e={...e},n={...n};const s=Object.keys(e).filter(J6);let i=[],o=!1;const l=[];if(s.forEach(c=>{const u=t.getValue(c);if(!t.hasValue(c))return;let d=r[c],h=Zf(d);const g=e[c];let m;if(Ly(g)){const w=g.length,_=g[0]===null?1:0;d=g[_],h=Zf(d);for(let T=_;T<w&&g[T]!==null;T++)m?Jx(Zf(g[T])===m):m=Zf(g[T])}else m=Zf(g);if(h!==m)if(c3(h)&&c3(m)){const w=u.get();typeof w=="string"&&u.set(parseFloat(w)),typeof g=="string"?e[c]=parseFloat(g):Array.isArray(g)&&m===vt&&(e[c]=g.map(parseFloat))}else h!=null&&h.transform&&(m!=null&&m.transform)&&(d===0||g===0)?d===0?u.set(m.transform(d)):e[c]=h.transform(g):(o||(i=SK(t),o=!0),l.push(c),n[c]=n[c]!==void 0?n[c]:e[c],u.jump(g))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,u=AK(e,t,l);return i.length&&i.forEach(([d,h])=>{t.getValue(d).set(h)}),t.render(),Wx&&c!==null&&window.scrollTo({top:c}),{target:u,transitionEnd:n}}else return{target:e,transitionEnd:n}};function kK(t,e,r,n){return NK(e)?EK(t,e,r,n):{target:e,transitionEnd:n}}const TK=(t,e,r,n)=>{const s=bK(t,e,n);return e=s.target,n=s.transitionEnd,kK(t,e,r,n)},Sb={current:null},X6={current:!1};function IK(){if(X6.current=!0,!!Wx)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Sb.current=t.matches;t.addListener(e),e()}else Sb.current=!1}function CK(t,e,r){const{willChange:n}=e;for(const s in e){const i=e[s],o=r[s];if(Js(i))t.addValue(s,i),Vy(n)&&n.add(s);else if(Js(o))t.addValue(s,sf(i,{owner:t})),Vy(n)&&n.remove(s);else if(o!==i)if(t.hasValue(s)){const l=t.getValue(s);!l.hasAnimated&&l.set(i)}else{const l=t.getStaticValue(s);t.addValue(s,sf(l!==void 0?l:i,{owner:t}))}}for(const s in r)e[s]===void 0&&t.removeValue(s);return e}const h3=new WeakMap,Z6=Object.keys(gp),PK=Z6.length,f3=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],RK=nN.length;class DK{constructor({parent:e,props:r,presenceContext:n,reducedMotionConfig:s,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>jr.render(this.render,!1,!0);const{latestValues:l,renderState:c}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=r,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.isControllingVariants=Gx(r),this.isVariantNode=MC(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(r,{});for(const h in d){const g=d[h];l[h]!==void 0&&Js(g)&&(g.set(l[h],!1),Vy(u)&&u.add(h))}}scrapeMotionValuesFromProps(e,r){return{}}mount(e){this.current=e,h3.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),X6.current||IK(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Sb.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){h3.delete(this.current),this.projection&&this.projection.unmount(),fl(this.notifyUpdate),fl(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,r){const n=vd.has(e),s=r.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&jr.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),i=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{s(),i()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...r},n,s,i){let o,l;for(let c=0;c<PK;c++){const u=Z6[c],{isEnabled:d,Feature:h,ProjectionNode:g,MeasureLayout:m}=gp[u];g&&(o=g),d(r)&&(!this.features[u]&&h&&(this.features[u]=new h(this)),m&&(l=m))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:u,drag:d,dragConstraints:h,layoutScroll:g,layoutRoot:m}=r;this.projection.setOptions({layoutId:c,layout:u,alwaysMeasureLayout:!!d||h&&xh(h),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:i,layoutScroll:g,layoutRoot:m})}return l}updateFeatures(){for(const e in this.features){const r=this.features[e];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):hn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}makeTargetAnimatable(e,r=!0){return this.makeTargetAnimatableFromInstance(e,this.props,r)}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<f3.length;n++){const s=f3[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i=e["on"+s];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=CK(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const r={};for(let n=0;n<RK;n++){const s=nN[n],i=this.props[s];(pp(i)||i===!1)&&(r[s]=i)}return r}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){r!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,r)),this.values.set(e,r),this.latestValues[e]=r.get()}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&r!==void 0&&(n=sf(r,{owner:this}),this.addValue(e,n)),n}readValue(e){var r;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){var r;const{initial:n}=this.props,s=typeof n=="string"||typeof n=="object"?(r=dN(this.props,n))===null||r===void 0?void 0:r[e]:void 0;if(n&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Js(i)?i:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new bN),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}}class eP extends DK{sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:n}){delete r[e],delete n[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:r,...n},{transformValues:s},i){let o=JH(n,e||{},this);if(s&&(r&&(r=s(r)),n&&(n=s(n)),o&&(o=s(o))),i){YH(this,n,o);const l=TK(this,n,o,r);r=l.transitionEnd,n=l.target}return{transition:e,transitionEnd:r,...n}}}function LK(t){return window.getComputedStyle(t)}class OK extends eP{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,r){if(vd.has(r)){const n=pN(r);return n&&n.default||0}else{const n=LK(e),s=(UC(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:r}){return U6(e,r)}build(e,r,n,s){aN(e,r,n,s.transformTemplate)}scrapeMotionValuesFromProps(e,r){return uN(e,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Js(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(e,r,n,s){GC(e,r,n,s)}}class MK extends eP{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(vd.has(r)){const n=pN(r);return n&&n.default||0}return r=KC.has(r)?r:tN(r),e.getAttribute(r)}measureInstanceViewportBox(){return hn()}scrapeMotionValuesFromProps(e,r){return QC(e,r)}build(e,r,n,s){lN(e,r,n,this.isSVGTag,s.transformTemplate)}renderInstance(e,r,n,s){YC(e,r,n,s)}mount(e){this.isSVGTag=cN(e.tagName),super.mount(e)}}const FK=(t,e)=>iN(t)?new MK(e,{enableHardwareAcceleration:!1}):new OK(e,{enableHardwareAcceleration:!0}),VK={layout:{ProjectionNode:Q6,MeasureLayout:q6}},BK={...hG,...PW,...yK,...VK},oe=U$((t,e)=>vW(t,e,BK,FK));function tP(){const t=M.useRef(!1);return eN(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function UK(){const t=tP(),[e,r]=M.useState(0),n=M.useCallback(()=>{t.current&&r(e+1)},[e]);return[M.useCallback(()=>jr.postRender(n),[n]),e]}class zK extends M.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function qK({children:t,isPresent:e}){const r=M.useId(),n=M.useRef(null),s=M.useRef({width:0,height:0,top:0,left:0});return M.useInsertionEffect(()=>{const{width:i,height:o,top:l,left:c}=s.current;if(e||!n.current||!i||!o)return;n.current.dataset.motionPopId=r;const u=document.createElement("style");return document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),M.createElement(zK,{isPresent:e,childRef:n,sizeRef:s},M.cloneElement(t,{ref:n}))}const Sv=({children:t,initial:e,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:i,mode:o})=>{const l=JC($K),c=M.useId(),u=M.useMemo(()=>({id:c,initial:e,isPresent:r,custom:s,onExitComplete:d=>{l.set(d,!0);for(const h of l.values())if(!h)return;n&&n()},register:d=>(l.set(d,!1),()=>l.delete(d))}),i?void 0:[r]);return M.useMemo(()=>{l.forEach((d,h)=>l.set(h,!1))},[r]),M.useEffect(()=>{!r&&!l.size&&n&&n()},[r]),o==="popLayout"&&(t=M.createElement(qK,{isPresent:r},t)),M.createElement($x.Provider,{value:u},t)};function $K(){return new Map}function WK(t){return M.useEffect(()=>()=>t(),[])}const Ru=t=>t.key||"";function HK(t,e){t.forEach(r=>{const n=Ru(r);e.set(n,r)})}function GK(t){const e=[];return M.Children.forEach(t,r=>{M.isValidElement(r)&&e.push(r)}),e}const po=({children:t,custom:e,initial:r=!0,onExitComplete:n,exitBeforeEnter:s,presenceAffectsLayout:i=!0,mode:o="sync"})=>{const l=M.useContext(sN).forceRender||UK()[0],c=tP(),u=GK(t);let d=u;const h=M.useRef(new Map).current,g=M.useRef(d),m=M.useRef(new Map).current,w=M.useRef(!0);if(eN(()=>{w.current=!1,HK(u,m),g.current=d}),WK(()=>{w.current=!0,m.clear(),h.clear()}),w.current)return M.createElement(M.Fragment,null,d.map(b=>M.createElement(Sv,{key:Ru(b),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:i,mode:o},b)));d=[...d];const _=g.current.map(Ru),T=u.map(Ru),v=_.length;for(let b=0;b<v;b++){const x=_[b];T.indexOf(x)===-1&&!h.has(x)&&h.set(x,void 0)}return o==="wait"&&h.size&&(d=[]),h.forEach((b,x)=>{if(T.indexOf(x)!==-1)return;const P=m.get(x);if(!P)return;const F=_.indexOf(x);let $=b;if(!$){const k=()=>{h.delete(x);const A=Array.from(m.keys()).filter(I=>!T.includes(I));if(A.forEach(I=>m.delete(I)),g.current=u.filter(I=>{const O=Ru(I);return O===x||A.includes(O)}),!h.size){if(c.current===!1)return;l(),n&&n()}};$=M.createElement(Sv,{key:Ru(P),isPresent:!1,onExitComplete:k,custom:e,presenceAffectsLayout:i,mode:o},P),h.set(x,$)}d.splice(F,0,$)}),d=d.map(b=>{const x=b.key;return h.has(x)?b:M.createElement(Sv,{key:Ru(b),isPresent:!0,presenceAffectsLayout:i,mode:o},b)}),M.createElement(M.Fragment,null,h.size?d:d.map(b=>M.cloneElement(b)))};function KK(t,e,r){var n;if(typeof t=="string"){let s=document;e&&(Jx(!!e.current),s=e.current),r?((n=r[t])!==null&&n!==void 0||(r[t]=s.querySelectorAll(t)),t=r[t]):t=s.querySelectorAll(t)}else t instanceof Element&&(t=[t]);return Array.from(t||[])}const YK={some:0,all:1};function QK(t,e,{root:r,margin:n,amount:s="some"}={}){const i=KK(t),o=new WeakMap,l=u=>{u.forEach(d=>{const h=o.get(d.target);if(d.isIntersecting!==!!h)if(d.isIntersecting){const g=e(d);typeof g=="function"?o.set(d.target,g):c.unobserve(d.target)}else h&&(h(d),o.delete(d.target))})},c=new IntersectionObserver(l,{root:r,rootMargin:n,threshold:typeof s=="number"?s:YK[s]});return i.forEach(u=>c.observe(u)),()=>c.disconnect()}function JK(t,{root:e,margin:r,amount:n,once:s=!1}={}){const[i,o]=M.useState(!1);return M.useEffect(()=>{if(!t.current||s&&i)return;const l=()=>(o(!0),s?void 0:()=>o(!1)),c={root:e&&e.current||void 0,margin:r,amount:n};return QK(t.current,l,c)},[e,t,r,s,n]),i}var XK={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const ZK=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),eY=(t,e)=>{const r=M.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:l,...c},u)=>M.createElement("svg",{ref:u,...XK,width:s,height:s,stroke:n,strokeWidth:o?Number(i)*24/Number(s):i,className:`lucide lucide-${ZK(t)}`,...c},[...e.map(([d,h])=>M.createElement(d,h)),...(Array.isArray(l)?l:[l])||[]]));return r.displayName=`${t}`,r};var Ve=eY;const Mm=Ve("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),_s=Ve("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),ml=Ve("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),tY=Ve("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),rY=Ve("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]),xp=Ve("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),nY=Ve("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]),sY=Ve("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),iY=Ve("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),aY=Ve("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),oY=Ve("CalendarCheck",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]),Un=Ve("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),m3=Ve("CheckCircle2",[["path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",key:"14v8dr"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),xr=Ve("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),wN=Ve("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),NN=Ve("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]]),rP=Ve("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),lY=Ve("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),cY=Ve("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),uY=Ve("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Rr=Ve("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),p3=Ve("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]),nP=Ve("Cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]),dY=Ve("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),T0=Ve("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Et=Ve("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),Dh=Ve("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),hY=Ve("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Ja=Ve("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Lh=Ve("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]),Gp=Ve("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Ca=Ve("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),fY=Ve("FileDown",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]),Sa=Ve("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),Uy=Ve("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),g3=Ve("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]),Ki=Ve("Gift",[["polyline",{points:"20 12 20 22 4 22 4 12",key:"nda8fc"}],["rect",{width:"20",height:"5",x:"2",y:"7",key:"wkgdzj"}],["line",{x1:"12",x2:"12",y1:"22",y2:"7",key:"1n8zgp"}],["path",{d:"M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z",key:"zighg4"}],["path",{d:"M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z",key:"1pa5tk"}]]),mY=Ve("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),pY=Ve("Grid",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"9",y2:"9",key:"1vqk6q"}],["line",{x1:"3",x2:"21",y1:"15",y2:"15",key:"o2sbyz"}],["line",{x1:"9",x2:"9",y1:"3",y2:"21",key:"13tij5"}],["line",{x1:"15",x2:"15",y1:"3",y2:"21",key:"1hpv9i"}]]),sP=Ve("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),gY=Ve("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Av=Ve("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),Ab=Ve("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),zy=Ve("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),iP=Ve("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),aP=Ve("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),_N=Ve("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),y3=Ve("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),ji=Ve("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Si=Ve("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),yY=Ve("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]),xY=Ve("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),oP=Ve("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),lP=Ve("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),vY=Ve("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),bY=Ve("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),wY=Ve("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),NY=Ve("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]),Qu=Ve("Package",[["path",{d:"M16.5 9.4 7.55 4.24",key:"10qotr"}],["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),_Y=Ve("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),Kp=Ve("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),cP=Ve("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),Hn=Ve("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),jY=Ve("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),SY=Ve("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),Ai=Ve("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),x3=Ve("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]),Nr=Ve("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),AY=Ve("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),jN=Ve("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),uP=Ve("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]),Sf=Ve("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Yc=Ve("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),_n=Ve("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),of=Ve("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),EY=Ve("StarOff",[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),zn=Ve("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),Eb=Ve("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),dP=Ve("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),kY=Ve("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]),TY=Ve("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]),Qs=Ve("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),v3=Ve("TreePine",[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]]),pl=Ve("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),IY=Ve("Truck",[["path",{d:"M10 17h4V5H2v12h3",key:"1jq12e"}],["path",{d:"M20 17h2v-3.34a4 4 0 0 0-1.17-2.83L19 9h-5",key:"1xb3ft"}],["path",{d:"M14 17h1",key:"nufu4t"}],["circle",{cx:"7.5",cy:"17.5",r:"2.5",key:"a7aife"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),CY=Ve("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),PY=Ve("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),RY=Ve("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Aa=Ve("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),qn=Ve("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),hP=Ve("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"1ogz0v"}]]),DY=Ve("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),LY=Ve("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),OY=Ve("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),gl=Ve("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Zi=Ve("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),MY=()=>{const[t,e]=M.useState(!1),r=[{icon:iP,href:"https://www.instagram.com/royal.waldkraiburg/",label:"Instagram",color:"from-purple-500 via-pink-500 to-orange-500"},{icon:ji,href:"mailto:Royal.Waldkraiburg@gmail.com",label:"E-Mail",color:"bg-royal-gold"},{icon:Hn,href:"tel:+4915781413767",label:"Telefon",color:"bg-green-600"}];return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden lg:flex fixed left-6 top-1/2 transform -translate-y-1/2 z-50",children:a.jsx(oe.div,{initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.8,delay:.5},className:"flex flex-col space-y-4 royal-glass rounded-2xl p-4 royal-glow",children:r.map((n,s)=>a.jsx(oe.a,{href:n.href,target:"_blank",rel:"noopener noreferrer",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.8+s*.1},whileHover:{scale:1.2,rotate:5},whileTap:{scale:.9},className:`w-12 h-12 rounded-full flex items-center justify-center text-white transition-all 
duration-300 royal-hover-glow ${n.color.includes("from-")?`bg-gradient-to-r ${n.color}`:n.color}`,title:n.label,children:a.jsx(n.icon,{size:20})},n.label))})}),a.jsx("div",{className:"lg:hidden fixed bottom-6 right-6 z-50",children:a.jsxs("div",{className:"relative",children:[a.jsx(po,{children:t&&a.jsx(oe.div,{initial:{opacity:0,y:15,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:15,scale:.95},transition:{duration:.4,ease:"easeOut"},className:"absolute bottom-16 right-0 royal-glass rounded-2xl p-3 royal-glow mb-3",children:a.jsx("div",{className:"flex flex-col space-y-3",children:r.map((n,s)=>a.jsx(oe.a,{href:n.href,target:"_blank",rel:"noopener noreferrer",initial:{opacity:0,scale:.7,y:-10},animate:{opacity:1,scale:1,y:0},transition:{duration:.5,delay:s*.1,ease:"easeOut"},whileHover:{scale:1.1},whileTap:{scale:.95},className:`w-12 h-12 rounded-full flex items-center justify-center text-white transition-all duration-300 royal-hover-glow ${n.color.includes("from-")?`bg-gradient-to-r ${n.color}`:n.color}`,title:n.label,children:a.jsx(n.icon,{size:20})},n.label))})})}),a.jsx(oe.button,{whileHover:{scale:1.1},whileTap:{scale:.9},className:"w-14 h-14 bg-royal-gradient-gold rounded-full flex items-center justify-center text-royal-charcoal royal-glow royal-hover-glow shadow-lg",onClick:()=>e(!t),children:a.jsx(oe.div,{animate:{rotate:t?45:0},transition:{duration:.4,ease:"easeOut"},children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})})]})})]})},FY=({end:t,duration:e=2500,suffix:r="",className:n=""})=>{const[s,i]=M.useState(0),o=M.useRef(null),l=JK(o,{once:!0,margin:"-50px"});return M.useEffect(()=>{if(!l)return;let c,u;const d=h=>{c||(c=h);const g=Math.min((h-c)/e,1),m=g===1?1:1-Math.pow(2,-10*g),w=Math.floor(m*t);i(w),g<1&&(u=requestAnimationFrame(d))};return u=requestAnimationFrame(d),()=>{u&&cancelAnimationFrame(u)}},[l,t,e]),a.jsxs("span",{ref:o,className:n,children:[s,r]})},SN="/assets/Logo-caddc32e.jpeg",Fo=[{id:1,title:"Royal Shisha Experience",description:"Experience the premium atmosphere of Royal Shisha",url:"/videos/optimized/clip_1.mp4",fallback:"https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",duration:2.3,category:"experience"},{id:2,title:"Aerial View",description:"Breathtaking aerial footage of our location",url:"/videos/optimized/clip_2.mp4",fallback:"https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",duration:2.3,category:"drone"},{id:3,title:"Premium Hookah Setup",description:"Watch our expert staff prepare your perfect hookah",url:"/videos/optimized/clip_3.mp4",fallback:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",duration:2.3,category:"service"},{id:4,title:"Evening Atmosphere",description:"The magical evening ambiance at Royal Shisha",url:"/videos/optimized/clip_4.mp4",fallback:"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",duration:2.3,category:"atmosphere"},{id:5,title:"Drone Footage",description:"Spectacular drone views of our premium location",url:"/videos/optimized/clip_5.mp4",fallback:"https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",duration:2.3,category:"drone"},{id:6,title:"Sunset Views",description:"Beautiful sunset over Royal Shisha",url:"/videos/optimized/clip_6.mp4",fallback:"https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",duration:2.3,category:"atmosphere"},{id:7,title:"Premium Service",description:"Our dedicated staff providing exceptional service",url:"/videos/optimized/clip_7.mp4",fallback:"https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",duration:2.3,category:"service"},{id:8,title:"Hookah Preparation",description:"The art of preparing the perfect hookah",url:"/videos/optimized/clip_8.mp4",fallback:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",duration:2.3,category:"service"},{id:9,title:"Aerial Tour",description:"Complete aerial tour of our facilities",url:"/videos/optimized/clip_9.mp4",fallback:"https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",duration:2.3,category:"drone"},{id:10,title:"Evening Lights",description:"The beautiful evening lighting at Royal Shisha",url:"/videos/optimized/clip_10.mp4",fallback:"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",duration:2.3,category:"atmosphere"},{id:11,title:"Premium Atmosphere",description:"Experience our premium atmosphere and service",url:"/videos/optimized/clip_11.mp4",fallback:"https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",duration:2.3,category:"atmosphere"},{id:12,title:"Quick Tour",description:"A quick tour of our premium facilities",url:"/videos/optimized/clip_12.mp4",fallback:"https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",duration:2.3,category:"tour"},{id:13,title:"Service Excellence",description:"Our commitment to service excellence",url:"/videos/optimized/clip_13.mp4",fallback:"https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",duration:2.3,category:"service"},{id:14,title:"Complete Experience",description:"The complete Royal Shisha experience",url:"/videos/optimized/clip_14.mp4",fallback:"https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",duration:2.3,category:"experience"},{id:15,title:"Royal Shisha Complete",description:"The complete Royal Shisha experience showcase",url:"/videos/optimized/clip_15.mp4",fallback:"https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",duration:2.3,category:"showcase"}],b3={autoPlay:!0,loop:!0,muted:!0,transitionDuration:1e3,autoAdvanceInterval:6e3,showControls:!0,showIndicators:!0,showInfo:!0,fallbackOnError:!0},AN=({className:t="",width:e="100%",zoom:r=15})=>{const n={lat:48.2082,lng:12.3985,address:"Stadtpl. 2, 84478 Waldkraiburg, Germany",name:"Royal Shisha Bar"},s=`https://www.google.com/maps/embed/v1/place?key=AIzaSyBFw0Qbyq9zTFTd-tUY6dZWTgaQzuU17R8&q=${encodeURIComponent(n.address)}&zoom=${r}`;return a.jsx("div",{className:`w-full ${e} ${t}`,children:a.jsx(oe.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},className:"space-y-6",children:a.jsxs("div",{className:"relative w-full h-80 md:h-96 rounded-2xl overflow-hidden shadow-2xl border-2 border-royal-gold/20",children:[a.jsx("iframe",{src:s,width:"100%",height:"100%",style:{border:0},allowFullScreen:!0,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade",title:"Royal Shisha Bar Location",className:"w-full h-full"}),a.jsxs("div",{className:"absolute top-4 left-4 bg-white/95 backdrop-blur-sm rounded-lg p-4 shadow-lg max-w-xs",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(Si,{className:"w-5 h-5 text-royal-gold"}),a.jsx("h3",{className:"font-royal font-bold text-royal-charcoal",children:n.name})]}),a.jsx("p",{className:"text-sm text-royal-charcoal/80 mb-3",children:n.address}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("a",{href:`https://maps.google.com/maps?daddr=${encodeURIComponent(n.address)}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 text-xs bg-royal-gold text-white px-3 py-1.5 rounded-full hover:bg-royal-gold-dark transition-colors duration-200",children:[a.jsx(NY,{className:"w-3 h-3"}),a.jsx("span",{children:"Route"})]}),a.jsxs("a",{href:"tel:+4915781413767",className:"flex items-center space-x-1 text-xs bg-royal-purple text-white px-3 py-1.5 rounded-full hover:bg-royal-purple-dark transition-colors duration-200",children:[a.jsx(Hn,{className:"w-3 h-3"}),a.jsx("span",{children:"Anrufen"})]})]})]})]})})})},VY=()=>{const[t,e]=M.useState(0),[r,n]=M.useState(!0),s=b3.autoPlay,i=M.useRef([]);M.useEffect(()=>{const m=setInterval(()=>{e(w=>(w+1)%Fo.length)},b3.autoAdvanceInterval);return()=>clearInterval(m)},[s]);const o=()=>{const m=i.current[t];m&&(r?m.pause():m.play(),n(!r))},l=m=>{e(m),n(!0);const w=i.current[m];w&&(w.currentTime=0,w.play())},c=()=>{const m=t===0?Fo.length-1:t-1;l(m)},u=()=>{const m=(t+1)%Fo.length;l(m)},d=m=>{const w=i.current[m];if(w){w.style.display="none";const _=w.nextElementSibling;_&&(_.style.display="block")}},h=[{icon:Et,title:"Königliches Erlebnis",description:"Erleben Sie die feinsten Shisha-Aromen in einer luxuriösen Atmosphäre"},{icon:wY,title:"Live-Unterhaltung",description:"Genießen Sie Live-DJ-Auftritte und erstellen Sie Ihre eigene königliche Playlist"},{icon:qn,title:"Exklusive Atmosphäre",description:"Der perfekte Ort, um stilvoll zu entspannen und sich mit Freunden zu treffen"},{icon:zn,title:"Premium-Service",description:"Professionelles Personal, das sich Ihrem königlichen Wohlbefinden widmet"}],g=[{number:50,suffix:"+",label:"Premium-Aromen"},{number:100,suffix:"+",label:"Königliche Gäste"},{number:5,suffix:"",label:"Sterne-Bewertung"},{number:24,suffix:"/7",label:"Königlicher Service"}];return a.jsxs("div",{className:"min-h-screen",children:[a.jsx(MY,{}),a.jsxs("section",{className:"relative h-screen flex items-center justify-center overflow-hidden hero-section",children:[a.jsx("div",{className:"absolute inset-0 z-0",children:a.jsx(po,{mode:"wait",children:a.jsxs(oe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:1},className:"absolute inset-0",children:[a.jsxs("video",{ref:m=>i.current[t]=m,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,onError:()=>d(t),className:"absolute top-1/2 left-1/2 w-auto min-w-full min-h-full max-w-none transform -translate-x-1/2 -translate-y-1/2 object-cover",children:[a.jsx("source",{src:Fo[t].url,type:"video/mp4"}),"Your browser does not support the video tag."]}),a.jsx("img",{src:Fo[t].fallback,alt:Fo[t].title,className:"absolute top-1/2 left-1/2 w-auto min-w-full min-h-full max-w-none transform -translate-x-1/2 -translate-y-1/2 object-cover hidden"})]},t)})}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black/60 via-black/40 to-royal-purple-dark/50 z-10"}),a.jsx("div",{className:"absolute top-1/2 left-2 md:left-4 transform -translate-y-1/2 z-30",children:a.jsx(oe.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:c,className:"bg-royal-gold/20 backdrop-blur-sm text-white p-2 md:p-3 rounded-full border border-royal-gold/30 hover:bg-royal-gold/30 transition-all duration-300 royal-glow",children:a.jsx(lY,{className:"w-4 h-4 md:w-6 md:h-6"})})}),a.jsx("div",{className:"absolute top-1/2 right-2 md:right-4 transform -translate-y-1/2 z-30",children:a.jsx(oe.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:u,className:"bg-royal-gold/20 backdrop-blur-sm text-white p-2 md:p-3 rounded-full border border-royal-gold/30 hover:bg-royal-gold/30 transition-all duration-300 royal-glow",children:a.jsx(cY,{className:"w-4 h-4 md:w-6 md:h-6"})})}),a.jsx("div",{className:"absolute top-20 md:top-24 right-2 md:right-4 z-30",children:a.jsx(oe.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:o,className:"bg-royal-gold/20 backdrop-blur-sm text-white p-2 md:p-3 rounded-full border border-royal-gold/30 hover:bg-royal-gold/30 transition-all duration-300 royal-glow",children:r?a.jsx(_Y,{className:"w-4 h-4 md:w-5 md:h-5"}):a.jsx(SY,{className:"w-4 h-4 md:w-5 md:h-5"})})}),a.jsx("div",{className:"absolute bottom-16 md:bottom-20 left-1/2 transform -translate-x-1/2 z-30",children:a.jsx("div",{className:"flex space-x-2 md:space-x-3",children:Fo.map((m,w)=>a.jsx(oe.button,{whileHover:{scale:1.2},whileTap:{scale:.9},onClick:()=>l(w),className:`w-2 h-2 md:w-3 md:h-3 rounded-full transition-all duration-300 ${w===t?"bg-royal-gold royal-glow":"bg-white/50 hover:bg-white/70"}`},w))})}),a.jsx("div",{className:"absolute bottom-32 left-1/2 transform -translate-x-1/2 z-30 text-center hidden md:block",children:a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-white",children:[a.jsx("h3",{className:"text-2xl font-royal font-bold mb-2 royal-text-glow",children:Fo[t].title}),a.jsx("p",{className:"text-royal-cream-light",children:Fo[t].description})]},t)}),a.jsxs("div",{className:"absolute inset-0 z-10 pointer-events-none hero-background-elements",children:[a.jsx(oe.div,{animate:{scale:[1,1.1,1],opacity:[.1,.2,.1]},transition:{duration:25,repeat:1/0,ease:"easeInOut"},className:"absolute top-20 left-20 w-16 h-16 md:w-32 md:h-32 bg-royal-gold/10 rounded-full blur-2xl"}),a.jsx(oe.div,{animate:{scale:[1.1,1,1.1],opacity:[.1,.15,.1]},transition:{duration:20,repeat:1/0,ease:"easeInOut"},className:"absolute bottom-20 right-20 w-20 h-20 md:w-40 md:h-40 bg-royal-purple/10 rounded-full blur-2xl"}),a.jsx(oe.div,{animate:{y:[0,-15,0],opacity:[.2,.4,.2]},transition:{duration:6,repeat:1/0,ease:"easeInOut"},className:"absolute top-1/4 left-1/6 w-12 h-12 bg-royal-gold/20 rounded-full blur-lg hidden md:block"}),a.jsx(oe.div,{animate:{y:[0,10,0],opacity:[.15,.3,.15]},transition:{duration:8,repeat:1/0,ease:"easeInOut",delay:3},className:"absolute bottom-1/4 right-1/6 w-10 h-10 bg-royal-burgundy/15 rounded-full blur-md hidden md:block"})]}),a.jsxs("div",{className:"relative z-30 text-center text-white px-4 max-w-4xl mx-auto w-full",children:[a.jsx(oe.div,{initial:{opacity:0,y:-30},animate:{opacity:1,y:0},transition:{duration:1,delay:.2},className:"mb-4 md:mb-8 hero-logo-container",children:a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:SN,alt:"Royal Shisha Logo",className:"w-20 h-20 sm:w-24 sm:h-24 md:w-40 md:h-40 mx-auto rounded-full object-cover border-2 md:border-4 border-royal-gold shadow-2xl relative z-10"}),a.jsx("div",{className:"absolute inset-0 bg-royal-gold/20 rounded-full blur-xl animate-pulse"})]})}),a.jsxs(oe.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:1,delay:.4},className:"mb-6 md:mb-8",children:[a.jsx("h1",{className:"text-4xl sm:text-5xl md:text-7xl font-royal font-bold mb-4 md:mb-6 royal-text-glow",children:"Royal Shisha Bar"}),a.jsx("p",{className:"text-lg sm:text-xl md:text-2xl text-royal-cream-light mb-6 md:mb-8 max-w-3xl mx-auto leading-relaxed",children:"Erleben Sie die Kunst des Shisha-Rauchens in einer königlichen Atmosphäre mit Premium-Aromen und exklusivem Service"})]}),a.jsxs(oe.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:1,delay:.6},className:"flex flex-col sm:flex-row gap-4 justify-center items-center mb-8 md:mb-12",children:[a.jsx(Jr,{to:"/menu",className:"px-8 py-4 bg-royal-gold text-royal-charcoal font-royal font-bold rounded-royal hover:bg-royal-gold/90 transition-all duration-300 royal-glow hover:scale-105 transform",children:"Menü Entdecken"}),a.jsx(Jr,{to:"/events",className:"px-8 py-4 border-2 border-royal-gold text-royal-gold font-royal font-bold rounded-royal hover:bg-royal-gold hover:text-royal-charcoal transition-all duration-300 royal-glow hover:scale-105 transform",children:"Events & Reservierungen"}),a.jsxs(Jr,{to:"/loyalty",className:"px-8 py-4 bg-gradient-to-r from-purple-600 to-purple-800 text-white font-royal font-bold rounded-royal hover:from-purple-700 hover:to-purple-900 transition-all duration-300 royal-glow hover:scale-105 transform flex items-center space-x-2",children:[a.jsx(Et,{className:"w-5 h-5"}),a.jsx("span",{children:"Stempelpass"})]})]}),a.jsx(oe.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:1,delay:.8},className:"grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-8 max-w-4xl mx-auto",children:g.map((m,w)=>a.jsxs("div",{className:"text-center p-4 bg-royal-gold/10 backdrop-blur-sm rounded-royal border border-royal-gold/20",children:[a.jsx("div",{className:"text-2xl md:text-3xl font-royal font-bold text-royal-gold mb-1",children:a.jsx(FY,{end:m.number,suffix:m.suffix})}),a.jsx("div",{className:"text-xs md:text-sm text-royal-cream-light",children:m.label})]},w))})]})]}),a.jsx("section",{className:"py-16 md:py-24 bg-gradient-to-br from-purple-900 to-royal-purple-dark",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8},viewport:{once:!0},className:"text-center mb-12 md:mb-16",children:[a.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-4",children:[a.jsx(Et,{className:"w-12 h-12 text-royal-gold"}),a.jsx("h2",{className:"text-3xl md:text-5xl font-royal font-bold text-white",children:"Royal Stempelpass"})]}),a.jsx("p",{className:"text-lg md:text-xl text-royal-cream-light max-w-3xl mx-auto",children:"Sammeln Sie bei jeder Shisha-Bestellung Stempel und erhalten Sie nach 10 Stempeln eine gratis Shisha"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-12",children:[a.jsxs(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.1},viewport:{once:!0},className:"text-center p-6 bg-white/10 backdrop-blur-sm rounded-royal border border-white/20",children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-royal-gold/20 rounded-full flex items-center justify-center",children:a.jsx(zn,{className:"w-8 h-8 text-royal-gold"})}),a.jsx("h3",{className:"text-xl font-royal font-bold text-white mb-3",children:"Sammeln"}),a.jsx("p",{className:"text-royal-cream-light leading-relaxed",children:"1 Stempel pro bestellter Shisha"})]}),a.jsxs(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.2},viewport:{once:!0},className:"text-center p-6 bg-white/10 backdrop-blur-sm rounded-royal border border-white/20",children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-royal-gold/20 rounded-full flex items-center justify-center",children:a.jsx(Et,{className:"w-8 h-8 text-royal-gold"})}),a.jsx("h3",{className:"text-xl font-royal font-bold text-white mb-3",children:"10 Stempel = Belohnung"}),a.jsx("p",{className:"text-royal-cream-light leading-relaxed",children:"Eine gratis Shisha Ihrer Wahl"})]}),a.jsxs(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.3},viewport:{once:!0},className:"text-center p-6 bg-white/10 backdrop-blur-sm rounded-royal border border-white/20",children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-royal-gold/20 rounded-full flex items-center justify-center",children:a.jsx(Ki,{className:"w-8 h-8 text-royal-gold"})}),a.jsx("h3",{className:"text-xl font-royal font-bold text-white mb-3",children:"Einlösen"}),a.jsx("p",{className:"text-royal-cream-light leading-relaxed",children:"Einfach bei der nächsten Bestellung verwenden"})]})]}),a.jsx(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.4},viewport:{once:!0},className:"text-center",children:a.jsxs(Jr,{to:"/loyalty",className:"inline-flex items-center space-x-2 px-8 py-4 bg-royal-gold text-royal-charcoal font-royal font-bold rounded-royal hover:bg-royal-gold/90 transition-all duration-300 royal-glow hover:scale-105 transform",children:[a.jsx(Et,{className:"w-5 h-5"}),a.jsx("span",{children:"Stempelpass erstellen"})]})})]})}),a.jsx("section",{className:"py-16 md:py-24 bg-royal-charcoal",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8},viewport:{once:!0},className:"text-center mb-12 md:mb-16",children:[a.jsx("h2",{className:"text-3xl md:text-5xl font-royal font-bold text-white mb-4 md:mb-6",children:"Warum Royal Shisha Bar?"}),a.jsx("p",{className:"text-lg md:text-xl text-royal-cream-light max-w-3xl mx-auto",children:"Entdecken Sie die einzigartigen Vorteile, die uns zu Ihrer ersten Wahl für ein königliches Shisha-Erlebnis machen"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:h.map((m,w)=>a.jsxs(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:w*.1},viewport:{once:!0},className:"text-center p-6 bg-royal-gradient-gold rounded-royal royal-glow border border-royal-gold/30",children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-royal-gold/20 rounded-full flex items-center justify-center",children:a.jsx(m.icon,{className:"w-8 h-8 text-royal-gold"})}),a.jsx("h3",{className:"text-xl font-royal font-bold text-royal-charcoal mb-3",children:m.title}),a.jsx("p",{className:"text-royal-charcoal/80 leading-relaxed",children:m.description})]},w))})]})}),a.jsx("section",{className:"py-16 md:py-24 bg-gradient-to-br from-royal-purple-dark to-royal-burgundy",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8},viewport:{once:!0},className:"text-center mb-12 md:mb-16",children:[a.jsx("h2",{className:"text-3xl md:text-5xl font-royal font-bold text-white mb-4 md:mb-6",children:"Kontaktieren Sie Uns"}),a.jsx("p",{className:"text-lg md:text-xl text-royal-cream-light max-w-3xl mx-auto",children:"Bereit für ein königliches Erlebnis? Kontaktieren Sie uns für Reservierungen oder Fragen"})]}),a.jsx(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},className:"mb-12",children:a.jsx(AN,{className:"max-w-4xl mx-auto"})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[a.jsxs(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},className:"text-center p-6 bg-white/10 backdrop-blur-sm rounded-royal border border-white/20",children:[a.jsx(Hn,{className:"w-12 h-12 mx-auto mb-4 text-royal-gold"}),a.jsx("h3",{className:"text-xl font-royal font-bold text-white mb-2",children:"Telefon"}),a.jsx("p",{className:"text-royal-cream-light",children:"+49 15781413767"})]}),a.jsxs(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.1},viewport:{once:!0},className:"text-center p-6 bg-white/10 backdrop-blur-sm rounded-royal border border-white/20",children:[a.jsx(ji,{className:"w-12 h-12 mx-auto mb-4 text-royal-gold"}),a.jsx("h3",{className:"text-xl font-royal font-bold text-white mb-2",children:"E-Mail"}),a.jsx("p",{className:"text-royal-cream-light",children:"Royal.Waldkraiburg@gmail.com"})]}),a.jsxs(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.2},viewport:{once:!0},className:"text-center p-6 bg-white/10 backdrop-blur-sm rounded-royal border border-white/20",children:[a.jsx(Rr,{className:"w-12 h-12 mx-auto mb-4 text-royal-gold"}),a.jsx("h3",{className:"text-xl font-royal font-bold text-white mb-2",children:"Öffnungszeiten"}),a.jsxs("p",{className:"text-royal-cream-light",children:["Mo-Fr: 17:00 - 01:00",a.jsx("br",{}),"Sa-So: 17:00 - 03:00"]})]})]})]})})]})},BY=({onSuccess:t,onError:e,variant:r="default"})=>{const{isLoading:n}=yn(),s=async()=>{try{await EC.signInWithProvider("google"),t==null||t("google"),_t.success("Successfully signed in with Google!")}catch(i){_t.error(i.message),e==null||e(i.message)}};return r==="compact"?a.jsxs(oe.button,{onClick:s,disabled:n,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full py-3 px-4 bg-white border border-gray-300 rounded-lg shadow-sm hover:shadow-md transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-3 group",children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),a.jsx("span",{className:"text-gray-700 font-medium group-hover:text-gray-900 transition-colors",children:"Mit Google fortfahren"})]}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-gray-300"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Oder fortfahren mit"})})]}),a.jsxs(oe.button,{onClick:s,disabled:n,whileHover:{scale:1.02,y:-1},whileTap:{scale:.98},className:"w-full py-4 px-6 bg-white border-2 border-gray-200 rounded-xl shadow-lg hover:shadow-xl hover:border-blue-300 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-4 group relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-50 to-red-50 opacity-0 group-hover:opacity-30 transition-opacity duration-300"}),a.jsxs("svg",{className:"w-6 h-6 relative z-10",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),a.jsx("span",{className:"text-gray-700 font-semibold text-lg group-hover:text-gray-900 transition-colors relative z-10",children:n?"Anmeldung läuft...":"Mit Google fortfahren"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-0 group-hover:opacity-20 transform -skew-x-12 -translate-x-full group-hover:translate-x-full transition-all duration-700 ease-out"})]})]})},UY=()=>{const[t,e]=M.useState("login"),[r,n]=M.useState(!1),[s,i]=M.useState({email:"",password:"",name:"",phone:""}),{signIn:o,signUp:l,signInWithSocial:c,resetPassword:u,isLoading:d,isAuthenticated:h}=yn(),g=Ap();M.useEffect(()=>{h&&g("/",{replace:!0})},[h,g]);const m=T=>{i({...s,[T.target.name]:T.target.value})},w=async T=>{T.preventDefault();try{t==="login"?(await o(s.email,s.password),_t.success("Welcome back!"),g("/",{replace:!0})):t==="register"?(await l(s.email,s.password,s.name,s.phone),_t.success("Account created successfully!"),g("/",{replace:!0})):t==="reset"&&(await u(s.email),_t.success("Password reset email sent!"),e("login"))}catch(v){_t.error(v.message)}},_=async T=>{try{await c(T),_t.success(`Welcome! Signed in with ${T}`),g("/",{replace:!0})}catch(v){_t.error(v.message)}};return a.jsxs("div",{className:"min-h-screen flex items-center justify-center pt-20 px-4 bg-royal-gradient relative overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 z-0",children:[a.jsx(oe.div,{animate:{scale:[1,1.2,1],rotate:[0,180,360]},transition:{duration:20,repeat:1/0,ease:"linear"},className:"absolute top-20 left-20 w-32 h-32 bg-royal-gold/10 rounded-full blur-xl"}),a.jsx(oe.div,{animate:{scale:[1.2,1,1.2],rotate:[360,180,0]},transition:{duration:15,repeat:1/0,ease:"linear"},className:"absolute bottom-20 right-20 w-40 h-40 bg-royal-purple/10 rounded-full blur-xl"})]}),a.jsxs(oe.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.6,ease:"easeOut"},className:"relative z-10 max-w-md w-full royal-glass p-8 rounded-2xl royal-glow border border-royal-gold/30",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx(oe.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.2},className:"w-16 h-16 bg-royal-gradient-gold rounded-full flex items-center justify-center mx-auto mb-4 royal-glow",children:a.jsx(Et,{className:"w-8 h-8 text-royal-charcoal"})}),a.jsxs(oe.h2,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},className:"text-3xl font-royal font-bold text-royal-gold mb-2 royal-text-glow",children:[t==="login"&&"Willkommen zurück",t==="register"&&"Royalty beitreten",t==="reset"&&"Passwort zurücksetzen"]}),a.jsxs(oe.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"text-royal-cream-light",children:[t==="login"&&"Melden Sie sich an, um exklusive Vorteile zu erhalten.",t==="register"&&"Erstellen Sie Ihr königliches Konto.",t==="reset"&&"Geben Sie Ihre E-Mail-Adresse ein."]})]}),a.jsxs(oe.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.5},onSubmit:w,className:"space-y-4 mb-6",children:[t==="register"&&a.jsxs("div",{className:"relative",children:[a.jsx(Aa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-royal-cream-light w-5 h-5"}),a.jsx("input",{type:"text",name:"name",placeholder:"Vollständiger Name",value:s.name,onChange:m,required:t==="register",className:"royal-input w-full pl-10 pr-4 py-3 text-royal-cream-light placeholder-royal-cream-light/60"})]}),t==="register"&&a.jsxs("div",{className:"relative",children:[a.jsx(Hn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-royal-cream-light w-5 h-5"}),a.jsx("input",{type:"tel",name:"phone",placeholder:"Telefonnummer (optional)",value:s.phone,onChange:m,className:"royal-input w-full pl-10 pr-4 py-3 text-royal-cream-light placeholder-royal-cream-light/60"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ji,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-royal-cream-light w-5 h-5"}),a.jsx("input",{type:"email",name:"email",placeholder:"E-Mail-Adresse",value:s.email,onChange:m,required:!0,className:"royal-input w-full pl-10 pr-4 py-3 text-royal-cream-light placeholder-royal-cream-light/60"})]}),t!=="reset"&&a.jsxs("div",{className:"relative",children:[a.jsx(_N,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-royal-cream-light w-5 h-5"}),a.jsx("input",{type:r?"text":"password",name:"password",placeholder:"Passwort",value:s.password,onChange:m,required:t==="login"||t==="register",className:"royal-input w-full pl-10 pr-12 py-3 text-royal-cream-light placeholder-royal-cream-light/60"}),a.jsx("button",{type:"button",onClick:()=>n(!r),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-royal-cream-light hover:text-royal-gold transition-colors duration-200",children:r?a.jsx(Gp,{className:"w-5 h-5"}):a.jsx(Ca,{className:"w-5 h-5"})})]}),a.jsx(oe.button,{type:"submit",disabled:d,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-royal-gradient-gold text-royal-charcoal font-semibold py-3 px-6 rounded-lg hover:shadow-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed royal-hover-glow relative overflow-hidden",children:d?a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-royal-charcoal mr-2"}),t==="login"&&"Anmelden...",t==="register"&&"Registrieren...",t==="reset"&&"Senden..."]}):a.jsxs(a.Fragment,{children:[t==="login"&&"Anmelden",t==="register"&&"Registrieren",t==="reset"&&"Zurücksetzen"]})})]}),a.jsxs(oe.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5,delay:.6},className:"text-center mb-6",children:[t==="login"&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("button",{onClick:()=>e("register"),className:"text-royal-gold hover:text-royal-gold-light transition-colors duration-200 text-sm font-medium",children:"Noch kein Konto? Registrieren"}),a.jsx("div",{children:a.jsx("button",{onClick:()=>e("reset"),className:"text-royal-cream-light hover:text-royal-gold transition-colors duration-200 text-sm",children:"Passwort vergessen?"})})]}),t==="register"&&a.jsx("button",{onClick:()=>e("login"),className:"text-royal-gold hover:text-royal-gold-light transition-colors duration-200 text-sm font-medium",children:"Bereits ein Konto? Anmelden"}),t==="reset"&&a.jsx("button",{onClick:()=>e("login"),className:"text-royal-gold hover:text-royal-gold-light transition-colors duration-200 text-sm font-medium",children:"Zurück zur Anmeldung"})]}),a.jsxs(oe.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5,delay:.7},children:[a.jsxs("div",{className:"relative mb-6",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-royal-gold/30"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"px-2 bg-royal-charcoal-dark text-royal-cream-light",children:"Oder fortfahren mit"})})]}),a.jsx(BY,{onSuccess:_})]})]})]})};class Xa{static async createPopup(e){try{const r={...e,createdAt:yt.now(),updatedAt:yt.now()};return(await xo(Be(Ce(),this.COLLECTION),r)).id}catch(r){throw console.error("Error creating popup:",r),new Error("Failed to create popup")}}static async createEventNotification(e){try{console.log("PopupService: Creating event notification for event:",e.title);const r=new Date(e.date),n=new Date,s=r.getTime()-n.getTime(),i=Math.ceil(s/(1e3*60*60*24));let o="",l="";i===0?(o="🎉 Event Tonight!",l=`Don't miss ${e.title} happening tonight at ${e.time}!`):i===1?(o="📅 Event Tomorrow!",l=`${e.title} is happening tomorrow at ${e.time}. Get ready for an amazing time!`):i<=7?(o="📅 Upcoming Event!",l=`${e.title} is coming up in ${i} days. Don't miss out!`):(o="📅 New Event Announced!",l=`We're excited to announce ${e.title} on ${r.toLocaleDateString()} at ${e.time}!`),console.log("PopupService: Generated title:",o,"message:",l);const c={type:"event",title:o,message:l,isActive:!0,createdBy:e.createdBy,priority:10,expiresAt:new Date(r.getTime()+24*60*60*1e3),eventId:e.id,eventData:{title:e.title,date:e.date,time:e.time,location:e.location,imageUrl:e.imageUrl,category:e.category}};console.log("PopupService: Popup data to create:",c);const u=await this.createPopup(c);return console.log("PopupService: Event notification created with ID:",u),u}catch(r){throw console.error("PopupService: Error creating event notification:",r),new Error("Failed to create event notification")}}static async createUpcomingEventPopup(e){try{if(e.length===0)return null;const r=e[0],n=new Date(r.date),s=new Date,i=n.getTime()-s.getTime(),o=Math.ceil(i/(1e3*60*60*24));let l="",c="";o===0?(l="🎉 Tonight's Event!",c=`Join us for ${r.title} tonight at ${r.time} - ${r.location}`):o===1?(l="📅 Tomorrow's Highlight!",c=`${r.title} tomorrow at ${r.time}. ${r.location}`):(l="📅 Next Upcoming Event!",c=`${r.title} in ${o} days. ${n.toLocaleDateString()} at ${r.time}`);const u={type:"event",title:l,message:c,isActive:!0,createdBy:"system",priority:8,expiresAt:new Date(n.getTime()+24*60*60*1e3),eventId:r.id,eventData:{title:r.title,date:r.date,time:r.time,location:r.location,imageUrl:r.imageUrl,category:r.category}};return this.createPopup(u)}catch(r){throw console.error("Error creating upcoming event popup:",r),new Error("Failed to create upcoming event popup")}}static async getEventPopups(){try{const e=qe(Be(Ce(),this.COLLECTION),Je("type","==","event"),Je("isActive","==",!0),Vt("priority","desc"),Vt("createdAt","desc")),r=await st(e),n=[];r.forEach(i=>{var c;const o=i.data();let l=o.eventData;l&&l.date&&typeof l.date=="object"&&"toDate"in l.date&&(l={...l,date:l.date.toDate()}),n.push({id:i.id,type:o.type,title:o.title,message:o.message,isActive:o.isActive,createdAt:o.createdAt.toDate(),updatedAt:o.updatedAt.toDate(),createdBy:o.createdBy,expiresAt:(c=o.expiresAt)==null?void 0:c.toDate(),priority:o.priority||0,eventId:o.eventId,eventData:l})});const s=new Date;return n.filter(i=>!i.expiresAt||i.expiresAt>s)}catch(e){throw console.error("Error getting event popups:",e),new Error("Failed to get event popups")}}static async updatePopup(e,r){try{const n={...r,updatedAt:yt.now()};await Qt(ot(Ce(),this.COLLECTION,e),n)}catch(n){throw console.error("Error updating popup:",n),new Error("Failed to update popup")}}static async deletePopup(e){try{await ba(ot(Ce(),this.COLLECTION,e))}catch(r){throw console.error("Error deleting popup:",r),new Error("Failed to delete popup")}}static async getActivePopups(){try{const e=qe(Be(Ce(),this.COLLECTION),Je("isActive","==",!0)),r=await st(e),n=[];r.forEach(i=>{var c;const o=i.data();let l=o.eventData;l&&l.date&&typeof l.date=="object"&&"toDate"in l.date&&(l={...l,date:l.date.toDate()}),n.push({id:i.id,type:o.type,title:o.title,message:o.message,isActive:o.isActive,createdAt:o.createdAt.toDate(),updatedAt:o.updatedAt.toDate(),createdBy:o.createdBy,expiresAt:(c=o.expiresAt)==null?void 0:c.toDate(),priority:o.priority||0,eventId:o.eventId,eventData:l})}),n.sort((i,o)=>i.priority!==o.priority?o.priority-i.priority:o.createdAt.getTime()-i.createdAt.getTime());const s=new Date;return n.filter(i=>!i.expiresAt||i.expiresAt>s)}catch(e){throw console.error("Error getting active popups:",e),new Error("Failed to get popups")}}static async getAllPopups(){try{const e=qe(Be(Ce(),this.COLLECTION),Vt("createdAt","desc")),r=await st(e),n=[];return r.forEach(s=>{var l;const i=s.data();let o=i.eventData;o&&o.date&&typeof o.date=="object"&&"toDate"in o.date&&(o={...o,date:o.date.toDate()}),n.push({id:s.id,type:i.type,title:i.title,message:i.message,isActive:i.isActive,createdAt:i.createdAt.toDate(),updatedAt:i.updatedAt.toDate(),createdBy:i.createdBy,expiresAt:(l=i.expiresAt)==null?void 0:l.toDate(),priority:i.priority||0,eventId:i.eventId,eventData:o})}),n}catch(e){throw console.error("Error getting all popups:",e),new Error("Failed to get popups")}}static onActivePopupsChange(e){console.log("PopupService: Setting up real-time listener");const r=qe(Be(Ce(),this.COLLECTION),Je("isActive","==",!0));return wi(r,n=>{console.log("PopupService: Received snapshot with",n.size,"documents");const s=[];n.forEach(l=>{var d;const c=l.data();console.log("PopupService: Processing popup:",l.id,c);let u=c.eventData;u&&u.date&&typeof u.date=="object"&&"toDate"in u.date&&(u={...u,date:u.date.toDate()}),s.push({id:l.id,type:c.type,title:c.title,message:c.message,isActive:c.isActive,createdAt:c.createdAt.toDate(),updatedAt:c.updatedAt.toDate(),createdBy:c.createdBy,expiresAt:(d=c.expiresAt)==null?void 0:d.toDate(),priority:c.priority||0,eventId:c.eventId,eventData:u})}),s.sort((l,c)=>l.priority!==c.priority?c.priority-l.priority:c.createdAt.getTime()-l.createdAt.getTime());const i=new Date;console.log("PopupService: Current time:",i),s.forEach(l=>{console.log("PopupService: Popup",l.id,"expires at:",l.expiresAt,"is expired:",l.expiresAt?l.expiresAt<=i:!1)});const o=s.filter(l=>!l.expiresAt||l.expiresAt>i);console.log("PopupService: Filtered to",o.length,"active popups"),e(o)})}static async togglePopupStatus(e,r){try{await Qt(ot(Ce(),this.COLLECTION,e),{isActive:r,updatedAt:yt.now()})}catch(n){throw console.error("Error toggling popup status:",n),new Error("Failed to update popup status")}}static async createSamplePopup(){const e={type:"promotion",title:"🎉 Weekend Special!",message:"Get 20% off on all premium hookah flavors this weekend!",isActive:!0,createdBy:"admin",priority:1};return this.createPopup(e)}static async fixExpiredPopups(){try{const e=await this.getAllPopups(),r=new Date,n=new Date(r.getTime()+7*24*60*60*1e3);for(const s of e)s.isActive&&s.expiresAt&&s.expiresAt<=r&&(console.log("PopupService: Extending expiration for popup:",s.id,s.title),await this.updatePopup(s.id,{expiresAt:n}))}catch(e){console.error("Error fixing expired popups:",e)}}static async getPopups(){try{const e=qe(Be(Ce(),this.COLLECTION),Vt("createdAt","desc")),r=await st(e),n=[];return r.forEach(s=>{var l;const i=s.data();let o=i.eventData;o&&o.date&&typeof o.date=="object"&&"toDate"in o.date&&(o={...o,date:o.date.toDate()}),n.push({id:s.id,type:i.type,title:i.title,message:i.message,isActive:i.isActive,createdAt:i.createdAt.toDate(),updatedAt:i.updatedAt.toDate(),createdBy:i.createdBy,expiresAt:(l=i.expiresAt)==null?void 0:l.toDate(),priority:i.priority||0,eventId:i.eventId,eventData:o})}),n}catch(e){throw console.error("Error getting all popups:",e),new Error("Failed to get popups")}}static async createAdminPopup(e){try{const r={type:e.type==="promo"?"promotion":e.type==="announcement"?"alert":e.type,title:e.title,message:e.message,isActive:!0,createdBy:"admin",priority:e.priority,expiresAt:new Date(e.endDate)};return this.createPopup(r)}catch(r){throw console.error("Error creating admin popup:",r),new Error("Failed to create popup")}}static async updateAdminPopup(e,r){try{const n={type:r.type==="promo"?"promotion":r.type==="announcement"?"alert":r.type,title:r.title,message:r.message,priority:r.priority,expiresAt:new Date(r.endDate),updatedAt:new Date};await this.updatePopup(e,n)}catch(n){throw console.error("Error updating admin popup:",n),new Error("Failed to update popup")}}}Dr(Xa,"COLLECTION","popups");const Vo="events";class ds{static async getEvents(e){try{const r=[];(e==null?void 0:e.isActive)!==void 0&&r.push(Je("isActive","==",e.isActive)),e!=null&&e.category&&r.push(Je("category","==",e.category)),e!=null&&e.dateFrom&&r.push(Je("date",">=",e.dateFrom)),e!=null&&e.dateTo&&r.push(Je("date","<=",e.dateTo)),r.length===0&&r.push(Vt("date","desc"));const n=qe(Be(Ce(),Vo),...r),s=await st(n),i=[];if(s.forEach(o=>{const l=o.data();i.push({id:o.id,...l,date:l.date.toDate(),createdAt:l.createdAt.toDate(),updatedAt:l.updatedAt.toDate()})}),(r.length===0||!r.some(o=>o.type==="orderBy"))&&i.sort((o,l)=>l.date.getTime()-o.date.getTime()),e!=null&&e.search){const o=e.search.toLowerCase();return i.filter(l=>l.title.toLowerCase().includes(o)||l.description.toLowerCase().includes(o)||l.location.toLowerCase().includes(o))}return i}catch(r){throw console.error("Error fetching events:",r),r}}static async getEventById(e){try{const r=ot(Ce(),Vo,e),n=await os(r);if(n.exists()){const s=n.data();return{id:n.id,...s,date:s.date.toDate(),createdAt:s.createdAt.toDate(),updatedAt:s.updatedAt.toDate()}}return null}catch(r){throw console.error("Error fetching event:",r),r}}static async createEvent(e,r){try{const n={...e,date:yt.fromDate(new Date(e.date)),isActive:!0,createdBy:r,createdAt:ft(),updatedAt:ft(),attendees:[]},i=(await xo(Be(Ce(),Vo),n)).id,o={id:i,...e,date:new Date(e.date),isActive:!0,createdBy:r,createdAt:new Date,updatedAt:new Date,attendees:[]};try{await Xa.createEventNotification(o),console.log("Event notification popup created successfully")}catch(l){console.error("Failed to create event notification popup:",l)}return i}catch(n){throw console.error("Error creating event:",n),n}}static async updateEvent(e,r){try{const n=ot(Ce(),Vo,e),s={...r,updatedAt:ft()};r.date&&(s.date=yt.fromDate(new Date(r.date))),await Qt(n,s)}catch(n){throw console.error("Error updating event:",n),n}}static async deleteEvent(e){try{const r=ot(Ce(),Vo,e);await ba(r)}catch(r){throw console.error("Error deleting event:",r),r}}static async toggleEventStatus(e,r){try{const n=ot(Ce(),Vo,e);await Qt(n,{isActive:r,updatedAt:ft()})}catch(n){throw console.error("Error toggling event status:",n),n}}static async toggleAttendance(e,r){try{const n=await this.getEventById(e);if(!n)throw new Error("Event not found");const s=ot(Ce(),Vo,e),i=n.attendees||[];if(i.includes(r)){const l=i.filter(c=>c!==r);await Qt(s,{attendees:l,updatedAt:ft()})}else{const l=[...i,r];await Qt(s,{attendees:l,updatedAt:ft()})}}catch(n){throw console.error("Error toggling attendance:",n),n}}static async getUpcomingEvents(e=5){try{const r=new Date,n=qe(Be(Ce(),Vo),Je("date",">=",r)),s=await st(n),i=[];return s.forEach(o=>{const l=o.data();l.isActive===!0&&i.push({id:o.id,...l,date:l.date.toDate(),createdAt:l.createdAt.toDate(),updatedAt:l.updatedAt.toDate()})}),i.sort((o,l)=>o.date.getTime()-l.date.getTime()),i.slice(0,e)}catch(r){return console.warn("Error fetching upcoming events:",r),[]}}static async getEventsByAdmin(e){try{const r=qe(Be(Ce(),Vo),Je("createdBy","==",e)),n=await st(r),s=[];return n.forEach(i=>{const o=i.data();s.push({id:i.id,...o,date:o.date.toDate(),createdAt:o.createdAt.toDate(),updatedAt:o.updatedAt.toDate()})}),s.sort((i,o)=>o.createdAt.getTime()-i.createdAt.getTime()),s}catch(r){throw console.error("Error fetching admin events:",r),r}}static async createUpcomingEventNotification(){try{const e=await this.getUpcomingEvents(3);e.length>0&&(await Xa.createUpcomingEventPopup(e),console.log("Upcoming event notification popup created successfully"))}catch(e){console.error("Failed to create upcoming event notification:",e)}}static async getEventStats(){try{const e=await this.getEvents(),r=new Date,n=e.filter(o=>o.isActive),s=e.filter(o=>o.isActive&&o.date>r),i=e.reduce((o,l)=>{var c;return o+(((c=l.attendees)==null?void 0:c.length)||0)},0);return{totalEvents:e.length,activeEvents:n.length,upcomingEvents:s.length,totalAttendees:i}}catch(e){throw console.error("Error fetching event stats:",e),e}}}const fP=6048e5,zY=864e5,w3=Symbol.for("constructDateFrom");function Ia(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&w3 in t?t[w3](e):t instanceof Date?new t.constructor(e):new Date(e)}function Gn(t,e){return Ia(e||t,t)}function mP(t,e,r){const n=Gn(t,r==null?void 0:r.in);return isNaN(e)?Ia((r==null?void 0:r.in)||t,NaN):(e&&n.setDate(n.getDate()+e),n)}function qY(t,e,r){const n=Gn(t,r==null?void 0:r.in);if(isNaN(e))return Ia((r==null?void 0:r.in)||t,NaN);if(!e)return n;const s=n.getDate(),i=Ia((r==null?void 0:r.in)||t,n.getTime());i.setMonth(n.getMonth()+e+1,0);const o=i.getDate();return s>=o?i:(n.setFullYear(i.getFullYear(),i.getMonth(),s),n)}let $Y={};function Yp(){return $Y}function ud(t,e){var l,c,u,d;const r=Yp(),n=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,s=Gn(t,e==null?void 0:e.in),i=s.getDay(),o=(i<n?7:0)+i-n;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function qy(t,e){return ud(t,{...e,weekStartsOn:1})}function pP(t,e){const r=Gn(t,e==null?void 0:e.in),n=r.getFullYear(),s=Ia(r,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const i=qy(s),o=Ia(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=qy(o);return r.getTime()>=i.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function N3(t){const e=Gn(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function WY(t,...e){const r=Ia.bind(null,t||e.find(n=>typeof n=="object"));return e.map(r)}function Nh(t,e){const r=Gn(t,e==null?void 0:e.in);return r.setHours(0,0,0,0),r}function HY(t,e,r){const[n,s]=WY(r==null?void 0:r.in,t,e),i=Nh(n),o=Nh(s),l=+i-N3(i),c=+o-N3(o);return Math.round((l-c)/zY)}function GY(t,e){const r=pP(t,e),n=Ia((e==null?void 0:e.in)||t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),qy(n)}function KY(t,e,r){return mP(t,e*7,r)}function YY(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function QY(t){return!(!YY(t)&&typeof t!="number"||isNaN(+Gn(t)))}function Xg(t,e){const r=Gn(t,e==null?void 0:e.in);return r.setHours(23,59,59,999),r}function _3(t,e){const r=Gn(t,e==null?void 0:e.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function j3(t,e){const r=Gn(t,e==null?void 0:e.in);return r.setDate(1),r.setHours(0,0,0,0),r}function JY(t,e){const r=Gn(t,e==null?void 0:e.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}function S3(t,e){var l,c,u,d;const r=Yp(),n=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,s=Gn(t,e==null?void 0:e.in),i=s.getDay(),o=(i<n?-7:0)+6-(i-n);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}const XY={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},ZY=(t,e,r)=>{let n;const s=XY[t];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Oh(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const eQ={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},tQ={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},rQ={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},nQ={date:Oh({formats:eQ,defaultWidth:"full"}),time:Oh({formats:tQ,defaultWidth:"full"}),dateTime:Oh({formats:rQ,defaultWidth:"full"})},sQ={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},iQ=(t,e,r,n)=>sQ[t];function Za(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):o;s=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;s=t.values[l]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return s[i]}}const aQ={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},oQ={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},lQ={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},cQ={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},uQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},dQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},hQ=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},fQ={ordinalNumber:hQ,era:Za({values:aQ,defaultWidth:"wide"}),quarter:Za({values:oQ,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Za({values:lQ,defaultWidth:"wide"}),day:Za({values:cQ,defaultWidth:"wide"}),dayPeriod:Za({values:uQ,defaultWidth:"wide",formattingValues:dQ,defaultFormattingWidth:"wide"})};function eo(t){return(e,r={})=>{const n=r.width,s=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],i=e.match(s);if(!i)return null;const o=i[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?pQ(l,h=>h.test(o)):mQ(l,h=>h.test(o));let u;u=t.valueCallback?t.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const d=e.slice(o.length);return{value:u,rest:d}}}function mQ(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function pQ(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function gP(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const s=n[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const l=e.slice(s.length);return{value:o,rest:l}}}const gQ=/^(\d+)(th|st|nd|rd)?/i,yQ=/\d+/i,xQ={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},vQ={any:[/^b/i,/^(a|c)/i]},bQ={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},wQ={any:[/1/i,/2/i,/3/i,/4/i]},NQ={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},_Q={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},jQ={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},SQ={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},AQ={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},EQ={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},kQ={ordinalNumber:gP({matchPattern:gQ,parsePattern:yQ,valueCallback:t=>parseInt(t,10)}),era:eo({matchPatterns:xQ,defaultMatchWidth:"wide",parsePatterns:vQ,defaultParseWidth:"any"}),quarter:eo({matchPatterns:bQ,defaultMatchWidth:"wide",parsePatterns:wQ,defaultParseWidth:"any",valueCallback:t=>t+1}),month:eo({matchPatterns:NQ,defaultMatchWidth:"wide",parsePatterns:_Q,defaultParseWidth:"any"}),day:eo({matchPatterns:jQ,defaultMatchWidth:"wide",parsePatterns:SQ,defaultParseWidth:"any"}),dayPeriod:eo({matchPatterns:AQ,defaultMatchWidth:"any",parsePatterns:EQ,defaultParseWidth:"any"})},TQ={code:"en-US",formatDistance:ZY,formatLong:nQ,formatRelative:iQ,localize:fQ,match:kQ,options:{weekStartsOn:0,firstWeekContainsDate:1}};function IQ(t,e){const r=Gn(t,e==null?void 0:e.in);return HY(r,JY(r))+1}function CQ(t,e){const r=Gn(t,e==null?void 0:e.in),n=+qy(r)-+GY(r);return Math.round(n/fP)+1}function yP(t,e){var d,h,g,m;const r=Gn(t,e==null?void 0:e.in),n=r.getFullYear(),s=Yp(),i=(e==null?void 0:e.firstWeekContainsDate)??((h=(d=e==null?void 0:e.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(g=s.locale)==null?void 0:g.options)==null?void 0:m.firstWeekContainsDate)??1,o=Ia((e==null?void 0:e.in)||t,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const l=ud(o,e),c=Ia((e==null?void 0:e.in)||t,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const u=ud(c,e);return+r>=+l?n+1:+r>=+u?n:n-1}function PQ(t,e){var l,c,u,d;const r=Yp(),n=(e==null?void 0:e.firstWeekContainsDate)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,s=yP(t,e),i=Ia((e==null?void 0:e.in)||t,0);return i.setFullYear(s,0,n),i.setHours(0,0,0,0),ud(i,e)}function RQ(t,e){const r=Gn(t,e==null?void 0:e.in),n=+ud(r,e)-+PQ(r,e);return Math.round(n/fP)+1}function ir(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const Jl={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return ir(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):ir(r+1,2)},d(t,e){return ir(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return ir(t.getHours()%12||12,e.length)},H(t,e){return ir(t.getHours(),e.length)},m(t,e){return ir(t.getMinutes(),e.length)},s(t,e){return ir(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return ir(s,e.length)}},Yd={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},A3={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return Jl.y(t,e)},Y:function(t,e,r,n){const s=yP(t,n),i=s>0?s:1-s;if(e==="YY"){const o=i%100;return ir(o,2)}return e==="Yo"?r.ordinalNumber(i,{unit:"year"}):ir(i,e.length)},R:function(t,e){const r=pP(t);return ir(r,e.length)},u:function(t,e){const r=t.getFullYear();return ir(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return ir(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return ir(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return Jl.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return ir(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const s=RQ(t,n);return e==="wo"?r.ordinalNumber(s,{unit:"week"}):ir(s,e.length)},I:function(t,e,r){const n=CQ(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):ir(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):Jl.d(t,e)},D:function(t,e,r){const n=IQ(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):ir(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const s=t.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return ir(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const s=t.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return ir(i,e.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),s=n===0?7:n;switch(e){case"i":return String(s);case"ii":return ir(s,e.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let s;switch(n===12?s=Yd.noon:n===0?s=Yd.midnight:s=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let s;switch(n>=17?s=Yd.evening:n>=12?s=Yd.afternoon:n>=4?s=Yd.morning:s=Yd.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Jl.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):Jl.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):ir(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):ir(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):Jl.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):Jl.s(t,e)},S:function(t,e){return Jl.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return k3(n);case"XXXX":case"XX":return Du(n);case"XXXXX":case"XXX":default:return Du(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return k3(n);case"xxxx":case"xx":return Du(n);case"xxxxx":case"xxx":default:return Du(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+E3(n,":");case"OOOO":default:return"GMT"+Du(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+E3(n,":");case"zzzz":default:return"GMT"+Du(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return ir(n,e.length)},T:function(t,e,r){return ir(+t,e.length)}};function E3(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=Math.trunc(n/60),i=n%60;return i===0?r+String(s):r+String(s)+e+ir(i,2)}function k3(t,e){return t%60===0?(t>0?"-":"+")+ir(Math.abs(t)/60,2):Du(t,e)}function Du(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=ir(Math.trunc(n/60),2),i=ir(n%60,2);return r+s+e+i}const T3=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},xP=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},DQ=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return T3(t,e);let i;switch(n){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",T3(n,e)).replace("{{time}}",xP(s,e))},LQ={p:xP,P:DQ},OQ=/^D+$/,MQ=/^Y+$/,FQ=["D","DD","YY","YYYY"];function VQ(t){return OQ.test(t)}function BQ(t){return MQ.test(t)}function UQ(t,e,r){const n=zQ(t,e,r);if(console.warn(n),FQ.includes(t))throw new RangeError(n)}function zQ(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const qQ=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,$Q=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,WQ=/^'([^]*?)'?$/,HQ=/''/g,GQ=/[a-zA-Z]/;function Lr(t,e,r){var d,h,g,m,w,_,T,v;const n=Yp(),s=(r==null?void 0:r.locale)??n.locale??TQ,i=(r==null?void 0:r.firstWeekContainsDate)??((h=(d=r==null?void 0:r.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??n.firstWeekContainsDate??((m=(g=n.locale)==null?void 0:g.options)==null?void 0:m.firstWeekContainsDate)??1,o=(r==null?void 0:r.weekStartsOn)??((_=(w=r==null?void 0:r.locale)==null?void 0:w.options)==null?void 0:_.weekStartsOn)??n.weekStartsOn??((v=(T=n.locale)==null?void 0:T.options)==null?void 0:v.weekStartsOn)??0,l=Gn(t,r==null?void 0:r.in);if(!QY(l))throw new RangeError("Invalid time value");let c=e.match($Q).map(b=>{const x=b[0];if(x==="p"||x==="P"){const P=LQ[x];return P(b,s.formatLong)}return b}).join("").match(qQ).map(b=>{if(b==="''")return{isToken:!1,value:"'"};const x=b[0];if(x==="'")return{isToken:!1,value:KQ(b)};if(A3[x])return{isToken:!0,value:b};if(x.match(GQ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:b}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const u={firstWeekContainsDate:i,weekStartsOn:o,locale:s};return c.map(b=>{if(!b.isToken)return b.value;const x=b.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&BQ(x)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&VQ(x))&&UQ(x,e,String(t));const P=A3[x[0]];return P(l,x,s.localize,u)}).join("")}function KQ(t){const e=t.match(WQ);return e?e[1].replace(HQ,"'"):t}function YQ(t,e,r){return mP(t,-e,r)}function QQ(t,e,r){return qY(t,-e,r)}function JQ(t,e,r){return KY(t,-e,r)}const XQ=({event:t,onUpdate:e,showAdminControls:r=!1})=>{var m,w;const{user:n}=yn(),[s,i]=Lc.useState(!1),[o,l]=Lc.useState(((m=t.attendees)==null?void 0:m.includes((n==null?void 0:n.id)||""))||!1),c=async()=>{if(!n){Ee.error("Please log in to attend events");return}i(!0);try{await ds.toggleAttendance(t.id,n.id),l(!o),Ee.success(o?"Removed from event":"Added to event"),e==null||e()}catch(_){Ee.error("Failed to update attendance"),console.error("Error toggling attendance:",_)}finally{i(!1)}},u=async()=>{i(!0);try{await ds.toggleEventStatus(t.id,!t.isActive),Ee.success(`Event ${t.isActive?"deactivated":"activated"}`),e==null||e()}catch(_){Ee.error("Failed to update event status"),console.error("Error toggling status:",_)}finally{i(!1)}},d=async()=>{if(confirm("Are you sure you want to delete this event?")){i(!0);try{await ds.deleteEvent(t.id),Ee.success("Event deleted successfully"),e==null||e()}catch(_){Ee.error("Failed to delete event"),console.error("Error deleting event:",_)}finally{i(!1)}}},h=_=>Lr(_,"MMM dd, yyyy"),g=_=>_;return a.jsxs("div",{className:`bg-white rounded-lg shadow-lg overflow-hidden transition-all duration-300 hover:shadow-xl ${t.isActive?"":"opacity-75"}`,children:[t.imageUrl&&a.jsx("div",{className:"h-48 overflow-hidden",children:a.jsx("img",{src:t.imageUrl,alt:t.title,className:"w-full h-full object-cover"})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:t.title}),a.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-2",children:[a.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),h(t.date)," at ",g(t.time)]}),a.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[a.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),t.location]})]}),a.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-semibold ${t.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.isActive?"Active":"Inactive"})]}),a.jsx("p",{className:"text-gray-700 mb-4 line-clamp-3",children:t.description}),a.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 text-sm text-gray-600",children:[t.category&&a.jsxs("div",{className:"flex items-center",children:[a.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),t.category]}),t.price!==void 0&&a.jsxs("div",{className:"flex items-center",children:[a.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),"$",t.price]}),t.capacity&&a.jsxs("div",{className:"flex items-center",children:[a.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),((w=t.attendees)==null?void 0:w.length)||0,"/",t.capacity," attendees"]})]}),t.tags&&t.tags.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:t.tags.map((_,T)=>a.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:_},T))}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("div",{className:"flex gap-2",children:a.jsx("button",{onClick:c,disabled:s||!t.isActive,className:`px-4 py-2 rounded-lg font-medium transition-colors ${o?"bg-red-500 text-white hover:bg-red-600":"bg-blue-500 text-white hover:bg-blue-600"} ${!t.isActive||s?"opacity-50 cursor-not-allowed":""}`,children:s?a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Loading..."]}):o?"Leave Event":"Join Event"})}),r&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:u,disabled:s,className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${t.isActive?"bg-yellow-500 text-white hover:bg-yellow-600":"bg-green-500 text-white hover:bg-green-600"} ${s?"opacity-50 cursor-not-allowed":""}`,children:t.isActive?"Deactivate":"Activate"}),a.jsx("button",{onClick:d,disabled:s,className:"px-3 py-2 bg-red-500 text-white rounded-lg text-sm font-medium hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Delete"})]})]})]})]})};class vP{static validateImageFile(e){return["image/jpeg","image/jpg","image/png","image/webp"].includes(e.type)?e.size>5242880?{isValid:!1,error:"Image size must be less than 5MB"}:{isValid:!0}:{isValid:!1,error:"Please select a valid image file (JPEG, PNG, or WebP)"}}static async compressImage(e,r=1200){return new Promise(n=>{const s=document.createElement("canvas"),i=s.getContext("2d"),o=new Image;o.onload=()=>{let{width:l,height:c}=o;l>r&&(c=c*r/l,l=r),s.width=l,s.height=c,i==null||i.drawImage(o,0,0,l,c),s.toBlob(u=>{if(u){const d=new File([u],e.name,{type:"image/jpeg",lastModified:Date.now()});n(d)}else n(e)},"image/jpeg",.8)},o.src=URL.createObjectURL(e)})}static async uploadImage(e,r="events",n){try{const s=this.validateImageFile(e);if(!s.isValid)throw new Error(s.error);const i=await this.compressImage(e),o=Date.now(),l=`${r}/${o}_${i.name}`,c=iS(this.storage,l),u=Zz(c,i);return new Promise((d,h)=>{u.on("state_changed",g=>{const m=g.bytesTransferred/g.totalBytes*100;n==null||n(m)},g=>{console.error("Upload error:",g),h(g)},async()=>{try{const g=await eq(u.snapshot.ref);d(g)}catch(g){console.error("Error getting download URL:",g),h(g)}})})}catch(s){throw console.error("Image upload error:",s),s}}static async deleteImage(e){try{const r=iS(this.storage,e);await tq(r)}catch(r){throw console.error("Error deleting image:",r),r}}}Dr(vP,"storage",lq());const ZQ=({value:t,onChange:e,onError:r,className:n="",disabled:s=!1,folder:i="events"})=>{const[o,l]=M.useState(!1),[c,u]=M.useState(!1),[d,h]=M.useState(0),[g,m]=M.useState(t||null),w=M.useRef(null),_=M.useCallback(async $=>{try{u(!0),h(0);const k=await vP.uploadImage($,i,A=>h(A));m(k),e(k),Ee.success("Image uploaded successfully!")}catch(k){const A=k instanceof Error?k.message:"Failed to upload image";Ee.error(A),r==null||r(A)}finally{u(!1),h(0)}},[e,r,i]),T=$=>{var A;const k=(A=$.target.files)==null?void 0:A[0];k&&_(k)},v=$=>{$.preventDefault(),s||l(!0)},b=$=>{$.preventDefault(),l(!1)},x=$=>{var A;if($.preventDefault(),l(!1),s)return;const k=(A=$.dataTransfer.files)==null?void 0:A[0];k&&_(k)},P=()=>{var $;!s&&!c&&(($=w.current)==null||$.click())},F=()=>{m(null),e(""),w.current&&(w.current.value="")};return a.jsxs("div",{className:`w-full ${n}`,children:[a.jsx("input",{ref:w,type:"file",accept:"image/*",onChange:T,className:"hidden",disabled:s||c}),a.jsx("div",{className:`
          relative border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-all duration-200
          ${o?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}
          ${s?"opacity-50 cursor-not-allowed":""}
          ${c?"cursor-wait":""}
        `,onDragOver:v,onDragLeave:b,onDrop:x,onClick:P,children:g?a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:g,alt:"Preview",className:"w-full h-48 object-cover rounded-lg"}),!s&&a.jsx("button",{type:"button",onClick:$=>{$.stopPropagation(),F()},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center hover:bg-red-600 transition-colors",title:"Remove image",children:"×"})]}):a.jsx("div",{className:"space-y-4",children:c?a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"w-12 h-12 mx-auto border-4 border-blue-200 border-t-blue-500 rounded-full animate-spin"}),a.jsxs("div",{className:"text-sm text-gray-600",children:["Uploading... ",Math.round(d),"%"]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${d}%`}})})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-16 h-16 mx-auto bg-gray-100 rounded-full flex items-center justify-center",children:a.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-lg font-medium text-gray-900",children:"Upload Image"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Drag and drop an image here, or click to select"}),a.jsx("p",{className:"text-xs text-gray-400",children:"Supports JPEG, PNG, WebP up to 5MB"})]})]})})}),g&&a.jsx("div",{className:"mt-3 text-center",children:a.jsx("p",{className:"text-sm text-gray-500",children:"Image uploaded successfully"})})]})},eJ=({event:t,onSuccess:e,onCancel:r})=>{const{user:n}=yn(),[s,i]=M.useState(!1),[o,l]=M.useState({title:"",description:"",date:"",time:"",location:"",imageUrl:"",price:void 0,capacity:void 0,category:"",tags:[]}),[c,u]=M.useState(""),d=[{value:"Live Music",label:"Live Music",icon:"🎵"},{value:"DJ Night",label:"DJ Night",icon:"🎧"},{value:"Special Event",label:"Special Event",icon:"⭐"},{value:"Holiday Celebration",label:"Holiday Celebration",icon:"🎉"},{value:"Themed Night",label:"Themed Night",icon:"🎭"},{value:"VIP Event",label:"VIP Event",icon:"👑"},{value:"Food & Drinks",label:"Food & Drinks",icon:"🍹"},{value:"Other",label:"Other",icon:"📅"}];M.useEffect(()=>{t&&l({title:t.title,description:t.description,date:Lr(t.date,"yyyy-MM-dd"),time:t.time,location:t.location,imageUrl:t.imageUrl||"",price:t.price,capacity:t.capacity,category:t.category||"",tags:t.tags||[]})},[t]);const h=T=>{const{name:v,value:b}=T.target;l(x=>({...x,[v]:v==="price"||v==="capacity"?b?Number(b):void 0:b}))},g=T=>{l(v=>({...v,imageUrl:T}))},m=()=>{var T;c.trim()&&!((T=o.tags)!=null&&T.includes(c.trim()))&&(l(v=>({...v,tags:[...v.tags||[],c.trim()]})),u(""))},w=T=>{l(v=>{var b;return{...v,tags:((b=v.tags)==null?void 0:b.filter(x=>x!==T))||[]}})},_=async T=>{if(T.preventDefault(),!n){Ee.error("You must be logged in to create events");return}if(!o.title.trim()){Ee.error("Event title is required");return}if(!o.description.trim()){Ee.error("Event description is required");return}if(!o.date){Ee.error("Event date is required");return}if(!o.time){Ee.error("Event time is required");return}if(!o.location.trim()){Ee.error("Event location is required");return}i(!0);try{t?(await ds.updateEvent(t.id,o),Ee.success("Event updated successfully")):(await ds.createEvent(o,n.id),Ee.success("Event created successfully")),e==null||e()}catch(v){Ee.error(t?"Failed to update event":"Failed to create event"),console.error("Error saving event:",v)}finally{i(!1)}};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-50 py-8",children:a.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 px-8 py-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-white",children:t?"Edit Event":"Create New Event"}),a.jsx("p",{className:"text-purple-100 mt-1",children:t?"Update your event details":"Share your amazing event with the world"})]}),a.jsx("div",{className:"hidden sm:block",children:a.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})})]})}),a.jsx("div",{className:"p-8",children:a.jsxs("form",{onSubmit:_,className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-lg font-semibold text-gray-900 mb-4",children:"Event Image"}),a.jsx(ZQ,{value:o.imageUrl,onChange:g,className:"max-w-md"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"title",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Event Title *"}),a.jsx("input",{type:"text",id:"title",name:"title",value:o.title,onChange:h,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",placeholder:"Enter a captivating event title",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"category",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Category"}),a.jsxs("select",{id:"category",name:"category",value:o.category,onChange:h,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",children:[a.jsx("option",{value:"",children:"Select a category"}),d.map(T=>a.jsxs("option",{value:T.value,children:[T.icon," ",T.label]},T.value))]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"location",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Location *"}),a.jsx("input",{type:"text",id:"location",name:"location",value:o.location,onChange:h,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",placeholder:"Where is your event taking place?",required:!0})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"date",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Date *"}),a.jsx("input",{type:"date",id:"date",name:"date",value:o.date,onChange:h,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"time",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Time *"}),a.jsx("input",{type:"time",id:"time",name:"time",value:o.time,onChange:h,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"price",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Price"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),a.jsx("input",{type:"number",id:"price",name:"price",value:o.price||"",onChange:h,min:"0",step:"0.01",className:"w-full pl-8 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",placeholder:"0.00"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"capacity",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Capacity"}),a.jsx("input",{type:"number",id:"capacity",name:"capacity",value:o.capacity||"",onChange:h,min:"1",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",placeholder:"100"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"description",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Description *"}),a.jsx("textarea",{id:"description",name:"description",value:o.description,onChange:h,rows:5,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200 resize-none",placeholder:"Tell people about your amazing event...",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Tags"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex gap-3",children:[a.jsx("input",{type:"text",value:c,onChange:T=>u(T.target.value),onKeyPress:T=>T.key==="Enter"&&(T.preventDefault(),m()),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",placeholder:"Add tags to help people find your event"}),a.jsx("button",{type:"button",onClick:m,className:"px-6 py-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors font-medium",children:"Add"})]}),o.tags&&o.tags.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:o.tags.map((T,v)=>a.jsxs("span",{className:"inline-flex items-center px-4 py-2 bg-purple-100 text-purple-800 text-sm rounded-full font-medium",children:["#",T,a.jsx("button",{type:"button",onClick:()=>w(T),className:"ml-2 text-purple-600 hover:text-purple-800 font-bold",children:"×"})]},v))})]})]}),a.jsxs("div",{className:"flex justify-end gap-4 pt-8 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:r,className:"px-8 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:s,className:"px-8 py-3 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-xl hover:from-purple-700 hover:to-blue-700 transition-all duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl",children:s?a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Saving..."]}):t?"Update Event":"Create Event"})]})]})})]})})})},jn=({size:t="md",text:e="Laden...",showLogo:r=!0,className:n=""})=>{const s={sm:"w-6 h-6",md:"w-12 h-12",lg:"w-16 h-16"},i={sm:"text-sm",md:"text-base",lg:"text-lg"};return a.jsxs("div",{className:`flex flex-col items-center justify-center ${n}`,children:[r?a.jsx(oe.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:`${s[t]} mb-4 flex items-center justify-center`,children:a.jsx(Et,{className:"w-full h-full text-royal-gold"})}):a.jsx(oe.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:`${s[t]} mb-4 border-4 border-royal-gold/20 border-t-royal-gold rounded-full`}),e&&a.jsx(oe.p,{initial:{opacity:.5},animate:{opacity:[.5,1,.5]},transition:{duration:1.5,repeat:1/0},className:`${i[t]} text-royal-charcoal font-medium`,children:e})]})},tJ=[{title:"Live Jazz Night",description:"Experience the smooth sounds of live jazz music while enjoying our premium shisha selection. Featuring local jazz artists and special cocktails.",date:"2024-02-15",time:"20:00",location:"Royal Shisha Bar - Main Lounge",imageUrl:"https://images.unsplash.com/photo-1511192336575-5a79af67a629?w=800&h=600&fit=crop",price:25,capacity:50,category:"Live Music",tags:["jazz","live music","cocktails"]},{title:"Middle Eastern Night",description:"Immerse yourself in authentic Middle Eastern culture with traditional music, belly dancing performances, and our signature shisha flavors.",date:"2024-02-20",time:"19:30",location:"Royal Shisha Bar - Terrace",imageUrl:"https://images.unsplash.com/photo-1518837695005-2083093ee35b?w=800&h=600&fit=crop",price:30,capacity:40,category:"Themed Night",tags:["middle eastern","belly dance","traditional"]},{title:"VIP Lounge Experience",description:"Exclusive VIP experience with premium shisha, gourmet appetizers, and private seating. Limited availability for our most discerning guests.",date:"2024-02-25",time:"21:00",location:"Royal Shisha Bar - VIP Lounge",imageUrl:"https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=800&h=600&fit=crop",price:75,capacity:20,category:"VIP Event",tags:["vip","exclusive","premium"]},{title:"DJ Electronic Night",description:"Get ready for an electrifying night with our resident DJ spinning the latest electronic and house music. Special light show included.",date:"2024-03-01",time:"22:00",location:"Royal Shisha Bar - Dance Floor",imageUrl:"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=800&h=600&fit=crop",price:20,capacity:80,category:"DJ Night",tags:["electronic","dj","dance"]},{title:"Shisha Masterclass",description:"Learn the art of shisha preparation from our expert staff. Includes hands-on experience, flavor combinations, and take-home guide.",date:"2024-03-05",time:"18:00",location:"Royal Shisha Bar - Workshop Area",imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=800&h=600&fit=crop",price:45,capacity:15,category:"Special Event",tags:["workshop","learning","shisha"]},{title:"Sunset Rooftop Gathering",description:"Enjoy breathtaking sunset views from our rooftop terrace with light refreshments and our signature shisha blends.",date:"2024-03-10",time:"18:30",location:"Royal Shisha Bar - Rooftop",imageUrl:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&h=600&fit=crop",price:15,capacity:35,category:"Special Event",tags:["sunset","rooftop","relaxing"]}],rJ=async t=>{try{console.log("Adding sample events...");for(const e of tJ)await ds.createEvent(e,t),console.log(`Created event: ${e.title}`);return console.log("All sample events created successfully!"),!0}catch(e){return console.error("Error creating sample events:",e),!1}},nJ=()=>{const{user:t}=yn(),[e,r]=M.useState([]),[n,s]=M.useState([]),[i,o]=M.useState(null),[l,c]=M.useState(!0),[u,d]=M.useState(!1),[h,g]=M.useState(null),[m,w]=M.useState({isActive:!0}),_=(t==null?void 0:t.role)==="admin",T=["Live Music","DJ Night","Special Event","Holiday Celebration","Themed Night","VIP Event","Food & Drinks","Other"],v=M.useCallback(()=>{let S=[...e];if(m.search){const R=m.search.toLowerCase();S=S.filter(C=>{var G;return C.title.toLowerCase().includes(R)||C.description.toLowerCase().includes(R)||C.location.toLowerCase().includes(R)||((G=C.category)==null?void 0:G.toLowerCase().includes(R))})}m.category&&(S=S.filter(R=>R.category===m.category)),m.isActive!==void 0&&(S=S.filter(R=>R.isActive===m.isActive)),m.dateFrom&&(S=S.filter(R=>R.date>=m.dateFrom)),m.dateTo&&(S=S.filter(R=>R.date<=m.dateTo)),s(S)},[e,m]);M.useEffect(()=>{b(),x()},[]),M.useEffect(()=>{v()},[v]);const b=async()=>{try{c(!0);const S=await ds.getEvents();r(S)}catch(S){Ee.error("Failed to load events"),console.error("Error loading events:",S)}finally{c(!1)}},x=async()=>{try{const S=await ds.getEventStats();o(S)}catch(S){console.error("Error loading stats:",S)}},P=()=>{g(null),d(!0)},F=S=>{g(S),d(!0)},$=()=>{d(!1),g(null),b(),x()},k=()=>{d(!1),g(null)},A=async()=>{if(!t){Ee.error("You must be logged in to add sample events");return}try{c(!0),await rJ(t.id)?(Ee.success("Sample events added successfully!"),b(),x()):Ee.error("Failed to add sample events")}catch(S){Ee.error("Error adding sample events"),console.error("Error adding sample events:",S)}finally{c(!1)}},I=(S,R)=>{w(C=>({...C,[S]:R}))},O=()=>{w({isActive:!0})};return l?a.jsx("div",{className:"flex justify-center items-center min-h-64",children:a.jsx(jn,{})}):u?a.jsx("div",{className:"container mx-auto px-4 py-8",children:a.jsx(eJ,{event:h||void 0,onSuccess:$,onCancel:k})}):a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-royal-cream mb-2",children:"Event Planner"}),a.jsx("p",{className:"text-royal-cream/70",children:"Discover and join amazing events at Royal Shisha Bar"})]}),a.jsxs("div",{className:"flex space-x-4",children:[a.jsx("button",{onClick:A,className:"bg-royal-charcoal text-royal-gold border border-royal-gold px-4 py-2 rounded-royal hover:bg-royal-gold hover:text-royal-charcoal transition-all duration-300",children:"Add Sample Events"}),a.jsx("button",{onClick:P,className:"bg-royal-gradient-gold text-royal-charcoal px-4 py-2 rounded-royal royal-glow hover:shadow-lg transition-all duration-300",children:"Create Event"})]})]}),i&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.totalEvents}),a.jsx("div",{className:"text-sm text-gray-600",children:"Total Events"})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.activeEvents}),a.jsx("div",{className:"text-sm text-gray-600",children:"Active Events"})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:i.upcomingEvents}),a.jsx("div",{className:"text-sm text-gray-600",children:"Upcoming Events"})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:i.totalAttendees}),a.jsx("div",{className:"text-sm text-gray-600",children:"Total Attendees"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-8",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Filters"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),a.jsx("input",{type:"text",value:m.search||"",onChange:S=>I("search",S.target.value),placeholder:"Search events...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),a.jsxs("select",{value:m.category||"",onChange:S=>I("category",S.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"All Categories"}),T.map(S=>a.jsx("option",{value:S,children:S},S))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),a.jsxs("select",{value:m.isActive===void 0?"":m.isActive.toString(),onChange:S=>I("isActive",S.target.value===""?void 0:S.target.value==="true"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"All Events"}),a.jsx("option",{value:"true",children:"Active Only"}),a.jsx("option",{value:"false",children:"Inactive Only"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date From"}),a.jsx("input",{type:"date",value:m.dateFrom?m.dateFrom.toISOString().split("T")[0]:"",onChange:S=>I("dateFrom",S.target.value?new Date(S.target.value):void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsx("button",{onClick:O,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Clear Filters"})})]}),a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Events (",n.length,")"]}),_&&a.jsx("div",{className:"text-sm text-gray-600",children:"Admin Mode - You can edit and manage events"})]}),n.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),a.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No events found"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:m.search||m.category||m.isActive!==void 0?"Try adjusting your filters":"Get started by creating a new event"}),_&&!m.search&&!m.category&&m.isActive===void 0&&a.jsxs("div",{className:"mt-6 space-x-4",children:[a.jsxs("button",{onClick:A,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700",children:[a.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Sample Events"]}),a.jsxs("button",{onClick:P,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[a.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Create Event"]})]})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(S=>a.jsxs("div",{className:"relative",children:[a.jsx(XQ,{event:S,onUpdate:b,showAdminControls:_}),_&&a.jsx("button",{onClick:()=>F(S),className:"absolute top-2 right-2 p-2 bg-white rounded-full shadow-lg hover:bg-gray-50 transition-colors",title:"Edit Event",children:a.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]},S.id))})]})]})},sJ=({event:t,onUpdate:e})=>a.jsxs("div",{className:"bg-white rounded-royal shadow-lg p-6 border border-royal-gold/20",children:[a.jsx("h3",{className:"text-lg font-bold text-royal-charcoal mb-2",children:t.title}),a.jsx("p",{className:"text-royal-charcoal/70 mb-4",children:t.description}),a.jsxs("div",{className:"text-sm text-royal-charcoal/60",children:[a.jsxs("p",{children:["Date: ",new Date(t.date).toLocaleDateString()]}),a.jsxs("p",{children:["Category: ",t.category]}),t.price&&a.jsxs("p",{children:["Price: €",t.price]})]})]}),iJ=()=>{const[t,e]=M.useState([]),[r,n]=M.useState([]),[s,i]=M.useState(!0),[o,l]=M.useState({isActive:!0}),c=["Live Music","DJ Night","Special Event","Holiday Celebration","Themed Night","VIP Event","Food & Drinks","Other"];M.useEffect(()=>{d()},[]);const u=M.useCallback(()=>{let m=[...t];if(o.search){const w=o.search.toLowerCase();m=m.filter(_=>{var T;return _.title.toLowerCase().includes(w)||_.description.toLowerCase().includes(w)||_.location.toLowerCase().includes(w)||((T=_.category)==null?void 0:T.toLowerCase().includes(w))})}o.category&&(m=m.filter(w=>w.category===o.category)),o.dateFrom&&(m=m.filter(w=>w.date>=o.dateFrom)),o.dateTo&&(m=m.filter(w=>w.date<=o.dateTo)),n(m)},[t,o]);M.useEffect(()=>{u()},[u]);const d=async()=>{try{i(!0);const m=await ds.getEvents({isActive:!0});e(m)}catch(m){Ee.error("Failed to load events"),console.error("Error loading events:",m)}finally{i(!1)}},h=(m,w)=>{l(_=>({..._,[m]:w}))},g=()=>{l({isActive:!0})};return s?a.jsx("div",{className:"flex justify-center items-center min-h-64",children:a.jsx(jn,{})}):a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsxs("div",{className:"mb-8 text-center",children:[a.jsx("h1",{className:"text-3xl font-bold text-royal-cream mb-2",children:"Upcoming Events"}),a.jsx("p",{className:"text-royal-cream/70",children:"Discover amazing events at Royal Shisha Bar"})]}),a.jsxs("div",{className:"bg-royal-charcoal-dark rounded-royal shadow-lg p-6 mb-8 border border-royal-gold/30 royal-glow",children:[a.jsx("h2",{className:"text-xl font-semibold text-royal-cream mb-4",children:"Find Events"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-2",children:"Search"}),a.jsx("input",{type:"text",value:o.search||"",onChange:m=>h("search",m.target.value),placeholder:"Search events...",className:"w-full px-3 py-2 border border-royal-gold/30 rounded-royal focus:ring-2 focus:ring-royal-gold/50 focus:border-transparent bg-royal-charcoal text-royal-cream"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-2",children:"Category"}),a.jsxs("select",{value:o.category||"",onChange:m=>h("category",m.target.value||void 0),className:"w-full px-3 py-2 border border-royal-gold/30 rounded-royal focus:ring-2 focus:ring-royal-gold/50 focus:border-transparent bg-royal-charcoal text-royal-cream",children:[a.jsx("option",{value:"",children:"All Categories"}),c.map(m=>a.jsx("option",{value:m,children:m},m))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-2",children:"From Date"}),a.jsx("input",{type:"date",value:o.dateFrom?o.dateFrom.toISOString().split("T")[0]:"",onChange:m=>h("dateFrom",m.target.value?new Date(m.target.value):void 0),className:"w-full px-3 py-2 border border-royal-gold/30 rounded-royal focus:ring-2 focus:ring-royal-gold/50 focus:border-transparent bg-royal-charcoal text-royal-cream"})]})]}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsx("button",{onClick:g,className:"px-4 py-2 text-royal-gold hover:text-royal-gold/80 transition-colors",children:"Clear Filters"})})]}),a.jsxs("div",{className:"mb-8",children:[a.jsx("div",{className:"flex justify-between items-center mb-6",children:a.jsxs("h2",{className:"text-2xl font-bold text-royal-cream",children:["Events (",r.length,")"]})}),r.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),a.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No events found"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:o.search||o.category||o.dateFrom?"Try adjusting your filters":"Check back soon for upcoming events"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(m=>a.jsx(sJ,{event:m,onUpdate:d},m.id))})]})]})},aJ=()=>{const{user:t}=yn(),e=(t==null?void 0:t.role)==="admin";return a.jsx("div",{className:"min-h-screen bg-royal-gradient-cream pt-20",children:e?a.jsx(nJ,{}):a.jsx(iJ,{})})},Xl="menuItems";class Wo{static onMenuItemsChange(e){const r=qe(Be(Ce(),Xl),Vt("name"));return wi(r,n=>{const s=[];n.forEach(o=>{var c,u;const l=o.data();s.push({id:o.id,...l,createdAt:((c=l.createdAt)==null?void 0:c.toDate())||new Date,updatedAt:((u=l.updatedAt)==null?void 0:u.toDate())||new Date})});const i=s.filter(o=>o.isAvailable).sort((o,l)=>o.category!==l.category?o.category.localeCompare(l.category):o.name.localeCompare(l.name));e(i)})}static async getAllMenuItems(){const e=qe(Be(Ce(),Xl),Vt("name")),r=await st(e),n=[];return r.forEach(s=>{var o,l;const i=s.data();n.push({id:s.id,...i,createdAt:((o=i.createdAt)==null?void 0:o.toDate())||new Date,updatedAt:((l=i.updatedAt)==null?void 0:l.toDate())||new Date})}),n.sort((s,i)=>s.category!==i.category?s.category.localeCompare(i.category):s.name.localeCompare(i.name))}static async getAvailableMenuItems(){const e=qe(Be(Ce(),Xl),Vt("name")),r=await st(e),n=[];return r.forEach(s=>{var o,l;const i=s.data();n.push({id:s.id,...i,createdAt:((o=i.createdAt)==null?void 0:o.toDate())||new Date,updatedAt:((l=i.updatedAt)==null?void 0:l.toDate())||new Date})}),n.filter(s=>s.isAvailable).sort((s,i)=>s.category!==i.category?s.category.localeCompare(i.category):s.name.localeCompare(i.name))}static async getMenuItemsByCategory(e){const r=qe(Be(Ce(),Xl),Vt("name")),n=await st(r),s=[];return n.forEach(i=>{var l,c;const o=i.data();s.push({id:i.id,...o,createdAt:((l=o.createdAt)==null?void 0:l.toDate())||new Date,updatedAt:((c=o.updatedAt)==null?void 0:c.toDate())||new Date})}),s.filter(i=>i.category===e&&i.isAvailable).sort((i,o)=>i.name.localeCompare(o.name))}static cleanDataForFirebase(e){const r={};for(const[n,s]of Object.entries(e))s!==void 0&&(r[n]=s);return r}static async createMenuItem(e){const r=this.cleanDataForFirebase({...e,createdAt:ft(),updatedAt:ft()});return(await xo(Be(Ce(),Xl),r)).id}static async updateMenuItem(e,r){const n=ot(Ce(),Xl,e),s=this.cleanDataForFirebase({...r,updatedAt:ft()});await Qt(n,s)}static async deleteMenuItem(e){const r=ot(Ce(),Xl,e);await ba(r)}static async getMenuItemById(e){var s,i;const r=await st(qe(Be(Ce(),Xl),Je("__name__","==",e)));if(r.empty)return null;const n=r.docs[0].data();return{id:r.docs[0].id,...n,createdAt:((s=n.createdAt)==null?void 0:s.toDate())||new Date,updatedAt:((i=n.updatedAt)==null?void 0:i.toDate())||new Date}}static async getCategories(){const e=await this.getAllMenuItems();return Array.from(new Set(e.map(n=>n.category))).sort()}static async toggleItemAvailability(e,r){await this.updateMenuItem(e,{isAvailable:r})}static async toggleMenuItemAvailability(e,r){await this.updateMenuItem(e,{isAvailable:r})}static async toggleMenuItemPopularity(e,r){await this.updateMenuItem(e,{isPopular:r})}static async createSampleMenuItems(){const e=[{name:"Premium Shisha Mix",description:"Exklusive Mischung aus hochwertigen Tabaksorten",price:15,category:"shisha",isAvailable:!0,isPopular:!0,imageUrl:"",allergens:[],ingredients:["Premium Tabak","Honig","Glycerin"],preparationTime:"5-10 Minuten"},{name:"Royal Mojito",description:"Erfrischender Mojito mit Premium Rum",price:12.5,category:"drinks",isAvailable:!0,isPopular:!0,imageUrl:"",allergens:[],ingredients:["Premium Rum","Minze","Limette","Zucker"],preparationTime:"3-5 Minuten"},{name:"Oriental Platter",description:"Auswahl orientalischer Spezialitäten",price:18,category:"food",isAvailable:!0,isPopular:!1,imageUrl:"",allergens:["Nüsse","Gluten"],ingredients:["Hummus","Falafel","Tabouleh","Fladenbrot"],preparationTime:"10-15 Minuten"}];for(const r of e)await this.createMenuItem(r)}static async searchMenuItems(e){const r=await this.getAllMenuItems(),n=e.toLowerCase();return r.filter(s=>s.name.toLowerCase().includes(n)||s.description.toLowerCase().includes(n)||s.category.toLowerCase().includes(n))}}const oJ=Object.freeze(Object.defineProperty({__proto__:null,MenuService:Wo},Symbol.toStringTag,{value:"Module"})),Bo="specialOffers";class Ju{static onSpecialOffersChange(e){const r=qe(Be(Ce(),Bo),Vt("createdAt","desc"));return wi(r,n=>{const s=[];n.forEach(i=>{var l,c,u,d;const o=i.data();s.push({id:i.id,...o,startDate:((l=o.startDate)==null?void 0:l.toDate())||new Date,endDate:((c=o.endDate)==null?void 0:c.toDate())||new Date,createdAt:((u=o.createdAt)==null?void 0:u.toDate())||new Date,updatedAt:((d=o.updatedAt)==null?void 0:d.toDate())||new Date})}),e(s)})}static onActiveSpecialOffersChange(e){const r=new Date,n=qe(Be(Ce(),Bo),Vt("createdAt","desc"));return wi(n,s=>{const i=[];s.forEach(l=>{var u,d,h,g;const c=l.data();i.push({id:l.id,...c,startDate:((u=c.startDate)==null?void 0:u.toDate())||new Date,endDate:((d=c.endDate)==null?void 0:d.toDate())||new Date,createdAt:((h=c.createdAt)==null?void 0:h.toDate())||new Date,updatedAt:((g=c.updatedAt)==null?void 0:g.toDate())||new Date})});const o=i.filter(l=>l.isActive&&l.endDate>=r&&l.startDate<=r).sort((l,c)=>l.endDate.getTime()-c.endDate.getTime());e(o)})}static async getAllSpecialOffers(){const e=qe(Be(Ce(),Bo),Vt("createdAt","desc")),r=await st(e),n=[];return r.forEach(s=>{var o,l,c,u;const i=s.data();n.push({id:s.id,...i,startDate:((o=i.startDate)==null?void 0:o.toDate())||new Date,endDate:((l=i.endDate)==null?void 0:l.toDate())||new Date,createdAt:((c=i.createdAt)==null?void 0:c.toDate())||new Date,updatedAt:((u=i.updatedAt)==null?void 0:u.toDate())||new Date})}),n}static async getActiveSpecialOffers(){const e=new Date,r=qe(Be(Ce(),Bo),Vt("createdAt","desc")),n=await st(r),s=[];return n.forEach(i=>{var l,c,u,d;const o=i.data();s.push({id:i.id,...o,startDate:((l=o.startDate)==null?void 0:l.toDate())||new Date,endDate:((c=o.endDate)==null?void 0:c.toDate())||new Date,createdAt:((u=o.createdAt)==null?void 0:u.toDate())||new Date,updatedAt:((d=o.updatedAt)==null?void 0:d.toDate())||new Date})}),s.filter(i=>i.isActive&&i.endDate>=e&&i.startDate<=e).sort((i,o)=>i.endDate.getTime()-o.endDate.getTime())}static async createSpecialOffer(e){return(await xo(Be(Ce(),Bo),{...e,startDate:yt.fromDate(e.startDate),endDate:yt.fromDate(e.endDate),createdAt:ft(),updatedAt:ft()})).id}static async updateSpecialOffer(e,r){const n=ot(Ce(),Bo,e),s={...r,updatedAt:ft()};r.startDate&&(s.startDate=yt.fromDate(r.startDate)),r.endDate&&(s.endDate=yt.fromDate(r.endDate)),await Qt(n,s)}static async deleteSpecialOffer(e){const r=ot(Ce(),Bo,e);await ba(r)}static async getSpecialOfferById(e){var s,i,o,l;const r=await st(qe(Be(Ce(),Bo),Je("__name__","==",e)));if(r.empty)return null;const n=r.docs[0].data();return{id:r.docs[0].id,...n,startDate:((s=n.startDate)==null?void 0:s.toDate())||new Date,endDate:((i=n.endDate)==null?void 0:i.toDate())||new Date,createdAt:((o=n.createdAt)==null?void 0:o.toDate())||new Date,updatedAt:((l=n.updatedAt)==null?void 0:l.toDate())||new Date}}static async incrementUsage(e){const r=ot(Ce(),Bo,e);await Qt(r,{currentUses:zU(1),updatedAt:ft()})}static isOfferValid(e){const r=new Date,n=e.startDate<=r&&e.endDate>=r,s=!e.maxUses||e.currentUses<e.maxUses;return e.isActive&&n&&s}}const lJ=({item:t,onAdd:e})=>{const{addItem:r}=Z5(),[n,s]=M.useState(1),[i,o]=M.useState(""),[l,c]=M.useState(!1),u=t.category.toLowerCase()==="shisha"||t.category.toLowerCase()==="tobacco",d=g=>{g>=1&&g<=10&&s(g)},h=async()=>{if(!t.isAvailable){_t.error("Dieses Artikel ist derzeit nicht verfügbar");return}c(!0);try{const g={id:`${t.id}-${Date.now()}`,menuItemId:t.id,name:t.name,price:t.price,quantity:n,category:t.category,imageUrl:t.imageUrl,specialInstructions:i.trim()||void 0};r(g),_t.success(a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(of,{className:"w-4 h-4"}),a.jsxs("span",{children:[t.name," wurde zum Warenkorb hinzugefügt!"]})]})),s(1),o(""),e&&e()}catch(g){console.error("Error adding to cart:",g),_t.error("Fehler beim Hinzufügen zum Warenkorb")}finally{c(!1)}};return t.isAvailable?a.jsxs("div",{className:"space-y-4",children:[u&&a.jsx("div",{className:"flex items-center justify-center",children:a.jsxs("div",{className:"flex items-center space-x-1 bg-royal-purple text-white px-3 py-1 rounded-full text-sm",children:[a.jsx(Et,{className:"w-4 h-4"}),a.jsx("span",{children:"Sammelt Loyalty Stempel"})]})}),a.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[a.jsx("button",{onClick:()=>d(n-1),disabled:n<=1,className:"w-8 h-8 rounded-full bg-royal-gold/20 text-royal-gold hover:bg-royal-gold/30 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center transition-colors",children:a.jsx(lP,{className:"w-4 h-4"})}),a.jsx("span",{className:"text-lg font-semibold text-royal-charcoal w-12 text-center",children:n}),a.jsx("button",{onClick:()=>d(n+1),disabled:n>=10,className:"w-8 h-8 rounded-full bg-royal-gold/20 text-royal-gold hover:bg-royal-gold/30 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center transition-colors",children:a.jsx(Ai,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-medium text-royal-charcoal",children:"Spezielle Anweisungen (optional)"}),a.jsx("textarea",{value:i,onChange:g=>o(g.target.value),placeholder:"z.B. extra scharf, ohne Zwiebeln...",className:"w-full p-3 border border-royal-gold/30 rounded-royal bg-white text-royal-charcoal focus:outline-none focus:ring-2 focus:ring-royal-gold/50 resize-none",rows:2,maxLength:200})]}),a.jsx(oe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:h,disabled:!t.isAvailable||l,className:"w-full bg-royal-gradient-gold text-royal-charcoal font-royal font-bold py-3 px-6 rounded-royal royal-glow hover:shadow-lg transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:l?a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("div",{className:"w-4 h-4 border-2 border-royal-charcoal border-t-transparent rounded-full animate-spin"}),a.jsx("span",{children:"Hinzufügen..."})]}):a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx(of,{className:"w-5 h-5"}),a.jsxs("span",{children:["Zum Warenkorb hinzufügen (",(t.price*n).toFixed(2),"€)"]})]})})]}):a.jsx("button",{disabled:!0,className:"w-full px-4 py-3 bg-gray-300 text-gray-500 font-semibold rounded-lg cursor-not-allowed opacity-50",children:"Nicht verfügbar"})},cJ=()=>{const[t,e]=M.useState([]),[r,n]=M.useState([]),[s,i]=M.useState(!0),[o,l]=M.useState("all"),c=["all",...Array.from(new Set(t.map(d=>d.category)))],u=o==="all"?t:t.filter(d=>d.category===o);return M.useEffect(()=>{const d=Wo.onMenuItemsChange(_=>{e(_)}),h=Ju.onActiveSpecialOffersChange(_=>{n(_),i(!1)}),g=_=>{console.error("Error loading special offers:",_),n([]),i(!1)},w=setTimeout(async()=>{try{const _=await Ju.getActiveSpecialOffers();n(_)}catch(_){g(_)}},5e3);return()=>{d(),h(),clearTimeout(w)}},[]),s?a.jsx("div",{className:"min-h-screen bg-royal-gradient-cream flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-royal-gold mx-auto mb-4"}),a.jsx("p",{className:"text-royal-charcoal",children:"Lade Menü..."})]})}):a.jsxs("div",{className:"min-h-screen bg-royal-gradient-cream",children:[a.jsx("div",{className:"bg-royal-gradient-gold py-8 md:py-12",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"text-center",children:a.jsxs(oe.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},children:[a.jsx(Et,{className:"w-12 h-12 mx-auto text-royal-charcoal mb-4"}),a.jsx("h1",{className:"text-4xl md:text-6xl font-royal font-bold text-royal-charcoal mb-4",children:"Unser Menü"}),a.jsx("p",{className:"text-lg md:text-xl text-royal-charcoal/80 max-w-2xl mx-auto",children:"Entdecken Sie unsere königliche Auswahl an Premium-Shisha-Aromen, exklusiven Getränken und feinen Speisen"})]})})})}),r.length>0&&a.jsx("section",{className:"py-8 bg-royal-gradient",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"text-center mb-8",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-royal font-bold text-royal-cream mb-4",children:"🎉 Spezielle Angebote"}),a.jsx("p",{className:"text-royal-cream/90 text-lg",children:"Begrenzte Zeit - Exklusive Deals für unsere königlichen Gäste"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map((d,h)=>a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3+h*.1},className:"bg-royal-charcoal-dark/80 backdrop-blur-sm rounded-royal p-6 border border-royal-gold/30 relative overflow-hidden royal-glow",children:[a.jsxs("div",{className:"absolute top-4 right-4 bg-royal-gold text-royal-charcoal px-3 py-1 rounded-full text-sm font-bold",children:["-",d.discountPercentage,"%"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-xl font-royal font-bold text-royal-cream",children:d.title}),a.jsx("p",{className:"text-royal-cream/80",children:d.description}),a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"text-royal-cream",children:[a.jsxs("span",{className:"line-through text-royal-cream/60",children:[d.originalPrice.toFixed(2),"€"]}),a.jsxs("span",{className:"text-2xl font-bold ml-2 text-royal-gold",children:[d.discountedPrice.toFixed(2),"€"]})]})}),d.validUntil&&a.jsxs("div",{className:"flex items-center text-royal-cream/80 text-sm",children:[a.jsx(Rr,{className:"w-4 h-4 mr-2"}),a.jsxs("span",{children:["Gültig bis"," ",new Date(d.validUntil).toLocaleDateString("de-DE")]})]})]})]},d.id))})]})}),a.jsx("section",{className:"py-8 bg-royal-charcoal-dark",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"flex flex-wrap justify-center gap-4",children:c.map(d=>a.jsx(oe.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>l(d),className:`px-6 py-3 rounded-royal font-royal font-semibold transition-all duration-300 ${o===d?"bg-royal-gradient-gold text-royal-charcoal royal-glow":"bg-royal-charcoal text-royal-cream hover:bg-royal-charcoal-light border border-royal-gold/30"}`,children:d==="all"?"Alle":d},d))})})}),a.jsx("section",{className:"py-12 bg-royal-gradient-cream",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:u.map((d,h)=>a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:h*.1},className:"bg-white rounded-royal shadow-lg royal-glow border border-royal-gold/20 overflow-hidden hover:shadow-xl transition-all duration-300",children:[d.imageUrl&&a.jsxs("div",{className:"relative h-48 overflow-hidden",children:[a.jsx("img",{src:d.imageUrl,alt:d.name,className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute top-4 left-4",children:a.jsx("span",{className:"bg-royal-gold/90 text-royal-charcoal px-3 py-1 rounded-full text-sm font-bold",children:d.category})})]}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsx("h3",{className:"text-xl font-royal font-bold text-royal-charcoal",children:d.name}),a.jsxs("span",{className:"text-2xl font-bold text-royal-gold",children:[(typeof d.price=="number"?d.price:parseFloat(d.price)||0).toFixed(2),"€"]})]}),a.jsx("p",{className:"text-royal-charcoal/70 mb-4 leading-relaxed",children:d.description}),a.jsxs("div",{className:"space-y-2 mb-6",children:[d.ingredients&&a.jsxs("div",{className:"flex items-center text-sm text-royal-charcoal/60",children:[a.jsx(zn,{className:"w-4 h-4 mr-2"}),a.jsx("span",{children:d.ingredients})]}),d.preparationTime&&a.jsxs("div",{className:"flex items-center text-sm text-royal-charcoal/60",children:[a.jsx(Rr,{className:"w-4 h-4 mr-2"}),a.jsxs("span",{children:["Zubereitungszeit: ",d.preparationTime]})]}),d.allergens&&a.jsxs("div",{className:"flex items-center text-sm text-royal-charcoal/60",children:[a.jsx(Si,{className:"w-4 h-4 mr-2"}),a.jsxs("span",{children:["Allergene: ",d.allergens]})]})]}),a.jsx(lJ,{item:d})]})]},d.id))}),u.length===0&&a.jsxs(oe.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[a.jsx(Et,{className:"w-16 h-16 mx-auto text-royal-charcoal/30 mb-4"}),a.jsx("h3",{className:"text-xl font-royal font-bold text-royal-charcoal mb-2",children:"Keine Artikel in dieser Kategorie"}),a.jsx("p",{className:"text-royal-charcoal/70",children:"Wählen Sie eine andere Kategorie oder schauen Sie später wieder vorbei."})]})]})}),a.jsx("section",{className:"py-16 bg-royal-charcoal",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8},viewport:{once:!0},className:"text-center mb-12",children:[a.jsx("h2",{className:"text-3xl md:text-5xl font-royal font-bold text-white mb-4 md:mb-6",children:"Besuchen Sie Uns"}),a.jsx("p",{className:"text-lg md:text-xl text-royal-cream-light max-w-3xl mx-auto",children:"Finden Sie uns in der Innenstadt von Waldkraiburg für ein königliches Shisha-Erlebnis"})]}),a.jsx(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},children:a.jsx(AN,{className:"max-w-4xl mx-auto"})})]})})]})},uJ=()=>{const t=[{icon:Hn,title:"Telefon",content:"+49 15781413767",action:"tel:+4915781413767",actionText:"Anrufen"},{icon:ji,title:"E-Mail",content:"Royal.Waldkraiburg@gmail.com",action:"mailto:Royal.Waldkraiburg@gmail.com",actionText:"E-Mail senden"},{icon:Rr,title:"Öffnungszeiten",content:`Mo-Fr: 17:00 - 01:00
Sa-So: 17:00 - 03:00`,action:null,actionText:null},{icon:Si,title:"Adresse",content:"Stadtpl. 2, 84478 Waldkraiburg, Deutschland",action:"https://maps.google.com/?q=Stadtpl.+2,+84478+Waldkraiburg,+Germany",actionText:"In Google Maps öffnen"}],e=r=>{r&&window.open(r,"_blank")};return a.jsxs("div",{className:"min-h-screen bg-royal-gradient-cream",children:[a.jsxs("section",{className:"relative py-20 md:py-32 bg-gradient-to-br from-royal-purple-dark to-royal-burgundy overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 z-0",children:[a.jsx(oe.div,{animate:{scale:[1,1.1,1],opacity:[.1,.2,.1]},transition:{duration:8,repeat:1/0,ease:"easeInOut"},className:"absolute top-10 left-10 w-20 h-20 bg-royal-gold/10 rounded-full blur-xl"}),a.jsx(oe.div,{animate:{scale:[1.1,1,1.1],opacity:[.1,.2,.1]},transition:{duration:10,repeat:1/0,ease:"easeInOut",delay:2},className:"absolute bottom-10 right-10 w-24 h-24 bg-royal-purple/10 rounded-full blur-xl"})]}),a.jsx("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:a.jsxs(oe.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},children:[a.jsx("div",{className:"mb-6",children:a.jsx(Et,{className:"w-16 h-16 mx-auto text-royal-gold"})}),a.jsx("h1",{className:"text-4xl md:text-6xl font-royal font-bold text-white mb-6 royal-text-glow",children:"Kontakt"}),a.jsx("p",{className:"text-lg md:text-xl text-royal-cream-light max-w-3xl mx-auto leading-relaxed",children:"Bereit für ein königliches Erlebnis? Kontaktieren Sie uns für Reservierungen, Fragen oder Feedback"})]})})]}),a.jsx("section",{className:"py-16 md:py-24 bg-white",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8},viewport:{once:!0},className:"text-center mb-12 md:mb-16",children:[a.jsx("h2",{className:"text-3xl md:text-5xl font-royal font-bold text-royal-charcoal mb-4 md:mb-6",children:"Kontaktinformationen"}),a.jsx("p",{className:"text-lg md:text-xl text-royal-charcoal/80 max-w-3xl mx-auto",children:"Erreichen Sie uns über verschiedene Kanäle für ein persönliches Gespräch"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:t.map((r,n)=>a.jsxs(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:n*.1},viewport:{once:!0},className:"text-center p-6 bg-royal-gradient-gold rounded-royal royal-glow border border-royal-gold/30 hover:shadow-xl transition-all duration-300",children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-royal-gold/20 rounded-full flex items-center justify-center",children:a.jsx(r.icon,{className:"w-8 h-8 text-royal-gold"})}),a.jsx("h3",{className:"text-xl font-royal font-bold text-royal-charcoal mb-3",children:r.title}),a.jsx("p",{className:"text-royal-charcoal/80 mb-4 whitespace-pre-line",children:r.content}),r.action&&a.jsx("button",{onClick:()=>e(r.action),className:"px-4 py-2 bg-royal-charcoal text-white rounded-lg hover:bg-royal-charcoal-dark transition-colors text-sm font-semibold",children:r.actionText})]},n))})]})}),a.jsx("section",{className:"py-16 md:py-24 bg-royal-charcoal",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8},viewport:{once:!0},className:"text-center mb-12 md:mb-16",children:[a.jsx("h2",{className:"text-3xl md:text-5xl font-royal font-bold text-white mb-4 md:mb-6",children:"Finden Sie Uns"}),a.jsx("p",{className:"text-lg md:text-xl text-royal-cream-light max-w-3xl mx-auto",children:"Besuchen Sie uns in der Innenstadt von Waldkraiburg für ein königliches Shisha-Erlebnis"})]}),a.jsx(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},children:a.jsx(AN,{className:"max-w-5xl mx-auto"})})]})}),a.jsx("section",{className:"py-16 md:py-24 bg-royal-gradient-cream",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8},viewport:{once:!0},className:"text-center mb-12",children:[a.jsx("h2",{className:"text-3xl md:text-5xl font-royal font-bold text-royal-charcoal mb-4 md:mb-6",children:"Senden Sie Uns Eine Nachricht"}),a.jsx("p",{className:"text-lg md:text-xl text-royal-charcoal/80 max-w-3xl mx-auto",children:"Haben Sie Fragen oder möchten Sie eine Reservierung vornehmen? Füllen Sie das Formular aus und wir melden uns bei Ihnen."})]}),a.jsx(oe.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},className:"bg-white rounded-royal shadow-lg p-8 md:p-12",children:a.jsxs("form",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"firstName",className:"block text-sm font-semibold text-royal-charcoal mb-2",children:"Vorname *"}),a.jsx("input",{type:"text",id:"firstName",name:"firstName",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-royal-gold focus:border-transparent transition-all duration-200",placeholder:"Ihr Vorname"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"lastName",className:"block text-sm font-semibold text-royal-charcoal mb-2",children:"Nachname *"}),a.jsx("input",{type:"text",id:"lastName",name:"lastName",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-royal-gold focus:border-transparent transition-all duration-200",placeholder:"Ihr Nachname"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold text-royal-charcoal mb-2",children:"E-Mail *"}),a.jsx("input",{type:"email",id:"email",name:"email",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-royal-gold focus:border-transparent transition-all duration-200",placeholder:"ihre.email@beispiel.de"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"phone",className:"block text-sm font-semibold text-royal-charcoal mb-2",children:"Telefon"}),a.jsx("input",{type:"tel",id:"phone",name:"phone",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-royal-gold focus:border-transparent transition-all duration-200",placeholder:"+49 15781413767"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"subject",className:"block text-sm font-semibold text-royal-charcoal mb-2",children:"Betreff *"}),a.jsxs("select",{id:"subject",name:"subject",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-royal-gold focus:border-transparent transition-all duration-200",children:[a.jsx("option",{value:"",children:"Bitte wählen Sie einen Betreff"}),a.jsx("option",{value:"reservation",children:"Reservierung"}),a.jsx("option",{value:"question",children:"Allgemeine Frage"}),a.jsx("option",{value:"feedback",children:"Feedback"}),a.jsx("option",{value:"complaint",children:"Beschwerde"}),a.jsx("option",{value:"other",children:"Sonstiges"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"message",className:"block text-sm font-semibold text-royal-charcoal mb-2",children:"Nachricht *"}),a.jsx("textarea",{id:"message",name:"message",rows:6,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-royal-gold focus:border-transparent transition-all duration-200 resize-none",placeholder:"Ihre Nachricht an uns..."})]}),a.jsx("div",{className:"text-center",children:a.jsx("button",{type:"submit",className:"px-8 py-4 bg-royal-gradient-gold text-royal-charcoal font-royal font-bold rounded-royal hover:shadow-xl transition-all duration-300 royal-glow hover:scale-105 transform",children:"Nachricht Senden"})})]})})]})})]})},dJ="modulepreload",hJ=function(t){return"/"+t},I3={},vp=function(e,r,n){if(!r||r.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(r.map(i=>{if(i=hJ(i),i in I3)return;I3[i]=!0;const o=i.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!n)for(let d=s.length-1;d>=0;d--){const h=s[d];if(h.href===i&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":dJ,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((d,h)=>{u.addEventListener("load",d),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},Ga={STAMPS_FOR_FREE_SHISHA:10,MAX_STAMPS_PER_VISIT:5,STAMP_EXPIRY_DAYS:365};class ks{static countShishaItems(e){return e.filter(r=>r.category.toLowerCase()==="shisha"||r.category.toLowerCase()==="tobacco").reduce((r,n)=>r+n.quantity,0)}static async getOrCreateLoyaltyCard(e,r){var n,s,i;try{const o=Ce(),l=qe(Be(o,this.loyaltyCardsCollection),Je("customerPhone","==",e)),c=await st(l);if(!c.empty){const h=c.docs[0],g=h.data();return{id:h.id,...g,createdAt:((n=g.createdAt)==null?void 0:n.toDate())||new Date,updatedAt:((s=g.updatedAt)==null?void 0:s.toDate())||new Date,lastStampDate:(i=g.lastStampDate)==null?void 0:i.toDate()}}const u={userId:"",customerName:r,customerPhone:e,stamps:0,totalShishaOrders:0,freeShishaEarned:0,freeShishaUsed:0,createdAt:new Date,updatedAt:new Date,isActive:!0};return{id:(await xo(Be(o,this.loyaltyCardsCollection),{...u,createdAt:ft(),updatedAt:ft()})).id,...u}}catch(o){throw console.error("Error getting or creating loyalty card:",o),o}}static async addStamps(e,r,n){try{const s=Ce();return await X4(s,async i=>{const o=ot(s,this.loyaltyCardsCollection,e),l=await i.get(o);if(!l.exists())throw new Error("Loyalty card not found");const c=l.data(),u=Math.min(n,Ga.MAX_STAMPS_PER_VISIT),d=c.stamps+u,h=Math.floor(d/Ga.STAMPS_FOR_FREE_SHISHA),m={stamps:d%Ga.STAMPS_FOR_FREE_SHISHA,totalShishaOrders:c.totalShishaOrders+n,freeShishaEarned:c.freeShishaEarned+h,updatedAt:new Date,lastStampDate:new Date};if(i.update(o,{...m,updatedAt:ft(),lastStampDate:ft()}),u>0){const w={loyaltyCardId:e,orderId:r,type:"stamp_earned",shishaCount:n,stampsChanged:u,description:`Earned ${u} stamp${u>1?"s":""} for ${n} shisha${n>1?"s":""}`,createdAt:new Date},_=ot(Be(s,this.loyaltyTransactionsCollection));i.set(_,{...w,createdAt:ft()})}if(h>0){const w={loyaltyCardId:e,orderId:r,type:"free_shisha_earned",shishaCount:h,stampsChanged:-h*Ga.STAMPS_FOR_FREE_SHISHA,description:`Earned ${h} free shisha${h>1?"s":""}!`,createdAt:new Date},_=ot(Be(s,this.loyaltyTransactionsCollection));i.set(_,{...w,createdAt:ft()})}return{...c,...m,id:e}})}catch(s){throw console.error("Error adding stamps:",s),s}}static async redeemFreeShisha(e,r,n=1){try{const s=Ce();return await X4(s,async i=>{const o=ot(s,this.loyaltyCardsCollection,e),l=await i.get(o);if(!l.exists())throw new Error("Loyalty card not found");const c=l.data();if(c.freeShishaEarned<n)throw new Error("Not enough free shishas available");const u={freeShishaEarned:c.freeShishaEarned-n,freeShishaUsed:c.freeShishaUsed+n,updatedAt:new Date};i.update(o,{...u,updatedAt:ft()});const d={loyaltyCardId:e,orderId:r,type:"free_shisha_redeemed",shishaCount:n,stampsChanged:0,description:`Redeemed ${n} free shisha${n>1?"s":""}`,createdAt:new Date},h=ot(Be(s,this.loyaltyTransactionsCollection));return i.set(h,{...d,createdAt:ft()}),{...c,...u,id:e}})}catch(s){throw console.error("Error redeeming free shisha:",s),s}}static async getLoyaltyCard(e){var r,n,s;try{const i=Ce(),o=ot(i,this.loyaltyCardsCollection,e),l=await os(o);if(l.exists()){const c=l.data();return{id:l.id,...c,createdAt:((r=c.createdAt)==null?void 0:r.toDate())||new Date,updatedAt:((n=c.updatedAt)==null?void 0:n.toDate())||new Date,lastStampDate:(s=c.lastStampDate)==null?void 0:s.toDate()}}return null}catch(i){throw console.error("Error getting loyalty card:",i),i}}static async getLoyaltyTransactions(e){try{const r=Ce(),n=qe(Be(r,this.loyaltyTransactionsCollection),Je("loyaltyCardId","==",e),Vt("createdAt","desc"));return(await st(n)).docs.map(i=>{var l;const o=i.data();return{id:i.id,...o,createdAt:((l=o.createdAt)==null?void 0:l.toDate())||new Date}})}catch(r){throw console.error("Error getting loyalty transactions:",r),r}}static async searchLoyaltyCardByPhone(e){var r,n,s;try{const i=Ce(),o=qe(Be(i,this.loyaltyCardsCollection),Je("customerPhone","==",e)),l=await st(o);if(!l.empty){const c=l.docs[0],u=c.data();return{id:c.id,...u,createdAt:((r=u.createdAt)==null?void 0:r.toDate())||new Date,updatedAt:((n=u.updatedAt)==null?void 0:n.toDate())||new Date,lastStampDate:(s=u.lastStampDate)==null?void 0:s.toDate()}}return null}catch(i){throw console.error("Error searching loyalty card by phone:",i),i}}static calculatePotentialRewards(e){return Math.floor(e/Ga.STAMPS_FOR_FREE_SHISHA)}static calculateProgressPercentage(e){return e%Ga.STAMPS_FOR_FREE_SHISHA/Ga.STAMPS_FOR_FREE_SHISHA*100}}Dr(ks,"loyaltyCardsCollection","loyaltyCards"),Dr(ks,"loyaltyTransactionsCollection","loyaltyTransactions");const kb=t=>{if(t!=null){if(t&&typeof t.toDate=="function")try{return t.toDate()}catch(e){console.warn("Error converting Firestore Timestamp to Date:",e);return}if(t instanceof Date)return t;if(typeof t=="string")try{const e=new Date(t);if(!isNaN(e.getTime()))return e}catch(e){console.warn("Error parsing string date:",t,e)}if(typeof t=="number")try{const e=new Date(t);if(!isNaN(e.getTime()))return e}catch(e){console.warn("Error converting numeric timestamp to Date:",t,e)}if(typeof t=="object"&&t.seconds!==void 0)try{const e=t.seconds*1e3+(t.nanoseconds||0)/1e6;return new Date(e)}catch(e){console.warn("Error converting timestamp object to Date:",t,e)}if(typeof t=="object"&&t._methodName==="serverTimestamp")return new Date;console.warn("Unknown date format, cannot convert:",t,typeof t)}},qo=(t,e=new Date)=>kb(t)||e;class ls{static removeUndefinedValues(e){if(!e||typeof e!="object")return e;const r={};return Object.keys(e).forEach(n=>{const s=e[n];if(s!==void 0)if(Array.isArray(s)){const i=s.map(o=>typeof o=="object"?this.removeUndefinedValues(o):o).filter(o=>o!==void 0);r[n]=i}else if(typeof s=="object"&&s!==null&&!(s instanceof Date)&&!(s!=null&&s.toDate)&&!(s!=null&&s.isEqual)){const i=this.removeUndefinedValues(s);i&&Object.keys(i).length>0&&(r[n]=i)}else r[n]=s}),r}static convertOrderDates(e){const r={...e,createdAt:qo(e.createdAt),updatedAt:qo(e.updatedAt),estimatedCompletionTime:kb(e.estimatedCompletionTime),completedAt:kb(e.completedAt)};return r.payment||(r.payment={status:"unpaid",amount:r.totalAmount||0}),r}static async createOrder(e){try{const r=Ce();console.log("🔍 Creating order with raw data:",e);const n={...e,payment:e.payment||{status:"unpaid",amount:e.totalAmount||0},createdAt:ft(),updatedAt:ft()},s=this.removeUndefinedValues(n);console.log("✅ Cleaned order data:",s);const i=await xo(Be(r,this.collectionName),s);return console.log("🎉 Order created successfully with ID:",i.id),i.id}catch(r){throw vp(()=>import("./productionLogger-a30e1463.js"),[]).then(({logger:n})=>{n.error("Error creating order:",r),n.debug("Order data that failed:",e)}),r}}static async getOrders(){try{const e=Ce();return(await st(Be(e,this.collectionName))).docs.map(n=>{const s=n.data();return{id:n.id,...this.convertOrderDates(s)}})}catch(e){throw console.error("Error getting orders:",e),e}}static async getOrdersWithFilters(e){try{console.log("🔍 Loading orders with filters:",e);const r=Ce();let s=Be(r,this.collectionName);e.status&&(s=qe(s,Je("status","==",e.status))),e.paymentStatus&&(s=qe(s,Je("payment.status","==",e.paymentStatus))),e.tableNumber&&(s=qe(s,Je("tableNumber","==",e.tableNumber))),e.dateRange&&(s=qe(s,Je("createdAt",">=",yt.fromDate(e.dateRange.start)),Je("createdAt","<=",yt.fromDate(e.dateRange.end)))),s=qe(s,Vt("createdAt","desc"));let o=(await st(s)).docs.map(l=>{const c=l.data();return{id:l.id,...this.convertOrderDates(c)}});if(e.search){const l=e.search.toLowerCase();o=o.filter(c=>{var u;return((u=c.customerName)==null?void 0:u.toLowerCase().includes(l))||c.items.some(d=>d.name.toLowerCase().includes(l))||c.tableNumber.toString().includes(l)})}return console.log("✅ Orders loaded successfully:",o.length,"orders"),o}catch(r){throw console.error("❌ Error getting orders with filters:",r),r}}static async getOrderById(e){try{const r=Ce(),n=ot(r,this.collectionName,e),s=await os(n);if(s.exists()){const i=s.data();return{id:s.id,...this.convertOrderDates(i)}}return null}catch(r){throw console.error("Error getting order by ID:",r),r}}static async updateOrderStatus(e,r){console.log("📊 Updating order status:",{orderId:e,newStatus:r});try{const n=Ce(),s=ot(n,this.collectionName,e),i=this.removeUndefinedValues({status:r,updatedAt:ft(),...r==="delivered"&&{completedAt:ft()}});if(await Qt(s,i),console.log(`✅ Order status updated successfully: ${e} -> ${r}`),r==="confirmed"){console.log(`🎯 Order confirmed! Triggering loyalty stamp process for order: ${e}`);try{await this.addLoyaltyStampsForOrder(e),console.log(`✅ Loyalty stamp process completed for order: ${e}`)}catch(o){console.error("❌ Error adding loyalty stamps:",o),console.error("❌ Loyalty error details:",{orderId:e,errorMessage:o instanceof Error?o.message:String(o),errorStack:o instanceof Error?o.stack:void 0})}}else console.log(`ℹ️  Order status '${r}' does not trigger loyalty stamps`)}catch(n){throw console.error("❌ Error updating order status:",n),console.error("❌ Status update error details:",{orderId:e,status:r,errorMessage:n instanceof Error?n.message:String(n)}),n}}static async addLoyaltyStampsForOrder(e){var r,n;console.log(`🎯 Starting loyalty stamp process for order: ${e}`);try{const s=await this.getOrderById(e);if(console.log("📋 Order details:",{orderId:e,exists:!!s,customerPhone:s==null?void 0:s.customerPhone,customerName:s==null?void 0:s.customerName,itemCount:((r=s==null?void 0:s.items)==null?void 0:r.length)||0,items:(n=s==null?void 0:s.items)==null?void 0:n.map(c=>({name:c.name,category:c.category,quantity:c.quantity}))}),!s){console.log("❌ Order not found for loyalty stamps");return}if(!s.customerPhone||!s.customerName){console.log("❌ Order missing customer info for loyalty stamps:",{hasPhone:!!s.customerPhone,hasName:!!s.customerName,phone:s.customerPhone,name:s.customerName});return}const i=ks.countShishaItems(s.items);if(console.log("🔢 Shisha count calculation:",{totalItems:s.items.length,shishaCount:i,itemBreakdown:s.items.map(c=>({name:c.name,category:c.category.toLowerCase(),quantity:c.quantity,isShisha:c.category.toLowerCase()==="shisha"||c.category.toLowerCase()==="tobacco"}))}),i===0){console.log("❌ No shisha items in order for loyalty stamps");return}console.log(`✅ Proceeding with loyalty stamp addition: ${i} shisha items found`),console.log("🏷️ Getting or creating loyalty card for:",{phone:s.customerPhone,name:s.customerName});const o=await ks.getOrCreateLoyaltyCard(s.customerPhone,s.customerName);console.log("🏷️ Loyalty card retrieved:",{cardId:o.id,currentStamps:o.stamps,totalShishaOrders:o.totalShishaOrders,freeShishaEarned:o.freeShishaEarned}),console.log(`🎯 Adding ${i} stamps to loyalty card ${o.id}`);const l=await ks.addStamps(o.id,e,i);console.log("🎉 Loyalty stamps added successfully!",{orderId:e,shishaCount:i,cardId:o.id,newStamps:l.stamps,newTotalOrders:l.totalShishaOrders,newFreeShishas:l.freeShishaEarned})}catch(s){throw console.error("❌ Error processing loyalty stamps:",s),console.error("❌ Error details:",{orderId:e,errorMessage:s instanceof Error?s.message:String(s),errorStack:s instanceof Error?s.stack:void 0}),s}}static async verifyLoyaltyDiscount(e){try{const r=Ce(),n=ot(r,this.collectionName,e);await Qt(n,{"loyaltyDiscount.isVerified":!0,updatedAt:ft()}),console.log(`Loyalty discount verified for order ${e}`)}catch(r){throw console.error("Error verifying loyalty discount:",r),r}}static async updateOrder(e,r){try{const n=Ce(),s=ot(n,this.collectionName,e),i=this.removeUndefinedValues({...r,updatedAt:ft()});await Qt(s,i)}catch(n){throw console.error("Error updating order:",n),n}}static async processPayment(e,r){try{const n=Ce(),s=ot(n,this.collectionName,e),i={status:"paid",method:r.method,amount:r.amount,paidAt:new Date,transactionId:r.transactionId,processedBy:r.processedBy,notes:r.notes},o=this.removeUndefinedValues({payment:i,updatedAt:ft()});await Qt(s,o),console.log(`Payment processed for order ${e}`)}catch(n){throw console.error("Error processing payment:",n),n}}static async updatePaymentStatus(e,r){try{const n=Ce(),s=ot(n,this.collectionName,e),i=this.removeUndefinedValues({"payment.status":r,updatedAt:ft()});await Qt(s,i),console.log(`Payment status updated to ${r} for order ${e}`)}catch(n){throw console.error("Error updating payment status:",n),n}}static async processRefund(e,r){try{const n=Ce(),s=ot(n,this.collectionName,e),i=this.removeUndefinedValues({"payment.status":"refunded","payment.refundAmount":r.amount,"payment.refundReason":r.reason,"payment.refundedBy":r.processedBy,"payment.refundedAt":new Date,updatedAt:ft()});await Qt(s,i),console.log(`Refund processed for order ${e}: €${r.amount}`)}catch(n){throw console.error("Error processing refund:",n),n}}static async getUnpaidOrdersForTable(e){try{const r=Ce(),n=qe(Be(r,this.collectionName),Je("tableNumber","==",e),Je("payment.status","in",["unpaid","partial"]));return(await st(n)).docs.map(i=>{const o=i.data();return{id:i.id,...this.convertOrderDates(o)}})}catch(r){throw console.error("Error getting unpaid orders for table:",r),r}}static async getUnpaidOrdersForReservation(e){try{const r=Ce(),n=qe(Be(r,this.collectionName),Je("reservationId","==",e),Je("payment.status","in",["unpaid","partial"]));return(await st(n)).docs.map(i=>{const o=i.data();return{id:i.id,...this.convertOrderDates(o)}})}catch(r){throw console.error("Error getting unpaid orders for reservation:",r),r}}static async deleteOrder(e){try{const r=Ce(),n=ot(r,this.collectionName,e);await ba(n)}catch(r){throw console.error("Error deleting order:",r),r}}static async getOrderStats(){try{const e=await this.getOrders();return{totalOrders:e.length,pendingOrders:e.filter(n=>n.status==="pending").length,preparingOrders:e.filter(n=>n.status==="preparing").length,readyOrders:e.filter(n=>n.status==="ready").length,deliveredOrders:e.filter(n=>n.status==="delivered").length,cancelledOrders:e.filter(n=>n.status==="cancelled").length,paidOrders:e.filter(n=>{var s;return((s=n.payment)==null?void 0:s.status)==="paid"}).length,unpaidOrders:e.filter(n=>{var s;return((s=n.payment)==null?void 0:s.status)==="unpaid"}).length,totalRevenue:e.reduce((n,s)=>n+(s.totalAmount||0),0),paidRevenue:e.filter(n=>{var s;return((s=n.payment)==null?void 0:s.status)==="paid"}).reduce((n,s)=>n+(s.totalAmount||0),0),unpaidRevenue:e.filter(n=>{var s;return((s=n.payment)==null?void 0:s.status)==="unpaid"}).reduce((n,s)=>n+(s.totalAmount||0),0),averageOrderValue:e.length>0?e.reduce((n,s)=>n+(s.totalAmount||0),0)/e.length:0}}catch(e){throw console.error("Error getting order stats:",e),e}}static onOrdersChange(e){const r=Ce(),n=qe(Be(r,this.collectionName),Vt("createdAt","desc"));return wi(n,i=>{const o=i.docs.map(l=>{const c=l.data();return{id:l.id,...this.convertOrderDates(c)}});e(o)},i=>{console.error("Error listening to orders:",i)})}static onOrdersChangeWithFilters(e,r){const n=Ce();let i=Be(n,this.collectionName);return e.status&&(i=qe(i,Je("status","==",e.status))),e.tableNumber&&(i=qe(i,Je("tableNumber","==",e.tableNumber))),e.dateRange&&(i=qe(i,Je("createdAt",">=",yt.fromDate(e.dateRange.start)),Je("createdAt","<=",yt.fromDate(e.dateRange.end)))),i=qe(i,Vt("createdAt","desc")),wi(i,l=>{let c=l.docs.map(u=>{const d=u.data();return{id:u.id,...this.convertOrderDates(d)}});if(e.search){const u=e.search.toLowerCase();c=c.filter(d=>{var h;return((h=d.customerName)==null?void 0:h.toLowerCase().includes(u))||d.items.some(g=>g.name.toLowerCase().includes(u))||d.tableNumber.toString().includes(u)})}r(c)},l=>{console.error("Error listening to orders with filters:",l)})}}Dr(ls,"collectionName","orders");class C3{static async getAnalyticsData(){try{const[e,r,n,s]=await Promise.all([ls.getOrderStats(),ds.getEventStats(),this.getUserStats(),this.getRevenueData()]),i=s.lastMonthRevenue>0?(s.thisMonthRevenue-s.lastMonthRevenue)/s.lastMonthRevenue*100:0,o=n.totalUsers>0?n.activeUsers/n.totalUsers*100:0,l=r.totalEvents>0?r.totalAttendees/r.totalEvents:0;return{totalUsers:n.totalUsers,activeUsers:n.activeUsers,totalEvents:r.totalEvents,activeEvents:r.activeEvents,totalRevenue:e.totalRevenue,monthlyGrowth:Math.round(i*10)/10,thisMonthRevenue:s.thisMonthRevenue,lastMonthRevenue:s.lastMonthRevenue,revenueGrowth:Math.round(i*10)/10,newUsersThisMonth:n.newUsersThisMonth,activeUsersCount:n.activeUsers,engagementRate:Math.round(o*10)/10,totalOrders:e.totalOrders,pendingOrders:e.pendingOrders,deliveredOrders:e.deliveredOrders,averageOrderValue:Math.round(e.averageOrderValue*100)/100,upcomingEvents:r.upcomingEvents,totalAttendees:r.totalAttendees,eventEngagement:Math.round(l*10)/10}}catch(e){throw console.error("Error getting analytics data:",e),e}}static async getUserStats(){try{const e=Ce(),r=await st(Be(e,"users")),n=new Date,s=new Date(n.getFullYear(),n.getMonth(),1),i=new Date(n.getTime()-30*24*60*60*1e3);let o=0,l=0,c=0;return r.forEach(u=>{var g;const d=u.data();o++;const h=((g=d.createdAt)==null?void 0:g.toDate())||new Date;h>=i&&l++,h>=s&&c++}),{totalUsers:o,activeUsers:l,newUsersThisMonth:c}}catch(e){return console.error("Error getting user stats:",e),{totalUsers:0,activeUsers:0,newUsersThisMonth:0}}}static async getRevenueData(){try{const e=await ls.getOrders(),r=new Date,n=new Date(r.getFullYear(),r.getMonth(),1),s=new Date(r.getFullYear(),r.getMonth()-1,1),i=new Date(r.getFullYear(),r.getMonth(),0);let o=0,l=0;return e.forEach(c=>{if(c.status==="delivered"){const u=c.createdAt;u>=n?o+=c.totalAmount:u>=s&&u<=i&&(l+=c.totalAmount)}}),{thisMonthRevenue:o,lastMonthRevenue:l}}catch(e){return console.error("Error getting revenue data:",e),{thisMonthRevenue:0,lastMonthRevenue:0}}}static onAnalyticsChange(e){let r=null,n=null,s=null;const i=async()=>{try{const d=await this.getAnalyticsData();e(d)}catch(d){console.error("Error updating analytics:",d)}},o=Ce(),l=qe(Be(o,"orders"),Vt("createdAt","desc"));r=wi(l,i);const c=qe(Be(o,"events"),Vt("createdAt","desc"));n=wi(c,i);const u=qe(Be(o,"users"),Vt("createdAt","desc"));return s=wi(u,i),i(),()=>{r&&r(),n&&n(),s&&s()}}}const fm=[{id:"food",name:"Speisen",icon:"🍽️"},{id:"drinks",name:"Getränke",icon:"🥤"},{id:"tobacco",name:"Tabak",icon:"🚬"},{id:"shisha",name:"Shisha",icon:"💨"},{id:"desserts",name:"Desserts",icon:"🍰"},{id:"snacks",name:"Snacks",icon:"🍿"},{id:"other",name:"Sonstiges",icon:"📦"}],fJ=({item:t,onSave:e,onCancel:r})=>{const[n,s]=M.useState({name:"",description:"",price:0,category:"food",imageUrl:"",isAvailable:!0,isPopular:!1,allergens:[],ingredients:[],preparationTime:""}),[i,o]=M.useState(!1);M.useEffect(()=>{var d;t&&s({name:t.name,description:t.description,price:t.price,category:t.category,imageUrl:t.imageUrl||"",isAvailable:t.isAvailable,isPopular:t.isPopular||!1,allergens:t.allergens||[],ingredients:Array.isArray(t.ingredients)?t.ingredients:t.ingredients?[t.ingredients]:[],preparationTime:((d=t.preparationTime)==null?void 0:d.toString())||""})},[t]);const l=d=>{const{name:h,value:g}=d.target;s(m=>({...m,[h]:g}))},c=()=>n.name.trim()?n.description.trim()?n.price<=0?(Ee.error("Preis muss größer als 0 sein"),!1):!0:(Ee.error("Beschreibung ist erforderlich"),!1):(Ee.error("Name ist erforderlich"),!1),u=async d=>{if(d.preventDefault(),!!c()){o(!0);try{const h={name:n.name.trim(),description:n.description.trim(),price:parseFloat(n.price.toString()),category:n.category,imageUrl:n.imageUrl||"",isAvailable:n.isAvailable,isPopular:n.isPopular,allergens:n.allergens.filter(g=>g.trim()),ingredients:n.ingredients.filter(g=>g.trim()),preparationTime:n.preparationTime||""};t!=null&&t.id?(await Wo.updateMenuItem(t.id,h),Ee.success("Menüpunkt erfolgreich aktualisiert")):(await Wo.createMenuItem(h),Ee.success("Menüpunkt erfolgreich erstellt")),e()}catch(h){console.error("Error saving menu item:",h),Ee.error("Fehler beim Speichern des Menüpunkts")}finally{o(!1)}}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-royal-charcoal-dark rounded-royal p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-royal font-bold text-royal-cream",children:t?"Menüpunkt bearbeiten":"Neuer Menüpunkt"}),a.jsx("button",{onClick:r,className:"text-royal-cream hover:text-royal-gold transition-colors",children:a.jsx(Zi,{className:"w-6 h-6"})})]}),a.jsxs("form",{onSubmit:u,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-royal-cream font-medium mb-2",children:"Name *"}),a.jsx("input",{type:"text",name:"name",value:n.name,onChange:l,className:"w-full px-4 py-3 bg-royal-charcoal border border-royal-gold/30 rounded-royal text-royal-cream placeholder-royal-cream/50 focus:outline-none focus:border-royal-gold",placeholder:"Menüpunkt Name",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-royal-cream font-medium mb-2",children:"Beschreibung *"}),a.jsx("textarea",{name:"description",value:n.description,onChange:l,rows:3,className:"w-full px-4 py-3 bg-royal-charcoal border border-royal-gold/30 rounded-royal text-royal-cream placeholder-royal-cream/50 focus:outline-none focus:border-royal-gold resize-none",placeholder:"Detaillierte Beschreibung",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-royal-cream font-medium mb-2",children:"Preis (€) *"}),a.jsx("input",{type:"number",name:"price",value:n.price,onChange:l,step:"0.01",min:"0",className:"w-full px-4 py-3 bg-royal-charcoal border border-royal-gold/30 rounded-royal text-royal-cream focus:outline-none focus:border-royal-gold",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-royal-cream font-medium mb-2",children:"Kategorie"}),a.jsx("select",{name:"category",value:n.category,onChange:l,className:"w-full px-4 py-3 bg-royal-charcoal border border-royal-gold/30 rounded-royal text-royal-cream focus:outline-none focus:border-royal-gold",children:fm.map(d=>a.jsxs("option",{value:d.id,children:[d.icon," ",d.name]},d.id))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-royal-cream font-medium mb-2",children:"Zubereitungszeit (optional)"}),a.jsx("input",{type:"text",name:"preparationTime",value:n.preparationTime,onChange:l,className:"w-full px-4 py-3 bg-royal-charcoal border border-royal-gold/30 rounded-royal text-royal-cream placeholder-royal-cream/50 focus:outline-none focus:border-royal-gold",placeholder:"z.B. 5-10 Minuten"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:"isAvailable",name:"isAvailable",checked:n.isAvailable,onChange:d=>s(h=>({...h,isAvailable:d.target.checked})),className:"w-4 h-4 text-royal-gold bg-royal-charcoal border-royal-gold/30 rounded focus:ring-royal-gold"}),a.jsx("label",{htmlFor:"isAvailable",className:"ml-2 text-royal-cream",children:"Verfügbar"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:"isPopular",name:"isPopular",checked:n.isPopular,onChange:d=>s(h=>({...h,isPopular:d.target.checked})),className:"w-4 h-4 text-royal-gold bg-royal-charcoal border-royal-gold/30 rounded focus:ring-royal-gold"}),a.jsx("label",{htmlFor:"isPopular",className:"ml-2 text-royal-cream",children:"Beliebt"})]})]}),a.jsxs("div",{className:"flex gap-4 pt-4",children:[a.jsx("button",{type:"submit",disabled:i,className:"flex-1 bg-royal-gradient-gold text-royal-charcoal px-6 py-3 rounded-royal font-royal font-semibold hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",children:i?a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"w-4 h-4 border-2 border-royal-charcoal border-t-transparent rounded-full animate-spin mr-2"}),"Speichern..."]}):a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx(jN,{className:"w-4 h-4 mr-2"}),t?"Aktualisieren":"Erstellen"]})}),a.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 bg-royal-charcoal text-royal-cream border border-royal-gold/30 rounded-royal font-royal font-semibold hover:bg-royal-charcoal-light transition-colors",children:"Abbrechen"})]})]})]})})},mJ=()=>{const[t,e]=M.useState([]),[r,n]=M.useState(!0),[s,i]=M.useState(""),[o,l]=M.useState(!1),[c,u]=M.useState(null),[d,h]=M.useState("all"),[g,m]=M.useState("");M.useEffect(()=>{let k=null;try{k=Wo.onMenuItemsChange(A=>{console.log("📋 Menu items loaded:",A.length),e(A||[]),n(!1),i("")})}catch(A){console.error("❌ Error setting up menu listener:",A),i("Fehler beim Laden der Menüartikel"),n(!1),Ee.error("Fehler beim Laden der Menüartikel")}return()=>{k&&k()}},[]);const w=async k=>{if(window.confirm("Sind Sie sicher, dass Sie diesen Menüpunkt löschen möchten?"))try{await Wo.deleteMenuItem(k),Ee.success("Menüpunkt erfolgreich gelöscht")}catch(A){const I=A instanceof Error?A.message:"Fehler beim Löschen des Menüpunkts";i(I),Ee.error(I)}},_=async(k,A)=>{try{await Wo.toggleMenuItemAvailability(k,!A),Ee.success(`Artikel ${A?"deaktiviert":"aktiviert"}`)}catch(I){const O=I instanceof Error?I.message:"Fehler beim Umschalten der Verfügbarkeit";i(O),Ee.error(O)}},T=async(k,A)=>{try{await Wo.toggleMenuItemPopularity(k,!A),Ee.success(`Artikel als ${A?"normal":"beliebt"} markiert`)}catch(I){const O=I instanceof Error?I.message:"Fehler beim Umschalten der Beliebtheit";i(O),Ee.error(O)}},v=async()=>{try{await Wo.createSampleMenuItems(),Ee.success("Beispielartikel erfolgreich erstellt")}catch(k){const A=k instanceof Error?k.message:"Fehler beim Erstellen von Beispielartikeln";i(A),Ee.error(A)}},b=Lc.useMemo(()=>{try{return Array.isArray(t)?t.filter(k=>{if(!k||typeof k!="object")return console.warn("⚠️ Invalid menu item:",k),!1;const A=d==="all"||k.category===d,I=k.name||"",O=k.description||"",S=g.toLowerCase(),R=I.toLowerCase().includes(S)||O.toLowerCase().includes(S);return A&&R}):(console.warn("⚠️ menuItems is not an array:",t),[])}catch(k){return console.error("❌ Error filtering menu items:",k),[]}},[t,d,g]),x=k=>{if(!k)return"📦";const A=fm.find(I=>I.id===k);return(A==null?void 0:A.icon)||"📦"},P=k=>{if(!k)return"Other";const A=fm.find(I=>I.id===k);return(A==null?void 0:A.name)||"Other"},F=k=>{try{return`€${(typeof k=="number"?k:parseFloat(k)||0).toFixed(2)}`}catch(A){return console.warn("⚠️ Error formatting price:",k,A),"€0.00"}},$=k=>typeof k=="string"&&k.trim()?k:void 0;return r?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-royal-gold"})}):o?a.jsx(fJ,{item:c||void 0,onSave:()=>{l(!1),u(null)},onCancel:()=>{l(!1),u(null)}}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-royal-charcoal",children:"Menü Verwaltung"}),a.jsx("p",{className:"text-gray-600",children:"Verwalten Sie Ihre Menüartikel, Kategorien und Verfügbarkeit"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:v,className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors",children:"Beispielartikel hinzufügen"}),a.jsxs("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-royal-gold text-white rounded-md hover:bg-royal-gold/80 flex items-center gap-2 transition-colors",children:[a.jsx(Ai,{className:"w-4 h-4"}),"Artikel hinzufügen"]})]})]}),s&&a.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded flex justify-between items-center",children:[a.jsx("span",{children:s}),a.jsx("button",{onClick:()=>i(""),className:"text-red-500 hover:text-red-700 font-bold",children:"×"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx("input",{type:"text",placeholder:"Menüartikel suchen...",value:g,onChange:k=>m(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-royal-gold transition-all"})}),a.jsx("div",{children:a.jsxs("select",{value:d,onChange:k=>h(k.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-royal-gold transition-all",children:[a.jsx("option",{value:"all",children:"Alle Kategorien"}),fm.map(k=>a.jsxs("option",{value:k.id,children:[k.icon," ",k.name]},k.id))]})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Artikel"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kategorie"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Preis"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aktionen"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(k=>!k||!k.id?(console.warn("⚠️ Skipping invalid menu item:",k),null):a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[$(k.imageUrl)&&a.jsx("img",{src:$(k.imageUrl),alt:k.name||"Menü Artikel",className:"w-10 h-10 rounded-lg object-cover mr-3",onError:A=>{console.warn("⚠️ Image failed to load:",k.imageUrl),A.currentTarget.style.display="none"}}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:k.name||"Unbenannter Artikel"}),a.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:k.description||"Keine Beschreibung"})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[x(k.category)," ",P(k.category)]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:F(k.price)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>_(k.id,k.isAvailable||!1),className:`p-1 rounded-full transition-colors ${k.isAvailable?"text-green-600 hover:text-green-800 hover:bg-green-50":"text-red-600 hover:text-red-800 hover:bg-red-50"}`,title:k.isAvailable?"Verfügbar":"Nicht verfügbar",children:k.isAvailable?a.jsx(Ca,{className:"w-4 h-4"}):a.jsx(Gp,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>T(k.id,k.isPopular||!1),className:`p-1 rounded-full transition-colors ${k.isPopular?"text-yellow-600 hover:text-yellow-800 hover:bg-yellow-50":"text-gray-400 hover:text-gray-600 hover:bg-gray-50"}`,title:k.isPopular?"Beliebt":"Nicht beliebt",children:k.isPopular?a.jsx(zn,{className:"w-4 h-4"}):a.jsx(EY,{className:"w-4 h-4"})})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>{u(k),l(!0)},className:"text-indigo-600 hover:text-indigo-900 p-1 rounded-full hover:bg-indigo-50 transition-colors",title:"Bearbeiten",children:a.jsx(Kp,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>w(k.id),className:"text-red-600 hover:text-red-900 p-1 rounded-full hover:bg-red-50 transition-colors",title:"Löschen",children:a.jsx(Qs,{className:"w-4 h-4"})})]})})]},k.id))})]})}),b.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx("p",{className:"text-gray-500 text-lg mb-4",children:t.length===0?"Noch keine Menüartikel vorhanden.":"Keine Menüartikel gefunden."}),a.jsx("button",{onClick:()=>l(!0),className:"px-6 py-3 bg-royal-gold text-white rounded-lg hover:bg-royal-gold/80 transition-colors font-medium",children:t.length===0?"Ihren ersten Menüpunkt hinzufügen":"Neuen Menüpunkt hinzufügen"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsx("div",{className:"text-2xl font-bold text-royal-charcoal",children:t.length}),a.jsx("div",{className:"text-sm text-gray-600",children:"Gesamte Artikel"})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.filter(k=>k==null?void 0:k.isAvailable).length}),a.jsx("div",{className:"text-sm text-gray-600",children:"Verfügbar"})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:t.filter(k=>k==null?void 0:k.isPopular).length}),a.jsx("div",{className:"text-sm text-gray-600",children:"Beliebt"})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:fm.length}),a.jsx("div",{className:"text-sm text-gray-600",children:"Kategorien"})]})]})]})},pJ=[{id:"food",name:"Speisen"},{id:"drinks",name:"Getränke"},{id:"tobacco",name:"Tabak"},{id:"combo",name:"Kombi-Angebot"},{id:"event",name:"Event-Special"},{id:"other",name:"Sonstiges"}],gJ=({offer:t,onClose:e,onSuccess:r})=>{const[n,s]=M.useState({title:"",description:"",originalPrice:0,discountPercentage:0,startDate:new Date().toISOString().split("T")[0],endDate:new Date(Date.now()+6048e5).toISOString().split("T")[0],category:"food",maxUses:"",terms:[""],isActive:!0}),[i,o]=M.useState(!1),[l,c]=M.useState("");M.useEffect(()=>{var v,b;t&&(s({title:t.title,description:t.description,originalPrice:t.originalPrice,discountPercentage:t.discountPercentage,startDate:t.startDate.toISOString().split("T")[0],endDate:t.endDate.toISOString().split("T")[0],category:t.category,maxUses:((v=t.maxUses)==null?void 0:v.toString())||"",terms:(b=t.terms)!=null&&b.length?t.terms:[""],isActive:t.isActive}),t.imageUrl&&c(t.imageUrl))},[t]);const u=v=>{const{name:b,value:x}=v.target;s(P=>({...P,[b]:x}))},d=v=>{var x;const b=(x=v.target.files)==null?void 0:x[0];if(b){const P=new FileReader;P.onload=F=>{var $;c(($=F.target)==null?void 0:$.result)},P.readAsDataURL(b)}},h=(v,b)=>{const x=[...n.terms];x[v]=b,s(P=>({...P,terms:x}))},g=()=>{s(v=>({...v,terms:[...v.terms,""]}))},m=v=>{if(n.terms.length>1){const b=n.terms.filter((x,P)=>P!==v);s(x=>({...x,terms:b}))}},w=()=>n.originalPrice>0&&n.discountPercentage>=0?n.originalPrice*(1-n.discountPercentage/100):0,_=()=>n.title.trim()?n.description.trim()?n.originalPrice<=0?(Ee.error("Ursprungspreis muss größer als 0 sein"),!1):n.discountPercentage<0||n.discountPercentage>100?(Ee.error("Rabatt muss zwischen 0 und 100% liegen"),!1):new Date(n.startDate)>=new Date(n.endDate)?(Ee.error("Enddatum muss nach dem Startdatum liegen"),!1):!0:(Ee.error("Beschreibung ist erforderlich"),!1):(Ee.error("Titel ist erforderlich"),!1),T=async v=>{if(v.preventDefault(),!!_()){o(!0);try{const b=w(),x={title:n.title.trim(),description:n.description.trim(),originalPrice:n.originalPrice,discountedPrice:b,discountPercentage:n.discountPercentage,startDate:new Date(n.startDate),endDate:new Date(n.endDate),category:n.category,isActive:n.isActive,maxUses:n.maxUses?parseInt(n.maxUses):void 0,currentUses:(t==null?void 0:t.currentUses)||0,terms:n.terms.filter(P=>P.trim()),imageUrl:l||void 0,createdBy:"admin"};t!=null&&t.id?(await Ju.updateSpecialOffer(t.id,x),Ee.success("Sonderangebot erfolgreich aktualisiert")):(await Ju.createSpecialOffer(x),Ee.success("Sonderangebot erfolgreich erstellt")),r(),e()}catch(b){console.error("Error saving special offer:",b),Ee.error("Fehler beim Speichern des Sonderangebots")}finally{o(!1)}}};return a.jsx(oe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs(oe.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-royal-charcoal-dark rounded-royal p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-royal font-bold text-royal-cream",children:t?"Sonderangebot bearbeiten":"Neues Sonderangebot"}),a.jsx("button",{onClick:e,className:"text-royal-cream hover:text-royal-gold transition-colors",children:a.jsx(Zi,{className:"w-6 h-6"})})]}),a.jsxs("form",{onSubmit:T,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-royal-cream font-medium mb-2",children:"Titel *"}),a.jsx("input",{type:"text",name:"title",value:n.title,onChange:u,className:"w-full px-4 py-3 bg-royal-charcoal border border-royal-gold/30 rounded-royal text-royal-cream placeholder-royal-cream/50 focus:outline-none focus:border-royal-gold",placeholder:"Angebotstitel eingeben",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-royal-cream font-medium mb-2",children:"Beschreibung *"}),a.jsx("textarea",{name:"description",value:n.description,onChange:u,rows:3,className:"w-full px-4 py-3 bg-royal-charcoal border border-royal-gold/30 rounded-royal text-royal-cream placeholder-royal-cream/50 focus:outline-none focus:border-royal-gold resize-none",placeholder:"Detaillierte Beschreibung des Angebots",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-royal-cream font-medium mb-2",children:"Kategorie"}),a.jsx("select",{name:"category",value:n.category,onChange:u,className:"w-full px-4 py-3 bg-royal-charcoal border border-royal-gold/30 rounded-royal text-royal-cream focus:outline-none focus:border-royal-gold",children:pJ.map(v=>a.jsx("option",{value:v.id,children:v.name},v.id))})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-royal-cream font-medium mb-2",children:"Ursprungspreis (€) *"}),a.jsxs("div",{className:"relative",children:[a.jsx(Lh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-royal-cream/50 w-4 h-4"}),a.jsx("input",{type:"number",name:"originalPrice",value:n.originalPrice,onChange:u,step:"0.01",min:"0",className:"w-full pl-10 pr-4 py-3 bg-royal-charcoal border border-royal-gold/30 rounded-royal text-royal-cream focus:outline-none focus:border-royal-gold",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-royal-cream font-medium mb-2",children:"Rabatt (%) *"}),a.jsxs("div",{className:"relative",children:[a.jsx(cP,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-royal-cream/50 w-4 h-4"}),a.jsx("input",{type:"number",name:"discountPercentage",value:n.discountPercentage,onChange:u,min:"0",max:"100",className:"w-full pl-10 pr-4 py-3 bg-royal-charcoal border border-royal-gold/30 rounded-royal text-royal-cream focus:outline-none focus:border-royal-gold",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-royal-cream font-medium mb-2",children:"Neuer Preis (€)"}),a.jsxs("div",{className:"px-4 py-3 bg-royal-charcoal border border-royal-gold/30 rounded-royal text-royal-gold font-bold",children:[w().toFixed(2),"€"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-royal-cream font-medium mb-2",children:"Startdatum *"}),a.jsxs("div",{className:"relative",children:[a.jsx(Un,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-royal-cream/50 w-4 h-4"}),a.jsx("input",{type:"date",name:"startDate",value:n.startDate,onChange:u,className:"w-full pl-10 pr-4 py-3 bg-royal-charcoal border border-royal-gold/30 rounded-royal text-royal-cream focus:outline-none focus:border-royal-gold",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-royal-cream font-medium mb-2",children:"Enddatum *"}),a.jsxs("div",{className:"relative",children:[a.jsx(Un,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-royal-cream/50 w-4 h-4"}),a.jsx("input",{type:"date",name:"endDate",value:n.endDate,onChange:u,className:"w-full pl-10 pr-4 py-3 bg-royal-charcoal border border-royal-gold/30 rounded-royal text-royal-cream focus:outline-none focus:border-royal-gold",required:!0})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-royal-cream font-medium mb-2",children:"Maximale Nutzungen (optional)"}),a.jsx("input",{type:"number",name:"maxUses",value:n.maxUses,onChange:u,min:"1",className:"w-full px-4 py-3 bg-royal-charcoal border border-royal-gold/30 rounded-royal text-royal-cream focus:outline-none focus:border-royal-gold",placeholder:"Unbegrenzt wenn leer"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-royal-cream font-medium mb-2",children:"Bild (optional)"}),a.jsxs("div",{className:"border-2 border-dashed border-royal-gold/30 rounded-royal p-6 text-center",children:[a.jsx("input",{type:"file",accept:"image/*",onChange:d,className:"hidden",id:"image-upload"}),a.jsxs("label",{htmlFor:"image-upload",className:"cursor-pointer flex flex-col items-center",children:[a.jsx(CY,{className:"w-8 h-8 text-royal-gold mb-2"}),a.jsx("span",{className:"text-royal-cream",children:l?"Bild ändern":"Bild hochladen"})]}),l&&a.jsx("div",{className:"mt-4",children:a.jsx("img",{src:l,alt:"Preview",className:"max-w-full h-32 object-cover rounded-royal mx-auto"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-royal-cream font-medium mb-2",children:"Bedingungen (optional)"}),n.terms.map((v,b)=>a.jsxs("div",{className:"flex gap-2 mb-2",children:[a.jsx("input",{type:"text",value:v,onChange:x=>h(b,x.target.value),className:"flex-1 px-4 py-3 bg-royal-charcoal border border-royal-gold/30 rounded-royal text-royal-cream focus:outline-none focus:border-royal-gold",placeholder:"Bedingung eingeben"}),n.terms.length>1&&a.jsx("button",{type:"button",onClick:()=>m(b),className:"px-3 py-3 bg-red-600 text-white rounded-royal hover:bg-red-700 transition-colors",children:a.jsx(Zi,{className:"w-4 h-4"})})]},b)),a.jsx("button",{type:"button",onClick:g,className:"text-royal-gold hover:text-royal-gold-light transition-colors",children:"+ Bedingung hinzufügen"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:"isActive",name:"isActive",checked:n.isActive,onChange:v=>s(b=>({...b,isActive:v.target.checked})),className:"w-4 h-4 text-royal-gold bg-royal-charcoal border-royal-gold/30 rounded focus:ring-royal-gold"}),a.jsx("label",{htmlFor:"isActive",className:"ml-2 text-royal-cream",children:"Angebot ist aktiv"})]}),a.jsxs("div",{className:"flex gap-4 pt-4",children:[a.jsx("button",{type:"submit",disabled:i,className:"flex-1 bg-royal-gradient-gold text-royal-charcoal px-6 py-3 rounded-royal font-royal font-semibold hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",children:i?a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"w-4 h-4 border-2 border-royal-charcoal border-t-transparent rounded-full animate-spin mr-2"}),"Speichern..."]}):a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx(jN,{className:"w-4 h-4 mr-2"}),t?"Aktualisieren":"Erstellen"]})}),a.jsx("button",{type:"button",onClick:e,className:"px-6 py-3 bg-royal-charcoal text-royal-cream border border-royal-gold/30 rounded-royal font-royal font-semibold hover:bg-royal-charcoal-light transition-colors",children:"Abbrechen"})]})]})]})})},P3=[{id:"all",name:"Alle Kategorien"},{id:"food",name:"Speisen"},{id:"drinks",name:"Getränke"},{id:"tobacco",name:"Tabak"},{id:"combo",name:"Kombi-Angebot"},{id:"event",name:"Event-Special"},{id:"other",name:"Sonstiges"}],yJ=()=>{const[t,e]=M.useState([]),[r,n]=M.useState([]),[s,i]=M.useState(!0),[o,l]=M.useState(!1),[c,u]=M.useState(),[d,h]=M.useState(""),[g,m]=M.useState("all"),[w,_]=M.useState("all");M.useEffect(()=>Ju.onSpecialOffersChange(O=>{e(O),i(!1)}),[]),M.useEffect(()=>{let I=t;d&&(I=I.filter(O=>O.title.toLowerCase().includes(d.toLowerCase())||O.description.toLowerCase().includes(d.toLowerCase()))),g!=="all"&&(I=I.filter(O=>O.category===g)),w==="active"?I=I.filter(O=>O.isActive):w==="inactive"&&(I=I.filter(O=>!O.isActive)),n(I)},[t,d,g,w]);const T=()=>{u(void 0),l(!0)},v=I=>{u(I),l(!0)},b=async I=>{if(I.id&&window.confirm(`Sind Sie sicher, dass Sie "${I.title}" löschen möchten?`))try{await Ju.deleteSpecialOffer(I.id),Ee.success("Sonderangebot erfolgreich gelöscht")}catch(O){console.error("Error deleting special offer:",O),Ee.error("Fehler beim Löschen des Sonderangebots")}},x=async I=>{if(I.id)try{await Ju.updateSpecialOffer(I.id,{isActive:!I.isActive}),Ee.success(`Sonderangebot ${I.isActive?"deaktiviert":"aktiviert"}`)}catch(O){console.error("Error toggling offer status:",O),Ee.error("Fehler beim Ändern des Status")}},P=I=>{const O=new Date,S=I.endDate<O,R=I.startDate>O;return I.isActive?S?a.jsx("span",{className:"px-2 py-1 bg-red-500 text-white text-xs rounded-full",children:"Abgelaufen"}):R?a.jsx("span",{className:"px-2 py-1 bg-yellow-500 text-white text-xs rounded-full",children:"Geplant"}):a.jsx("span",{className:"px-2 py-1 bg-green-500 text-white text-xs rounded-full",children:"Aktiv"}):a.jsx("span",{className:"px-2 py-1 bg-gray-500 text-white text-xs rounded-full",children:"Inaktiv"})},F=I=>{const O=P3.find(S=>S.id===I);return(O==null?void 0:O.name)||I},$=I=>new Intl.DateTimeFormat("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(I),A=(()=>{const I=t.length,O=t.filter(G=>G.isActive).length,S=t.filter(G=>G.endDate<new Date).length,R=t.reduce((G,de)=>G+de.discountPercentage,0),C=I>0?Math.round(R/I):0;return{total:I,active:O,expired:S,avgDiscount:C}})();return s?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-8 h-8 border-2 border-royal-gold border-t-transparent rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-royal-cream-light",children:"Lade Sonderangebote..."})]})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-royal font-bold text-royal-gold",children:"Sonderangebote verwalten"}),a.jsx("p",{className:"text-royal-cream-light",children:"Erstellen und verwalten Sie exklusive Angebote für Ihre Kunden"})]}),a.jsxs("button",{onClick:T,className:"flex items-center space-x-2 px-4 py-2 bg-royal-gradient-gold text-royal-charcoal rounded-lg font-medium hover:shadow-lg transition-all duration-200",children:[a.jsx(Ai,{size:16}),a.jsx("span",{children:"Neues Angebot"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-royal-charcoal p-4 rounded-lg border border-royal-gold/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream-light text-sm",children:"Gesamt"}),a.jsx("p",{className:"text-2xl font-bold text-royal-gold",children:A.total})]}),a.jsx(Eb,{className:"w-8 h-8 text-royal-gold"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-royal-charcoal p-4 rounded-lg border border-royal-gold/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream-light text-sm",children:"Aktiv"}),a.jsx("p",{className:"text-2xl font-bold text-green-400",children:A.active})]}),a.jsx(pl,{className:"w-8 h-8 text-green-400"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-royal-charcoal p-4 rounded-lg border border-royal-gold/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream-light text-sm",children:"Abgelaufen"}),a.jsx("p",{className:"text-2xl font-bold text-red-400",children:A.expired})]}),a.jsx(Rr,{className:"w-8 h-8 text-red-400"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-royal-charcoal p-4 rounded-lg border border-royal-gold/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream-light text-sm",children:"Ø Rabatt"}),a.jsxs("p",{className:"text-2xl font-bold text-royal-gold",children:[A.avgDiscount,"%"]})]}),a.jsx(cP,{className:"w-8 h-8 text-royal-gold"})]})})]}),a.jsx("div",{className:"bg-royal-charcoal p-4 rounded-lg border border-royal-gold/20",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Sf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-royal-cream-light w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"Sonderangebote durchsuchen...",value:d,onChange:I=>h(I.target.value),className:"w-full pl-10 pr-4 py-2 bg-royal-charcoal-light border border-royal-gold/30 rounded-lg text-royal-cream focus:border-royal-gold focus:outline-none"})]}),a.jsx("select",{value:g,onChange:I=>m(I.target.value),className:"px-4 py-2 bg-royal-charcoal-light border border-royal-gold/30 rounded-lg text-royal-cream focus:border-royal-gold focus:outline-none",children:P3.map(I=>a.jsx("option",{value:I.id,children:I.name},I.id))}),a.jsxs("select",{value:w,onChange:I=>_(I.target.value),className:"px-4 py-2 bg-royal-charcoal-light border border-royal-gold/30 rounded-lg text-royal-cream focus:border-royal-gold focus:outline-none",children:[a.jsx("option",{value:"all",children:"Alle Status"}),a.jsx("option",{value:"active",children:"Aktiv"}),a.jsx("option",{value:"inactive",children:"Inaktiv"})]})]})}),a.jsx("div",{className:"bg-royal-charcoal rounded-lg border border-royal-gold/20 overflow-hidden",children:r.length===0?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx(Eb,{className:"w-12 h-12 text-royal-gold/50 mx-auto mb-4"}),a.jsx("p",{className:"text-royal-cream-light text-lg mb-2",children:"Keine Sonderangebote gefunden"}),a.jsx("p",{className:"text-royal-cream-light/70",children:t.length===0?"Erstellen Sie Ihr erstes Sonderangebot":"Versuchen Sie andere Suchkriterien"})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-royal-charcoal-dark",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-royal-cream-light uppercase tracking-wider",children:"Angebot"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-royal-cream-light uppercase tracking-wider",children:"Kategorie"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-royal-cream-light uppercase tracking-wider",children:"Rabatt"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-royal-cream-light uppercase tracking-wider",children:"Zeitraum"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-royal-cream-light uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-royal-cream-light uppercase tracking-wider",children:"Nutzungen"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-royal-cream-light uppercase tracking-wider",children:"Aktionen"})]})}),a.jsx("tbody",{className:"divide-y divide-royal-gold/10",children:r.map((I,O)=>a.jsxs(oe.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:O*.05},className:"hover:bg-royal-charcoal-light transition-colors",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[I.imageUrl&&a.jsx("img",{src:I.imageUrl,alt:I.title,className:"w-10 h-10 rounded-lg object-cover"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-royal-cream",children:I.title}),a.jsx("div",{className:"text-sm text-royal-cream-light max-w-xs truncate",children:I.description})]})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:"text-sm text-royal-cream-light",children:F(I.category)})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"text-sm",children:[a.jsxs("div",{className:"text-royal-cream",children:[a.jsxs("span",{className:"line-through text-royal-cream-light",children:["€",I.originalPrice.toFixed(2)]})," → ",a.jsxs("span",{className:"text-royal-gold font-semibold",children:["€",I.discountedPrice.toFixed(2)]})]}),a.jsxs("div",{className:"text-xs text-royal-gold",children:["-",I.discountPercentage,"%"]})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"text-sm text-royal-cream-light",children:[a.jsx("div",{children:$(I.startDate)}),a.jsxs("div",{children:["bis ",$(I.endDate)]})]})}),a.jsx("td",{className:"px-6 py-4",children:P(I)}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"text-sm text-royal-cream-light",children:[I.currentUses,I.maxUses&&` / ${I.maxUses}`]})}),a.jsx("td",{className:"px-6 py-4 text-right",children:a.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[a.jsx("button",{onClick:()=>x(I),className:"p-1 text-royal-cream-light hover:text-royal-gold transition-colors",title:I.isActive?"Deaktivieren":"Aktivieren",children:I.isActive?a.jsx(Gp,{size:16}):a.jsx(Ca,{size:16})}),a.jsx("button",{onClick:()=>v(I),className:"p-1 text-royal-cream-light hover:text-royal-gold transition-colors",title:"Bearbeiten",children:a.jsx(Kp,{size:16})}),a.jsx("button",{onClick:()=>b(I),className:"p-1 text-red-400 hover:text-red-300 transition-colors",title:"Löschen",children:a.jsx(Qs,{size:16})})]})})]},I.id))})]})})}),a.jsx(po,{children:o&&a.jsx(gJ,{offer:c,onClose:()=>l(!1),onSuccess:()=>l(!1)})})]})},R3={lessThanXSeconds:{standalone:{one:"weniger als 1 Sekunde",other:"weniger als {{count}} Sekunden"},withPreposition:{one:"weniger als 1 Sekunde",other:"weniger als {{count}} Sekunden"}},xSeconds:{standalone:{one:"1 Sekunde",other:"{{count}} Sekunden"},withPreposition:{one:"1 Sekunde",other:"{{count}} Sekunden"}},halfAMinute:{standalone:"eine halbe Minute",withPreposition:"einer halben Minute"},lessThanXMinutes:{standalone:{one:"weniger als 1 Minute",other:"weniger als {{count}} Minuten"},withPreposition:{one:"weniger als 1 Minute",other:"weniger als {{count}} Minuten"}},xMinutes:{standalone:{one:"1 Minute",other:"{{count}} Minuten"},withPreposition:{one:"1 Minute",other:"{{count}} Minuten"}},aboutXHours:{standalone:{one:"etwa 1 Stunde",other:"etwa {{count}} Stunden"},withPreposition:{one:"etwa 1 Stunde",other:"etwa {{count}} Stunden"}},xHours:{standalone:{one:"1 Stunde",other:"{{count}} Stunden"},withPreposition:{one:"1 Stunde",other:"{{count}} Stunden"}},xDays:{standalone:{one:"1 Tag",other:"{{count}} Tage"},withPreposition:{one:"1 Tag",other:"{{count}} Tagen"}},aboutXWeeks:{standalone:{one:"etwa 1 Woche",other:"etwa {{count}} Wochen"},withPreposition:{one:"etwa 1 Woche",other:"etwa {{count}} Wochen"}},xWeeks:{standalone:{one:"1 Woche",other:"{{count}} Wochen"},withPreposition:{one:"1 Woche",other:"{{count}} Wochen"}},aboutXMonths:{standalone:{one:"etwa 1 Monat",other:"etwa {{count}} Monate"},withPreposition:{one:"etwa 1 Monat",other:"etwa {{count}} Monaten"}},xMonths:{standalone:{one:"1 Monat",other:"{{count}} Monate"},withPreposition:{one:"1 Monat",other:"{{count}} Monaten"}},aboutXYears:{standalone:{one:"etwa 1 Jahr",other:"etwa {{count}} Jahre"},withPreposition:{one:"etwa 1 Jahr",other:"etwa {{count}} Jahren"}},xYears:{standalone:{one:"1 Jahr",other:"{{count}} Jahre"},withPreposition:{one:"1 Jahr",other:"{{count}} Jahren"}},overXYears:{standalone:{one:"mehr als 1 Jahr",other:"mehr als {{count}} Jahre"},withPreposition:{one:"mehr als 1 Jahr",other:"mehr als {{count}} Jahren"}},almostXYears:{standalone:{one:"fast 1 Jahr",other:"fast {{count}} Jahre"},withPreposition:{one:"fast 1 Jahr",other:"fast {{count}} Jahren"}}},xJ=(t,e,r)=>{let n;const s=r!=null&&r.addSuffix?R3[t].withPreposition:R3[t].standalone;return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",String(e)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:"vor "+n:n},vJ={full:"EEEE, do MMMM y",long:"do MMMM y",medium:"do MMM y",short:"dd.MM.y"},bJ={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},wJ={full:"{{date}} 'um' {{time}}",long:"{{date}} 'um' {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},NJ={date:Oh({formats:vJ,defaultWidth:"full"}),time:Oh({formats:bJ,defaultWidth:"full"}),dateTime:Oh({formats:wJ,defaultWidth:"full"})},_J={lastWeek:"'letzten' eeee 'um' p",yesterday:"'gestern um' p",today:"'heute um' p",tomorrow:"'morgen um' p",nextWeek:"eeee 'um' p",other:"P"},jJ=(t,e,r,n)=>_J[t],SJ={narrow:["v.Chr.","n.Chr."],abbreviated:["v.Chr.","n.Chr."],wide:["vor Christus","nach Christus"]},AJ={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1. Quartal","2. Quartal","3. Quartal","4. Quartal"]},Tb={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],wide:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"]},EJ={narrow:Tb.narrow,abbreviated:["Jan.","Feb.","März","Apr.","Mai","Juni","Juli","Aug.","Sep.","Okt.","Nov.","Dez."],wide:Tb.wide},kJ={narrow:["S","M","D","M","D","F","S"],short:["So","Mo","Di","Mi","Do","Fr","Sa"],abbreviated:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],wide:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"]},TJ={narrow:{am:"vm.",pm:"nm.",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachm.",evening:"Abend",night:"Nacht"},abbreviated:{am:"vorm.",pm:"nachm.",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachmittag",evening:"Abend",night:"Nacht"},wide:{am:"vormittags",pm:"nachmittags",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachmittag",evening:"Abend",night:"Nacht"}},IJ={narrow:{am:"vm.",pm:"nm.",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachm.",evening:"abends",night:"nachts"},abbreviated:{am:"vorm.",pm:"nachm.",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachmittags",evening:"abends",night:"nachts"},wide:{am:"vormittags",pm:"nachmittags",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachmittags",evening:"abends",night:"nachts"}},CJ=t=>Number(t)+".",PJ={ordinalNumber:CJ,era:Za({values:SJ,defaultWidth:"wide"}),quarter:Za({values:AJ,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Za({values:Tb,formattingValues:EJ,defaultWidth:"wide"}),day:Za({values:kJ,defaultWidth:"wide"}),dayPeriod:Za({values:TJ,defaultWidth:"wide",formattingValues:IJ,defaultFormattingWidth:"wide"})},RJ=/^(\d+)(\.)?/i,DJ=/\d+/i,LJ={narrow:/^(v\.? ?Chr\.?|n\.? ?Chr\.?)/i,abbreviated:/^(v\.? ?Chr\.?|n\.? ?Chr\.?)/i,wide:/^(vor Christus|vor unserer Zeitrechnung|nach Christus|unserer Zeitrechnung)/i},OJ={any:[/^v/i,/^n/i]},MJ={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](\.)? Quartal/i},FJ={any:[/1/i,/2/i,/3/i,/4/i]},VJ={narrow:/^[jfmasond]/i,abbreviated:/^(j[aä]n|feb|mär[z]?|apr|mai|jun[i]?|jul[i]?|aug|sep|okt|nov|dez)\.?/i,wide:/^(januar|februar|märz|april|mai|juni|juli|august|september|oktober|november|dezember)/i},BJ={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^j[aä]/i,/^f/i,/^mär/i,/^ap/i,/^mai/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},UJ={narrow:/^[smdmf]/i,short:/^(so|mo|di|mi|do|fr|sa)/i,abbreviated:/^(son?|mon?|die?|mit?|don?|fre?|sam?)\.?/i,wide:/^(sonntag|montag|dienstag|mittwoch|donnerstag|freitag|samstag)/i},zJ={any:[/^so/i,/^mo/i,/^di/i,/^mi/i,/^do/i,/^f/i,/^sa/i]},qJ={narrow:/^(vm\.?|nm\.?|Mitternacht|Mittag|morgens|nachm\.?|abends|nachts)/i,abbreviated:/^(vorm\.?|nachm\.?|Mitternacht|Mittag|morgens|nachm\.?|abends|nachts)/i,wide:/^(vormittags|nachmittags|Mitternacht|Mittag|morgens|nachmittags|abends|nachts)/i},$J={any:{am:/^v/i,pm:/^n/i,midnight:/^Mitte/i,noon:/^Mitta/i,morning:/morgens/i,afternoon:/nachmittags/i,evening:/abends/i,night:/nachts/i}},WJ={ordinalNumber:gP({matchPattern:RJ,parsePattern:DJ,valueCallback:t=>parseInt(t)}),era:eo({matchPatterns:LJ,defaultMatchWidth:"wide",parsePatterns:OJ,defaultParseWidth:"any"}),quarter:eo({matchPatterns:MJ,defaultMatchWidth:"wide",parsePatterns:FJ,defaultParseWidth:"any",valueCallback:t=>t+1}),month:eo({matchPatterns:VJ,defaultMatchWidth:"wide",parsePatterns:BJ,defaultParseWidth:"any"}),day:eo({matchPatterns:UJ,defaultMatchWidth:"wide",parsePatterns:zJ,defaultParseWidth:"any"}),dayPeriod:eo({matchPatterns:qJ,defaultMatchWidth:"wide",parsePatterns:$J,defaultParseWidth:"any"})},Ss={code:"de",formatDistance:xJ,formatLong:NJ,formatRelative:jJ,localize:PJ,match:WJ,options:{weekStartsOn:1,firstWeekContainsDate:4}},HJ=()=>{const[t,e]=M.useState([]),[r,n]=M.useState(null),[s,i]=M.useState(!0),[o,l]=M.useState(null),[c,u]=M.useState({}),[d,h]=M.useState(!1),g={pending:"bg-royal-gold/20 text-royal-gold border border-royal-gold/30",confirmed:"bg-royal-purple/20 text-royal-purple-light border border-royal-purple/30",preparing:"bg-royal-burgundy/20 text-royal-burgundy-light border border-royal-burgundy/30",ready:"bg-green-600/20 text-green-500 border border-green-600/30",delivered:"bg-royal-charcoal/20 text-royal-cream border border-royal-charcoal/30",cancelled:"bg-red-600/20 text-red-500 border border-red-600/30"},m={pending:Rr,confirmed:Qu,preparing:Nr,ready:xr,delivered:xr,cancelled:gl};M.useEffect(()=>{w(),_()},[c]);const w=async()=>{try{console.log("🔄 Loading orders with filters:",c),i(!0);const F=await ls.getOrdersWithFilters(c);console.log("✅ Orders loaded successfully:",F.length,"orders"),e(F)}catch(F){console.error("❌ Error loading orders:",F),_t.error("Fehler beim Laden der Bestellungen: "+(F instanceof Error?F.message:String(F)))}finally{i(!1)}},_=async()=>{try{const F=await ls.getOrderStats();n(F)}catch(F){console.error("Error loading stats:",F)}},T=async(F,$)=>{try{await ls.updateOrderStatus(F,$),_t.success("Bestellstatus erfolgreich aktualisiert"),w(),_()}catch(k){console.error("Error updating order status:",k),_t.error("Fehler beim Aktualisieren des Bestellstatus")}},v=async F=>{if(confirm("Sind Sie sicher, dass Sie diese Bestellung löschen möchten?"))try{await ls.deleteOrder(F),_t.success("Bestellung erfolgreich gelöscht"),w(),_()}catch($){console.error("Error deleting order:",$),_t.error("Fehler beim Löschen der Bestellung")}},b=F=>F.items.reduce(($,k)=>$+k.quantity,0),x=F=>({pending:"Ausstehend",confirmed:"Bestätigt",preparing:"In Zubereitung",ready:"Bereit",delivered:"Ausgeliefert",cancelled:"Storniert"})[F],P=async F=>{try{await ls.verifyLoyaltyDiscount(F),console.log("Loyalty Rabatt bestätigt"),w(),_()}catch($){console.error("Error verifying loyalty discount:",$),alert("Fehler beim Bestätigen des Loyalty Rabatts")}};return s&&t.length===0?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-royal-gold"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-royal font-bold text-royal-charcoal",children:"Bestellverwaltung"}),a.jsx("p",{className:"text-royal-charcoal/70",children:"Verwalten Sie alle Kundenbestellungen und deren Status"})]}),a.jsxs("button",{onClick:w,className:"bg-royal-gradient-gold text-royal-charcoal px-4 py-2 rounded-royal royal-glow hover:shadow-lg transition-all duration-300 flex items-center space-x-2",children:[a.jsx(Nr,{className:"w-4 h-4"}),a.jsx("span",{children:"Aktualisieren"})]})]}),r&&a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-royal-charcoal-dark p-4 rounded-royal shadow-md border border-royal-gold/30 royal-glow",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-royal-cream/70",children:"Gesamtbestellungen"}),a.jsx("p",{className:"text-2xl font-bold text-royal-cream",children:r.totalOrders})]}),a.jsx(Qu,{className:"w-8 h-8 text-royal-gold"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-royal-charcoal-dark p-4 rounded-royal shadow-md border border-royal-gold/30 royal-glow",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-royal-cream/70",children:"Ausstehend"}),a.jsx("p",{className:"text-2xl font-bold text-royal-gold",children:r.pendingOrders})]}),a.jsx(Rr,{className:"w-8 h-8 text-royal-gold"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-royal-charcoal-dark p-4 rounded-royal shadow-md border border-royal-gold/30 royal-glow",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-royal-cream/70",children:"Gesamtumsatz"}),a.jsxs("p",{className:"text-2xl font-bold text-royal-gold",children:[r.totalRevenue.toFixed(2),"€"]})]}),a.jsx(Lh,{className:"w-8 h-8 text-royal-gold"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-royal-charcoal-dark p-4 rounded-royal shadow-md border border-royal-gold/30 royal-glow",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-royal-cream/70",children:"Ø Bestellwert"}),a.jsxs("p",{className:"text-2xl font-bold text-royal-cream",children:[r.averageOrderValue.toFixed(2),"€"]})]}),a.jsx(pl,{className:"w-8 h-8 text-royal-gold"})]})})]}),a.jsxs("div",{className:"bg-royal-charcoal-dark p-4 rounded-royal shadow-md border border-royal-gold/30 royal-glow",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-royal-cream",children:"Filter"}),a.jsxs("button",{onClick:()=>h(!d),className:"flex items-center space-x-2 text-royal-gold hover:text-royal-gold/80",children:[a.jsx(Uy,{className:"w-4 h-4"}),a.jsx("span",{children:d?"Filter ausblenden":"Filter anzeigen"})]})]}),d&&a.jsxs(oe.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-2",children:"Status"}),a.jsxs("select",{value:c.status||"",onChange:F=>u({...c,status:F.target.value||void 0}),className:"w-full p-2 border border-royal-gold/30 rounded-royal focus:outline-none focus:ring-2 focus:ring-royal-gold/50 bg-royal-charcoal text-royal-cream",children:[a.jsx("option",{value:"",children:"Alle Status"}),a.jsx("option",{value:"pending",children:"Ausstehend"}),a.jsx("option",{value:"confirmed",children:"Bestätigt"}),a.jsx("option",{value:"preparing",children:"In Zubereitung"}),a.jsx("option",{value:"ready",children:"Bereit"}),a.jsx("option",{value:"delivered",children:"Ausgeliefert"}),a.jsx("option",{value:"cancelled",children:"Storniert"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-2",children:"Tischnummer"}),a.jsx("input",{type:"number",value:c.tableNumber||"",onChange:F=>u({...c,tableNumber:parseInt(F.target.value)||void 0}),placeholder:"Alle Tische",className:"w-full p-2 border border-royal-gold/30 rounded-royal focus:outline-none focus:ring-2 focus:ring-royal-gold/50 bg-royal-charcoal text-royal-cream"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-2",children:"Suche"}),a.jsx("input",{type:"text",value:c.search||"",onChange:F=>u({...c,search:F.target.value}),placeholder:"Kunde, Artikel, etc.",className:"w-full p-2 border border-royal-gold/30 rounded-royal focus:outline-none focus:ring-2 focus:ring-royal-gold/50 bg-royal-charcoal text-royal-cream"})]})]})]}),a.jsxs("div",{className:"bg-royal-charcoal-dark rounded-royal shadow-md border border-royal-gold/30 overflow-hidden royal-glow",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-royal-gradient-gold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-royal-charcoal font-semibold",children:"Bestellung"}),a.jsx("th",{className:"px-4 py-3 text-left text-royal-charcoal font-semibold",children:"Tisch"}),a.jsx("th",{className:"px-4 py-3 text-left text-royal-charcoal font-semibold",children:"Kunde"}),a.jsx("th",{className:"px-4 py-3 text-left text-royal-charcoal font-semibold",children:"Artikel"}),a.jsx("th",{className:"px-4 py-3 text-left text-royal-charcoal font-semibold",children:"Gesamt"}),a.jsx("th",{className:"px-4 py-3 text-left text-royal-charcoal font-semibold",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-royal-charcoal font-semibold",children:"Datum"}),a.jsx("th",{className:"px-4 py-3 text-left text-royal-charcoal font-semibold",children:"Aktionen"})]})}),a.jsx("tbody",{className:"divide-y divide-royal-gold/20",children:t.map(F=>{const $=m[F.status];return a.jsxs(oe.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-royal-charcoal/5 transition-colors",children:[a.jsx("td",{className:"px-4 py-3",children:a.jsxs("span",{className:"font-mono text-sm text-royal-cream/70",children:["#",F.id.slice(-8)]})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("span",{className:"bg-royal-gold/20 text-royal-gold px-2 py-1 rounded-full text-sm font-semibold",children:["Tisch ",F.tableNumber]})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-royal-cream",children:F.customerName||"Anonym"}),F.customerPhone&&a.jsx("p",{className:"text-sm text-royal-cream/70",children:F.customerPhone})]})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"text-sm text-royal-cream/70",children:[a.jsxs("p",{children:[b(F)," Artikel"]}),a.jsxs("p",{className:"text-xs",children:[F.items.slice(0,2).map(k=>k.name).join(", "),F.items.length>2&&"..."]})]})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("span",{className:"font-bold text-royal-gold",children:[F.totalAmount.toFixed(2),"€"]}),F.loyaltyDiscount&&a.jsxs("div",{className:"flex items-center space-x-1 bg-royal-purple text-white px-2 py-1 rounded-full text-xs",children:[a.jsx(Et,{className:"w-3 h-3"}),a.jsxs("span",{children:["-",F.loyaltyDiscount.amount.toFixed(2),"€"]})]})]})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${g[F.status]}`,children:[a.jsx($,{className:"w-3 h-3 mr-1"}),x(F.status)]})}),a.jsx("td",{className:"px-4 py-3 text-sm text-royal-cream/70",children:Lr(F.createdAt,"dd.MM.yyyy HH:mm",{locale:Ss})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>l(F),className:"p-1 hover:bg-royal-gold/20 rounded transition-colors",title:"Details anzeigen",children:a.jsx(Ca,{className:"w-4 h-4 text-royal-gold"})}),a.jsxs("select",{value:F.status,onChange:k=>T(F.id,k.target.value),className:"text-xs border border-royal-gold/30 rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-royal-gold/50 bg-royal-charcoal text-royal-cream",children:[a.jsx("option",{value:"pending",children:"Ausstehend"}),a.jsx("option",{value:"confirmed",children:"Bestätigt"}),a.jsx("option",{value:"preparing",children:"In Zubereitung"}),a.jsx("option",{value:"ready",children:"Bereit"}),a.jsx("option",{value:"delivered",children:"Ausgeliefert"}),a.jsx("option",{value:"cancelled",children:"Storniert"})]}),a.jsx("button",{onClick:()=>v(F.id),className:"p-1 hover:bg-red-100 rounded transition-colors",title:"Bestellung löschen",children:a.jsx(Qs,{className:"w-4 h-4 text-red-500"})})]})})]},F.id)})})]})}),t.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Qu,{className:"w-16 h-16 mx-auto text-royal-cream/30 mb-4"}),a.jsx("p",{className:"text-royal-cream/70",children:"Keine Bestellungen gefunden"})]})]}),o&&a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>l(null)}),a.jsxs("div",{className:"relative bg-white rounded-royal shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"bg-royal-gradient-gold p-4 flex items-center justify-between",children:[a.jsxs("h3",{className:"text-xl font-royal font-bold text-royal-charcoal",children:["Bestelldetails #",o.id.slice(-8)]}),a.jsx("button",{onClick:()=>l(null),className:"p-2 hover:bg-royal-charcoal/20 rounded-full transition-colors",children:a.jsx(gl,{className:"w-5 h-5 text-royal-charcoal"})})]}),a.jsxs("div",{className:"p-6 space-y-4 max-h-[60vh] overflow-y-auto",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-royal-charcoal/70",children:"Tischnummer"}),a.jsxs("p",{className:"font-semibold text-royal-charcoal",children:["Tisch ",o.tableNumber]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-royal-charcoal/70",children:"Status"}),a.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${g[o.status]}`,children:x(o.status)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-royal-charcoal/70",children:"Kunde"}),a.jsx("p",{className:"font-semibold text-royal-charcoal",children:o.customerName||"Anonym"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-royal-charcoal/70",children:"Telefon"}),a.jsx("p",{className:"font-semibold text-royal-charcoal",children:o.customerPhone||"Nicht angegeben"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-royal-charcoal/70",children:"Bestelldatum"}),a.jsx("p",{className:"font-semibold text-royal-charcoal",children:Lr(o.createdAt,"dd.MM.yyyy HH:mm",{locale:Ss})})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-royal-charcoal/70",children:"Gesamtbetrag"}),a.jsxs("p",{className:"font-bold text-royal-gold text-lg",children:[o.totalAmount.toFixed(2),"€"]})]})]}),o.loyaltyDiscount&&a.jsxs("div",{className:"bg-royal-purple/10 rounded-royal p-4 border border-royal-purple/30",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Et,{className:"w-5 h-5 text-royal-purple"}),a.jsx("span",{className:"font-medium text-royal-purple",children:"Loyalty Rabatt angewendet"})]}),a.jsxs("div",{className:"flex items-center space-x-1 bg-royal-purple text-white px-2 py-1 rounded-full text-xs",children:[a.jsx(Ki,{className:"w-3 h-3"}),a.jsx("span",{children:"Loyalty Order"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-purple/70",children:"Rabattbetrag"}),a.jsxs("p",{className:"font-bold text-royal-purple",children:["-",o.loyaltyDiscount.amount.toFixed(2),"€"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-purple/70",children:"Gratis Shishas"}),a.jsxs("p",{className:"font-bold text-royal-purple",children:[o.loyaltyDiscount.freeShishasRedeemed,"x"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-purple/70",children:"Kunde"}),a.jsx("p",{className:"font-bold text-royal-purple",children:o.loyaltyDiscount.customerPhone})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-purple/70",children:"Bestätigt"}),a.jsx("p",{className:`font-bold ${o.loyaltyDiscount.isVerified?"text-green-600":"text-red-600"}`,children:o.loyaltyDiscount.isVerified?"✅ Ja":"❌ Nein"})]})]}),a.jsxs("div",{className:"mt-3 bg-royal-purple/5 rounded-royal p-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(_n,{className:"w-4 h-4 text-royal-purple"}),a.jsx("span",{className:"text-sm font-medium text-royal-purple",children:"Bestätigungscode:"})]}),!o.loyaltyDiscount.isVerified&&a.jsx("button",{onClick:()=>P(o.id),className:"px-3 py-1 bg-royal-purple text-white rounded-royal text-xs hover:bg-royal-purple-light",children:"Bestätigen"})]}),a.jsx("div",{className:"mt-2 text-center",children:a.jsx("span",{className:"text-lg font-bold text-royal-purple bg-white px-3 py-1 rounded border-2 border-royal-purple font-mono",children:o.loyaltyDiscount.verificationCode})})]})]}),o.specialInstructions&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-royal-charcoal/70 mb-2",children:"Spezielle Anweisungen"}),a.jsx("p",{className:"bg-royal-gold/10 p-3 rounded-royal text-royal-charcoal",children:o.specialInstructions})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-royal-charcoal/70 mb-3",children:"Bestellte Artikel"}),a.jsx("div",{className:"space-y-2",children:o.items.map(F=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-royal-charcoal/5 rounded-royal",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("p",{className:"font-semibold text-royal-charcoal",children:F.name}),o.loyaltyDiscount&&(F.category.toLowerCase()==="shisha"||F.category.toLowerCase()==="tobacco")&&a.jsxs("div",{className:"flex items-center space-x-1 bg-royal-purple text-white px-2 py-1 rounded-full text-xs",children:[a.jsx(Et,{className:"w-3 h-3"}),a.jsx("span",{children:"Loyalty"})]})]}),a.jsx("p",{className:"text-sm text-royal-charcoal/70",children:F.category}),F.specialInstructions&&a.jsxs("p",{className:"text-xs text-royal-gold mt-1",children:["Anweisung: ",F.specialInstructions]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-semibold text-royal-charcoal",children:[F.quantity,"x ",F.price.toFixed(2),"€"]}),a.jsxs("p",{className:"font-bold text-royal-gold",children:[(F.price*F.quantity).toFixed(2),"€"]})]})]},F.id))})]})]})]})]})]})},GJ=()=>{const[t,e]=M.useState([]),[r,n]=M.useState(!1),[s,i]=M.useState(!1),[o,l]=M.useState(null),[c,u]=M.useState({title:"",message:"",type:"info",startDate:"",endDate:"",displayDuration:10,targetAudience:"all",priority:1});M.useEffect(()=>{d()},[]);const d=async()=>{try{n(!0);const x=await Xa.getPopups();e(x)}catch(x){Ee.error("Failed to load popups"),console.error("Error loading popups:",x)}finally{n(!1)}},h=async x=>{x.preventDefault();try{o?(await Xa.updateAdminPopup(o.id,c),Ee.success("Popup updated successfully")):(await Xa.createAdminPopup(c),Ee.success("Popup created successfully")),i(!1),l(null),_(),d()}catch(P){Ee.error("Failed to save popup"),console.error("Error saving popup:",P)}},g=x=>{l(x),u({title:x.title,message:x.message,type:x.type==="promotion"?"promo":x.type==="alert"?"announcement":x.type,startDate:x.createdAt.toISOString().slice(0,16),endDate:x.expiresAt?x.expiresAt.toISOString().slice(0,16):"",displayDuration:10,targetAudience:"all",priority:x.priority}),i(!0)},m=async x=>{if(window.confirm("Are you sure you want to delete this popup?"))try{await Xa.deletePopup(x),Ee.success("Popup deleted successfully"),d()}catch(P){Ee.error("Failed to delete popup"),console.error("Error deleting popup:",P)}},w=async(x,P)=>{try{await Xa.updatePopup(x,{isActive:!P}),Ee.success(`Popup ${P?"deactivated":"activated"} successfully`),d()}catch(F){Ee.error("Failed to update popup status"),console.error("Error updating popup status:",F)}},_=()=>{u({title:"",message:"",type:"info",startDate:"",endDate:"",displayDuration:10,targetAudience:"all",priority:1})},T=x=>{switch(x){case"promotion":return"bg-green-500/20 text-green-400 border-green-500/30";case"event":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"alert":return"bg-red-500/20 text-red-400 border-red-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}},v=x=>{switch(x){case"promotion":return"🏷️";case"event":return"📅";case"alert":return"📢";default:return"ℹ️"}},b=x=>{switch(x){case"promotion":return"Promotion";case"event":return"Event";case"alert":return"Announcement";default:return"Info"}};return r?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-royal-gold"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-royal-cream mb-2",children:"Popup Management"}),a.jsx("p",{className:"text-royal-cream-light",children:"Manage custom popup messages and notifications"})]}),a.jsxs("button",{onClick:()=>{i(!0),l(null),_()},className:"flex items-center space-x-2 bg-royal-gold text-royal-charcoal px-4 py-2 rounded-lg hover:bg-royal-gold-dark transition-colors",children:[a.jsx(Ai,{className:"w-4 h-4"}),a.jsx("span",{children:"New Popup"})]})]}),s&&a.jsxs(oe.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-royal-cream",children:o?"Edit Popup":"Create New Popup"}),a.jsx("button",{onClick:()=>{i(!1),l(null),_()},className:"text-royal-cream-light hover:text-royal-gold",children:a.jsx(Zi,{className:"w-5 h-5"})})]}),a.jsxs("form",{onSubmit:h,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-2",children:"Title"}),a.jsx("input",{type:"text",value:c.title,onChange:x=>u({...c,title:x.target.value}),className:"w-full bg-royal-charcoal-light border border-royal-gold/20 rounded-lg px-3 py-2 text-royal-cream focus:border-royal-gold focus:outline-none",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-2",children:"Type"}),a.jsxs("select",{value:c.type,onChange:x=>u({...c,type:x.target.value}),className:"w-full bg-royal-charcoal-light border border-royal-gold/20 rounded-lg px-3 py-2 text-royal-cream focus:border-royal-gold focus:outline-none",children:[a.jsx("option",{value:"info",children:"Info"}),a.jsx("option",{value:"promo",children:"Promotion"}),a.jsx("option",{value:"event",children:"Event"}),a.jsx("option",{value:"announcement",children:"Announcement"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-2",children:"Message"}),a.jsx("textarea",{value:c.message,onChange:x=>u({...c,message:x.target.value}),rows:3,className:"w-full bg-royal-charcoal-light border border-royal-gold/20 rounded-lg px-3 py-2 text-royal-cream focus:border-royal-gold focus:outline-none",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-2",children:"Start Date"}),a.jsx("input",{type:"datetime-local",value:c.startDate,onChange:x=>u({...c,startDate:x.target.value}),className:"w-full bg-royal-charcoal-light border border-royal-gold/20 rounded-lg px-3 py-2 text-royal-cream focus:border-royal-gold focus:outline-none",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-2",children:"End Date"}),a.jsx("input",{type:"datetime-local",value:c.endDate,onChange:x=>u({...c,endDate:x.target.value}),className:"w-full bg-royal-charcoal-light border border-royal-gold/20 rounded-lg px-3 py-2 text-royal-cream focus:border-royal-gold focus:outline-none",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-2",children:"Display Duration (seconds)"}),a.jsx("input",{type:"number",value:c.displayDuration,onChange:x=>u({...c,displayDuration:parseInt(x.target.value)}),min:"1",max:"60",className:"w-full bg-royal-charcoal-light border border-royal-gold/20 rounded-lg px-3 py-2 text-royal-cream focus:border-royal-gold focus:outline-none",required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-2",children:"Target Audience"}),a.jsxs("select",{value:c.targetAudience,onChange:x=>u({...c,targetAudience:x.target.value}),className:"w-full bg-royal-charcoal-light border border-royal-gold/20 rounded-lg px-3 py-2 text-royal-cream focus:border-royal-gold focus:outline-none",children:[a.jsx("option",{value:"all",children:"All Users"}),a.jsx("option",{value:"new",children:"New Users Only"}),a.jsx("option",{value:"returning",children:"Returning Users Only"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-2",children:"Priority"}),a.jsx("input",{type:"number",value:c.priority,onChange:x=>u({...c,priority:parseInt(x.target.value)}),min:"1",max:"10",className:"w-full bg-royal-charcoal-light border border-royal-gold/20 rounded-lg px-3 py-2 text-royal-cream focus:border-royal-gold focus:outline-none",required:!0})]})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{i(!1),l(null),_()},className:"px-4 py-2 text-royal-cream-light hover:text-royal-cream transition-colors",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"flex items-center space-x-2 bg-royal-gold text-royal-charcoal px-4 py-2 rounded-lg hover:bg-royal-gold-dark transition-colors",children:[a.jsx(jN,{className:"w-4 h-4"}),a.jsx("span",{children:o?"Update":"Create"})]})]})]})]}),a.jsx("div",{className:"space-y-4",children:t.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(oP,{className:"w-16 h-16 text-royal-charcoal/30 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-royal-cream mb-2",children:"No Popups Yet"}),a.jsx("p",{className:"text-royal-cream-light mb-4",children:"Create your first popup to start engaging with your customers"}),a.jsxs("button",{onClick:()=>{i(!0),l(null),_()},className:"flex items-center space-x-2 bg-royal-gold text-royal-charcoal px-4 py-2 rounded-lg hover:bg-royal-gold-dark transition-colors mx-auto",children:[a.jsx(Ai,{className:"w-4 h-4"}),a.jsx("span",{children:"Create First Popup"})]})]}):t.map(x=>a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20 hover:border-royal-gold/40 transition-colors",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[a.jsx("span",{className:"text-2xl",children:v(x.type)}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-royal-cream",children:x.title}),a.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded-full border ${T(x.type)}`,children:b(x.type)})]})]}),a.jsx("p",{className:"text-royal-cream-light mb-4 line-clamp-2",children:x.message}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Un,{className:"w-4 h-4 text-royal-gold"}),a.jsx("span",{className:"text-royal-cream-light",children:x.createdAt.toLocaleDateString()})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Rr,{className:"w-4 h-4 text-royal-gold"}),a.jsx("span",{className:"text-royal-cream-light",children:x.expiresAt?x.expiresAt.toLocaleDateString():"No expiry"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(dP,{className:"w-4 h-4 text-royal-gold"}),a.jsx("span",{className:"text-royal-cream-light",children:"All Users"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Yc,{className:"w-4 h-4 text-royal-gold"}),a.jsxs("span",{className:"text-royal-cream-light",children:["Priority: ",x.priority]})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[a.jsx("button",{onClick:()=>w(x.id,x.isActive),className:`p-2 rounded-lg transition-colors ${x.isActive?"bg-green-500/20 text-green-400 hover:bg-green-500/30":"bg-gray-500/20 text-gray-400 hover:bg-gray-500/30"}`,title:x.isActive?"Deactivate":"Activate",children:x.isActive?a.jsx(Ca,{className:"w-4 h-4"}):a.jsx(Gp,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>g(x),className:"p-2 bg-blue-500/20 text-blue-400 rounded-lg hover:bg-blue-500/30 transition-colors",title:"Edit",children:a.jsx(Kp,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>m(x.id),className:"p-2 bg-red-500/20 text-red-400 rounded-lg hover:bg-red-500/30 transition-colors",title:"Delete",children:a.jsx(Qs,{className:"w-4 h-4"})})]})]})},x.id))})]})},Zl="reservations",Zg="tables",D3="timeSlots";class Qr{static async createReservation(e,r){try{const n=Ce(),s=qe(Be(n,Zl),Je("userId","==",r),Je("status","in",["pending","confirmed"]));if((await st(s)).size>=2)throw new Error("Sie können maximal 2 aktive Reservierungen haben. Bitte stornieren Sie eine bestehende Reservierung oder warten Sie, bis eine abgeschlossen ist.");const o=await os(ot(n,Zg,e.tableId));if(!o.exists())throw new Error("Table not found");const l={id:o.id,...o.data()};if(!await this.checkTableAvailability(e.tableId,new Date(e.date),e.timeSlot))throw new Error("Table is no longer available for the selected time");const u=0,d={tableId:e.tableId,tableNumber:l.number,userId:r,customerName:e.customerName,customerEmail:e.customerEmail,customerPhone:e.customerPhone,date:yt.fromDate(new Date(e.date)),timeSlot:e.timeSlot,startTime:e.timeSlot.split("-")[0],endTime:e.timeSlot.split("-")[1],partySize:e.partySize,status:"pending",specialRequests:e.specialRequests,totalAmount:u,preOrderItems:e.preOrderItems||[],createdAt:yt.now(),updatedAt:yt.now()},h=await xo(Be(n,Zl),d);return console.log("Reservation created:",h.id),h.id}catch(n){throw console.error("Error creating reservation:",n),n}}static async getReservations(e){try{const r=Ce();let n=qe(Be(r,Zl),Vt("date","desc"));if(e!=null&&e.status&&(n=qe(n,Je("status","==",e.status))),e!=null&&e.date){const o=new Date(e.date);o.setHours(0,0,0,0);const l=new Date(e.date);l.setHours(23,59,59,999),n=qe(n,Je("date",">=",yt.fromDate(o)),Je("date","<=",yt.fromDate(l)))}e!=null&&e.tableNumber&&(n=qe(n,Je("tableNumber","==",e.tableNumber)));let i=(await st(n)).docs.map(o=>{var c,u,d,h,g,m;const l=o.data();return{id:o.id,...l,date:((c=l.date)==null?void 0:c.toDate())||new Date,createdAt:((u=l.createdAt)==null?void 0:u.toDate())||new Date,updatedAt:((d=l.updatedAt)==null?void 0:d.toDate())||new Date,confirmedAt:(h=l.confirmedAt)==null?void 0:h.toDate(),cancelledAt:(g=l.cancelledAt)==null?void 0:g.toDate(),noShowAt:(m=l.noShowAt)==null?void 0:m.toDate()}});if(e!=null&&e.customerName){const o=e.customerName.toLowerCase();i=i.filter(l=>l.customerName.toLowerCase().includes(o))}return e!=null&&e.partySize&&(i=i.filter(o=>o.partySize===e.partySize)),e!=null&&e.dateRange&&(i=i.filter(o=>o.date>=e.dateRange.start&&o.date<=e.dateRange.end)),i}catch(r){throw console.error("Error getting reservations:",r),r}}static async getUserReservations(e){try{const r=Ce(),n=qe(Be(r,Zl),Je("userId","==",e),Vt("date","desc"));return(await st(n)).docs.map(i=>{var l,c,u,d,h,g;const o=i.data();return{id:i.id,...o,date:((l=o.date)==null?void 0:l.toDate())||new Date,createdAt:((c=o.createdAt)==null?void 0:c.toDate())||new Date,updatedAt:((u=o.updatedAt)==null?void 0:u.toDate())||new Date,confirmedAt:(d=o.confirmedAt)==null?void 0:d.toDate(),cancelledAt:(h=o.cancelledAt)==null?void 0:h.toDate(),noShowAt:(g=o.noShowAt)==null?void 0:g.toDate()}})}catch(r){throw console.error("Error getting user reservations:",r),r}}static async updateReservationStatus(e,r,n){try{const s=Ce(),i={status:r,updatedAt:yt.now()};n&&(i.notes=n),r==="confirmed"?i.confirmedAt=yt.now():r==="cancelled"?i.cancelledAt=yt.now():r==="no_show"?i.noShowAt=yt.now():r==="completed"&&(i.completedAt=yt.now()),await Qt(ot(s,Zl,e),i)}catch(s){throw console.error("Error updating reservation status:",s),s}}static async cancelReservation(e,r){try{await this.updateReservationStatus(e,"cancelled",r)}catch(n){throw console.error("Error cancelling reservation:",n),n}}static async checkTableAvailability(e,r,n){try{const s=Ce(),i=qe(Be(s,Zl),Je("tableId","==",e),Je("timeSlot","==",n),Je("status","in",["pending","confirmed","seated"])),o=await st(i),l=new Date(r);l.setHours(0,0,0,0);const c=new Date(r);c.setHours(23,59,59,999);const u=o.docs.filter(d=>{var m;const g=((m=d.data().date)==null?void 0:m.toDate())||new Date;return g>=l&&g<=c});return console.log(`✅ Table ${e} availability check:`,{tableId:e,timeSlot:n,date:r.toDateString(),totalReservations:o.docs.length,conflictingReservations:u.length,isAvailable:u.length===0}),u.length===0}catch(s){return console.error("Error checking table availability:",s),!1}}static async getAvailableTables(e){try{const r=Ce(),n=qe(Be(r,Zg),Je("isActive","==",!0),Je("capacity",">=",e.partySize)),i=(await st(n)).docs.map(d=>({id:d.id,...d.data()}));let o=e.preferredLocation?i.filter(d=>d.location===e.preferredLocation):i;const l=e.timeSlot.split("-")[1],c=parseInt(l.split(":")[0]);o=o.filter(d=>d.location==="outdoor"&&(c>22||c<6)?(console.log(`Excluding outdoor table ${d.number} - Außenbereich closes at 22:00 (slot ends at ${l})`),!1):!0),console.log(`Available tables after outdoor hours filter: ${o.length} (slot: ${e.timeSlot})`);const u=[];for(const d of o){const h=await this.checkTableAvailability(d.id,e.date,e.timeSlot),g=0;u.push({table:d,timeSlot:e.timeSlot,available:h,price:g})}return u.sort((d,h)=>d.table.number-h.table.number)}catch(r){throw console.error("Error getting available tables:",r),r}}static async getReservationStats(){try{const e=await this.getReservations(),r=new Date;r.setHours(0,0,0,0);const n=new Date(r);n.setDate(n.getDate()+1);const s=e.filter(v=>v.date>=r&&v.date<n),i=e.filter(v=>v.date>=r&&["pending","confirmed"].includes(v.status)),o=e.filter(v=>v.status==="confirmed"),l=e.filter(v=>v.status==="pending"),c=e.filter(v=>v.status==="cancelled"),u=e.filter(v=>v.status==="no_show"),d=e.length>0?u.length/e.length*100:0,h=e.length>0?e.reduce((v,b)=>v+b.partySize,0)/e.length:0,g=e.reduce((v,b)=>(v[b.timeSlot]=(v[b.timeSlot]||0)+1,v),{}),m=Object.entries(g).map(([v,b])=>({slot:v,count:b})).sort((v,b)=>b.count-v.count).slice(0,5),_=e.reduce((v,b)=>{const x=v.find(P=>P.tableNumber===b.tableNumber);return x?x.count++:v.push({tableNumber:b.tableNumber,count:1}),v},[]).map(v=>({tableNumber:v.tableNumber,utilizationRate:v.count/e.length*100})),T=e.filter(v=>v.status==="completed").reduce((v,b)=>v+(b.totalAmount||0),0);return{totalReservations:e.length,todayReservations:s.length,upcomingReservations:i.length,confirmedReservations:o.length,pendingReservations:l.length,cancelledReservations:c.length,noShowRate:Math.round(d*10)/10,averagePartySize:Math.round(h*10)/10,popularTimeSlots:m,tableUtilization:_,revenue:T,occupancyRate:e.length>0?o.length/e.length*100:0}}catch(e){throw console.error("Error getting reservation stats:",e),e}}static onReservationsChange(e,r){const n=Ce();let s=qe(Be(n,Zl),Vt("date","desc"));return r!=null&&r.status&&(s=qe(s,Je("status","==",r.status))),wi(s,o=>{const l=o.docs.map(c=>{var d,h,g,m,w,_;const u=c.data();return{id:c.id,...u,date:((d=u.date)==null?void 0:d.toDate())||new Date,createdAt:((h=u.createdAt)==null?void 0:h.toDate())||new Date,updatedAt:((g=u.updatedAt)==null?void 0:g.toDate())||new Date,confirmedAt:(m=u.confirmedAt)==null?void 0:m.toDate(),cancelledAt:(w=u.cancelledAt)==null?void 0:w.toDate(),noShowAt:(_=u.noShowAt)==null?void 0:_.toDate()}});e(l)})}static async initializeSampleTables(){try{const e=Ce(),r=lb(e);[{number:1,capacity:2,location:"indoor",amenities:["smoking_area"],isActive:!0,priceMultiplier:1},{number:2,capacity:2,location:"indoor",amenities:["smoking_area"],isActive:!0,priceMultiplier:1},{number:3,capacity:2,location:"indoor",amenities:["smoking_area"],isActive:!0,priceMultiplier:1},{number:4,capacity:2,location:"indoor",amenities:["smoking_area"],isActive:!0,priceMultiplier:1},{number:5,capacity:2,location:"indoor",amenities:["smoking_area"],isActive:!0,priceMultiplier:1},{number:6,capacity:2,location:"indoor",amenities:["smoking_area"],isActive:!0,priceMultiplier:1},{number:7,capacity:2,location:"indoor",amenities:["smoking_area"],isActive:!0,priceMultiplier:1},{number:8,capacity:2,location:"indoor",amenities:["smoking_area"],isActive:!0,priceMultiplier:1},{number:9,capacity:4,location:"indoor",amenities:["smoking_area"],isActive:!0,priceMultiplier:1},{number:10,capacity:4,location:"indoor",amenities:["smoking_area"],isActive:!0,priceMultiplier:1},{number:11,capacity:4,location:"indoor",amenities:["smoking_area"],isActive:!0,priceMultiplier:1},{number:12,capacity:4,location:"indoor",amenities:["smoking_area"],isActive:!0,priceMultiplier:1},{number:13,capacity:4,location:"indoor",amenities:["smoking_area"],isActive:!0,priceMultiplier:1},{number:14,capacity:4,location:"indoor",amenities:["smoking_area"],isActive:!0,priceMultiplier:1},{number:15,capacity:4,location:"indoor",amenities:["smoking_area"],isActive:!0,priceMultiplier:1},{number:16,capacity:4,location:"indoor",amenities:["smoking_area"],isActive:!0,priceMultiplier:1},{number:17,capacity:6,location:"indoor",amenities:["smoking_area","private"],isActive:!0,priceMultiplier:1.1},{number:18,capacity:6,location:"indoor",amenities:["smoking_area","private"],isActive:!0,priceMultiplier:1.1},{number:19,capacity:6,location:"indoor",amenities:["smoking_area","private"],isActive:!0,priceMultiplier:1.1},{number:20,capacity:8,location:"vip",amenities:["smoking_area","private","bar_access"],isActive:!0,priceMultiplier:1.3},{number:21,capacity:2,location:"outdoor",amenities:["smoking_area","fresh_air"],isActive:!0,priceMultiplier:1.1},{number:22,capacity:2,location:"outdoor",amenities:["smoking_area","fresh_air"],isActive:!0,priceMultiplier:1.1},{number:23,capacity:2,location:"outdoor",amenities:["smoking_area","fresh_air"],isActive:!0,priceMultiplier:1.1},{number:24,capacity:2,location:"outdoor",amenities:["smoking_area","fresh_air"],isActive:!0,priceMultiplier:1.1},{number:25,capacity:4,location:"outdoor",amenities:["smoking_area","fresh_air"],isActive:!0,priceMultiplier:1.1},{number:26,capacity:4,location:"outdoor",amenities:["smoking_area","fresh_air"],isActive:!0,priceMultiplier:1.1},{number:27,capacity:4,location:"outdoor",amenities:["smoking_area","fresh_air"],isActive:!0,priceMultiplier:1.1},{number:28,capacity:4,location:"outdoor",amenities:["smoking_area","fresh_air"],isActive:!0,priceMultiplier:1.1},{number:29,capacity:6,location:"outdoor",amenities:["smoking_area","fresh_air","view"],isActive:!0,priceMultiplier:1.2},{number:30,capacity:6,location:"outdoor",amenities:["smoking_area","fresh_air","view"],isActive:!0,priceMultiplier:1.2}].forEach(s=>{const i=ot(Be(e,Zg));r.set(i,s)}),await r.commit(),console.log("Sample tables initialized")}catch(e){throw console.error("Error initializing sample tables:",e),e}}static async initializeSampleTimeSlots(){try{const e=Ce(),r=lb(e);[{startTime:"16:00",endTime:"18:00",duration:120,isActive:!0,maxReservations:30},{startTime:"17:00",endTime:"19:00",duration:120,isActive:!0,maxReservations:30},{startTime:"18:00",endTime:"20:00",duration:120,isActive:!0,maxReservations:30},{startTime:"19:00",endTime:"21:00",duration:120,isActive:!0,maxReservations:30},{startTime:"20:00",endTime:"22:00",duration:120,isActive:!0,maxReservations:30},{startTime:"21:00",endTime:"23:00",duration:120,isActive:!0,maxReservations:20},{startTime:"22:00",endTime:"00:00",duration:120,isActive:!0,maxReservations:20},{startTime:"23:00",endTime:"01:00",duration:120,isActive:!0,maxReservations:20},{startTime:"00:00",endTime:"02:00",duration:120,isActive:!0,maxReservations:15},{startTime:"01:00",endTime:"03:00",duration:120,isActive:!0,maxReservations:15}].forEach(s=>{const i=ot(Be(e,D3));r.set(i,s)}),await r.commit(),console.log("Sample time slots initialized")}catch(e){throw console.error("Error initializing sample time slots:",e),e}}static async getTables(){try{const e=Ce(),r=qe(Be(e,Zg),Vt("number","asc"));return(await st(r)).docs.map(s=>({id:s.id,...s.data()}))}catch(e){throw console.error("Error getting tables:",e),e}}static async getTimeSlots(){try{const e=Ce(),r=qe(Be(e,D3),Vt("startTime","asc")),s=(await st(r)).docs.map(o=>({id:o.id,...o.data()})),i=s.filter((o,l,c)=>l===c.findIndex(u=>u.startTime===o.startTime&&u.endTime===o.endTime));return console.log(`Loaded ${s.length} time slots, ${i.length} unique`),i}catch(e){throw console.error("Error getting time slots:",e),e}}static async getUserActiveReservation(e){var r,n;try{const s=Ce(),i=new Date;i.setHours(0,0,0,0);const o=new Date(i);o.setDate(o.getDate()+1);const l=qe(Be(s,Zl),Je("userId","==",e),Je("date",">=",yt.fromDate(i)),Je("date","<",yt.fromDate(o)),Je("status","in",["confirmed","seated"]),Vt("date","desc")),c=await st(l);if(c.empty)return null;const u=c.docs[0],d=u.data();return{id:u.id,...d,date:d.date.toDate(),createdAt:((r=d.createdAt)==null?void 0:r.toDate())||new Date,updatedAt:((n=d.updatedAt)==null?void 0:n.toDate())||new Date}}catch(s){return console.error("Error getting user active reservation:",s),null}}}const KJ=()=>{const[t,e]=M.useState([]),[r,n]=M.useState([]),[s,i]=M.useState(!0),[o,l]=M.useState(""),[c,u]=M.useState("all"),[d,h]=M.useState("all"),[g,m]=M.useState(null);M.useEffect(()=>{w()},[]),M.useEffect(()=>{_()},[t,o,c,d]);const w=async()=>{try{i(!0);const k=await Qr.getReservations();e(k)}catch(k){console.error("Error loading reservations:",k),Ee.error("Failed to load reservations")}finally{i(!1)}},_=()=>{let k=[...t];if(o.trim()){const A=o.toLowerCase();k=k.filter(I=>I.customerName.toLowerCase().includes(A)||I.customerEmail.toLowerCase().includes(A)||I.customerPhone.toLowerCase().includes(A)||I.tableNumber.toString().includes(A))}if(c!=="all"&&(k=k.filter(A=>A.status===c)),d!=="all"){const A=new Date;switch(A.setHours(0,0,0,0),d){case"today":{const I=new Date(A);I.setDate(I.getDate()+1),k=k.filter(O=>O.date>=A&&O.date<I);break}case"upcoming":k=k.filter(I=>I.date>=A&&["pending","confirmed"].includes(I.status));break;case"past":k=k.filter(I=>I.date<A);break}}n(k)},T=async(k,A)=>{try{await Qr.updateReservationStatus(k,A),Ee.success(`Reservation ${A} successfully`),w()}catch(I){console.error("Error updating reservation:",I),Ee.error("Failed to update reservation")}},v=k=>{switch(k){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"confirmed":return"bg-blue-100 text-blue-800 border-blue-200";case"seated":return"bg-green-100 text-green-800 border-green-200";case"completed":return"bg-emerald-100 text-emerald-800 border-emerald-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";case"no_show":return"bg-gray-100 text-gray-800 border-gray-200";case"expired":return"bg-orange-100 text-orange-800 border-orange-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},b=k=>k.tableNumber===20?a.jsx(Et,{className:"w-4 h-4 text-yellow-500"}):k.tableNumber>=21&&k.tableNumber<=30?a.jsx(zn,{className:"w-4 h-4 text-green-500"}):a.jsx(Si,{className:"w-4 h-4 text-blue-500"}),x=k=>k===20?"VIP Bereich":k>=21&&k<=30?"Außenbereich":"Innenbereich",P=k=>k.replace("_"," ").replace(/\b\w/g,A=>A.toUpperCase()),F=k=>{var A;return a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-lg transition-shadow duration-200",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[b(k),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-semibold text-gray-900",children:["Table ",k.tableNumber," •"," ",x(k.tableNumber)]}),a.jsx("p",{className:"text-sm text-gray-600",children:k.customerName})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${v(k.status)}`,children:P(k.status)}),a.jsx("button",{onClick:()=>m(k),className:"p-1 hover:bg-gray-100 rounded",children:a.jsx(bY,{className:"w-4 h-4 text-gray-400"})})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm text-gray-600 mb-3",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Un,{className:"w-4 h-4 mr-2"}),Lr(k.date,"dd.MM.yyyy",{locale:Ss})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(Rr,{className:"w-4 h-4 mr-2"}),k.timeSlot.replace("-"," - ")]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(qn,{className:"w-4 h-4 mr-2"}),k.partySize," people"]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(Hn,{className:"w-4 h-4 mr-2"}),k.customerPhone]})]}),k.specialRequests&&a.jsxs("div",{className:"p-2 bg-gray-50 rounded text-sm text-gray-700 mb-3",children:[a.jsx("strong",{children:"Special Requests:"})," ",k.specialRequests]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"text-sm text-gray-500",children:["#",(A=k.id)==null?void 0:A.slice(-8)]}),a.jsxs("div",{className:"flex space-x-2",children:[k.status==="pending"&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>T(k.id,"confirmed"),className:"flex items-center space-x-1 px-3 py-1 bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors",children:[a.jsx(xr,{className:"w-4 h-4"}),a.jsx("span",{children:"Confirm"})]}),a.jsxs("button",{onClick:()=>T(k.id,"cancelled"),className:"flex items-center space-x-1 px-3 py-1 bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",children:[a.jsx(gl,{className:"w-4 h-4"}),a.jsx("span",{children:"Cancel"})]})]}),k.status==="confirmed"&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>T(k.id,"seated"),className:"flex items-center space-x-1 px-3 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:[a.jsx(qn,{className:"w-4 h-4"}),a.jsx("span",{children:"Seated"})]}),a.jsxs("button",{onClick:()=>T(k.id,"no_show"),className:"flex items-center space-x-1 px-3 py-1 bg-orange-100 text-orange-700 rounded hover:bg-orange-200 transition-colors",children:[a.jsx(ml,{className:"w-4 h-4"}),a.jsx("span",{children:"No Show"})]})]}),k.status==="seated"&&a.jsxs("button",{onClick:()=>T(k.id,"completed"),className:"flex items-center space-x-1 px-3 py-1 bg-emerald-100 text-emerald-700 rounded hover:bg-emerald-200 transition-colors",children:[a.jsx(xr,{className:"w-4 h-4"}),a.jsx("span",{children:"Complete"})]})]})]})]},k.id)},$=()=>g?a.jsx(oe.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>m(null),children:a.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",onClick:k=>k.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Reservation Details"}),a.jsx("button",{onClick:()=>m(null),className:"p-2 hover:bg-gray-100 rounded",children:a.jsx(gl,{className:"w-5 h-5 text-gray-400"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-600 text-sm",children:"Customer"}),a.jsx("p",{className:"font-semibold",children:g.customerName})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-600 text-sm",children:"Table"}),a.jsxs("p",{className:"font-semibold",children:["Table ",g.tableNumber]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-600 text-sm",children:"Date"}),a.jsx("p",{className:"font-semibold",children:Lr(g.date,"EEEE, dd.MM.yyyy",{locale:Ss})})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-600 text-sm",children:"Time"}),a.jsx("p",{className:"font-semibold",children:g.timeSlot.replace("-"," - ")})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-600 text-sm",children:"Party Size"}),a.jsxs("p",{className:"font-semibold",children:[g.partySize," people"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-600 text-sm",children:"Status"}),a.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium border ${v(g.status)}`,children:P(g.status)})]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-600 text-sm",children:"Contact"}),a.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(ji,{className:"w-4 h-4 mr-2 text-gray-400"}),a.jsx("span",{className:"text-sm",children:g.customerEmail})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(Hn,{className:"w-4 h-4 mr-2 text-gray-400"}),a.jsx("span",{className:"text-sm",children:g.customerPhone})]})]})]}),g.specialRequests&&a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-600 text-sm",children:"Special Requests"}),a.jsx("p",{className:"text-sm bg-gray-50 p-3 rounded",children:g.specialRequests})]}),g.totalAmount&&a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-600 text-sm",children:"Total Amount"}),a.jsxs("p",{className:"font-semibold text-lg text-green-600",children:["€",g.totalAmount.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-600 text-sm",children:"Created"}),a.jsx("p",{className:"text-sm",children:Lr(g.createdAt,"dd.MM.yyyy HH:mm",{locale:Ss})})]})]})]})}):null;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Reservation Management"}),a.jsx("p",{className:"text-gray-300",children:"Manage table reservations and customer bookings"})]}),a.jsxs("button",{onClick:w,className:"flex items-center space-x-2 bg-royal-gold text-royal-charcoal px-4 py-2 rounded-lg hover:bg-royal-gold/90 transition-colors",children:[a.jsx(Nr,{className:"w-4 h-4"}),a.jsx("span",{children:"Refresh"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Sf,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search customers, phone, email...",value:o,onChange:k=>l(k.target.value),className:"w-full pl-10 pr-4 py-2 bg-white border border-gray-300 rounded-lg focus:ring-2 focus:ring-royal-gold/50 focus:border-royal-gold"})]}),a.jsxs("select",{value:c,onChange:k=>u(k.target.value),className:"w-full px-4 py-2 bg-white border border-gray-300 rounded-lg focus:ring-2 focus:ring-royal-gold/50 focus:border-royal-gold",children:[a.jsx("option",{value:"all",children:"All Statuses"}),a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"confirmed",children:"Confirmed"}),a.jsx("option",{value:"seated",children:"Seated"}),a.jsx("option",{value:"completed",children:"Completed"}),a.jsx("option",{value:"cancelled",children:"Cancelled"}),a.jsx("option",{value:"no_show",children:"No Show"})]}),a.jsxs("select",{value:d,onChange:k=>h(k.target.value),className:"w-full px-4 py-2 bg-white border border-gray-300 rounded-lg focus:ring-2 focus:ring-royal-gold/50 focus:border-royal-gold",children:[a.jsx("option",{value:"all",children:"All Dates"}),a.jsx("option",{value:"today",children:"Today"}),a.jsx("option",{value:"upcoming",children:"Upcoming"}),a.jsx("option",{value:"past",children:"Past"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.length})]}),a.jsx(Un,{className:"w-8 h-8 text-blue-500"})]})}),a.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),a.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:t.filter(k=>k.status==="pending").length})]}),a.jsx(Rr,{className:"w-8 h-8 text-yellow-500"})]})}),a.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Confirmed"}),a.jsx("p",{className:"text-2xl font-bold text-green-600",children:t.filter(k=>k.status==="confirmed").length})]}),a.jsx(xr,{className:"w-8 h-8 text-green-500"})]})}),a.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Today"}),a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:t.filter(k=>{const A=new Date;A.setHours(0,0,0,0);const I=new Date(A);return I.setDate(I.getDate()+1),k.date>=A&&k.date<I}).length})]}),a.jsx(qn,{className:"w-8 h-8 text-blue-500"})]})})]}),s?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(jn,{size:"lg"})}):r.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Un,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Reservations Found"}),a.jsx("p",{className:"text-gray-400",children:t.length===0?"No reservations have been made yet.":"No reservations match your current filters."})]}):a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:r.map(F)}),$()]})},EN=({loyaltyCard:t,showActions:e=!1,onRedeemFreeShisha:r})=>{const n=ks.calculateProgressPercentage(t.stamps),s=Ga.STAMPS_FOR_FREE_SHISHA-t.stamps,i=Array.from({length:Ga.STAMPS_FOR_FREE_SHISHA},(o,l)=>({filled:l<t.stamps,index:l}));return a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-royal-purple to-royal-purple-light rounded-royal p-6 text-white shadow-2xl border border-royal-purple/50 royal-glow",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Et,{className:"w-6 h-6 text-royal-gold"}),a.jsx("h3",{className:"text-xl font-royal font-bold",children:"Royal Stempelpass"})]}),t.freeShishaEarned>0&&a.jsxs("div",{className:"flex items-center space-x-1 bg-royal-gold/20 text-royal-gold px-3 py-1 rounded-full border border-royal-gold/30",children:[a.jsx(Ki,{className:"w-4 h-4"}),a.jsxs("span",{className:"text-sm font-medium",children:[t.freeShishaEarned," Gratis"]})]})]}),a.jsxs("div",{className:"mb-4 space-y-1",children:[a.jsx("div",{className:"font-medium text-lg",children:t.customerName}),a.jsxs("div",{className:"flex items-center space-x-1 text-white/80",children:[a.jsx(Hn,{className:"w-3 h-3"}),a.jsx("span",{className:"text-sm",children:t.customerPhone})]}),t.lastStampDate&&a.jsxs("div",{className:"flex items-center space-x-1 text-white/80",children:[a.jsx(Un,{className:"w-3 h-3"}),a.jsxs("span",{className:"text-sm",children:["Letzter Stempel:"," ",t.lastStampDate.toLocaleDateString("de-DE")]})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsxs("span",{className:"text-sm font-medium",children:["Stempel: ",t.stamps,"/",Ga.STAMPS_FOR_FREE_SHISHA]}),a.jsx("span",{className:"text-sm text-white/80",children:s>0?`${s} bis zur nächsten gratis Shisha`:"Bereit für gratis Shisha!"})]}),a.jsx("div",{className:"w-full bg-white/20 rounded-full h-2 mb-3",children:a.jsx(oe.div,{className:"bg-royal-gold h-2 rounded-full",initial:{width:0},animate:{width:`${n}%`},transition:{duration:1,ease:"easeOut"}})}),a.jsx("div",{className:"grid grid-cols-5 gap-2",children:i.map(o=>a.jsx(oe.div,{initial:{scale:0},animate:{scale:1},transition:{duration:.3,delay:o.index*.1},className:`
                aspect-square rounded-full flex items-center justify-center
                ${o.filled?"bg-royal-gold text-royal-purple border-2 border-royal-gold":"bg-white/20 border-2 border-white/30 border-dashed"}
              `,children:o.filled&&a.jsx(zn,{className:"w-4 h-4 fill-current"})},o.index))})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4 text-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-royal-gold",children:t.totalShishaOrders}),a.jsx("div",{className:"text-xs text-white/80",children:"Gesamt Shishas"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-royal-gold",children:t.freeShishaEarned}),a.jsx("div",{className:"text-xs text-white/80",children:"Gratis verdient"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-royal-gold",children:t.freeShishaUsed}),a.jsx("div",{className:"text-xs text-white/80",children:"Gratis eingelöst"})]})]}),e&&t.freeShishaEarned>0&&r&&a.jsxs(oe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:r,className:"w-full bg-royal-gold text-royal-purple py-3 rounded-royal font-medium hover:bg-royal-gold/90 transition-colors duration-300 flex items-center justify-center space-x-2 shadow-lg",children:[a.jsx(Ki,{className:"w-5 h-5"}),a.jsx("span",{children:"Gratis Shisha einlösen"})]}),t.totalShishaOrders>=50&&a.jsxs(oe.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"mt-3 bg-royal-gold/20 border border-royal-gold/30 text-royal-gold px-3 py-1 rounded-full text-sm text-center font-medium",children:["🏆 Royal VIP - ",t.totalShishaOrders,"+ Shishas genossen!"]})]})},bP=({onCardSelected:t,showCreateNew:e=!1,onCreateNew:r})=>{const[n,s]=M.useState(""),[i,o]=M.useState(""),[l,c]=M.useState(null),[u,d]=M.useState(!1),[h,g]=M.useState(""),[m,w]=M.useState(!1),_=async()=>{if(!n.trim()){g("Bitte Telefonnummer eingeben");return}d(!0),g(""),c(null);try{const x=await ks.searchLoyaltyCardByPhone(n.trim());x?(c(x),t&&t(x)):(g("Kein Stempelpass für diese Nummer gefunden"),e&&w(!0))}catch(x){g("Fehler beim Suchen der Stempelkarte"),console.error("Error searching loyalty card:",x)}finally{d(!1)}},T=async()=>{if(!n.trim()||!i.trim()){g("Bitte alle Felder ausfüllen");return}d(!0),g("");try{const x=await ks.getOrCreateLoyaltyCard(n.trim(),i.trim());c(x),w(!1),t&&t(x),r&&r(n.trim(),i.trim())}catch(x){g("Fehler beim Erstellen der Stempelkarte"),console.error("Error creating loyalty card:",x)}finally{d(!1)}},v=x=>{x.key==="Enter"&&(m?T():_())},b=()=>{s(""),o(""),c(null),g(""),w(!1)};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-white rounded-royal p-6 shadow-lg border border-royal-purple/20",children:[a.jsxs("h3",{className:"text-lg font-royal font-bold text-royal-purple mb-4 flex items-center space-x-2",children:[a.jsx(Et,{className:"w-5 h-5"}),a.jsx("span",{children:"Stempelpass suchen"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-charcoal mb-2",children:"Telefonnummer"}),a.jsxs("div",{className:"relative",children:[a.jsx(Hn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-royal-purple/60 w-5 h-5"}),a.jsx("input",{type:"tel",value:n,onChange:x=>s(x.target.value),onKeyPress:v,placeholder:"z.B. +49 123 4567890",className:"w-full pl-12 pr-4 py-3 border-2 border-royal-purple/20 rounded-royal focus:outline-none focus:border-royal-purple focus:ring-2 focus:ring-royal-purple/20 bg-white text-royal-charcoal placeholder-royal-charcoal/50 transition-all duration-200",disabled:u})]})]}),m&&a.jsxs(oe.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:[a.jsx("label",{className:"block text-sm font-medium text-royal-charcoal mb-2",children:"Kundenname"}),a.jsx("input",{type:"text",value:i,onChange:x=>o(x.target.value),onKeyPress:v,placeholder:"Name des Kunden",className:"w-full px-4 py-3 border-2 border-royal-purple/20 rounded-royal focus:outline-none focus:border-royal-purple focus:ring-2 focus:ring-royal-purple/20 bg-white text-royal-charcoal placeholder-royal-charcoal/50 transition-all duration-200",disabled:u})]}),h&&a.jsxs(oe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center space-x-2 text-red-600 bg-red-50 p-3 rounded-royal border border-red-200",children:[a.jsx(_s,{className:"w-5 h-5"}),a.jsx("span",{className:"text-sm font-medium",children:h})]}),a.jsx("div",{className:"flex space-x-3",children:m?a.jsxs(a.Fragment,{children:[a.jsxs(oe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:T,disabled:u||!n.trim()||!i.trim(),className:"flex-1 bg-royal-purple-light text-white py-3 px-6 rounded-royal font-medium hover:bg-royal-purple transition-colors duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2 royal-glow",children:[u?a.jsx(jn,{size:"sm"}):a.jsx(Ai,{className:"w-5 h-5"}),a.jsx("span",{children:u?"Erstelle...":"Neuen Stempelpass erstellen"})]}),a.jsx("button",{onClick:()=>w(!1),className:"px-6 py-3 border-2 border-royal-charcoal/30 text-royal-charcoal/70 rounded-royal hover:bg-royal-charcoal/5 transition-colors duration-300 font-medium",children:"Abbrechen"})]}):a.jsxs(a.Fragment,{children:[a.jsxs(oe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:_,disabled:u||!n.trim(),className:"flex-1 bg-royal-purple text-white py-3 px-6 rounded-royal font-medium hover:bg-royal-purple-light transition-colors duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2 royal-glow",children:[u?a.jsx(jn,{size:"sm"}):a.jsx(Sf,{className:"w-5 h-5"}),a.jsx("span",{children:u?"Suche...":"Suchen"})]}),l&&a.jsx("button",{onClick:b,className:"px-6 py-3 border-2 border-royal-purple text-royal-purple rounded-royal hover:bg-royal-purple/10 transition-colors duration-300 font-medium",children:"Neue Suche"})]})})]})]}),l&&a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:a.jsx(EN,{loyaltyCard:l,showActions:!0})})]})},YJ=()=>{const[t,e]=M.useState(null),[r,n]=M.useState([]),[s,i]=M.useState(!0),[o,l]=M.useState(!1),[c,u]=M.useState(!1),[d,h]=M.useState({totalCards:0,activeCards:0,totalStampsIssued:0,totalFreeShishasEarned:0,totalFreeShishasRedeemed:0,totalShishasSold:0});M.useEffect(()=>{g()},[]);const g=async()=>{i(!0);try{m([])}catch(v){console.error("Error loading loyalty data:",v)}finally{i(!1)}},m=v=>{const b={totalCards:v.length,activeCards:v.filter(x=>x.isActive).length,totalStampsIssued:v.reduce((x,P)=>x+P.stamps+P.freeShishaEarned*10,0),totalFreeShishasEarned:v.reduce((x,P)=>x+P.freeShishaEarned,0),totalFreeShishasRedeemed:v.reduce((x,P)=>x+P.freeShishaUsed,0),totalShishasSold:v.reduce((x,P)=>x+P.totalShishaOrders,0)};h(b)},w=async v=>{e(v),await _(v.id),u(!0)},_=async v=>{try{const b=await ks.getLoyaltyTransactions(v);n(b)}catch(b){console.error("Error loading transactions:",b)}},T=v=>{switch(v){case"stamp_earned":return a.jsx(zn,{className:"w-4 h-4 text-yellow-600"});case"free_shisha_earned":return a.jsx(Ki,{className:"w-4 h-4 text-green-600"});case"free_shisha_redeemed":return a.jsx(Ki,{className:"w-4 h-4 text-blue-600"});default:return a.jsx(zn,{className:"w-4 h-4 text-gray-600"})}};return s?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx(jn,{})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-2xl font-royal font-bold text-royal-charcoal flex items-center space-x-2",children:[a.jsx(Et,{className:"w-7 h-7 text-royal-gold"}),a.jsx("span",{children:"Stempelpass Verwaltung"})]}),a.jsx("p",{className:"text-royal-charcoal/70 mt-1",children:"Verwalten Sie Kundenstempelkarten und Treuepunkte"})]}),a.jsxs("button",{onClick:()=>l(!o),className:"bg-royal-gold text-royal-charcoal px-4 py-2 rounded-royal hover:bg-royal-gold/90 transition-colors duration-300 flex items-center space-x-2",children:[a.jsx(Sf,{className:"w-4 h-4"}),a.jsx("span",{children:"Karte suchen"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-royal-gold to-royal-gold/80 p-6 rounded-royal text-royal-charcoal shadow-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-charcoal/70 text-sm",children:"Gesamt Karten"}),a.jsx("p",{className:"text-3xl font-bold",children:d.totalCards})]}),a.jsx(qn,{className:"w-8 h-8 text-royal-charcoal/50"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-gradient-to-br from-green-500 to-green-600 p-6 rounded-royal text-white shadow-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-white/80 text-sm",children:"Aktive Karten"}),a.jsx("p",{className:"text-3xl font-bold",children:d.activeCards})]}),a.jsx(pl,{className:"w-8 h-8 text-white/50"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-gradient-to-br from-blue-500 to-blue-600 p-6 rounded-royal text-white shadow-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-white/80 text-sm",children:"Stempel ausgegeben"}),a.jsx("p",{className:"text-3xl font-bold",children:d.totalStampsIssued})]}),a.jsx(zn,{className:"w-8 h-8 text-white/50"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-gradient-to-br from-purple-500 to-purple-600 p-6 rounded-royal text-white shadow-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-white/80 text-sm",children:"Gratis Shishas verdient"}),a.jsx("p",{className:"text-3xl font-bold",children:d.totalFreeShishasEarned})]}),a.jsx(Ki,{className:"w-8 h-8 text-white/50"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-gradient-to-br from-red-500 to-red-600 p-6 rounded-royal text-white shadow-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-white/80 text-sm",children:"Gratis Shishas eingelöst"}),a.jsx("p",{className:"text-3xl font-bold",children:d.totalFreeShishasRedeemed})]}),a.jsx(Ki,{className:"w-8 h-8 text-white/50"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-gradient-to-br from-orange-500 to-orange-600 p-6 rounded-royal text-white shadow-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-white/80 text-sm",children:"Shishas verkauft"}),a.jsx("p",{className:"text-3xl font-bold",children:d.totalShishasSold})]}),a.jsx(Et,{className:"w-8 h-8 text-white/50"})]})})]}),o&&a.jsx(oe.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-white rounded-royal p-6 shadow-lg border border-royal-gold/20",children:a.jsx(bP,{onCardSelected:w,showCreateNew:!0,onCreateNew:()=>g()})}),t&&a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-royal p-6 shadow-lg border border-royal-gold/20",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-xl font-royal font-bold text-royal-charcoal",children:"Kundenkarte Details"}),a.jsxs("button",{onClick:()=>u(!c),className:"flex items-center space-x-2 bg-royal-gold/10 text-royal-charcoal px-3 py-1 rounded-royal hover:bg-royal-gold/20 transition-colors",children:[a.jsx(Ca,{className:"w-4 h-4"}),a.jsx("span",{children:c?"Historie ausblenden":"Historie anzeigen"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"font-medium text-royal-charcoal",children:"Name:"}),a.jsx("span",{className:"text-royal-charcoal/70",children:t.customerName})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Hn,{className:"w-4 h-4 text-royal-charcoal/50"}),a.jsx("span",{className:"text-royal-charcoal/70",children:t.customerPhone})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Un,{className:"w-4 h-4 text-royal-charcoal/50"}),a.jsxs("span",{className:"text-royal-charcoal/70",children:["Erstellt: ",t.createdAt.toLocaleDateString("de-DE")]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"text-center p-3 bg-royal-gold/10 rounded-royal",children:[a.jsx("div",{className:"text-2xl font-bold text-royal-charcoal",children:t.stamps}),a.jsx("div",{className:"text-sm text-royal-charcoal/70",children:"Aktuelle Stempel"})]}),a.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-royal",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.freeShishaEarned}),a.jsx("div",{className:"text-sm text-green-600/70",children:"Gratis verfügbar"})]})]})]}),c&&a.jsxs("div",{className:"border-t border-royal-gold/20 pt-4",children:[a.jsx("h4",{className:"font-royal font-bold text-royal-charcoal mb-3",children:"Transaktions-Historie"}),r.length>0?a.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:r.map(v=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-royal",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[T(v.type),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-800",children:v.description}),a.jsx("p",{className:"text-xs text-gray-600",children:v.createdAt.toLocaleDateString("de-DE")})]})]}),a.jsx("div",{className:"text-right text-sm",children:v.stampsChanged>0&&a.jsxs("div",{className:"text-green-600 font-bold",children:["+",v.stampsChanged]})})]},v.id))}):a.jsx("p",{className:"text-royal-charcoal/70 text-center py-4",children:"Keine Transaktionen vorhanden"})]})]})]})},QJ=["unavailable","network-request-failed","timeout","cancelled","deadline-exceeded","resource-exhausted","internal","aborted"],JJ={maxRetries:3,initialDelay:1e3,maxDelay:1e4,backoffFactor:2,retryableErrors:QJ,onRetry:()=>{}},XJ=(t,e)=>{var i,o;if(!t)return!1;const r=t.toString().toLowerCase(),n=((i=t.code)==null?void 0:i.toLowerCase())||"",s=((o=t.message)==null?void 0:o.toLowerCase())||"";return e.some(l=>r.includes(l)||n.includes(l)||s.includes(l))},ZJ=(t,e)=>{const r=e.initialDelay*Math.pow(e.backoffFactor,t-1),n=Math.random()*.1*r,s=Math.min(r+n,e.maxDelay);return Math.floor(s)},eX=t=>new Promise(e=>setTimeout(e,t)),tX=async(t,e={})=>{const r={...JJ,...e};let n=null;for(let s=1;s<=r.maxRetries+1;s++)try{return{success:!0,data:await t(),attempts:s}}catch(i){if(n=i,s>r.maxRetries||!XJ(i,r.retryableErrors))break;const o=ZJ(s,r);r.onRetry(n,s),console.warn(`Retrying operation (attempt ${s}/${r.maxRetries}) after ${o}ms:`,n.message),await eX(o)}return{success:!1,error:n||new Error("Unknown error"),attempts:r.maxRetries+1}},Jo=async(t,e=3)=>{const r=await tX(t,{maxRetries:e,initialDelay:1e3,maxDelay:5e3,onRetry:(n,s)=>{console.warn(`🔄 Retrying Firebase operation (${s}/${e}):`,n.message)}});if(!r.success)throw r.error;return r.data},wP=t=>{let e=null;return{execute:async()=>{e=new AbortController;try{return await t(e.signal)}catch(s){throw s instanceof Error&&s.name==="AbortError"?new Error("Operation was cancelled"):s}},cancel:()=>{e&&e.abort()}}},NP=(t={})=>{const{initialData:e=null,onSuccess:r,onError:n,checkEmpty:s=b=>Array.isArray(b)?b.length===0:!b,autoRetry:i=!1,retryDelay:o=5e3}=t,[l,c]=M.useState({data:e,loading:!1,error:null,isEmpty:!1,lastUpdated:null,retryCount:0}),u=M.useRef(null),d=M.useRef(null),h=M.useRef(null);M.useEffect(()=>()=>{d.current&&d.current.cancel(),h.current&&clearTimeout(h.current)},[]);const g=M.useCallback(()=>{c({data:e,loading:!1,error:null,isEmpty:!1,lastUpdated:null,retryCount:0}),d.current&&d.current.cancel(),h.current&&clearTimeout(h.current)},[e]),m=M.useCallback(b=>{c(x=>({...x,data:b,isEmpty:b?s(b):!1,lastUpdated:new Date,error:null}))},[s]),w=M.useCallback(b=>{c(x=>({...x,error:b,loading:!1}))},[]),_=M.useCallback(()=>{c(b=>({...b,error:null}))},[]),T=M.useCallback(async(b,x={})=>{const{skipRetry:P=!1,showLoadingState:F=!0,preserveData:$=!1,timeout:k=1e4}=x;d.current&&d.current.cancel(),h.current&&clearTimeout(h.current),u.current=b,c(I=>({...I,loading:F,error:null,data:$?I.data:null}));const A=wP(async I=>P?await b():await Jo(async()=>{if(I.aborted)throw new Error("Operation was cancelled");return await b()},3));d.current=A;try{const I=await(k>0?Promise.race([A.execute(),new Promise((S,R)=>setTimeout(()=>R(new Error(`Operation timeout after ${k}ms`)),k))]):A.execute()),O=s(I);c(S=>({...S,data:I,loading:!1,error:null,isEmpty:O,lastUpdated:new Date,retryCount:S.retryCount+1})),r&&r(I)}catch(I){const O=I instanceof Error?I.message:"Unknown error occurred";c(S=>({...S,loading:!1,error:O,retryCount:S.retryCount+1})),n&&n(O),console.error("Admin data loading error:",I),i&&O.includes("network")&&o>0&&(h.current=setTimeout(()=>{u.current&&(console.log("Auto-retrying failed operation..."),T(u.current,x))},o))}},[s,r,n,i,o]),v=M.useCallback(async()=>{u.current?await T(u.current,{preserveData:!0}):console.warn("No fetcher available for reload")},[T]);return{data:l.data,loading:l.loading,error:l.error,isEmpty:l.isEmpty,lastUpdated:l.lastUpdated,retryCount:l.retryCount,loadData:T,reload:v,reset:g,setData:m,setError:w,clearError:_}},rX=(t={})=>{const{initialData:e={},onSuccess:r,onError:n,checkEmpty:s=h=>Object.keys(h).length===0}=t,[i,o]=M.useState({data:e,loading:!1,error:null,isEmpty:!1,lastUpdated:null,retryCount:0}),l=M.useRef(new Map),c=M.useRef(null),u=M.useCallback(async(h,g={})=>{c.current=h;const{showLoadingState:m=!0,preserveData:w=!1}=g;l.current.forEach(_=>_.cancel()),l.current.clear(),o(_=>({..._,loading:m,error:null,data:w?_.data:e}));try{const _=await Promise.allSettled(Object.entries(h).map(async([P,F])=>{const $=wP(async()=>await Jo(F,3));l.current.set(P,$);const k=await $.execute();return{key:P,result:k}})),T={},v=[];_.forEach((P,F)=>{if(P.status==="fulfilled"){const{key:$,result:k}=P.value;T[$]=k}else{const $=Object.keys(h)[F];v.push(`${$}: ${P.reason.message}`)}});const b={...e,...T},x=s(b);o(P=>({...P,data:b,loading:!1,error:v.length>0?v.join("; "):null,isEmpty:x,lastUpdated:new Date,retryCount:P.retryCount+1})),r&&v.length===0&&r(b),n&&v.length>0&&n(v.join("; "))}catch(_){const T=_ instanceof Error?_.message:"Unknown error occurred";o(v=>({...v,loading:!1,error:T,retryCount:v.retryCount+1})),n&&n(T)}},[e,s,r,n]),d=M.useCallback(async()=>{c.current&&await u(c.current)},[u]);return{...i,loadMultipleData:u,reload:d}},_P=(t=null,e=r=>Array.isArray(r)?r.length===0:!r)=>{const[r,n]=M.useState({data:t,loading:!1,error:null,isEmpty:!1,lastUpdated:null,retryCount:0}),s=M.useRef(new Set),i=M.useCallback((l,c)=>{n(u=>({...u,loading:!0,error:null}));try{const u=l(d=>{const h=c?c(d):d;n(g=>({...g,data:h,loading:!1,error:null,isEmpty:e(h),lastUpdated:new Date,retryCount:g.retryCount+1}))});return s.current.add(u),u}catch(u){const d=u instanceof Error?u.message:"Unknown error occurred";return n(h=>({...h,loading:!1,error:d,retryCount:h.retryCount+1})),()=>{}}},[e]),o=M.useCallback(()=>{s.current.forEach(l=>{try{l()}catch(c){console.error("Error during cleanup:",c)}}),s.current.clear()},[]);return M.useEffect(()=>o,[o]),{...r,setupRealtimeListener:i,cleanup:o}},nX={default:{icon:a.jsx(Dh,{className:"w-12 h-12 text-gray-400"}),titleColor:"text-gray-900",descriptionColor:"text-gray-600",bgColor:"bg-gray-50"},error:{icon:a.jsx(gl,{className:"w-12 h-12 text-red-400"}),titleColor:"text-red-900",descriptionColor:"text-red-600",bgColor:"bg-red-50"},loading:{icon:a.jsx(Nr,{className:"w-12 h-12 text-blue-400 animate-spin"}),titleColor:"text-blue-900",descriptionColor:"text-blue-600",bgColor:"bg-blue-50"},network:{icon:a.jsx(LY,{className:"w-12 h-12 text-orange-400"}),titleColor:"text-orange-900",descriptionColor:"text-orange-600",bgColor:"bg-orange-50"},search:{icon:a.jsx(Sf,{className:"w-12 h-12 text-gray-400"}),titleColor:"text-gray-900",descriptionColor:"text-gray-600",bgColor:"bg-gray-50"},create:{icon:a.jsx(Ai,{className:"w-12 h-12 text-green-400"}),titleColor:"text-green-900",descriptionColor:"text-green-600",bgColor:"bg-green-50"}},sX=(t="primary")=>{switch(t){case"primary":return"bg-blue-600 hover:bg-blue-700 text-white border-transparent";case"secondary":return"bg-gray-600 hover:bg-gray-700 text-white border-transparent";case"outline":return"bg-white hover:bg-gray-50 text-gray-700 border-gray-300";default:return"bg-blue-600 hover:bg-blue-700 text-white border-transparent"}},kN=({title:t,description:e,icon:r,actions:n=[],className:s="",variant:i="default",showBackground:o=!0})=>{const l=nX[i],c=r||l.icon;return a.jsx("div",{className:`
      text-center py-12 px-4 
      ${o?`rounded-lg ${l.bgColor}`:""}
      ${s}
    `,children:a.jsxs("div",{className:"max-w-sm mx-auto",children:[a.jsx("div",{className:"flex justify-center mb-4",children:c}),a.jsx("h3",{className:`text-lg font-semibold mb-2 ${l.titleColor}`,children:t}),a.jsx("p",{className:`text-sm mb-6 ${l.descriptionColor}`,children:e}),n.length>0&&a.jsx("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:n.map((u,d)=>a.jsxs("button",{onClick:u.onClick,disabled:u.loading,className:`
                  inline-flex items-center px-4 py-2 rounded-md text-sm font-medium
                  border transition-colors duration-200 min-w-[120px]
                  disabled:opacity-50 disabled:cursor-not-allowed
                  ${sX(u.variant)}
                `,children:[u.loading?a.jsx(Nr,{className:"w-4 h-4 mr-2 animate-spin"}):u.icon?a.jsx("span",{className:"mr-2",children:u.icon}):null,u.label]},d))})]})})},I0=({title:t="No data available",description:e="There's no data to display at the moment.",onRefresh:r,onAdd:n,addLabel:s="Add New",refreshing:i=!1,className:o})=>{const l=[];return r&&l.push({label:"Refresh",onClick:r,variant:"outline",icon:a.jsx(Nr,{className:"w-4 h-4"}),loading:i}),n&&l.push({label:s,onClick:n,variant:"primary",icon:a.jsx(Ai,{className:"w-4 h-4"})}),a.jsx(kN,{title:t,description:e,variant:"default",actions:l,className:o})},TN=({title:t="Something went wrong",description:e="We encountered an error while loading your data. Please try again.",onRetry:r,retrying:n=!1,className:s})=>{const i=[];return r&&i.push({label:"Try Again",onClick:r,variant:"primary",icon:a.jsx(Nr,{className:"w-4 h-4"}),loading:n}),a.jsx(kN,{title:t,description:e,variant:"error",actions:i,className:s})},iX=({title:t="Get started",description:e="Create your first item to get started.",onAdd:r,addLabel:n="Create New",className:s})=>a.jsx(kN,{title:t,description:e,variant:"create",actions:[{label:n,onClick:r,variant:"primary",icon:a.jsx(Ai,{className:"w-4 h-4"})}],className:s}),aX=()=>{const[t,e]=M.useState(!1),[r,n]=M.useState(null),[s,i]=M.useState(!1),[o,l]=M.useState(null),[c,u]=M.useState({number:1,capacity:2,location:"indoor",amenities:["smoking_area"],priceMultiplier:1}),d=["smoking_area","private","view","bar_access","fresh_air"],h=[{value:"indoor",label:"Innenbereich",icon:a.jsx(Ab,{className:"w-4 h-4"})},{value:"outdoor",label:"Außenbereich",icon:a.jsx(v3,{className:"w-4 h-4"})},{value:"vip",label:"VIP Bereich",icon:a.jsx(Et,{className:"w-4 h-4"})}],{data:g,loading:m,error:w,isEmpty:_,loadData:T,reload:v,setError:b,clearError:x}=NP({initialData:[],onSuccess:C=>{console.log("📊 TableManagement: Tables loaded successfully:",C.length),Ee.success(`${C.length} Tische geladen`)},onError:C=>{console.error("❌ TableManagement: Failed to load tables:",C),Ee.error("Fehler beim Laden der Tische")},checkEmpty:C=>C.length===0});M.useEffect(()=>{console.log("🔄 TableManagement: Loading tables"),T(async()=>await Jo(()=>Qr.getTables(),3))},[]);const P=async C=>{if(o!==C.id){l(C.id),x();try{const G=Ce();await Jo(async()=>{await Qt(ot(G,"tables",C.id),{isActive:!C.isActive})},3),Ee.success(`Tisch ${C.number} ${C.isActive?"deaktiviert":"aktiviert"}`),await v()}catch(G){console.error("❌ Error updating table:",G);const de=G instanceof Error?G.message:"Unbekannter Fehler";b(`Fehler beim Aktualisieren von Tisch ${C.number}: ${de}`),Ee.error(`Fehler beim Aktualisieren von Tisch ${C.number}`)}finally{l(null)}}},F=C=>{n(C),u({number:C.number,capacity:C.capacity,location:C.location,amenities:C.amenities,priceMultiplier:C.priceMultiplier}),e(!0)},$=async C=>{if(o!==C.id&&window.confirm(`Möchten Sie Tisch ${C.number} wirklich löschen?`)){l(C.id),x();try{const G=Ce();await Jo(async()=>{await ba(ot(G,"tables",C.id))},3),Ee.success(`Tisch ${C.number} gelöscht`),await v()}catch(G){console.error("❌ Error deleting table:",G);const de=G instanceof Error?G.message:"Unbekannter Fehler";b(`Fehler beim Löschen von Tisch ${C.number}: ${de}`),Ee.error(`Fehler beim Löschen von Tisch ${C.number}`)}finally{l(null)}}},k=async C=>{if(C.preventDefault(),!s){i(!0),x();try{const G=Ce(),de={...c,isActive:!0};await Jo(async()=>{r?await Qt(ot(G,"tables",r.id),de):await xo(Be(G,"tables"),de)},3);const ne=r?"aktualisiert":"erstellt";Ee.success(`Tisch ${c.number} ${ne}`),e(!1),n(null),u({number:1,capacity:2,location:"indoor",amenities:["smoking_area"],priceMultiplier:1}),await v()}catch(G){console.error("❌ Error saving table:",G);const de=G instanceof Error?G.message:"Unbekannter Fehler";b(`Fehler beim Speichern von Tisch ${c.number}: ${de}`),Ee.error(`Fehler beim Speichern von Tisch ${c.number}`)}finally{i(!1)}}},A=async()=>{if(window.confirm("Dies wird ALLE TISCHE LÖSCHEN und das Standard 30-Tische Layout wiederherstellen. Diese Aktion kann nicht rückgängig gemacht werden. Fortfahren?")){x();try{await T(async()=>{const C=Ce(),G=await st(Be(C,"tables")),de=lb(C);return G.docs.forEach(ne=>{de.delete(ne.ref)}),await de.commit(),console.log("All tables deleted"),await Qr.initializeSampleTables(),console.log("Tables reinitialized"),await Qr.initializeSampleTimeSlots(),console.log("Time slots initialized"),await Qr.getTables()}),Ee.success("Tische erfolgreich zurückgesetzt")}catch(C){console.error("❌ Error during cleanup and reset:",C);const G=C instanceof Error?C.message:"Unbekannter Fehler";b(`Fehler beim Zurücksetzen der Tische: ${G}`),Ee.error("Fehler beim Zurücksetzen der Tische")}}},I=async()=>{if(window.confirm("Dies wird das Standard 30-Tische Layout erstellen. Fortfahren?")){x();try{await T(async()=>(await Qr.initializeSampleTables(),await Qr.initializeSampleTimeSlots(),await Qr.getTables())),Ee.success("Tische erfolgreich initialisiert")}catch(C){console.error("❌ Error initializing tables:",C);const G=C instanceof Error?C.message:"Unbekannter Fehler";b(`Fehler beim Initialisieren der Tische: ${G}`),Ee.error("Fehler beim Initialisieren der Tische")}}},O=C=>{const G=c.amenities.includes(C)?c.amenities.filter(de=>de!==C):[...c.amenities,C];u({...c,amenities:G})},S=C=>{switch(C){case"indoor":return a.jsx(Ab,{className:"w-4 h-4"});case"outdoor":return a.jsx(v3,{className:"w-4 h-4"});case"vip":return a.jsx(Et,{className:"w-4 h-4"});default:return a.jsx(Si,{className:"w-4 h-4"})}},R=C=>{const G=h.find(de=>de.value===C);return G?G.label:C};return m?a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-6",children:[a.jsx(Nr,{className:"w-5 h-5 animate-spin"}),a.jsx("span",{children:"Laden der Tische..."})]}),a.jsxs("div",{className:"animate-pulse",children:[a.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-4"}),a.jsx("div",{className:"space-y-3",children:[...Array(5)].map((C,G)=>a.jsx("div",{className:"h-16 bg-gray-200 rounded"},G))})]})]}):w?a.jsx("div",{className:"p-6",children:a.jsx(TN,{title:"Fehler beim Laden der Tische",description:w,onRetry:v,retrying:m})}):_?a.jsx("div",{className:"p-6",children:a.jsx(iX,{title:"Keine Tische vorhanden",description:"Erstellen Sie Ihre ersten Tische, um mit der Reservierungsverwaltung zu beginnen.",onAdd:I,addLabel:"Standard-Tische erstellen"})}):a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Tischverwaltung (",(g==null?void 0:g.length)||0," Tische)"]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("button",{onClick:v,disabled:m,className:"flex items-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 disabled:opacity-50",children:[a.jsx(Nr,{className:`w-4 h-4 ${m?"animate-spin":""}`}),a.jsx("span",{children:"Aktualisieren"})]}),a.jsxs("button",{onClick:()=>e(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(Ai,{className:"w-4 h-4"}),a.jsx("span",{children:"Tisch hinzufügen"})]}),a.jsxs("button",{onClick:A,disabled:m,className:"flex items-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50",children:[a.jsx(Nr,{className:"w-4 h-4"}),a.jsx("span",{children:"Zurücksetzen"})]})]})]}),w&&a.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-red-800",children:w}),a.jsx("button",{onClick:x,className:"text-red-600 hover:text-red-800",children:"×"})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:g==null?void 0:g.map(C=>a.jsxs("div",{className:`p-4 rounded-lg border-2 transition-all ${C.isActive?"border-green-200 bg-green-50":"border-gray-200 bg-gray-50"}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("span",{className:"text-lg font-semibold",children:["Tisch ",C.number]}),a.jsx("span",{className:`px-2 py-1 text-xs rounded ${C.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:C.isActive?"Aktiv":"Inaktiv"})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("button",{onClick:()=>P(C),disabled:o===C.id,className:`p-1 rounded transition-colors ${o===C.id?"opacity-50 cursor-not-allowed":"hover:bg-gray-200"}`,children:o===C.id?a.jsx(Nr,{className:"w-4 h-4 animate-spin"}):C.isActive?a.jsx(TY,{className:"w-4 h-4 text-green-600"}):a.jsx(kY,{className:"w-4 h-4 text-gray-400"})}),a.jsx("button",{onClick:()=>F(C),disabled:o===C.id,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-50",children:a.jsx(Kp,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>$(C),disabled:o===C.id,className:"p-1 rounded hover:bg-red-200 disabled:opacity-50",children:a.jsx(Qs,{className:"w-4 h-4 text-red-600"})})]})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-gray-600",children:"Kapazität:"}),a.jsxs("span",{className:"font-medium",children:[C.capacity," Personen"]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-gray-600",children:"Bereich:"}),a.jsxs("div",{className:"flex items-center space-x-1",children:[S(C.location),a.jsx("span",{className:"font-medium",children:R(C.location)})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-gray-600",children:"Preismultiplikator:"}),a.jsxs("span",{className:"font-medium",children:[C.priceMultiplier,"x"]})]}),C.amenities.length>0&&a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-gray-600",children:"Ausstattung:"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:C.amenities.map(G=>a.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:G},G))})]})]})]},C.id))}),t&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold",children:r?`Tisch ${r.number} bearbeiten`:"Neuen Tisch hinzufügen"}),a.jsx("button",{onClick:()=>{e(!1),n(null)},className:"text-gray-400 hover:text-gray-600",children:"×"})]}),a.jsxs("form",{onSubmit:k,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tischnummer"}),a.jsx("input",{type:"number",value:c.number,onChange:C=>u({...c,number:parseInt(C.target.value)}),min:"1",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kapazität"}),a.jsx("input",{type:"number",value:c.capacity,onChange:C=>u({...c,capacity:parseInt(C.target.value)}),min:"1",max:"20",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bereich"}),a.jsx("select",{value:c.location,onChange:C=>u({...c,location:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:h.map(C=>a.jsx("option",{value:C.value,children:C.label},C.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preismultiplikator"}),a.jsx("input",{type:"number",value:c.priceMultiplier,onChange:C=>u({...c,priceMultiplier:parseFloat(C.target.value)}),min:"0.5",max:"5",step:"0.1",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ausstattung"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:d.map(C=>a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:c.amenities.includes(C),onChange:()=>O(C),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm",children:C})]},C))})]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[a.jsx("button",{type:"submit",disabled:s,className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:s?a.jsxs(a.Fragment,{children:[a.jsx(Nr,{className:"w-4 h-4 animate-spin"}),a.jsx("span",{children:"Speichern..."})]}):a.jsx("span",{children:r?"Aktualisieren":"Hinzufügen"})}),a.jsx("button",{type:"button",onClick:()=>{e(!1),n(null)},className:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Abbrechen"})]})]})]})})]})};class mm{static updateConfig(e){this.config={...this.config,...e}}static async getTableStatuses(){try{const e=await Qr.getTables(),r=new Date;r.setHours(0,0,0,0);const n=new Date(r);n.setDate(n.getDate()+1);const s=await Qr.getReservations({dateRange:{start:r,end:n}}),i=await ls.getOrdersWithFilters({dateRange:{start:r,end:n}}),o=[];for(const l of e){const c=s.filter(h=>h.tableNumber===l.number),u=i.filter(h=>h.tableNumber===l.number),d=this.calculateTableStatus(l,c,u);o.push(d)}return o.sort((l,c)=>l.table.number-c.table.number)}catch(e){throw console.error("Error getting table statuses:",e),e}}static calculateTableStatus(e,r,n){const s=new Date,i={table:e,reservation:null,currentOrder:null,status:"available",lastActivity:s};if(!e.isActive)return i.status="unavailable",i;const o=r.find(c=>["confirmed","seated"].includes(c.status)&&this.isReservationActive(c,s));o&&(i.reservation=o,i.customerName=o.customerName,i.partySize=o.partySize,i.lastActivity=o.updatedAt);const l=n.filter(c=>["pending","confirmed","preparing","ready"].includes(c.status)).sort((c,u)=>u.createdAt.getTime()-c.createdAt.getTime())[0];return l&&(i.currentOrder=l,i.customerName=l.customerName||i.customerName,i.lastActivity=l.updatedAt),i.lastActivity&&(i.waitingTime=Math.floor((s.getTime()-i.lastActivity.getTime())/(1e3*60))),i.status=this.determineTableStatusType(i,s),i}static isReservationActive(e,r){const n=new Date(e.date),[s,i]=e.startTime.split(":").map(Number),[o,l]=e.endTime.split(":").map(Number),c=new Date(n);c.setHours(s,i,0,0);const u=new Date(n);return u.setHours(o,l,0,0),u.setHours(u.getHours()+2),r>=c&&r<=u}static determineTableStatusType(e,r){const{reservation:n,currentOrder:s,waitingTime:i}=e;if(i&&i>this.config.overdueTimeMinutes)return"overdue";if(s)switch(s.status){case"pending":case"confirmed":case"preparing":return"ordered";case"ready":return i&&i>this.config.warningTimeMinutes?"overdue":"served";case"delivered":return"awaiting_payment"}if(n){if(n.status==="confirmed")return"reserved";if(n.status==="seated")return"seated"}return"available"}static onTableStatusChange(e){const r=Ce(),n=[],s=wi(qe(Be(r,"reservations"),Vt("updatedAt","desc")),()=>{this.getTableStatuses().then(e).catch(console.error)}),i=wi(qe(Be(r,"orders"),Vt("updatedAt","desc")),()=>{this.getTableStatuses().then(e).catch(console.error)});return n.push(s,i),this.getTableStatuses().then(e).catch(console.error),()=>{n.forEach(o=>o())}}static async getTableStatusStats(e){const r={totalTables:e.length,available:0,occupied:0,ordersInProgress:0,awaitingPayment:0,overdue:0,averageWaitTime:0,revenue:0};let n=0,s=0;for(const i of e){switch(i.status){case"available":r.available++;break;case"reserved":case"seated":r.occupied++;break;case"ordered":case"served":r.occupied++,r.ordersInProgress++;break;case"awaiting_payment":r.awaitingPayment++;break;case"overdue":r.overdue++;break}i.waitingTime&&(n+=i.waitingTime,s++),i.currentOrder&&i.currentOrder.status==="delivered"&&(r.revenue+=i.currentOrder.totalAmount)}return r.averageWaitTime=s>0?n/s:0,r}static getStatusColor(e){switch(e){case"available":return"bg-green-100 border-green-300 text-green-800";case"reserved":return"bg-blue-100 border-blue-300 text-blue-800";case"seated":return"bg-yellow-100 border-yellow-300 text-yellow-800";case"ordered":return"bg-orange-100 border-orange-300 text-orange-800";case"served":return"bg-purple-100 border-purple-300 text-purple-800";case"awaiting_payment":return"bg-indigo-100 border-indigo-300 text-indigo-800";case"overdue":return"bg-red-100 border-red-300 text-red-800 animate-pulse";case"cleaning":return"bg-gray-100 border-gray-300 text-gray-800";case"unavailable":return"bg-gray-200 border-gray-400 text-gray-600";default:return"bg-gray-100 border-gray-300 text-gray-800"}}static getStatusIcon(e){switch(e){case"available":return"✅";case"reserved":return"📅";case"seated":return"👥";case"ordered":return"🍽️";case"served":return"🥘";case"awaiting_payment":return"💳";case"overdue":return"⚠️";case"cleaning":return"🧽";case"unavailable":return"❌";default:return"❓"}}static getStatusDisplayName(e){switch(e){case"available":return"Available";case"reserved":return"Reserved";case"seated":return"Seated";case"ordered":return"Order In Progress";case"served":return"Food Served";case"awaiting_payment":return"Awaiting Payment";case"overdue":return"OVERDUE";case"cleaning":return"Cleaning";case"unavailable":return"Unavailable";default:return"Unknown"}}}Dr(mm,"config",{warningTimeMinutes:45,overdueTimeMinutes:90,maxServiceTimeMinutes:30});const oX=({onTableClick:t})=>{const[e,r]=M.useState(!1),[n,s]=M.useState(!1),[i,o]=M.useState({warningTimeMinutes:45,overdueTimeMinutes:90,maxServiceTimeMinutes:30}),{data:l,loading:c,error:u,loadData:d,reload:h}=NP({initialData:{statuses:[],stats:{totalTables:0,available:0,occupied:0,ordersInProgress:0,awaitingPayment:0,overdue:0,averageWaitTime:0,revenue:0}},onSuccess:x=>{console.log("📊 LiveTableGrid: Initial data loaded successfully",{statuses:x.statuses.length,totalRevenue:x.stats.revenue})},onError:x=>{console.error("❌ LiveTableGrid: Failed to load initial data:",x),Ee.error("Fehler beim Laden der Tischstatus")},checkEmpty:x=>x.statuses.length===0}),{setupRealtimeListener:g}=_P([],x=>Array.isArray(x)?x.length===0:!x),m=M.useCallback(async x=>{try{return await Jo(()=>mm.getTableStatusStats(x),2)}catch(P){console.warn("⚠️ Failed to calculate stats, using defaults:",P);const F=x.length,$=x.filter(S=>S.status==="available").length,k=x.filter(S=>S.status==="seated"||S.status==="ordered"||S.status==="served").length,A=x.filter(S=>S.currentOrder!==null).length,I=x.filter(S=>S.status==="awaiting_payment").length,O=x.filter(S=>S.status==="overdue").length;return{totalTables:F,available:$,occupied:k,ordersInProgress:A,awaitingPayment:I,overdue:O,averageWaitTime:0,revenue:0}}},[]);M.useEffect(()=>{console.log("🔄 LiveTableGrid: Loading initial data"),d(async()=>{const x=await Jo(()=>mm.getTableStatuses(),3),P=await m(x);return{statuses:x,stats:P}})},[d,m]),M.useEffect(()=>{if(!l||c)return;console.log("🔄 LiveTableGrid: Setting up realtime listener");const x=g(P=>mm.onTableStatusChange(async F=>{try{console.log("📊 Realtime table status update:",{statuses:F.length,occupied:F.filter($=>$.status==="seated"||$.status==="ordered"||$.status==="served").length}),m(F).then($=>{d(async()=>({statuses:F,stats:$}),{showLoadingState:!1,preserveData:!1})}).catch($=>{console.warn("⚠️ Stats calculation failed in realtime update:",$)}),P(F)}catch($){console.error("❌ Error processing realtime update:",$)}}),P=>P);return()=>{console.log("🔄 Cleaning up LiveTableGrid realtime listener"),x()}},[l,c,g,m,d]);const w=M.useCallback(async()=>{try{await Jo(()=>Promise.resolve(mm.updateConfig(i)),2),Ee.success("Konfiguration aktualisiert"),await h()}catch(x){console.error("❌ Failed to update config:",x),Ee.error("Fehler beim Aktualisieren der Konfiguration")}},[i,h]),_=x=>{switch(x){case"vip":return a.jsx(Et,{className:"w-4 h-4 text-yellow-500"});case"outdoor":return a.jsx(zn,{className:"w-4 h-4 text-green-500"});default:return a.jsx(Si,{className:"w-4 h-4 text-blue-500"})}},T=x=>{if(x<60)return`${x}m`;const P=Math.floor(x/60),F=x%60;return`${P}h ${F}m`};if(c)return a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-6",children:[a.jsx(Nr,{className:"w-5 h-5 animate-spin"}),a.jsx("span",{children:"Laden der Tischstatus..."})]}),a.jsxs("div",{className:"animate-pulse",children:[a.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),a.jsx("div",{className:"grid grid-cols-7 gap-4 mb-6",children:[...Array(7)].map((x,P)=>a.jsx("div",{className:"h-20 bg-gray-200 rounded"},P))}),a.jsx("div",{className:"grid grid-cols-6 gap-4",children:[...Array(30)].map((x,P)=>a.jsx("div",{className:"h-24 bg-gray-200 rounded"},P))})]})]});if(u)return a.jsx("div",{className:"p-6",children:a.jsx(TN,{title:"Fehler beim Laden des Tischstatus",description:u,onRetry:h,retrying:c})});if((l==null?void 0:l.statuses.length)===0)return a.jsx("div",{className:"p-6",children:a.jsx(I0,{title:"Keine Tische verfügbar",description:"Es sind derzeit keine Tische konfiguriert.",onRefresh:h,refreshing:c})});const v=(l==null?void 0:l.statuses)||[],b=(l==null?void 0:l.stats)||{totalTables:0,available:0,occupied:0,ordersInProgress:0,awaitingPayment:0,overdue:0,averageWaitTime:0,revenue:0};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-2xl font-bold text-royal-cream mb-2",children:["Live Tischstatus (",v.length," Tische)"]}),a.jsx("p",{className:"text-royal-cream/70",children:"Echtzeitüberwachung von Tischreservierungen und Bestellungen"})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("button",{onClick:()=>s(!n),className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(gY,{className:"w-4 h-4"}),a.jsx("span",{children:"Legende"}),n?a.jsx(uY,{className:"w-4 h-4"}):a.jsx(rP,{className:"w-4 h-4"})]}),a.jsxs("button",{onClick:()=>r(!0),className:"flex items-center space-x-2 bg-royal-charcoal text-royal-cream px-4 py-2 rounded-lg hover:bg-royal-charcoal-dark transition-colors",children:[a.jsx(Yc,{className:"w-4 h-4"}),a.jsx("span",{children:"Config"})]}),a.jsxs("button",{onClick:h,disabled:c,className:"flex items-center space-x-2 bg-royal-gradient-gold text-royal-charcoal px-4 py-2 rounded-lg hover:shadow-lg transition-all duration-200 disabled:opacity-50",children:[a.jsx(Nr,{className:`w-4 h-4 ${c?"animate-spin":""}`}),a.jsx("span",{children:"Aktualisieren"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4",children:[a.jsx("div",{className:"bg-royal-charcoal p-4 rounded-lg border border-royal-gold/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream/70 text-sm",children:"Verfügbar"}),a.jsx("p",{className:"text-xl font-bold text-green-400",children:b.available})]}),a.jsx("div",{className:"text-green-400",children:"✅"})]})}),a.jsx("div",{className:"bg-royal-charcoal p-4 rounded-lg border border-royal-gold/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream/70 text-sm",children:"Besetzt"}),a.jsx("p",{className:"text-xl font-bold text-orange-400",children:b.occupied})]}),a.jsx(qn,{className:"w-6 h-6 text-orange-400"})]})}),a.jsx("div",{className:"bg-royal-charcoal p-4 rounded-lg border border-royal-gold/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream/70 text-sm",children:"Bestellungen"}),a.jsx("p",{className:"text-xl font-bold text-purple-400",children:b.ordersInProgress})]}),a.jsx("div",{className:"text-purple-400",children:"🍽️"})]})}),a.jsx("div",{className:"bg-royal-charcoal p-4 rounded-lg border border-royal-gold/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream/70 text-sm",children:"Zahlung"}),a.jsx("p",{className:"text-xl font-bold text-indigo-400",children:b.awaitingPayment})]}),a.jsx(hY,{className:"w-6 h-6 text-indigo-400"})]})}),a.jsx("div",{className:"bg-royal-charcoal p-4 rounded-lg border border-royal-gold/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream/70 text-sm",children:"Überfällig"}),a.jsx("p",{className:"text-xl font-bold text-red-400",children:b.overdue})]}),a.jsx(ml,{className:"w-6 h-6 text-red-400"})]})}),a.jsx("div",{className:"bg-royal-charcoal p-4 rounded-lg border border-royal-gold/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream/70 text-sm",children:"Ø Wartezeit"}),a.jsxs("p",{className:"text-xl font-bold text-yellow-400",children:[Math.round(b.averageWaitTime),"m"]})]}),a.jsx(Rr,{className:"w-6 h-6 text-yellow-400"})]})}),a.jsx("div",{className:"bg-royal-charcoal p-4 rounded-lg border border-royal-gold/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream/70 text-sm",children:"Umsatz"}),a.jsxs("p",{className:"text-xl font-bold text-royal-gold",children:["€",b.revenue.toFixed(0)]})]}),a.jsx(pl,{className:"w-6 h-6 text-royal-gold"})]})})]}),n&&a.jsxs(oe.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/30",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx(zy,{className:"w-5 h-5 text-royal-gold mr-2"}),a.jsx("h3",{className:"text-lg font-bold text-royal-cream",children:"Personal Legende"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-royal-cream font-semibold mb-3 text-sm uppercase tracking-wide",children:"Tischstatus"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 rounded bg-green-100 border-2 border-green-300 flex items-center justify-center",children:a.jsx("span",{className:"text-sm",children:"✅"})}),a.jsxs("div",{className:"text-royal-cream/90 text-sm",children:[a.jsx("div",{className:"font-medium",children:"Verfügbar"}),a.jsx("div",{className:"text-xs text-royal-cream/60",children:"Bereit für Kunden"})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 rounded bg-blue-100 border-2 border-blue-300 flex items-center justify-center",children:a.jsx("span",{className:"text-sm",children:"📅"})}),a.jsxs("div",{className:"text-royal-cream/90 text-sm",children:[a.jsx("div",{className:"font-medium",children:"Reserviert"}),a.jsx("div",{className:"text-xs text-royal-cream/60",children:"Kunde noch nicht da"})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 rounded bg-yellow-100 border-2 border-yellow-300 flex items-center justify-center",children:a.jsx("span",{className:"text-sm",children:"👥"})}),a.jsxs("div",{className:"text-royal-cream/90 text-sm",children:[a.jsx("div",{className:"font-medium",children:"Besetzt"}),a.jsx("div",{className:"text-xs text-royal-cream/60",children:"Kunde sitzt, keine Bestellung"})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 rounded bg-orange-100 border-2 border-orange-300 flex items-center justify-center",children:a.jsx("span",{className:"text-sm",children:"🍽️"})}),a.jsxs("div",{className:"text-royal-cream/90 text-sm",children:[a.jsx("div",{className:"font-medium",children:"Bestellung aufgegeben"}),a.jsx("div",{className:"text-xs text-royal-cream/60",children:"Küche bereitet zu"})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 rounded bg-purple-100 border-2 border-purple-300 flex items-center justify-center",children:a.jsx("span",{className:"text-sm",children:"🥘"})}),a.jsxs("div",{className:"text-royal-cream/90 text-sm",children:[a.jsx("div",{className:"font-medium",children:"Essen serviert"}),a.jsx("div",{className:"text-xs text-royal-cream/60",children:"Kunden essen"})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 rounded bg-indigo-100 border-2 border-indigo-300 flex items-center justify-center",children:a.jsx("span",{className:"text-sm",children:"💳"})}),a.jsxs("div",{className:"text-royal-cream/90 text-sm",children:[a.jsx("div",{className:"font-medium",children:"Warten auf Zahlung"}),a.jsx("div",{className:"text-xs text-royal-cream/60",children:"Bereit zum Kassieren"})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 rounded bg-red-100 border-2 border-red-300 flex items-center justify-center animate-pulse",children:a.jsx("span",{className:"text-sm",children:"⚠️"})}),a.jsxs("div",{className:"text-royal-cream/90 text-sm",children:[a.jsx("div",{className:"font-medium text-red-400",children:"ÜBERFÄLLIG"}),a.jsx("div",{className:"text-xs text-red-300",children:"Braucht sofortige Aufmerksamkeit!"})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 rounded bg-gray-200 border-2 border-gray-400 flex items-center justify-center",children:a.jsx("span",{className:"text-sm",children:"❌"})}),a.jsxs("div",{className:"text-royal-cream/90 text-sm",children:[a.jsx("div",{className:"font-medium",children:"Nicht verfügbar"}),a.jsx("div",{className:"text-xs text-royal-cream/60",children:"Deaktiviert/Wartung"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-royal-cream font-semibold mb-3 text-sm uppercase tracking-wide",children:"Bereiche"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(Et,{className:"w-5 h-5 text-yellow-500"}),a.jsxs("div",{className:"text-royal-cream/90 text-sm",children:[a.jsx("div",{className:"font-medium",children:"VIP Bereich"}),a.jsx("div",{className:"text-xs text-royal-cream/60",children:"Premium Sitzplätze (Tisch 20)"})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(zn,{className:"w-5 h-5 text-green-500"}),a.jsxs("div",{className:"text-royal-cream/90 text-sm",children:[a.jsx("div",{className:"font-medium",children:"Außenbereich"}),a.jsx("div",{className:"text-xs text-royal-cream/60",children:"Terrasse (Tische 21-30)"})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(Si,{className:"w-5 h-5 text-blue-500"}),a.jsxs("div",{className:"text-royal-cream/90 text-sm",children:[a.jsx("div",{className:"font-medium",children:"Innenbereich"}),a.jsx("div",{className:"text-xs text-royal-cream/60",children:"Hauptrestaurant (Tische 1-19)"})]})]})]}),a.jsx("h4",{className:"text-royal-cream font-semibold mb-3 mt-6 text-sm uppercase tracking-wide",children:"Zeitwarnungen"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(Rr,{className:"w-5 h-5 text-yellow-400"}),a.jsxs("div",{className:"text-royal-cream/90 text-sm",children:[a.jsxs("div",{className:"font-medium",children:[i.warningTimeMinutes," Minuten"]}),a.jsx("div",{className:"text-xs text-royal-cream/60",children:"Gelbe Warnung"})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(ml,{className:"w-5 h-5 text-red-400"}),a.jsxs("div",{className:"text-royal-cream/90 text-sm",children:[a.jsxs("div",{className:"font-medium",children:[i.overdueTimeMinutes," Minuten"]}),a.jsx("div",{className:"text-xs text-royal-cream/60",children:"Rote Überfälligkeit"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-royal-cream font-semibold mb-3 text-sm uppercase tracking-wide",children:"Schnellaktionen"}),a.jsxs("div",{className:"space-y-2 text-sm text-royal-cream/90",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:"Tisch anklicken"}),a.jsx("div",{className:"text-xs text-royal-cream/60",children:"Details und Aktionen anzeigen"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:"Automatische Updates"}),a.jsx("div",{className:"text-xs text-royal-cream/60",children:"Status aktualisiert sich live"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:"Konfiguration"}),a.jsx("div",{className:"text-xs text-royal-cream/60",children:"Zeitlimits anpassen"})]})]})]})]})]}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-10 gap-3",children:v.sort((x,P)=>x.table.number-P.table.number).map(x=>{const P=x.status==="overdue",F=x.waitingTime||0,$=F>i.warningTimeMinutes;return a.jsxs(oe.div,{layout:!0,whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>t==null?void 0:t(x),className:`
                  relative cursor-pointer rounded-lg border-2 p-3 transition-all duration-200
                  ${P?"border-red-400 bg-red-100 animate-pulse":$?"border-yellow-400 bg-yellow-100":x.status==="available"?"border-green-300 bg-green-100":x.status==="seated"||x.status==="ordered"||x.status==="served"?"border-orange-300 bg-orange-100":x.status==="reserved"?"border-blue-300 bg-blue-100":x.status==="awaiting_payment"?"border-indigo-300 bg-indigo-100":"border-gray-300 bg-gray-100"}
                  hover:shadow-lg
                `,children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-bold text-lg",children:x.table.number}),a.jsxs("div",{className:"flex items-center space-x-1",children:[_(x.table.location),x.currentOrder&&a.jsx("span",{className:"text-xs",children:"🍽️"})]})]}),a.jsx("div",{className:"text-center mb-2",children:a.jsxs("div",{className:"text-2xl",children:[x.status==="available"&&"✅",x.status==="reserved"&&"📅",(x.status==="seated"||x.status==="ordered"||x.status==="served")&&"👥",x.status==="awaiting_payment"&&"💳",x.status==="unavailable"&&"❌",P&&"⚠️"]})}),F>0&&a.jsx("div",{className:"text-center",children:a.jsx("div",{className:`text-xs font-medium ${P?"text-red-700":$?"text-yellow-700":"text-gray-700"}`,children:T(F)})}),a.jsx("div",{className:"absolute top-1 left-1",children:a.jsx("span",{className:"text-xs text-gray-600",children:x.table.capacity})}),x.currentOrder&&a.jsx("div",{className:"absolute top-1 right-1",children:a.jsxs("span",{className:"text-xs text-green-600 font-medium",children:["€",x.currentOrder.totalAmount.toFixed(0)]})})]},x.table.id)})}),e&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Zeitkonfiguration"}),a.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-600",children:"×"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Warnzeit (Minuten)"}),a.jsx("input",{type:"number",value:i.warningTimeMinutes,onChange:x=>o(P=>({...P,warningTimeMinutes:parseInt(x.target.value)})),min:"1",max:"180",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Überfälligkeitszeit (Minuten)"}),a.jsx("input",{type:"number",value:i.overdueTimeMinutes,onChange:x=>o(P=>({...P,overdueTimeMinutes:parseInt(x.target.value)})),min:"1",max:"300",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Maximale Servicezeit (Minuten)"}),a.jsx("input",{type:"number",value:i.maxServiceTimeMinutes,onChange:x=>o(P=>({...P,maxServiceTimeMinutes:parseInt(x.target.value)})),min:"1",max:"120",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[a.jsx("button",{onClick:w,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Speichern"}),a.jsx("button",{onClick:()=>r(!1),className:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Abbrechen"})]})]})]})})]})};class $y{static async getActiveReservationForTable(e){try{const r=new Date;r.setHours(0,0,0,0);const n=new Date(r);n.setDate(n.getDate()+1);const i=(await Qr.getReservations({tableNumber:e,dateRange:{start:r,end:n}})).find(o=>["confirmed","seated"].includes(o.status)&&this.isReservationCurrentlyActive(o));return i?{reservation:i,customerInfo:{name:i.customerName,email:i.customerEmail,phone:i.customerPhone},preOrderItems:i.preOrderItems}:null}catch(r){return console.error("Error getting active reservation for table:",r),null}}static isReservationCurrentlyActive(e){const r=new Date,n=new Date(e.date),[s,i]=e.startTime.split(":").map(Number),[o,l]=e.endTime.split(":").map(Number),c=new Date(n);c.setHours(s,i,0,0);const u=new Date(n);u.setHours(o,l,0,0);const d=new Date(c);d.setMinutes(d.getMinutes()-30);const h=new Date(u);return h.setHours(h.getHours()+3),r>=d&&r<=h}static async createOrderWithReservation(e,r){try{const n={...e,orderType:r?"reservation":"walk-in",payment:{status:"unpaid",amount:e.totalAmount},...r&&{reservationId:r}},s=await ls.createOrder(n);return r&&await this.updateReservationStatusFromOrder(r,"seated"),s}catch(n){throw console.error("Error creating order with reservation:",n),n}}static async updateReservationStatusFromOrder(e,r){try{await Qr.updateReservationStatus(e,r)}catch(n){console.error("Error updating reservation status:",n)}}static async getRecentOrdersForReservation(e){try{const r=Ce(),n=Be(r,"orders"),s=qe(n,Je("reservationId","==",e));return(await st(s)).docs.map(o=>{var c,u,d,h;const l=o.data();return{id:o.id,...l,createdAt:((c=l.createdAt)==null?void 0:c.toDate())||new Date,updatedAt:((u=l.updatedAt)==null?void 0:u.toDate())||new Date,estimatedCompletionTime:(d=l.estimatedCompletionTime)==null?void 0:d.toDate(),completedAt:(h=l.completedAt)==null?void 0:h.toDate()}})}catch(r){return console.error("Error getting orders for reservation:",r),[]}}static async handleOrderCompletion(e){try{const r=await ls.getOrderById(e);if(!r||!r.reservationId)return;if(r.status==="delivered"){const n=Ce(),s=await os(ot(n,"reservations",r.reservationId));s.exists()&&{id:s.id,...s.data()}.status!=="completed"&&await this.updateReservationStatusFromOrder(r.reservationId,"completed")}}catch(r){console.error("Error handling order completion:",r)}}static async getTableContextForOrdering(e){try{const r=await this.getActiveReservationForTable(e);return r?{hasActiveReservation:!0,reservationInfo:r,suggestedCustomerInfo:r.customerInfo}:{hasActiveReservation:!1}}catch(r){return console.error("Error getting table context:",r),{hasActiveReservation:!1}}}static async processPreOrderItems(e){try{if(!e||e.length===0)return[];const{MenuService:r}=await vp(()=>Promise.resolve().then(()=>oJ),void 0),n=await r.getAllMenuItems();return e.map(i=>{const o=n.find(l=>l.id===i);return o?{id:o.id,name:o.name,price:o.price,quantity:1,category:o.category,description:o.description,specialInstructions:"",createdAt:new Date}:null}).filter(i=>i!==null)}catch(r){return console.error("Error processing pre-order items:",r),[]}}static async getReservationOrdersByDateRange(e,r){try{const n=await ls.getOrdersWithFilters({dateRange:{start:e,end:r}}),s=n.filter(o=>o.orderType==="reservation"),i=n.filter(o=>o.orderType==="walk-in");return{reservationOrders:s,walkInOrders:i}}catch(n){return console.error("Error getting reservation orders:",n),{reservationOrders:[],walkInOrders:[]}}}static async linkOrderToReservation(e,r){try{const i=(await this.getRecentOrdersForReservation(r)).length===0?"Order placed":"Additional order placed";await Qr.updateReservationStatus(r,"seated",i)}catch(n){throw console.error("Error linking order to reservation:",n),n}}static async completeReservationWithPayment(e,r){try{await Qr.updateReservationStatus(e,"completed","Payment completed")}catch(n){throw console.error("Error completing reservation with payment:",n),n}}static validateOrderReservationConsistency(e,r){try{return e.tableNumber!==r.tableNumber?(console.warn("Table number mismatch:",e.tableNumber,"vs",r.tableNumber),!1):e.customerName&&e.customerName!==r.customerName?(console.warn("Customer name mismatch:",e.customerName,"vs",r.customerName),!1):e.customerEmail&&e.customerEmail!==r.customerEmail?(console.warn("Customer email mismatch:",e.customerEmail,"vs",r.customerEmail),!1):e.customerPhone&&e.customerPhone!==r.customerPhone?(console.warn("Customer phone mismatch:",e.customerPhone,"vs",r.customerPhone),!1):!0}catch(n){return console.error("Error validating order-reservation consistency:",n),!1}}}const lX=()=>{const[t,e]=M.useState(null),[r,n]=M.useState(!0),[s,i]=M.useState({start:new Date(new Date().setHours(0,0,0,0)),end:new Date(new Date().setHours(23,59,59,999))}),o=async()=>{try{n(!0);const u=await Qr.getReservations({dateRange:s}),{reservationOrders:d,walkInOrders:h}=await $y.getReservationOrdersByDateRange(s.start,s.end),g=u.length,m=d.length+h.length,w=d.length,_=g>0?w/g*100:0,T=d.reduce((P,F)=>P+F.totalAmount,0),v=h.reduce((P,F)=>P+F.totalAmount,0),b=T+v,x=m>0?b/m:0;e({totalReservations:g,totalOrders:m,linkedOrders:w,walkInOrders:h.length,linkageRate:_,totalRevenue:b,reservationRevenue:T,walkInRevenue:v,averageOrderValue:x})}catch(u){console.error("Error fetching integration stats:",u)}finally{n(!1)}};M.useEffect(()=>{o()},[s]);const l=u=>`€${u.toFixed(2)}`,c=u=>`${u.toFixed(1)}%`;return r?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-royal-cream mb-2",children:"Reservation-Order Integration Dashboard"}),a.jsx("p",{className:"text-royal-cream/70",children:"Monitor the connection between reservations and orders"})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 bg-royal-charcoal p-2 rounded-lg",children:[a.jsx(Un,{className:"w-4 h-4 text-royal-cream"}),a.jsx("input",{type:"date",value:s.start.toISOString().split("T")[0],onChange:u=>{const d=new Date(u.target.value);i({start:new Date(d.setHours(0,0,0,0)),end:new Date(d.setHours(23,59,59,999))})},className:"bg-transparent text-royal-cream text-sm border-none outline-none"})]}),a.jsxs("button",{onClick:o,className:"flex items-center space-x-2 bg-royal-gradient-gold text-royal-charcoal px-4 py-2 rounded-lg hover:shadow-lg transition-all duration-200",children:[a.jsx(Nr,{className:"w-4 h-4"}),a.jsx("span",{children:"Refresh"})]})]})]}),t&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream/70 text-sm",children:"Integration Rate"}),a.jsx("p",{className:"text-2xl font-bold text-green-400",children:c(t.linkageRate)}),a.jsxs("p",{className:"text-xs text-royal-cream/50 mt-1",children:[t.linkedOrders," of ",t.totalReservations," ","reservations"]})]}),a.jsx(aP,{className:"w-8 h-8 text-green-400"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream/70 text-sm",children:"Total Revenue"}),a.jsx("p",{className:"text-2xl font-bold text-royal-gold",children:l(t.totalRevenue)}),a.jsxs("p",{className:"text-xs text-royal-cream/50 mt-1",children:[t.totalOrders," orders today"]})]}),a.jsx(Lh,{className:"w-8 h-8 text-royal-gold"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream/70 text-sm",children:"Avg Order Value"}),a.jsx("p",{className:"text-2xl font-bold text-purple-400",children:l(t.averageOrderValue)}),a.jsx("p",{className:"text-xs text-royal-cream/50 mt-1",children:"per order"})]}),a.jsx(pl,{className:"w-8 h-8 text-purple-400"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream/70 text-sm",children:"Reservations"}),a.jsx("p",{className:"text-2xl font-bold text-blue-400",children:t.totalReservations}),a.jsx("p",{className:"text-xs text-royal-cream/50 mt-1",children:"today"})]}),a.jsx(iY,{className:"w-8 h-8 text-blue-400"})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20",children:[a.jsxs("h3",{className:"text-lg font-semibold text-royal-cream mb-4 flex items-center",children:[a.jsx(Lh,{className:"w-5 h-5 mr-2"}),"Revenue Breakdown"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Et,{className:"w-4 h-4 text-purple-400"}),a.jsx("span",{className:"text-royal-cream",children:"Reservation Orders"})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-lg font-semibold text-purple-400",children:l(t.reservationRevenue)}),a.jsxs("p",{className:"text-xs text-royal-cream/50",children:[t.linkedOrders," orders"]})]})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(qn,{className:"w-4 h-4 text-orange-400"}),a.jsx("span",{className:"text-royal-cream",children:"Walk-in Orders"})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-lg font-semibold text-orange-400",children:l(t.walkInRevenue)}),a.jsxs("p",{className:"text-xs text-royal-cream/50",children:[t.walkInOrders," orders"]})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"flex bg-royal-charcoal-dark rounded-full h-3 overflow-hidden",children:[a.jsx("div",{className:"bg-purple-400 h-full",style:{width:t.totalRevenue>0?`${t.reservationRevenue/t.totalRevenue*100}%`:"0%"}}),a.jsx("div",{className:"bg-orange-400 h-full",style:{width:t.totalRevenue>0?`${t.walkInRevenue/t.totalRevenue*100}%`:"0%"}})]}),a.jsxs("div",{className:"flex justify-between mt-2 text-xs text-royal-cream/50",children:[a.jsxs("span",{children:[t.totalRevenue>0?c(t.reservationRevenue/t.totalRevenue*100):"0%"," ","Reservations"]}),a.jsxs("span",{children:[t.totalRevenue>0?c(t.walkInRevenue/t.totalRevenue*100):"0%"," ","Walk-ins"]})]})]})]})]}),a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20",children:[a.jsxs("h3",{className:"text-lg font-semibold text-royal-cream mb-4 flex items-center",children:[a.jsx(xr,{className:"w-5 h-5 mr-2"}),"Integration Status"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-royal-cream",children:"Connected Reservations"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full"}),a.jsx("span",{className:"text-green-400 font-semibold",children:t.linkedOrders})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-royal-cream",children:"Unlinked Reservations"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-3 h-3 bg-yellow-400 rounded-full"}),a.jsx("span",{className:"text-yellow-400 font-semibold",children:t.totalReservations-t.linkedOrders})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-royal-cream",children:"Walk-in Orders"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-3 h-3 bg-blue-400 rounded-full"}),a.jsx("span",{className:"text-blue-400 font-semibold",children:t.walkInOrders})]})]}),a.jsx("div",{className:"mt-4 p-3 rounded-lg bg-royal-charcoal-dark",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[t.linkageRate>=80?a.jsx(xr,{className:"w-5 h-5 text-green-400"}):t.linkageRate>=60?a.jsx(_s,{className:"w-5 h-5 text-yellow-400"}):a.jsx(_s,{className:"w-5 h-5 text-red-400"}),a.jsx("span",{className:"text-sm text-royal-cream",children:t.linkageRate>=80?"Excellent integration rate!":t.linkageRate>=60?"Good integration rate":"Integration rate could be improved"})]})})]})]})]}),a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20",children:[a.jsxs("h3",{className:"text-lg font-semibold text-royal-cream mb-4 flex items-center",children:[a.jsx(pl,{className:"w-5 h-5 mr-2"}),"Integration Benefits (Free Reservations + Paid Orders)"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-green-400/20 rounded-full flex items-center justify-center mx-auto mb-2",children:a.jsx(qn,{className:"w-6 h-6 text-green-400"})}),a.jsx("h4",{className:"font-semibold text-royal-cream",children:"Customer Experience"}),a.jsx("p",{className:"text-sm text-royal-cream/70 mt-1",children:"Seamless transition from free table reservation to paid food ordering"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-purple-400/20 rounded-full flex items-center justify-center mx-auto mb-2",children:a.jsx(hP,{className:"w-6 h-6 text-purple-400"})}),a.jsx("h4",{className:"font-semibold text-royal-cream",children:"Order Efficiency"}),a.jsx("p",{className:"text-sm text-royal-cream/70 mt-1",children:"Auto-populated customer data speeds up the ordering process"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-royal-gold/20 rounded-full flex items-center justify-center mx-auto mb-2",children:a.jsx(Lh,{className:"w-6 h-6 text-royal-gold"})}),a.jsx("h4",{className:"font-semibold text-royal-cream",children:"Revenue Tracking"}),a.jsx("p",{className:"text-sm text-royal-cream/70 mt-1",children:"Clear separation between table bookings (free) and food sales (paid)"})]})]})]})]})]})},cX=()=>{const[t,e]=M.useState([]),[r,n]=M.useState([]),[s,i]=M.useState(new Set),o=Ce(),{data:l,loading:c,error:u,isEmpty:d,loadMultipleData:h,reload:g}=rX({initialData:{menuItems:[],pendingOrders:[]},onSuccess:S=>{console.log("📊 BarOperations: Initial data loaded successfully",{menuItems:S.menuItems.length,pendingOrders:S.pendingOrders.length}),T(S.pendingOrders,S.menuItems)},onError:S=>{console.error("❌ BarOperations: Initial data loading failed:",S),Ee.error("Fehler beim Laden der Daten")},checkEmpty:S=>S.menuItems.length===0&&S.pendingOrders.length===0}),{loading:m,error:w,setupRealtimeListener:_}=_P([],S=>Array.isArray(S)?S.length===0:!S);M.useEffect(()=>{console.log("🔄 BarOperations: Loading initial data"),h({menuItems:async()=>{console.log("📋 Loading menu items...");const S=qe(Be(o,"menuItems")),C=(await st(S)).docs.map(G=>({id:G.id,...G.data()}));return console.log("📋 Menu items loaded:",C.length),C},pendingOrders:async()=>{console.log("📊 Loading pending orders...");const S=qe(Be(o,"orders"),Je("status","in",["pending","confirmed","preparing"]),Vt("createdAt","asc")),C=(await st(S)).docs.map(G=>{const de=G.data();return{id:G.id,...de,createdAt:qo(de.createdAt),updatedAt:qo(de.updatedAt)}});return console.log("📊 Orders loaded:",C.length),C}})},[]),M.useEffect(()=>{if(!l||c)return;console.log("🔄 BarOperations: Setting up realtime listener");const S=_(R=>{const C=qe(Be(o,"orders"),Je("status","in",["pending","confirmed","preparing"]),Vt("createdAt","asc"));return wi(C,G=>{console.log("📊 Realtime orders update:",{docs:G.docs.length,fromCache:G.metadata.fromCache,hasPendingWrites:G.metadata.hasPendingWrites});const de=G.docs.map(ne=>{const X=ne.data();return{id:ne.id,...X,createdAt:qo(X.createdAt),updatedAt:qo(X.updatedAt)}});R(de)},G=>{console.error("❌ Realtime listener error:",G),Ee.error("Fehler bei der Echtzeitaktualisierung")})},R=>(l!=null&&l.menuItems&&T(R,l.menuItems),R));return()=>{console.log("🔄 Cleaning up realtime listener"),S()}},[l,c,_]);const T=M.useCallback((S,R)=>{console.log("🔄 Processing orders with menu items",{orders:S.length,menuItems:R.length});const C=[],G=[];S.forEach(de=>{de.items.forEach(ne=>{const X=R.find(Y=>Y.id===ne.menuItemId);if(X){const Y={...de,currentItem:{...ne,...X}};console.log(`🍽️ Processing item: ${X.name} (${X.category})`),X.category==="drinks"||X.category==="beverages"?C.push(Y):(X.category==="shisha"||X.category==="hookah"||X.category==="tobacco")&&G.push(Y)}else console.warn("⚠️ Menu item not found for orderItem:",ne.menuItemId)})}),console.log("🍹 Processed drink orders:",C.length),console.log("💨 Processed shisha orders:",G.length),e(C),n(G)},[]),v=async S=>{if(!s.has(S)){i(R=>new Set(R).add(S));try{await ls.updateOrderStatus(S,"ready"),Ee.success("Bestellung abgeschlossen"),g()}catch(R){console.error("❌ Error completing order:",R),Ee.error("Fehler beim Abschließen der Bestellung")}finally{i(R=>{const C=new Set(R);return C.delete(S),C})}}},b=async S=>{if(!s.has(S)){i(R=>new Set(R).add(S));try{await ls.updateOrderStatus(S,"preparing"),Ee.success("Zubereitung gestartet")}catch(R){console.error("❌ Error starting preparation:",R),Ee.error("Fehler beim Starten der Zubereitung")}finally{i(R=>{const C=new Set(R);return C.delete(S),C})}}},x=S=>{const R=new Date,C=qo(S),G=Math.floor((R.getTime()-C.getTime())/(1e3*60));return G>20?"urgent":G>10?"high":"normal"},P=S=>{switch(S){case"urgent":return"bg-red-100 border-red-300 text-red-800";case"high":return"bg-orange-100 border-orange-300 text-orange-800";default:return"bg-blue-100 border-blue-300 text-blue-800"}},F=S=>{const R=new Date,C=qo(S);return`${Math.floor((R.getTime()-C.getTime())/(1e3*60))} min`},$=S=>{switch(S){case"urgent":return"DRINGEND";case"high":return"HOCH";default:return"NORMAL"}},k=S=>{switch(S){case"pending":return"Wartend";case"confirmed":return"Bestätigt";case"preparing":return"In Zubereitung";default:return S}},A=S=>{switch(S){case"pending":return"bg-yellow-100 text-yellow-800";case"confirmed":return"bg-blue-100 text-blue-800";case"preparing":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},I=({order:S})=>{const R=x(S.createdAt),C=s.has(S.id);return a.jsxs("div",{className:`
        p-4 rounded-lg border-2 mb-4 transition-all duration-300
        ${P(R)}
        ${C?"opacity-50 pointer-events-none":""}
      `,children:[a.jsxs("div",{className:"flex justify-between items-start mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(sP,{className:"w-4 h-4"}),a.jsxs("span",{className:"font-semibold",children:["#",S.id]}),a.jsx("span",{className:`px-2 py-1 rounded text-xs ${A(S.status)}`,children:k(S.status)})]}),a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(Rr,{className:"w-4 h-4"}),a.jsx("span",{children:F(S.createdAt)}),a.jsx("span",{className:"font-medium",children:$(R)})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[S.currentItem.category==="drinks"?a.jsx(p3,{className:"w-5 h-5 text-blue-600"}):a.jsx(g3,{className:"w-5 h-5 text-orange-600"}),a.jsx("span",{className:"font-medium",children:S.currentItem.name})]}),a.jsxs("p",{className:"text-sm text-gray-600 ml-7",children:["Menge: ",S.currentItem.quantity]}),S.currentItem.specialInstructions&&a.jsxs("p",{className:"text-sm text-gray-600 ml-7 mt-1",children:["Notizen: ",S.currentItem.specialInstructions]})]}),a.jsxs("div",{className:"flex space-x-2",children:[S.status==="pending"&&a.jsx("button",{onClick:()=>b(S.id),disabled:C,className:"flex-1 bg-blue-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:C?a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx(Nr,{className:"w-4 h-4 animate-spin mr-1"}),"Wird gestartet..."]}):a.jsxs(a.Fragment,{children:[a.jsx(NN,{className:"w-4 h-4 mr-1 inline"}),"Zubereitung starten"]})}),(S.status==="confirmed"||S.status==="preparing")&&a.jsx("button",{onClick:()=>v(S.id),disabled:C,className:"flex-1 bg-green-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:C?a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx(Nr,{className:"w-4 h-4 animate-spin mr-1"}),"Wird abgeschlossen..."]}):a.jsxs(a.Fragment,{children:[a.jsx(xr,{className:"w-4 h-4 mr-1 inline"}),"Abschließen"]})})]}),a.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:[a.jsxs("p",{children:["Tisch: ",S.tableNumber||"N/A"]}),a.jsxs("p",{children:["Kunde: ",S.customerName||"N/A"]}),a.jsxs("p",{children:["Erstellt: ",qo(S.createdAt).toLocaleString()]})]})]})};if(c)return a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-6",children:[a.jsx(Nr,{className:"w-5 h-5 animate-spin"}),a.jsx("span",{children:"Laden der Bardaten..."})]}),a.jsx(jn,{})]});if(u)return a.jsx("div",{className:"p-6",children:a.jsx(TN,{title:"Fehler beim Laden der Daten",description:u,onRetry:g,retrying:c})});if(d)return a.jsx("div",{className:"p-6",children:a.jsx(I0,{title:"Keine Daten verfügbar",description:"Es sind keine Menüdaten oder Bestellungen vorhanden.",onRefresh:g,refreshing:c})});const O=t.length+r.length;return a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Barbereich (",O," Bestellungen)"]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[m&&a.jsxs("div",{className:"flex items-center space-x-2 text-blue-600",children:[a.jsx(Nr,{className:"w-4 h-4 animate-spin"}),a.jsx("span",{className:"text-sm",children:"Aktualisierung..."})]}),a.jsxs("button",{onClick:g,disabled:c,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:[a.jsx(Nr,{className:`w-4 h-4 ${c?"animate-spin":""}`}),a.jsx("span",{children:"Aktualisieren"})]})]})]}),w&&a.jsx("div",{className:"mb-4 p-4 bg-orange-50 border border-orange-200 rounded-md",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Nr,{className:"w-4 h-4 text-orange-600"}),a.jsxs("span",{className:"text-sm text-orange-800",children:["Echtzeitaktualisierung unterbrochen: ",w]})]})}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[a.jsx(p3,{className:"w-6 h-6 mr-2 text-blue-600"}),"Getränke (",t.length,")"]}),a.jsx("div",{className:"space-y-4",children:t.length>0?t.map(S=>a.jsx(I,{order:S},`${S.id}-${S.currentItem.menuItemId}`)):a.jsx(I0,{title:"Keine Getränkebestellungen",description:"Derzeit gibt es keine offenen Getränkebestellungen."})})]}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[a.jsx(g3,{className:"w-6 h-6 mr-2 text-orange-600"}),"Shisha (",r.length,")"]}),a.jsx("div",{className:"space-y-4",children:r.length>0?r.map(S=>a.jsx(I,{order:S},`${S.id}-${S.currentItem.menuItemId}`)):a.jsx(I0,{title:"Keine Shisha-Bestellungen",description:"Derzeit gibt es keine offenen Shisha-Bestellungen."})})]})]})]})},jP=()=>{const{user:t,isAuthenticated:e}=yn();return{isAdmin:Mt.isAdmin(),isStaffOrAdmin:Mt.isStaffOrAdmin(),isAuthenticated:Mt.isAuthenticated(),userRole:Mt.getUserRole(),userId:Mt.getUserId(),userEmail:Mt.getUserEmail(),storeIsAuthenticated:e,storeUser:t,canAccessAdmin:()=>Mt.isAdmin(),canManageOrders:()=>Mt.isStaffOrAdmin(),canManageMenu:()=>Mt.isAdmin(),canManageEvents:()=>Mt.isAdmin(),canManageUsers:()=>Mt.isAdmin(),canCreateReservations:()=>Mt.isAuthenticated(),canViewAnalytics:()=>Mt.isAdmin(),canManageTables:()=>Mt.isAdmin(),canManageSpecialOffers:()=>Mt.isAdmin(),requiresAuth:r=>Mt.isAuthenticated()?!0:(console.warn(`⚠️ Action "${r}" requires authentication`),!1),requiresAdmin:r=>Mt.isAdmin()?!0:(console.warn(`⚠️ Action "${r}" requires admin privileges`),!1),requiresStaffOrAdmin:r=>Mt.isStaffOrAdmin()?!0:(console.warn(`⚠️ Action "${r}" requires staff or admin privileges`),!1),getSessionInfo:()=>Mt.getSessionInfo()}};class ar{static getCookieConsent(){try{const e=localStorage.getItem(this.COOKIE_CONSENT_KEY);if(e){const r=JSON.parse(e);return{...r,consentDate:new Date(r.consentDate)}}return null}catch(e){return console.error("Error getting cookie consent:",e),null}}static async saveCookieConsent(e){try{localStorage.setItem(this.COOKIE_CONSENT_KEY,JSON.stringify(e));const r=Ka.getCurrentUser();if(r){const n=Ce();await xa(ot(n,this.COOKIE_CONSENTS_COLLECTION,r.uid),{...e,consentDate:yt.fromDate(e.consentDate),userId:r.uid,ipAddress:await this.getClientIP(),userAgent:navigator.userAgent}),await this.logAuditEvent({userId:r.uid,action:"consent_updated",dataCategory:"privacy",resource:"cookie_consent",resourceId:r.uid,details:{consent:e}})}}catch(r){throw console.error("Error saving cookie consent:",r),r}}static async getPrivacySettings(e){try{const r=Ce(),n=ot(r,this.PRIVACY_SETTINGS_COLLECTION,e),s=await os(n);if(s.exists()){const i=s.data();return{...i,updatedAt:i.updatedAt.toDate()}}return null}catch(r){throw console.error("Error getting privacy settings:",r),r}}static async updatePrivacySettings(e,r){try{const n=Ce(),s=ot(n,this.PRIVACY_SETTINGS_COLLECTION,e),i={...r,userId:e,updatedAt:ft()};await xa(s,i,{merge:!0}),await this.logAuditEvent({userId:e,action:"privacy_settings_changed",dataCategory:"privacy",resource:"privacy_settings",resourceId:e,details:{updatedSettings:r}})}catch(n){throw console.error("Error updating privacy settings:",n),n}}static async requestDataExport(e,r){try{const n=Ce(),s=r==="complete"?Object.keys(this.getDataCategories()):r,i={userId:e,requestedAt:new Date,status:"pending",dataCategories:s},o=ot(Be(n,this.DATA_EXPORT_REQUESTS_COLLECTION));return await xa(o,{...i,requestedAt:ft()}),await this.logAuditEvent({userId:e,action:"export",dataCategory:"user_data",details:`Data export requested for categories: ${s.join(", ")}`,resource:"data_export_request",resourceId:o.id}),this.processDataExport(o.id,e,s),o.id}catch(n){throw console.error("Error requesting data export:",n),n}}static async processDataExport(e,r,n){try{const s=Ce(),i=ot(s,this.DATA_EXPORT_REQUESTS_COLLECTION,e);await Qt(i,{status:"processing",processedAt:ft()});const o=await this.collectUserDataFromFirebase(r,n),l=await this.generateExportFile(r,o);await Qt(i,{status:"completed",downloadUrl:l,completedAt:ft(),expiresAt:new Date(Date.now()+30*24*60*60*1e3)}),await this.logAuditEvent({userId:r,action:"export",dataCategory:"user_data",details:"Data export completed successfully",resource:"data_export_request",resourceId:e})}catch(s){console.error("Error processing data export:",s);const i=Ce(),o=ot(i,this.DATA_EXPORT_REQUESTS_COLLECTION,e);await Qt(o,{status:"failed",error:s instanceof Error?s.message:"Export processing failed"})}}static async collectUserDataFromFirebase(e,r){var i,o,l;const n=Ce(),s={exportDate:new Date().toISOString(),userId:e,categories:r,data:{}};try{if(r.includes("profile")){const c=await os(ot(n,"users",e));c.exists()&&(s.data.profile={...c.data(),id:c.id})}if(r.includes("reservations")){const c=qe(Be(n,"reservations"),Je("userId","==",e)),u=await st(c);s.data.reservations=u.docs.map(d=>{var h,g,m,w,_,T;return{id:d.id,...d.data(),createdAt:((m=(g=(h=d.data().createdAt)==null?void 0:h.toDate)==null?void 0:g.call(h))==null?void 0:m.toISOString())||d.data().createdAt,date:((T=(_=(w=d.data().date)==null?void 0:w.toDate)==null?void 0:_.call(w))==null?void 0:T.toISOString())||d.data().date}})}if(r.includes("orders")){const c=qe(Be(n,"orders"),Je("userId","==",e)),u=await st(c);s.data.orders=u.docs.map(d=>{var h,g,m,w,_,T;return{id:d.id,...d.data(),createdAt:((m=(g=(h=d.data().createdAt)==null?void 0:h.toDate)==null?void 0:g.call(h))==null?void 0:m.toISOString())||d.data().createdAt,updatedAt:((T=(_=(w=d.data().updatedAt)==null?void 0:w.toDate)==null?void 0:_.call(w))==null?void 0:T.toISOString())||d.data().updatedAt}})}if(r.includes("loyalty")){const c=qe(Be(n,"loyaltyCards"),Je("userId","==",e)),u=await st(c);s.data.loyalty=u.docs.map(d=>{var h,g,m,w,_,T;return{id:d.id,...d.data(),createdAt:((m=(g=(h=d.data().createdAt)==null?void 0:h.toDate)==null?void 0:g.call(h))==null?void 0:m.toISOString())||d.data().createdAt,lastUsed:((T=(_=(w=d.data().lastUsed)==null?void 0:w.toDate)==null?void 0:_.call(w))==null?void 0:T.toISOString())||d.data().lastUsed}})}if(r.includes("events")){const c=qe(Be(n,"events"),Je("attendees","array-contains",e)),u=await st(c);s.data.events=u.docs.map(d=>{var h,g,m;return{id:d.id,title:d.data().title,date:((m=(g=(h=d.data().date)==null?void 0:h.toDate)==null?void 0:g.call(h))==null?void 0:m.toISOString())||d.data().date,participationDate:new Date().toISOString()}})}if(r.includes("privacy")){const c=await os(ot(n,this.PRIVACY_SETTINGS_COLLECTION,e));c.exists()&&(s.data.privacy={...c.data(),updatedAt:((l=(o=(i=c.data().updatedAt)==null?void 0:i.toDate)==null?void 0:o.call(i))==null?void 0:l.toISOString())||c.data().updatedAt});const u=qe(Be(n,this.CONSENT_RECORDS_COLLECTION),Je("userId","==",e)),d=await st(u);s.data.consents=d.docs.map(h=>{var g,m,w,_,T,v;return{id:h.id,...h.data(),timestamp:((w=(m=(g=h.data().timestamp)==null?void 0:g.toDate)==null?void 0:m.call(g))==null?void 0:w.toISOString())||h.data().timestamp,withdrawnAt:((v=(T=(_=h.data().withdrawnAt)==null?void 0:_.toDate)==null?void 0:T.call(_))==null?void 0:v.toISOString())||h.data().withdrawnAt}})}if(r.includes("analytics")){const c=qe(Be(n,this.AUDIT_LOG_COLLECTION),Je("userId","==",e),Vt("timestamp","desc")),u=await st(c);s.data.analytics=u.docs.slice(0,100).map(d=>{var h,g,m;return{id:d.id,action:d.data().action,dataCategory:d.data().dataCategory,timestamp:((m=(g=(h=d.data().timestamp)==null?void 0:h.toDate)==null?void 0:g.call(h))==null?void 0:m.toISOString())||d.data().timestamp}})}if(r.includes("communication")){const c=await os(ot(n,this.PRIVACY_SETTINGS_COLLECTION,e));c.exists()&&(s.data.communication={preferences:c.data().communicationPreferences,emailMarketing:c.data().emailMarketing,smsMarketing:c.data().smsMarketing})}return s}catch(c){throw console.error("Error collecting user data from Firebase:",c),c}}static async generateExportFile(e,r){try{const n=JSON.stringify(r,null,2),s=new Blob([n],{type:"application/json"});return URL.createObjectURL(s)}catch(n){throw console.error("Error generating export file:",n),n}}static async getDataExportRequests(e){return this.getUserDataExportRequests(e)}static async getDataDeletionRequests(e){return this.getUserDataDeletionRequests(e)}static async getAuditLogs(e,r=50){return this.getUserAuditLog(e,r)}static async requestDataDeletion(e,r){try{const n=Ce(),s=await this.checkDataRetentionReasons(e),i={userId:e,requestedAt:new Date,scheduledDeletionDate:new Date(Date.now()+30*24*60*60*1e3),status:s.length>0?"pending":"processing",reason:r,retentionReasons:s,anonymizationComplete:!1},o=ot(Be(n,this.DATA_DELETION_REQUESTS_COLLECTION));return await xa(o,{...i,requestedAt:ft(),scheduledDeletionDate:new Date(Date.now()+30*24*60*60*1e3)}),await this.logAuditEvent({userId:e,action:"delete",dataCategory:"user_data",details:`Data deletion requested. Reason: ${r||"Not specified"}. Retention reasons: ${s.join(", ")||"None"}`,resource:"data_deletion_request",resourceId:o.id}),s.length===0&&this.processDataDeletion(o.id,e),o.id}catch(n){throw console.error("Error requesting data deletion:",n),n}}static async checkDataRetentionReasons(e){const r=[];try{const n=Ce(),s=qe(Be(n,"reservations"),Je("userId","==",e),Je("date",">=",new Date));(await st(s)).empty||r.push("Active or future reservations exist");const o=new Date(Date.now()-30*24*60*60*1e3),l=qe(Be(n,"orders"),Je("userId","==",e),Je("createdAt",">=",o));(await st(l)).empty||r.push("Recent orders within legal retention period (30 days)");const u=qe(Be(n,"orders"),Je("userId","==",e),Je("status","in",["pending","processing","confirmed"]));return(await st(u)).empty||r.push("Pending or processing orders exist"),r}catch(n){return console.error("Error checking retention reasons:",n),["Unable to verify data retention requirements"]}}static async processDataDeletion(e,r){try{const n=Ce(),s=ot(n,this.DATA_DELETION_REQUESTS_COLLECTION,e);await Qt(s,{status:"processing",processedAt:ft()}),await this.deleteUserDataFromFirebase(r),await Qt(s,{status:"completed",anonymizationComplete:!0,completedAt:ft()}),await this.logAuditEvent({userId:"system",action:"delete",dataCategory:"user_data",details:`User data deletion completed for userId: ${r}`,resource:"data_deletion_request",resourceId:e})}catch(n){console.error("Error processing data deletion:",n);const s=Ce(),i=ot(s,this.DATA_DELETION_REQUESTS_COLLECTION,e);await Qt(i,{status:"failed",error:n instanceof Error?n.message:"Data deletion processing failed"})}}static async deleteUserDataFromFirebase(e){const r=Ce();try{await ba(ot(r,"users",e));const n=qe(Be(r,"reservations"),Je("userId","==",e)),s=await st(n);for(const v of s.docs)await Qt(v.ref,{userId:"deleted-user",customerName:"Deleted User",email:"deleted@example.com",phone:"Deleted",specialRequests:"Deleted",gdprDeleted:!0,gdprDeletedAt:ft()});const i=qe(Be(r,"orders"),Je("userId","==",e)),o=await st(i);for(const v of o.docs)await Qt(v.ref,{userId:"deleted-user",customerInfo:{name:"Deleted User",email:"deleted@example.com",phone:"Deleted"},gdprDeleted:!0,gdprDeletedAt:ft()});const l=qe(Be(r,"loyaltyCards"),Je("userId","==",e)),c=await st(l);for(const v of c.docs)await ba(v.ref);const u=qe(Be(r,"events"),Je("attendees","array-contains",e)),d=await st(u);for(const v of d.docs)await Qt(v.ref,{attendees:UU(e)});await ba(ot(r,this.PRIVACY_SETTINGS_COLLECTION,e));const h=qe(Be(r,this.CONSENT_RECORDS_COLLECTION),Je("userId","==",e)),g=await st(h);for(const v of g.docs)await ba(v.ref);const m=qe(Be(r,this.AUDIT_LOG_COLLECTION),Je("userId","==",e)),w=await st(m);for(const v of w.docs)await Qt(v.ref,{userId:"deleted-user",ipAddress:"deleted",userAgent:"deleted",gdprDeleted:!0,gdprDeletedAt:ft()});const _=qe(Be(r,this.COOKIE_CONSENTS_COLLECTION),Je("userId","==",e)),T=await st(_);for(const v of T.docs)await ba(v.ref)}catch(n){throw console.error("Error deleting user data from Firebase:",n),n}}static async recordConsent(e,r,n,s){try{console.log("🔒 Recording consent:",{userId:e,purpose:r,granted:n});const i=Ce();if(!e||!r)throw new Error("Invalid user ID or purpose for consent recording");const o={userId:e,purpose:r,granted:n,timestamp:ft(),ipAddress:"hidden",userAgent:navigator.userAgent||"unknown",metadata:s||null},l=ot(Be(i,this.CONSENT_RECORDS_COLLECTION));await xa(l,o),console.log("✅ Consent recorded successfully with ID:",l.id);try{await this.logAuditEvent({userId:e,action:n?"consent_granted":"consent_denied",dataCategory:"consent",details:`Consent ${n?"granted":"denied"} for purpose: ${r}`,resource:"consent_record",resourceId:l.id})}catch(c){console.warn("⚠️ Failed to log audit event, but consent was saved:",c)}}catch(i){throw console.error("❌ Error recording consent:",i),i instanceof Error?i.message.includes("permission-denied")?new Error("Berechtigung verweigert. Bitte melden Sie sich erneut an."):i.message.includes("network")?new Error("Netzwerkfehler. Bitte überprüfen Sie Ihre Internetverbindung."):new Error(`Fehler beim Speichern: ${i.message}`):new Error("Unbekannter Fehler beim Speichern der Einwilligung")}}static async getConsentRecord(e,r){var n;try{const s=Ce(),i=qe(Be(s,this.CONSENT_RECORDS_COLLECTION),Je("userId","==",e),Je("purpose","==",r),Vt("timestamp","desc"),DU(1)),o=await st(i);if(o.empty)return null;const l=o.docs[0];return{id:l.id,...l.data(),timestamp:((n=l.data().timestamp)==null?void 0:n.toDate())||new Date}}catch(s){return console.error("Error getting consent record:",s),null}}static async withdrawConsent(e,r){try{const n=Ce(),s={userId:e,purpose:r,granted:!1,timestamp:new Date,withdrawnAt:new Date,ipAddress:"hidden",userAgent:navigator.userAgent};await xa(ot(Be(n,this.CONSENT_RECORDS_COLLECTION)),{...s,timestamp:ft(),withdrawnAt:ft()}),await this.logAuditEvent({userId:e,action:"consent_withdrawn",dataCategory:"consent",details:`Consent withdrawn for purpose: ${r}`,resource:"consent_record",resourceId:r})}catch(n){throw console.error("Error withdrawing consent:",n),n}}static async getAllConsentRecords(e){try{const r=Ce(),n=qe(Be(r,this.CONSENT_RECORDS_COLLECTION),Je("userId","==",e),Vt("timestamp","desc"));return(await st(n)).docs.map(i=>{var o,l;return{id:i.id,...i.data(),timestamp:((o=i.data().timestamp)==null?void 0:o.toDate())||new Date,withdrawnAt:((l=i.data().withdrawnAt)==null?void 0:l.toDate())||void 0}})}catch(r){return console.error("Error getting all consent records:",r),[]}}static async hasValidConsent(e,r){const n=await this.getConsentRecord(e,r);return n?n.granted&&!n.withdrawnAt:!1}static async getDataMinimizationRules(){return{reservation_processing:["name","email","phone","reservationDate","partySize"],order_processing:["name","email","phone","orderItems","paymentMethod"],loyalty_program:["name","email","phoneOptional","purchaseHistory"],marketing_communications:["name","email"],analytics:[]}}static async logAuditEvent(e){try{const r=Ce();let n="unknown";try{const o=this.getClientIP(),l=new Promise((c,u)=>setTimeout(()=>u(new Error("timeout")),2e3));n=await Promise.race([o,l])}catch(o){console.warn("Could not get client IP:",o),n="unknown"}const s={...e,timestamp:ft(),ipAddress:n,userAgent:navigator.userAgent||"unknown"},i=ot(Be(r,this.AUDIT_LOG_COLLECTION));await xa(i,s)}catch(r){console.error("Error logging audit event:",r)}}static async getPrivacyDashboardData(e){try{const[r,n,s,i,o]=await Promise.all([Ka.getUserData(e),this.getPrivacySettings(e),this.getUserDataExportRequests(e),this.getUserDataDeletionRequests(e),this.getUserAuditLog(e,50)]);return{user:{profile:r,dataCategories:this.getUserDataCategories(e),lastDataExport:this.getLastDataExportDate(s),accountCreated:(r==null?void 0:r.createdAt)||new Date},consents:await this.getUserConsentRecords(e),privacySettings:n||this.getDefaultPrivacySettings(e),dataRequests:{exports:s,deletions:i},auditLog:o}}catch(r){throw console.error("Error getting privacy dashboard data:",r),r}}static async getClientIP(){try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip}catch{return"unknown"}}static getDataCategories(){return{profile:"Profile Information",authentication:"Authentication Data",reservations:"Reservation History",orders:"Order History",loyalty:"Loyalty Program Data",events:"Event Participation",analytics:"Usage Analytics",communication:"Communication Preferences",privacy:"Privacy Settings and Consent Data"}}static getUserDataCategories(e){return Object.keys(this.getDataCategories())}static getDefaultPrivacySettings(e){return{userId:e,cookieConsent:{necessary:!0,analytics:!1,marketing:!1,functional:!1},communicationPreferences:{email:!1,sms:!1,push:!1},dataProcessingConsent:{profiling:!1,analytics:!1,marketing:!1},emailMarketing:!1,smsMarketing:!1,profilingConsent:!1,thirdPartyDataSharing:!1,updatedAt:new Date}}static async getUserDataExportRequests(e){try{const r=Ce(),n=qe(Be(r,this.DATA_EXPORT_REQUESTS_COLLECTION),Je("userId","==",e),Vt("requestedAt","desc"));return(await st(n)).docs.map(i=>{var o;return{id:i.id,...i.data(),requestedAt:i.data().requestedAt.toDate(),expiresAt:(o=i.data().expiresAt)==null?void 0:o.toDate()}})}catch(r){return console.error("Error getting export requests:",r),[]}}static async getUserDataDeletionRequests(e){try{const r=Ce(),n=qe(Be(r,this.DATA_DELETION_REQUESTS_COLLECTION),Je("userId","==",e),Vt("requestedAt","desc"));return(await st(n)).docs.map(i=>({id:i.id,...i.data(),requestedAt:i.data().requestedAt.toDate(),scheduledDeletionDate:i.data().scheduledDeletionDate.toDate()}))}catch(r){return console.error("Error getting deletion requests:",r),[]}}static async getUserAuditLog(e,r=50){try{const n=Ce(),s=qe(Be(n,this.AUDIT_LOG_COLLECTION),Je("userId","==",e),Vt("timestamp","desc"));return(await st(s)).docs.slice(0,r).map(o=>({id:o.id,...o.data(),timestamp:o.data().timestamp.toDate()}))}catch(n){return console.error("Error getting audit log:",n),[]}}static async getUserConsentRecords(e){try{const r=Ce(),n=qe(Be(r,this.CONSENT_RECORDS_COLLECTION),Je("userId","==",e),Vt("timestamp","desc"));return(await st(n)).docs.map(i=>{var o;return{...i.data(),timestamp:i.data().timestamp.toDate(),withdrawnAt:(o=i.data().withdrawnAt)==null?void 0:o.toDate()}})}catch(r){return console.error("Error getting consent records:",r),[]}}static getLastDataExportDate(e){const r=e.filter(n=>n.status==="completed");return r.length>0?r[0].requestedAt:void 0}static async getGDPRComplianceStatus(e){var r,n;try{const[s,i,o]=await Promise.all([this.getCookieConsent(),this.getPrivacySettings(e),this.getUserConsentRecords(e)]),l={};return o.forEach(c=>{l[c.purpose]=c.granted&&!c.withdrawnAt}),{cookieConsent:!!s,privacyPolicyAccepted:!!((r=i==null?void 0:i.dataProcessingConsent)!=null&&r.profiling),dataProcessingConsents:l,lastConsentUpdate:((n=o[0])==null?void 0:n.timestamp)||new Date,hasOutstandingRequests:!1}}catch(s){throw console.error("Error getting GDPR compliance status:",s),s}}static async getAdminGDPRStats(){try{const e=new Date;e.setHours(0,0,0,0);const[r,n,s]=await Promise.all([this.getAllDataExportRequests(),this.getAllDataDeletionRequests(),this.getSystemAuditLogs(1e3)]),i=r.filter(h=>h.status==="pending"||h.status==="processing").length,o=n.filter(h=>h.status==="pending"||h.status==="processing").length,l=r.filter(h=>h.status==="completed"&&h.requestedAt>=e).length,c=n.filter(h=>h.status==="completed"&&h.requestedAt>=e).length,u=r.filter(h=>h.status==="completed"),d=u.length>0?u.reduce((h,g)=>{const m=g.requestedAt.getTime();return h+m},0)/u.length/(1e3*60*60):0;return{totalUsers:150,activeExportRequests:i,activeDeletionRequests:o,completedExportsToday:l,completedDeletionsToday:c,averageProcessingTime:Math.round(d*10)/10,complianceScore:95,totalAuditLogs:s.length}}catch(e){throw console.error("Error getting admin GDPR stats:",e),e}}static async getAllDataExportRequests(){try{const e=Ce(),r=qe(Be(e,this.DATA_EXPORT_REQUESTS_COLLECTION),Vt("requestedAt","desc"));return(await st(r)).docs.map(s=>{var i;return{id:s.id,...s.data(),requestedAt:s.data().requestedAt.toDate(),expiresAt:(i=s.data().expiresAt)==null?void 0:i.toDate()}})}catch(e){return console.error("Error getting all export requests:",e),[]}}static async getAllDataDeletionRequests(){try{const e=Ce(),r=qe(Be(e,this.DATA_DELETION_REQUESTS_COLLECTION),Vt("requestedAt","desc"));return(await st(r)).docs.map(s=>({id:s.id,...s.data(),requestedAt:s.data().requestedAt.toDate(),scheduledDeletionDate:s.data().scheduledDeletionDate.toDate()}))}catch(e){return console.error("Error getting all deletion requests:",e),[]}}static async getSystemAuditLogs(e=100){try{const r=Ce(),n=qe(Be(r,this.AUDIT_LOG_COLLECTION),Vt("timestamp","desc"));return(await st(n)).docs.slice(0,e).map(i=>({id:i.id,...i.data(),timestamp:i.data().timestamp.toDate()}))}catch(r){return console.error("Error getting system audit logs:",r),[]}}static async searchUsers(e){try{const r=Ce(),n=qe(Be(r,"users"),Je("email",">=",e),Je("email","<=",e+"")),i=(await st(n)).docs.map(l=>{var c;return{id:l.id,...l.data(),lastLogin:((c=l.data().lastLogin)==null?void 0:c.toDate())||new Date,dataCategories:this.getUserDataCategories(l.id)}});return await Promise.all(i.map(async l=>{const[c,u]=await Promise.all([this.getUserDataExportRequests(l.id),this.getUserDataDeletionRequests(l.id)]);return{...l,hasGDPRRequests:c.length>0||u.length>0}}))}catch(r){return console.error("Error searching users:",r),[]}}static async adminProcessExportRequest(e,r){try{const n=Ce(),s=ot(n,this.DATA_EXPORT_REQUESTS_COLLECTION,e);if(r==="approve"){await Qt(s,{status:"processing"});const i=await os(s);if(i.exists()){const o=i.data();this.processDataExport(e,o.userId,o.dataCategories)}}else await Qt(s,{status:"failed"});await this.logAuditEvent({adminUserId:"current-admin-id",action:r==="approve"?"update":"delete",dataCategory:"export_request",details:`Export request ${r}d by admin`,resource:"data_export_request",resourceId:e})}catch(n){throw console.error(`Error ${r}ing export request:`,n),n}}static async adminProcessDeletionRequest(e,r,n){try{const s=Ce(),i=ot(s,this.DATA_DELETION_REQUESTS_COLLECTION,e);if(r==="approve"){await Qt(i,{status:"processing",adminNotes:n});const o=await os(i);if(o.exists()){const l=o.data();this.processDataDeletion(e,l.userId)}}else await Qt(i,{status:"rejected",adminNotes:n});await this.logAuditEvent({adminUserId:"current-admin-id",action:r==="approve"?"update":"delete",dataCategory:"deletion_request",details:`Deletion request ${r}d by admin. Notes: ${n||"None"}`,resource:"data_deletion_request",resourceId:e})}catch(s){throw console.error(`Error ${r}ing deletion request:`,s),s}}static async generateComplianceReport(){try{const[e,r,n,s]=await Promise.all([this.getAdminGDPRStats(),this.getAllDataExportRequests(),this.getAllDataDeletionRequests(),this.getSystemAuditLogs(500)]);return{generatedAt:new Date().toISOString(),reportPeriod:{from:new Date(Date.now()-30*24*60*60*1e3).toISOString(),to:new Date().toISOString()},summary:e,dataExports:{total:r.length,pending:r.filter(o=>o.status==="pending").length,processing:r.filter(o=>o.status==="processing").length,completed:r.filter(o=>o.status==="completed").length,failed:r.filter(o=>o.status==="failed").length},dataDeletions:{total:n.length,pending:n.filter(o=>o.status==="pending").length,processing:n.filter(o=>o.status==="processing").length,completed:n.filter(o=>o.status==="completed").length,rejected:n.filter(o=>o.status==="rejected").length},auditActivity:{totalEvents:s.length,recentEvents:s.slice(0,50)},compliance:{cookieConsentImplemented:!0,privacyPolicyUpdated:!0,dataExportProcessImplemented:!0,dataDeletionProcessImplemented:!0,auditLoggingActive:!0,adminDashboardActive:!0,overallScore:e.complianceScore}}}catch(e){throw console.error("Error generating compliance report:",e),e}}}Dr(ar,"COOKIE_CONSENT_KEY","royal_cookie_consent"),Dr(ar,"PRIVACY_SETTINGS_COLLECTION","privacy_settings"),Dr(ar,"CONSENT_RECORDS_COLLECTION","consent_records"),Dr(ar,"DATA_EXPORT_REQUESTS_COLLECTION","data_export_requests"),Dr(ar,"DATA_DELETION_REQUESTS_COLLECTION","data_deletion_requests"),Dr(ar,"AUDIT_LOG_COLLECTION","audit_log"),Dr(ar,"COOKIE_CONSENTS_COLLECTION","cookie_consents");const uX=()=>{const{canAccessAdmin:t,requiresAdmin:e}=jP(),[r,n]=M.useState("overview"),[s,i]=M.useState(!0),[o,l]=M.useState(null),[c,u]=M.useState([]),[d,h]=M.useState([]),[g,m]=M.useState([]),[w,_]=M.useState(""),[T,v]=M.useState([]),[b,x]=M.useState(null),[P,F]=M.useState(null),[$,k]=M.useState("all");M.useEffect(()=>{t()&&A()},[t]);const A=async()=>{if(e("Load GDPR dashboard data"))try{i(!0);const[X,Y,Q,se]=await Promise.all([ar.getAdminGDPRStats(),ar.getAllDataExportRequests(),ar.getAllDataDeletionRequests(),ar.getSystemAuditLogs(100)]);l(X),u(Y),h(Q),m(se)}catch(X){console.error("Error loading GDPR dashboard data:",X),_t.error("Failed to load dashboard data")}finally{i(!1)}},I=async()=>{if(w.trim())try{const X=await ar.searchUsers(w);v(X)}catch(X){console.error("Error searching users:",X),_t.error("Failed to search users")}},O=async X=>{x(X);try{const Y=await ar.getPrivacySettings(X.id);F(Y)}catch(Y){console.error("Error loading user privacy settings:",Y)}},S=async(X,Y)=>{if(e("Process export request"))try{await ar.adminProcessExportRequest(X,Y),_t.success(`Export request ${Y}d successfully`),await A()}catch(Q){console.error(`Error ${Y}ing export request:`,Q),_t.error(`Failed to ${Y} export request`)}},R=async(X,Y,Q)=>{if(e("Process deletion request"))try{await ar.adminProcessDeletionRequest(X,Y,Q),_t.success(`Deletion request ${Y}d successfully`),await A()}catch(se){console.error(`Error ${Y}ing deletion request:`,se),_t.error(`Failed to ${Y} deletion request`)}},C=async()=>{if(e("Generate compliance report"))try{const X=await ar.generateComplianceReport(),Y=new Blob([JSON.stringify(X,null,2)],{type:"application/json"}),Q=URL.createObjectURL(Y),se=document.createElement("a");se.href=Q,se.download=`gdpr-compliance-report-${new Date().toISOString().split("T")[0]}.json`,se.click(),URL.revokeObjectURL(Q),_t.success("Compliance report generated")}catch(X){console.error("Error generating compliance report:",X),_t.error("Failed to generate compliance report")}};if(!t())return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-royal-charcoal via-gray-900 to-royal-charcoal flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Et,{className:"h-16 w-16 text-royal-gold mx-auto mb-4"}),a.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Admin Access Required"}),a.jsx("p",{className:"text-gray-300",children:"You need administrator privileges to access this GDPR dashboard."})]})});if(s)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-royal-charcoal via-gray-900 to-royal-charcoal flex items-center justify-center",children:a.jsx(jn,{})});const G=[{id:"overview",name:"Übersicht",icon:xp},{id:"exports",name:"Datenexporte",icon:Ja},{id:"deletions",name:"Löschanfragen",icon:Qs},{id:"users",name:"Benutzerverwaltung",icon:qn},{id:"audit",name:"Audit-Protokoll",icon:Mm},{id:"compliance",name:"Compliance",icon:_n}],de=$==="all"?c:c.filter(X=>X.status===$),ne=$==="all"?d:d.filter(X=>X.status===$);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center",children:[a.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-royal-gold mb-2",children:"GDPR Admin Dashboard"}),a.jsx("p",{className:"text-gray-300",children:"Datenschutz-Compliance-Management und Benutzerdatenanfragen"}),a.jsx("div",{className:"flex justify-center mt-4",children:a.jsxs("button",{onClick:A,className:"flex items-center gap-2 px-4 py-2 bg-royal-gold/20 text-royal-gold border border-royal-gold rounded-lg hover:bg-royal-gold/30 transition-colors",children:[a.jsx(Nr,{className:"h-4 w-4"}),"Aktualisieren"]})})]}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-8",children:a.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:G.map(X=>{const Y=X.icon;return a.jsxs("button",{onClick:()=>n(X.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${r===X.id?"bg-royal-gold text-royal-charcoal":"bg-white/10 text-gray-300 hover:bg-white/20"}`,children:[a.jsx(Y,{className:"h-4 w-4"}),X.name]},X.id)})})}),a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[r==="overview"&&o&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[a.jsx("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(qn,{className:"h-8 w-8 text-blue-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-white",children:o.totalUsers}),a.jsx("p",{className:"text-sm text-gray-400",children:"Benutzer gesamt"})]})]})}),a.jsx("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ja,{className:"h-8 w-8 text-green-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-white",children:o.activeExportRequests}),a.jsx("p",{className:"text-sm text-gray-400",children:"Aktive Exporte"})]})]})}),a.jsx("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Qs,{className:"h-8 w-8 text-red-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-white",children:o.activeDeletionRequests}),a.jsx("p",{className:"text-sm text-gray-400",children:"Aktive Löschungen"})]})]})}),a.jsx("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(_n,{className:"h-8 w-8 text-royal-gold"}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-2xl font-bold text-white",children:[o.complianceScore,"%"]}),a.jsx("p",{className:"text-sm text-gray-400",children:"Compliance-Score"})]})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Heutige Aktivitäten"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-300",children:"Abgeschlossene Exporte"}),a.jsx("span",{className:"text-green-400 font-medium",children:o.completedExportsToday})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-300",children:"Abgeschlossene Löschungen"}),a.jsx("span",{className:"text-red-400 font-medium",children:o.completedDeletionsToday})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-300",children:"Ø Bearbeitungszeit"}),a.jsxs("span",{className:"text-blue-400 font-medium",children:[o.averageProcessingTime,"h"]})]})]})]}),a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Schnellaktionen"}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("button",{onClick:C,className:"w-full px-4 py-2 bg-royal-gold/20 text-royal-gold border border-royal-gold rounded-lg hover:bg-royal-gold/30 transition-colors",children:"Compliance-Bericht generieren"}),a.jsx("button",{onClick:()=>n("exports"),className:"w-full px-4 py-2 bg-blue-500/20 text-blue-400 border border-blue-500/30 rounded-lg hover:bg-blue-500/30 transition-colors",children:"Export-Anfragen bearbeiten"}),a.jsx("button",{onClick:()=>n("deletions"),className:"w-full px-4 py-2 bg-red-500/20 text-red-400 border border-red-500/30 rounded-lg hover:bg-red-500/30 transition-colors",children:"Lösch-Anfragen bearbeiten"})]})]})]})]}),r==="exports"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-4 border border-white/10",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Uy,{className:"h-5 w-5 text-gray-400"}),a.jsx("span",{className:"text-white",children:"Filter:"})]}),a.jsxs("select",{value:$,onChange:X=>k(X.target.value),className:"px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white",children:[a.jsx("option",{value:"all",children:"Alle Status"}),a.jsx("option",{value:"pending",children:"Ausstehend"}),a.jsx("option",{value:"processing",children:"Bearbeitung"}),a.jsx("option",{value:"completed",children:"Abgeschlossen"}),a.jsx("option",{value:"failed",children:"Fehler"})]})]})}),a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Datenexport-Anfragen"}),de.length===0?a.jsx("p",{className:"text-gray-400",children:"Keine Export-Anfragen gefunden."}):a.jsx("div",{className:"space-y-4",children:de.map(X=>a.jsx("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(Aa,{className:"h-5 w-5 text-gray-400"}),a.jsxs("span",{className:"text-white font-medium",children:["User ID: ",X.userId]}),a.jsxs("div",{className:"flex items-center gap-2",children:[X.status==="pending"&&a.jsxs(a.Fragment,{children:[a.jsx(Rr,{className:"h-4 w-4 text-yellow-500"}),a.jsx("span",{className:"text-yellow-500 text-sm",children:"Ausstehend"})]}),X.status==="processing"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-blue-500 border-t-transparent rounded-full"}),a.jsx("span",{className:"text-blue-500 text-sm",children:"Bearbeitung"})]}),X.status==="completed"&&a.jsxs(a.Fragment,{children:[a.jsx(xr,{className:"h-4 w-4 text-green-500"}),a.jsx("span",{className:"text-green-500 text-sm",children:"Abgeschlossen"})]}),X.status==="failed"&&a.jsxs(a.Fragment,{children:[a.jsx(gl,{className:"h-4 w-4 text-red-500"}),a.jsx("span",{className:"text-red-500 text-sm",children:"Fehler"})]})]})]}),a.jsxs("p",{className:"text-sm text-gray-400",children:["Kategorien: ",X.dataCategories.join(", ")]}),a.jsxs("p",{className:"text-sm text-gray-400",children:["Angefragt:"," ",X.requestedAt.toLocaleDateString("de-DE")]})]}),X.status==="pending"&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>S(X.id,"approve"),className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 transition-colors text-sm",children:"Genehmigen"}),a.jsx("button",{onClick:()=>S(X.id,"reject"),className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition-colors text-sm",children:"Ablehnen"})]}),X.downloadUrl&&a.jsxs("a",{href:X.downloadUrl,download:!0,className:"inline-flex items-center gap-2 px-3 py-1 bg-royal-gold text-royal-charcoal rounded hover:bg-royal-gold/90 transition-colors text-sm",children:[a.jsx(Ja,{className:"h-4 w-4"}),"Download"]})]})},X.id))})]})]}),r==="deletions"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-4 border border-white/10",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Uy,{className:"h-5 w-5 text-gray-400"}),a.jsx("span",{className:"text-white",children:"Filter:"})]}),a.jsxs("select",{value:$,onChange:X=>k(X.target.value),className:"px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white",children:[a.jsx("option",{value:"all",children:"Alle Status"}),a.jsx("option",{value:"pending",children:"Ausstehend"}),a.jsx("option",{value:"processing",children:"Bearbeitung"}),a.jsx("option",{value:"completed",children:"Abgeschlossen"}),a.jsx("option",{value:"rejected",children:"Abgelehnt"})]})]})}),a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Löschanfragen"}),ne.length===0?a.jsx("p",{className:"text-gray-400",children:"Keine Löschanfragen gefunden."}):a.jsx("div",{className:"space-y-4",children:ne.map(X=>a.jsx("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(Aa,{className:"h-5 w-5 text-gray-400"}),a.jsxs("span",{className:"text-white font-medium",children:["User ID: ",X.userId]}),a.jsxs("div",{className:"flex items-center gap-2",children:[X.status==="pending"&&a.jsxs(a.Fragment,{children:[a.jsx(Rr,{className:"h-4 w-4 text-yellow-500"}),a.jsx("span",{className:"text-yellow-500 text-sm",children:"Ausstehend"})]}),X.status==="processing"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-blue-500 border-t-transparent rounded-full"}),a.jsx("span",{className:"text-blue-500 text-sm",children:"Bearbeitung"})]}),X.status==="completed"&&a.jsxs(a.Fragment,{children:[a.jsx(xr,{className:"h-4 w-4 text-green-500"}),a.jsx("span",{className:"text-green-500 text-sm",children:"Abgeschlossen"})]}),X.status==="rejected"&&a.jsxs(a.Fragment,{children:[a.jsx(gl,{className:"h-4 w-4 text-red-500"}),a.jsx("span",{className:"text-red-500 text-sm",children:"Abgelehnt"})]})]})]}),a.jsxs("p",{className:"text-sm text-gray-400",children:["Grund: ",X.reason||"Nicht angegeben"]}),a.jsxs("p",{className:"text-sm text-gray-400",children:["Angefragt:"," ",X.requestedAt.toLocaleDateString("de-DE")]}),a.jsxs("p",{className:"text-sm text-gray-400",children:["Geplante Löschung:"," ",X.scheduledDeletionDate.toLocaleDateString("de-DE")]}),X.retentionReasons&&X.retentionReasons.length>0&&a.jsx("div",{className:"mt-2 p-2 bg-yellow-500/20 border border-yellow-500/30 rounded",children:a.jsxs("p",{className:"text-yellow-300 text-sm",children:[a.jsx("strong",{children:"Aufbewahrungsgründe:"})," ",X.retentionReasons.join(", ")]})}),X.adminNotes&&a.jsx("div",{className:"mt-2 p-2 bg-blue-500/20 border border-blue-500/30 rounded",children:a.jsxs("p",{className:"text-blue-300 text-sm",children:[a.jsx("strong",{children:"Admin-Notiz:"})," ",X.adminNotes]})})]}),X.status==="pending"&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>{const Y=prompt("Admin-Notiz (optional):");R(X.id,"approve",Y||void 0)},className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 transition-colors text-sm",children:"Genehmigen"}),a.jsx("button",{onClick:()=>{const Y=prompt("Ablehnungsgrund:");Y&&R(X.id,"reject",Y)},className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition-colors text-sm",children:"Ablehnen"})]})]})},X.id))})]})]}),r==="users"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Benutzer suchen"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx("input",{type:"text",value:w,onChange:X=>_(X.target.value),placeholder:"E-Mail, Name oder User ID eingeben...",className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-royal-gold",onKeyPress:X=>X.key==="Enter"&&I()})}),a.jsxs("button",{onClick:I,className:"flex items-center gap-2 px-4 py-2 bg-royal-gold text-royal-charcoal rounded-lg hover:bg-royal-gold/90 transition-colors",children:[a.jsx(Sf,{className:"h-4 w-4"}),"Suchen"]})]})]}),T.length>0&&a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Suchergebnisse"}),a.jsx("div",{className:"space-y-3",children:T.map(X=>a.jsx("div",{className:`p-4 rounded-lg border cursor-pointer transition-colors ${(b==null?void 0:b.id)===X.id?"bg-royal-gold/20 border-royal-gold":"bg-white/5 border-white/10 hover:bg-white/10"}`,onClick:()=>O(X),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-medium",children:X.name}),a.jsx("p",{className:"text-sm text-gray-400",children:X.email}),a.jsxs("p",{className:"text-sm text-gray-400",children:["Rolle: ",X.role]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"flex items-center gap-2",children:X.hasGDPRRequests&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ml,{className:"h-4 w-4 text-yellow-500"}),a.jsx("span",{className:"text-yellow-500 text-sm",children:"GDPR-Anfragen"})]})}),a.jsxs("p",{className:"text-sm text-gray-400",children:["Letzter Login:"," ",X.lastLogin.toLocaleDateString("de-DE")]})]})]})},X.id))})]}),b&&P&&a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsxs("h3",{className:"text-lg font-semibold text-white mb-4",children:["Datenschutzeinstellungen für ",b.name]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-medium mb-3",children:"Cookie-Einstellungen"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-400",children:"Analytics"}),a.jsx("span",{className:P.cookieConsent.analytics?"text-green-400":"text-red-400",children:P.cookieConsent.analytics?"Aktiv":"Inaktiv"})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-400",children:"Marketing"}),a.jsx("span",{className:P.cookieConsent.marketing?"text-green-400":"text-red-400",children:P.cookieConsent.marketing?"Aktiv":"Inaktiv"})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-medium mb-3",children:"Kommunikation"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-400",children:"E-Mail"}),a.jsx("span",{className:P.communicationPreferences.email?"text-green-400":"text-red-400",children:P.communicationPreferences.email?"Aktiv":"Inaktiv"})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-400",children:"SMS"}),a.jsx("span",{className:P.communicationPreferences.sms?"text-green-400":"text-red-400",children:P.communicationPreferences.sms?"Aktiv":"Inaktiv"})]})]})]})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h4",{className:"text-white font-medium mb-3",children:"Datenkategorien"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:b.dataCategories.map(X=>a.jsx("span",{className:"px-3 py-1 bg-blue-500/20 text-blue-400 border border-blue-500/30 rounded-full text-sm",children:X},X))})]})]})]}),r==="audit"&&a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"System-Audit-Protokoll"}),g.length===0?a.jsx("p",{className:"text-gray-400",children:"Keine Audit-Logs verfügbar."}):a.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:g.map(X=>a.jsx("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsxs("div",{className:"mt-1",children:[X.action==="read"&&a.jsx(Ca,{className:"h-4 w-4 text-blue-400"}),X.action==="update"&&a.jsx(Yc,{className:"h-4 w-4 text-yellow-400"}),X.action==="delete"&&a.jsx(Qs,{className:"h-4 w-4 text-red-400"}),X.action==="export"&&a.jsx(Ja,{className:"h-4 w-4 text-green-400"})]}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-white font-medium",children:[X.action==="read"&&"Datenzugriff",X.action==="update"&&"Datenaktualisierung",X.action==="delete"&&"Datenlöschung",X.action==="export"&&"Datenexport"]}),a.jsxs("p",{className:"text-sm text-gray-400",children:[X.dataCategory," -"," ",typeof X.details=="object"?JSON.stringify(X.details):X.details]}),a.jsx("p",{className:"text-xs text-gray-500",children:X.timestamp.toLocaleString("de-DE")}),X.userId&&a.jsxs("p",{className:"text-xs text-gray-500",children:["User: ",X.userId]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"text-xs text-gray-400",children:["IP: ",X.ipAddress]}),a.jsx("p",{className:"text-xs text-gray-400",children:X.userAgent})]})]})},X.id))})]}),r==="compliance"&&a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"GDPR Compliance Status"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-300",children:"Cookie-Consent-System"}),a.jsx(xr,{className:"h-5 w-5 text-green-500"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-300",children:"Datenschutzerklärung"}),a.jsx(xr,{className:"h-5 w-5 text-green-500"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-300",children:"Datenexport-System"}),a.jsx(xr,{className:"h-5 w-5 text-green-500"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-300",children:"Löschrecht-System"}),a.jsx(xr,{className:"h-5 w-5 text-green-500"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-300",children:"Audit-Logging"}),a.jsx(xr,{className:"h-5 w-5 text-green-500"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-300",children:"Admin-Dashboard"}),a.jsx(xr,{className:"h-5 w-5 text-green-500"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-300",children:"Datenanonymisierung"}),a.jsx(xr,{className:"h-5 w-5 text-green-500"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-300",children:"Benutzer-Dashboard"}),a.jsx(xr,{className:"h-5 w-5 text-green-500"})]})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-green-500/20 border border-green-500/30 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(xr,{className:"h-5 w-5 text-green-500"}),a.jsx("p",{className:"text-green-300 font-medium",children:"GDPR-Compliance vollständig implementiert"})]}),a.jsx("p",{className:"text-green-300/80 text-sm mt-1",children:"Alle erforderlichen Systeme und Prozesse sind aktiv und funktionsfähig."})]})]})]},r)]})};function or(t){"@babel/helpers - typeof";return or=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},or(t)}var cs=Uint8Array,xi=Uint16Array,IN=Int32Array,Xx=new cs([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Zx=new cs([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ib=new cs([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),SP=function(t,e){for(var r=new xi(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var s=new IN(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)s[i]=i-r[n]<<5|n;return{b:r,r:s}},AP=SP(Xx,2),EP=AP.b,Cb=AP.r;EP[28]=258,Cb[258]=28;var kP=SP(Zx,0),dX=kP.b,L3=kP.r,Pb=new xi(32768);for(var Tr=0;Tr<32768;++Tr){var ec=(Tr&43690)>>1|(Tr&21845)<<1;ec=(ec&52428)>>2|(ec&13107)<<2,ec=(ec&61680)>>4|(ec&3855)<<4,Pb[Tr]=((ec&65280)>>8|(ec&255)<<8)>>1}var fo=function(t,e,r){for(var n=t.length,s=0,i=new xi(e);s<n;++s)t[s]&&++i[t[s]-1];var o=new xi(e);for(s=1;s<e;++s)o[s]=o[s-1]+i[s-1]<<1;var l;if(r){l=new xi(1<<e);var c=15-e;for(s=0;s<n;++s)if(t[s])for(var u=s<<4|t[s],d=e-t[s],h=o[t[s]-1]++<<d,g=h|(1<<d)-1;h<=g;++h)l[Pb[h]>>c]=u}else for(l=new xi(n),s=0;s<n;++s)t[s]&&(l[s]=Pb[o[t[s]-1]++]>>15-t[s]);return l},Qc=new cs(288);for(var Tr=0;Tr<144;++Tr)Qc[Tr]=8;for(var Tr=144;Tr<256;++Tr)Qc[Tr]=9;for(var Tr=256;Tr<280;++Tr)Qc[Tr]=7;for(var Tr=280;Tr<288;++Tr)Qc[Tr]=8;var bp=new cs(32);for(var Tr=0;Tr<32;++Tr)bp[Tr]=5;var hX=fo(Qc,9,0),fX=fo(Qc,9,1),mX=fo(bp,5,0),pX=fo(bp,5,1),Ev=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},fa=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},kv=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},CN=function(t){return(t+7)/8|0},TP=function(t,e,r){return(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length),new cs(t.subarray(e,r))},gX=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ga=function(t,e,r){var n=new Error(e||gX[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,ga),!r)throw n;return n},yX=function(t,e,r,n){var s=t.length,i=n?n.length:0;if(!s||e.f&&!e.l)return r||new cs(0);var o=!r,l=o||e.i!=2,c=e.i;o&&(r=new cs(s*3));var u=function(De){var He=r.length;if(De>He){var $e=new cs(Math.max(He*2,De));$e.set(r),r=$e}},d=e.f||0,h=e.p||0,g=e.b||0,m=e.l,w=e.d,_=e.m,T=e.n,v=s*8;do{if(!m){d=fa(t,h,1);var b=fa(t,h+1,3);if(h+=3,b)if(b==1)m=fX,w=pX,_=9,T=5;else if(b==2){var $=fa(t,h,31)+257,k=fa(t,h+10,15)+4,A=$+fa(t,h+5,31)+1;h+=14;for(var I=new cs(A),O=new cs(19),S=0;S<k;++S)O[Ib[S]]=fa(t,h+S*3,7);h+=k*3;for(var R=Ev(O),C=(1<<R)-1,G=fo(O,R,1),S=0;S<A;){var de=G[fa(t,h,C)];h+=de&15;var x=de>>4;if(x<16)I[S++]=x;else{var ne=0,X=0;for(x==16?(X=3+fa(t,h,3),h+=2,ne=I[S-1]):x==17?(X=3+fa(t,h,7),h+=3):x==18&&(X=11+fa(t,h,127),h+=7);X--;)I[S++]=ne}}var Y=I.subarray(0,$),Q=I.subarray($);_=Ev(Y),T=Ev(Q),m=fo(Y,_,1),w=fo(Q,T,1)}else ga(1);else{var x=CN(h)+4,P=t[x-4]|t[x-3]<<8,F=x+P;if(F>s){c&&ga(0);break}l&&u(g+P),r.set(t.subarray(x,F),g),e.b=g+=P,e.p=h=F*8,e.f=d;continue}if(h>v){c&&ga(0);break}}l&&u(g+131072);for(var se=(1<<_)-1,Se=(1<<T)-1,U=h;;U=h){var ne=m[kv(t,h)&se],J=ne>>4;if(h+=ne&15,h>v){c&&ga(0);break}if(ne||ga(2),J<256)r[g++]=J;else if(J==256){U=h,m=null;break}else{var te=J-254;if(J>264){var S=J-257,ie=Xx[S];te=fa(t,h,(1<<ie)-1)+EP[S],h+=ie}var ue=w[kv(t,h)&Se],ge=ue>>4;ue||ga(3),h+=ue&15;var Q=dX[ge];if(ge>3){var ie=Zx[ge];Q+=kv(t,h)&(1<<ie)-1,h+=ie}if(h>v){c&&ga(0);break}l&&u(g+131072);var we=g+te;if(g<Q){var be=i-Q,Me=Math.min(Q,we);for(be+g<0&&ga(3);g<Me;++g)r[g]=n[be+g]}for(;g<we;++g)r[g]=r[g-Q]}}e.l=m,e.p=U,e.b=g,e.f=d,m&&(d=1,e.m=_,e.d=w,e.n=T)}while(!d);return g!=r.length&&o?TP(r,0,g):r.subarray(0,g)},Uo=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},tm=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},Tv=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var s=r.length,i=r.slice();if(!s)return{t:CP,l:0};if(s==1){var o=new cs(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(F,$){return F.f-$.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,d=1,h=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=s-1;)l=r[r[u].f<r[h].f?u++:h++],c=r[u!=d&&r[u].f<r[h].f?u++:h++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var g=i[0].s,n=1;n<s;++n)i[n].s>g&&(g=i[n].s);var m=new xi(g+1),w=Rb(r[d-1],m,0);if(w>e){var n=0,_=0,T=w-e,v=1<<T;for(i.sort(function($,k){return m[k.s]-m[$.s]||$.f-k.f});n<s;++n){var b=i[n].s;if(m[b]>e)_+=v-(1<<w-m[b]),m[b]=e;else break}for(_>>=T;_>0;){var x=i[n].s;m[x]<e?_-=1<<e-m[x]++-1:++n}for(;n>=0&&_;--n){var P=i[n].s;m[P]==e&&(--m[P],++_)}w=e}return{t:new cs(m),l:w}},Rb=function(t,e,r){return t.s==-1?Math.max(Rb(t.l,e,r+1),Rb(t.r,e,r+1)):e[t.s]=r},O3=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new xi(++e),n=0,s=t[0],i=1,o=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==s&&l!=e)++i;else{if(!s&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(s),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(s);i=1,s=t[l]}return{c:r.subarray(0,n),n:e}},rm=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},IP=function(t,e,r){var n=r.length,s=CN(e+2);t[s]=n&255,t[s+1]=n>>8,t[s+2]=t[s]^255,t[s+3]=t[s+1]^255;for(var i=0;i<n;++i)t[s+i+4]=r[i];return(s+4+n)*8},M3=function(t,e,r,n,s,i,o,l,c,u,d){Uo(e,d++,r),++s[256];for(var h=Tv(s,15),g=h.t,m=h.l,w=Tv(i,15),_=w.t,T=w.l,v=O3(g),b=v.c,x=v.n,P=O3(_),F=P.c,$=P.n,k=new xi(19),A=0;A<b.length;++A)++k[b[A]&31];for(var A=0;A<F.length;++A)++k[F[A]&31];for(var I=Tv(k,7),O=I.t,S=I.l,R=19;R>4&&!O[Ib[R-1]];--R);var C=u+5<<3,G=rm(s,Qc)+rm(i,bp)+o,de=rm(s,g)+rm(i,_)+o+14+3*R+rm(k,O)+2*k[16]+3*k[17]+7*k[18];if(c>=0&&C<=G&&C<=de)return IP(e,d,t.subarray(c,c+u));var ne,X,Y,Q;if(Uo(e,d,1+(de<G)),d+=2,de<G){ne=fo(g,m,0),X=g,Y=fo(_,T,0),Q=_;var se=fo(O,S,0);Uo(e,d,x-257),Uo(e,d+5,$-1),Uo(e,d+10,R-4),d+=14;for(var A=0;A<R;++A)Uo(e,d+3*A,O[Ib[A]]);d+=3*R;for(var Se=[b,F],U=0;U<2;++U)for(var J=Se[U],A=0;A<J.length;++A){var te=J[A]&31;Uo(e,d,se[te]),d+=O[te],te>15&&(Uo(e,d,J[A]>>5&127),d+=J[A]>>12)}}else ne=hX,X=Qc,Y=mX,Q=bp;for(var A=0;A<l;++A){var ie=n[A];if(ie>255){var te=ie>>18&31;tm(e,d,ne[te+257]),d+=X[te+257],te>7&&(Uo(e,d,ie>>23&31),d+=Xx[te]);var ue=ie&31;tm(e,d,Y[ue]),d+=Q[ue],ue>3&&(tm(e,d,ie>>5&8191),d+=Zx[ue])}else tm(e,d,ne[ie]),d+=X[ie]}return tm(e,d,ne[256]),d+X[256]},xX=new IN([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),CP=new cs(0),vX=function(t,e,r,n,s,i){var o=i.z||t.length,l=new cs(n+o+5*(1+Math.ceil(o/7e3))+s),c=l.subarray(n,l.length-s),u=i.l,d=(i.r||0)&7;if(e){d&&(c[0]=i.r>>3);for(var h=xX[e-1],g=h>>13,m=h&8191,w=(1<<r)-1,_=i.p||new xi(32768),T=i.h||new xi(w+1),v=Math.ceil(r/3),b=2*v,x=function(dt){return(t[dt]^t[dt+1]<<v^t[dt+2]<<b)&w},P=new IN(25e3),F=new xi(288),$=new xi(32),k=0,A=0,I=i.i||0,O=0,S=i.w||0,R=0;I+2<o;++I){var C=x(I),G=I&32767,de=T[C];if(_[G]=de,T[C]=G,S<=I){var ne=o-I;if((k>7e3||O>24576)&&(ne>423||!u)){d=M3(t,c,0,P,F,$,A,O,R,I-R,d),O=k=A=0,R=I;for(var X=0;X<286;++X)F[X]=0;for(var X=0;X<30;++X)$[X]=0}var Y=2,Q=0,se=m,Se=G-de&32767;if(ne>2&&C==x(I-Se))for(var U=Math.min(g,ne)-1,J=Math.min(32767,I),te=Math.min(258,ne);Se<=J&&--se&&G!=de;){if(t[I+Y]==t[I+Y-Se]){for(var ie=0;ie<te&&t[I+ie]==t[I+ie-Se];++ie);if(ie>Y){if(Y=ie,Q=Se,ie>U)break;for(var ue=Math.min(Se,ie-2),ge=0,X=0;X<ue;++X){var we=I-Se+X&32767,be=_[we],Me=we-be&32767;Me>ge&&(ge=Me,de=we)}}}G=de,de=_[G],Se+=G-de&32767}if(Q){P[O++]=268435456|Cb[Y]<<18|L3[Q];var De=Cb[Y]&31,He=L3[Q]&31;A+=Xx[De]+Zx[He],++F[257+De],++$[He],S=I+Y,++k}else P[O++]=t[I],++F[t[I]]}}for(I=Math.max(I,S);I<o;++I)P[O++]=t[I],++F[t[I]];d=M3(t,c,u,P,F,$,A,O,R,I-R,d),u||(i.r=d&7|c[d/8|0]<<3,d-=7,i.h=T,i.p=_,i.i=I,i.w=S)}else{for(var I=i.w||0;I<o+u;I+=65535){var $e=I+65535;$e>=o&&(c[d/8|0]=u,$e=o),d=IP(c,d+1,t.subarray(I,$e))}i.i=o}return TP(l,0,n+CN(d)+s)},PP=function(){var t=1,e=0;return{p:function(r){for(var n=t,s=e,i=r.length|0,o=0;o!=i;){for(var l=Math.min(o+2655,i);o<l;++o)s+=n+=r[o];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}t=n,e=s},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},bX=function(t,e,r,n,s){if(!s&&(s={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),o=new cs(i.length+t.length);o.set(i),o.set(t,i.length),t=o,s.w=i.length}return vX(t,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,s)},RP=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},wX=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var s=PP();s.p(e.dictionary),RP(t,2,s.d())}},NX=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&ga(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&ga(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Db(t,e){e||(e={});var r=PP();r.p(t);var n=bX(t,e,e.dictionary?6:2,4);return wX(n,e),RP(n,n.length-4,r.d()),n}function _X(t,e){return yX(t.subarray(NX(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}var jX=typeof TextDecoder<"u"&&new TextDecoder,SX=0;try{jX.decode(CP,{stream:!0}),SX=1}catch{}var wt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Iv(){wt.console&&typeof wt.console.log=="function"&&wt.console.log.apply(wt.console,arguments)}var yr={log:Iv,warn:function(t){wt.console&&(typeof wt.console.warn=="function"?wt.console.warn.apply(wt.console,arguments):Iv.call(null,arguments))},error:function(t){wt.console&&(typeof wt.console.error=="function"?wt.console.error.apply(wt.console,arguments):Iv(t))}};function Cv(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){Lu(n.response,e,r)},n.onerror=function(){yr.error("could not download file")},n.send()}function F3(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function e0(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Fm,Lb,Lu=wt.saveAs||((typeof window>"u"?"undefined":or(window))!=="object"||window!==wt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=wt.URL||wt.webkitURL,s=document.createElement("a");e=e||t.name||"download",s.download=e,s.rel="noopener",typeof t=="string"?(s.href=t,s.origin!==location.origin?F3(s.href)?Cv(t,e,r):e0(s,s.target="_blank"):e0(s)):(s.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){e0(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(F3(t))Cv(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){e0(n)})}else navigator.msSaveOrOpenBlob(function(s,i){return i===void 0?i={autoBom:!1}:or(i)!=="object"&&(yr.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob([String.fromCharCode(65279),s],{type:s.type}):s}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return Cv(t,e,r);var s=t.type==="application/octet-stream",i=/constructor/i.test(wt.HTMLElement)||wt.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&i)&&(typeof FileReader>"u"?"undefined":or(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(t)}else{var c=wt.URL||wt.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function DP(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,i=r[n].process,o=s.exec(t);o&&(e=i(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Pv(t,e){var r=t[0],n=t[1],s=t[2],i=t[3];r=es(r,n,s,i,e[0],7,-680876936),i=es(i,r,n,s,e[1],12,-389564586),s=es(s,i,r,n,e[2],17,606105819),n=es(n,s,i,r,e[3],22,-1044525330),r=es(r,n,s,i,e[4],7,-176418897),i=es(i,r,n,s,e[5],12,1200080426),s=es(s,i,r,n,e[6],17,-1473231341),n=es(n,s,i,r,e[7],22,-45705983),r=es(r,n,s,i,e[8],7,1770035416),i=es(i,r,n,s,e[9],12,-1958414417),s=es(s,i,r,n,e[10],17,-42063),n=es(n,s,i,r,e[11],22,-1990404162),r=es(r,n,s,i,e[12],7,1804603682),i=es(i,r,n,s,e[13],12,-40341101),s=es(s,i,r,n,e[14],17,-1502002290),r=ts(r,n=es(n,s,i,r,e[15],22,1236535329),s,i,e[1],5,-165796510),i=ts(i,r,n,s,e[6],9,-1069501632),s=ts(s,i,r,n,e[11],14,643717713),n=ts(n,s,i,r,e[0],20,-373897302),r=ts(r,n,s,i,e[5],5,-701558691),i=ts(i,r,n,s,e[10],9,38016083),s=ts(s,i,r,n,e[15],14,-660478335),n=ts(n,s,i,r,e[4],20,-405537848),r=ts(r,n,s,i,e[9],5,568446438),i=ts(i,r,n,s,e[14],9,-1019803690),s=ts(s,i,r,n,e[3],14,-187363961),n=ts(n,s,i,r,e[8],20,1163531501),r=ts(r,n,s,i,e[13],5,-1444681467),i=ts(i,r,n,s,e[2],9,-51403784),s=ts(s,i,r,n,e[7],14,1735328473),r=rs(r,n=ts(n,s,i,r,e[12],20,-1926607734),s,i,e[5],4,-378558),i=rs(i,r,n,s,e[8],11,-2022574463),s=rs(s,i,r,n,e[11],16,1839030562),n=rs(n,s,i,r,e[14],23,-35309556),r=rs(r,n,s,i,e[1],4,-1530992060),i=rs(i,r,n,s,e[4],11,1272893353),s=rs(s,i,r,n,e[7],16,-155497632),n=rs(n,s,i,r,e[10],23,-1094730640),r=rs(r,n,s,i,e[13],4,681279174),i=rs(i,r,n,s,e[0],11,-358537222),s=rs(s,i,r,n,e[3],16,-722521979),n=rs(n,s,i,r,e[6],23,76029189),r=rs(r,n,s,i,e[9],4,-640364487),i=rs(i,r,n,s,e[12],11,-421815835),s=rs(s,i,r,n,e[15],16,530742520),r=ns(r,n=rs(n,s,i,r,e[2],23,-995338651),s,i,e[0],6,-198630844),i=ns(i,r,n,s,e[7],10,1126891415),s=ns(s,i,r,n,e[14],15,-1416354905),n=ns(n,s,i,r,e[5],21,-57434055),r=ns(r,n,s,i,e[12],6,1700485571),i=ns(i,r,n,s,e[3],10,-1894986606),s=ns(s,i,r,n,e[10],15,-1051523),n=ns(n,s,i,r,e[1],21,-2054922799),r=ns(r,n,s,i,e[8],6,1873313359),i=ns(i,r,n,s,e[15],10,-30611744),s=ns(s,i,r,n,e[6],15,-1560198380),n=ns(n,s,i,r,e[13],21,1309151649),r=ns(r,n,s,i,e[4],6,-145523070),i=ns(i,r,n,s,e[11],10,-1120210379),s=ns(s,i,r,n,e[2],15,718787259),n=ns(n,s,i,r,e[9],21,-343485551),t[0]=xc(r,t[0]),t[1]=xc(n,t[1]),t[2]=xc(s,t[2]),t[3]=xc(i,t[3])}function e1(t,e,r,n,s,i){return e=xc(xc(e,t),xc(n,i)),xc(e<<s|e>>>32-s,r)}function es(t,e,r,n,s,i,o){return e1(e&r|~e&n,t,e,s,i,o)}function ts(t,e,r,n,s,i,o){return e1(e&n|r&~n,t,e,s,i,o)}function rs(t,e,r,n,s,i,o){return e1(e^r^n,t,e,s,i,o)}function ns(t,e,r,n,s,i,o){return e1(r^(e|~n),t,e,s,i,o)}function LP(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)Pv(n,AX(t.substring(e-64,e)));t=t.substring(e-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)s[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(Pv(n,s),e=0;e<16;e++)s[e]=0;return s[14]=8*r,Pv(n,s),n}function AX(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}Fm=wt.atob.bind(wt),Lb=wt.btoa.bind(wt);var V3="0123456789abcdef".split("");function EX(t){for(var e="",r=0;r<4;r++)e+=V3[t>>8*r+4&15]+V3[t>>8*r&15];return e}function kX(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Ob(t){return LP(t).map(kX).join("")}var TX=function(t){for(var e=0;e<t.length;e++)t[e]=EX(t[e]);return t.join("")}(LP("hello"))!="5d41402abc4b2a76b9719d911017c592";function xc(t,e){if(TX){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Mb(t,e){var r,n,s,i;if(t!==r){for(var o=(s=t,i=1+(256/t.length>>0),new Array(i+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+o.charCodeAt(c))%256,l[c]=l[u],l[u]=d}r=t,n=l}else l=n;var h=e.length,g=0,m=0,w="";for(c=0;c<h;c++)m=(m+(d=l[g=(g+1)%256]))%256,l[g]=l[m],l[m]=d,o=l[(l[g]+l[m])%256],w+=String.fromCharCode(e.charCodeAt(c)^o);return w}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var B3={print:4,modify:8,copy:16,"annot-forms":32};function rh(t,e,r,n){this.v=1,this.r=2;var s=192;t.forEach(function(l){if(B3.perm!==void 0)throw new Error("Invalid permission: "+l);s+=B3[l]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var i=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^s)),this.encryptionKey=Ob(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Mb(this.encryptionKey,this.padding)}function nh(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var s=t.charCodeAt(n);s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?e+="#"+("0"+s.toString(16)).slice(-2):e+=t[n]}return e}function U3(t){if(or(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var i=Math.random().toString(35);return e[r][i]=[n,!!s],i},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var i in e[r]){var o=e[r][i];try{o[0].apply(t,n)}catch(l){wt.console&&yr.error("jsPDF PubSub Error",l.message,l)}o[1]&&s.push(i)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Wy(t){if(!(this instanceof Wy))return new Wy(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function OP(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Mu(t,e,r,n,s){if(!(this instanceof Mu))return new Mu(t,e,r,n,s);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,OP.call(this,n,s)}function _h(t,e,r,n,s){if(!(this instanceof _h))return new _h(t,e,r,n,s);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,OP.call(this,n,s)}function bt(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],i=arguments[3],o=[],l=1,c=16,u="S",d=null;or(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,s=t.format||s,i=t.compress||t.compressPdf||i,(d=t.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),o=t.filters||(i===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var h=t.putOnlyUsedFonts||!1,g={},m={internal:{},__private__:{}};m.__private__.PubSub=U3;var w="1.3",_=m.__private__.getPdfVersion=function(){return w};m.__private__.setPdfVersion=function(N){w=N};var T={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return T};var v=m.__private__.getPageFormat=function(N){return T[N]};s=s||"a4";var b={COMPAT:"compat",ADVANCED:"advanced"},x=b.COMPAT;function P(){this.saveGraphicsState(),re(new ht(Xe,0,0,-Xe,0,la()*Xe).toString()+" cm"),this.setFontSize(this.getFontSize()/Xe),u="n",x=b.ADVANCED}function F(){this.restoreGraphicsState(),u="S",x=b.COMPAT}var $=m.__private__.combineFontStyleAndFontWeight=function(N,V){if(N=="bold"&&V=="normal"||N=="bold"&&V==400||N=="normal"&&V=="italic"||N=="bold"&&V=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return V&&(N=V==400||V==="normal"?N==="italic"?"italic":"normal":V!=700&&V!=="bold"||N!=="normal"?(V==700?"bold":V)+""+N:"bold"),N};m.advancedAPI=function(N){var V=x===b.COMPAT;return V&&P.call(this),typeof N!="function"||(N(this),V&&F.call(this)),this},m.compatAPI=function(N){var V=x===b.ADVANCED;return V&&F.call(this),typeof N!="function"||(N(this),V&&P.call(this)),this},m.isAdvancedAPI=function(){return x===b.ADVANCED};var k,A=function(N){if(x!==b.ADVANCED)throw new Error(N+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},I=m.roundToPrecision=m.__private__.roundToPrecision=function(N,V){var ee=e||V;if(isNaN(N)||isNaN(ee))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return N.toFixed(ee).replace(/0+$/,"")};k=m.hpf=m.__private__.hpf=typeof c=="number"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return I(N,c)}:c==="smart"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return I(N,N>-1&&N<1?16:5)}:function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return I(N,16)};var O=m.f2=m.__private__.f2=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f2");return I(N,2)},S=m.__private__.f3=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f3");return I(N,3)},R=m.scale=m.__private__.scale=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.scale");return x===b.COMPAT?N*Xe:x===b.ADVANCED?N:void 0},C=function(N){return x===b.COMPAT?la()-N:x===b.ADVANCED?N:void 0},G=function(N){return R(C(N))};m.__private__.setPrecision=m.setPrecision=function(N){typeof parseInt(N,10)=="number"&&(e=parseInt(N,10))};var de,ne="00000000000000000000000000000000",X=m.__private__.getFileId=function(){return ne},Y=m.__private__.setFileId=function(N){return ne=N!==void 0&&/^[a-fA-F0-9]{32}$/.test(N)?N.toUpperCase():ne.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Hr=new rh(d.userPermissions,d.userPassword,d.ownerPassword,ne)),ne};m.setFileId=function(N){return Y(N),this},m.getFileId=function(){return X()};var Q=m.__private__.convertDateToPDFDate=function(N){var V=N.getTimezoneOffset(),ee=V<0?"+":"-",ae=Math.floor(Math.abs(V/60)),pe=Math.abs(V%60),Ne=[ee,te(ae),"'",te(pe),"'"].join("");return["D:",N.getFullYear(),te(N.getMonth()+1),te(N.getDate()),te(N.getHours()),te(N.getMinutes()),te(N.getSeconds()),Ne].join("")},se=m.__private__.convertPDFDateToDate=function(N){var V=parseInt(N.substr(2,4),10),ee=parseInt(N.substr(6,2),10)-1,ae=parseInt(N.substr(8,2),10),pe=parseInt(N.substr(10,2),10),Ne=parseInt(N.substr(12,2),10),Le=parseInt(N.substr(14,2),10);return new Date(V,ee,ae,pe,Ne,Le,0)},Se=m.__private__.setCreationDate=function(N){var V;if(N===void 0&&(N=new Date),N instanceof Date)V=Q(N);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(N))throw new Error("Invalid argument passed to jsPDF.setCreationDate");V=N}return de=V},U=m.__private__.getCreationDate=function(N){var V=de;return N==="jsDate"&&(V=se(de)),V};m.setCreationDate=function(N){return Se(N),this},m.getCreationDate=function(N){return U(N)};var J,te=m.__private__.padd2=function(N){return("0"+parseInt(N)).slice(-2)},ie=m.__private__.padd2Hex=function(N){return("00"+(N=N.toString())).substr(N.length)},ue=0,ge=[],we=[],be=0,Me=[],De=[],He=!1,$e=we,dt=function(){ue=0,be=0,we=[],ge=[],Me=[],ta=Wr(),ri=Wr()};m.__private__.setCustomOutputDestination=function(N){He=!0,$e=N};var je=function(N){He||($e=N)};m.__private__.resetCustomOutputDestination=function(){He=!1,$e=we};var re=m.__private__.out=function(N){return N=N.toString(),be+=N.length+1,$e.push(N),$e},kt=m.__private__.write=function(N){return re(arguments.length===1?N.toString():Array.prototype.join.call(arguments," "))},it=m.__private__.getArrayBuffer=function(N){for(var V=N.length,ee=new ArrayBuffer(V),ae=new Uint8Array(ee);V--;)ae[V]=N.charCodeAt(V);return ee},Fe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return Fe};var ze=t.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(N){return ze=x===b.ADVANCED?N/Xe:N,this};var Ye,Ke=m.__private__.getFontSize=m.getFontSize=function(){return x===b.COMPAT?ze:ze*Xe},lt=t.R2L||!1;m.__private__.setR2L=m.setR2L=function(N){return lt=N,this},m.__private__.getR2L=m.getR2L=function(){return lt};var jt,Pt=m.__private__.setZoomMode=function(N){var V=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(N))Ye=N;else if(isNaN(N)){if(V.indexOf(N)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+N+'" is not recognized.');Ye=N}else Ye=parseInt(N,10)};m.__private__.getZoomMode=function(){return Ye};var Lt,xt=m.__private__.setPageMode=function(N){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(N)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+N+'" is not recognized.');jt=N};m.__private__.getPageMode=function(){return jt};var Rt=m.__private__.setLayoutMode=function(N){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(N)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+N+'" is not recognized.');Lt=N};m.__private__.getLayoutMode=function(){return Lt},m.__private__.setDisplayMode=m.setDisplayMode=function(N,V,ee){return Pt(N),Rt(V),xt(ee),this};var pt={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(N){if(Object.keys(pt).indexOf(N)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return pt[N]},m.__private__.getDocumentProperties=function(){return pt},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(N){for(var V in pt)pt.hasOwnProperty(V)&&N[V]&&(pt[V]=N[V]);return this},m.__private__.setDocumentProperty=function(N,V){if(Object.keys(pt).indexOf(N)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return pt[N]=V};var Ft,Xe,Sn,Ut,Cs,er={},cr={},Ti=[],Xt={},ea={},Sr={},Ps={},ms=null,vr=0,St=[],zt=new U3(m),Da=t.hotfixes||[],$r={},Zs={},Kn=[],ht=function N(V,ee,ae,pe,Ne,Le){if(!(this instanceof N))return new N(V,ee,ae,pe,Ne,Le);isNaN(V)&&(V=1),isNaN(ee)&&(ee=0),isNaN(ae)&&(ae=0),isNaN(pe)&&(pe=1),isNaN(Ne)&&(Ne=0),isNaN(Le)&&(Le=0),this._matrix=[V,ee,ae,pe,Ne,Le]};Object.defineProperty(ht.prototype,"sx",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(ht.prototype,"shy",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(ht.prototype,"shx",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(ht.prototype,"sy",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(ht.prototype,"tx",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(ht.prototype,"ty",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(ht.prototype,"a",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(ht.prototype,"b",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(ht.prototype,"c",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(ht.prototype,"d",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(ht.prototype,"e",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(ht.prototype,"f",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(ht.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ht.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ht.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ht.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ht.prototype.join=function(N){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(k).join(N)},ht.prototype.multiply=function(N){var V=N.sx*this.sx+N.shy*this.shx,ee=N.sx*this.shy+N.shy*this.sy,ae=N.shx*this.sx+N.sy*this.shx,pe=N.shx*this.shy+N.sy*this.sy,Ne=N.tx*this.sx+N.ty*this.shx+this.tx,Le=N.tx*this.shy+N.ty*this.sy+this.ty;return new ht(V,ee,ae,pe,Ne,Le)},ht.prototype.decompose=function(){var N=this.sx,V=this.shy,ee=this.shx,ae=this.sy,pe=this.tx,Ne=this.ty,Le=Math.sqrt(N*N+V*V),Ze=(N/=Le)*ee+(V/=Le)*ae;ee-=N*Ze,ae-=V*Ze;var at=Math.sqrt(ee*ee+ae*ae);return Ze/=at,N*(ae/=at)<V*(ee/=at)&&(N=-N,V=-V,Ze=-Ze,Le=-Le),{scale:new ht(Le,0,0,at,0,0),translate:new ht(1,0,0,1,pe,Ne),rotate:new ht(N,V,-V,N,0,0),skew:new ht(1,0,Ze,1,0,0)}},ht.prototype.toString=function(N){return this.join(" ")},ht.prototype.inversed=function(){var N=this.sx,V=this.shy,ee=this.shx,ae=this.sy,pe=this.tx,Ne=this.ty,Le=1/(N*ae-V*ee),Ze=ae*Le,at=-V*Le,p=-ee*Le,E=N*Le;return new ht(Ze,at,p,E,-Ze*pe-p*Ne,-at*pe-E*Ne)},ht.prototype.applyToPoint=function(N){var V=N.x*this.sx+N.y*this.shx+this.tx,ee=N.x*this.shy+N.y*this.sy+this.ty;return new Ri(V,ee)},ht.prototype.applyToRectangle=function(N){var V=this.applyToPoint(N),ee=this.applyToPoint(new Ri(N.x+N.w,N.y+N.h));return new Dl(V.x,V.y,ee.x-V.x,ee.y-V.y)},ht.prototype.clone=function(){var N=this.sx,V=this.shy,ee=this.shx,ae=this.sy,pe=this.tx,Ne=this.ty;return new ht(N,V,ee,ae,pe,Ne)},m.Matrix=ht;var mr=m.matrixMult=function(N,V){return V.multiply(N)},ei=new ht(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=ei;var ln=function(N,V){if(!ea[N]){var ee=(V instanceof Mu?"Sh":"P")+(Object.keys(Xt).length+1).toString(10);V.id=ee,ea[N]=ee,Xt[ee]=V,zt.publish("addPattern",V)}};m.ShadingPattern=Mu,m.TilingPattern=_h,m.addShadingPattern=function(N,V){return A("addShadingPattern()"),ln(N,V),this},m.beginTilingPattern=function(N){A("beginTilingPattern()"),Ol(N.boundingBox[0],N.boundingBox[1],N.boundingBox[2]-N.boundingBox[0],N.boundingBox[3]-N.boundingBox[1],N.matrix)},m.endTilingPattern=function(N,V){A("endTilingPattern()"),V.stream=De[J].join(`
`),ln(N,V),zt.publish("endTilingPattern",V),Kn.pop().restore()};var Ar=m.__private__.newObject=function(){var N=Wr();return ps(N,!0),N},Wr=m.__private__.newObjectDeferred=function(){return ue++,ge[ue]=function(){return be},ue},ps=function(N,V){return V=typeof V=="boolean"&&V,ge[N]=be,V&&re(N+" 0 obj"),N},ti=m.__private__.newAdditionalObject=function(){var N={objId:Wr(),content:""};return Me.push(N),N},ta=Wr(),ri=Wr(),Yn=m.__private__.decodeColorString=function(N){var V=N.split(" ");if(V.length!==2||V[1]!=="g"&&V[1]!=="G")V.length===5&&(V[4]==="k"||V[4]==="K")&&(V=[(1-V[0])*(1-V[3]),(1-V[1])*(1-V[3]),(1-V[2])*(1-V[3]),"r"]);else{var ee=parseFloat(V[0]);V=[ee,ee,ee,"r"]}for(var ae="#",pe=0;pe<3;pe++)ae+=("0"+Math.floor(255*parseFloat(V[pe])).toString(16)).slice(-2);return ae},Rs=m.__private__.encodeColorString=function(N){var V;typeof N=="string"&&(N={ch1:N});var ee=N.ch1,ae=N.ch2,pe=N.ch3,Ne=N.ch4,Le=N.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ee=="string"&&ee.charAt(0)!=="#"){var Ze=new DP(ee);if(Ze.ok)ee=Ze.toHex();else if(!/^\d*\.?\d*$/.test(ee))throw new Error('Invalid color "'+ee+'" passed to jsPDF.encodeColorString.')}if(typeof ee=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ee)&&(ee="#"+ee[1]+ee[1]+ee[2]+ee[2]+ee[3]+ee[3]),typeof ee=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ee)){var at=parseInt(ee.substr(1),16);ee=at>>16&255,ae=at>>8&255,pe=255&at}if(ae===void 0||Ne===void 0&&ee===ae&&ae===pe)if(typeof ee=="string")V=ee+" "+Le[0];else switch(N.precision){case 2:V=O(ee/255)+" "+Le[0];break;case 3:default:V=S(ee/255)+" "+Le[0]}else if(Ne===void 0||or(Ne)==="object"){if(Ne&&!isNaN(Ne.a)&&Ne.a===0)return V=["1.","1.","1.",Le[1]].join(" ");if(typeof ee=="string")V=[ee,ae,pe,Le[1]].join(" ");else switch(N.precision){case 2:V=[O(ee/255),O(ae/255),O(pe/255),Le[1]].join(" ");break;default:case 3:V=[S(ee/255),S(ae/255),S(pe/255),Le[1]].join(" ")}}else if(typeof ee=="string")V=[ee,ae,pe,Ne,Le[2]].join(" ");else switch(N.precision){case 2:V=[O(ee),O(ae),O(pe),O(Ne),Le[2]].join(" ");break;case 3:default:V=[S(ee),S(ae),S(pe),S(Ne),Le[2]].join(" ")}return V},Ds=m.__private__.getFilters=function(){return o},Rn=m.__private__.putStream=function(N){var V=(N=N||{}).data||"",ee=N.filters||Ds(),ae=N.alreadyAppliedFilters||[],pe=N.addLength1||!1,Ne=V.length,Le=N.objectId,Ze=function(Oe){return Oe};if(d!==null&&Le===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Ze=Hr.encryptor(Le,0));var at={};ee===!0&&(ee=["FlateEncode"]);var p=N.additionalKeyValues||[],E=(at=bt.API.processDataByFilters!==void 0?bt.API.processDataByFilters(V,ee):{data:V,reverseChain:[]}).reverseChain+(Array.isArray(ae)?ae.join(" "):ae.toString());if(at.data.length!==0&&(p.push({key:"Length",value:at.data.length}),pe===!0&&p.push({key:"Length1",value:Ne})),E.length!=0)if(E.split("/").length-1==1)p.push({key:"Filter",value:E});else{p.push({key:"Filter",value:"["+E+"]"});for(var L=0;L<p.length;L+=1)if(p[L].key==="DecodeParms"){for(var W=[],he=0;he<at.reverseChain.split("/").length-1;he+=1)W.push("null");W.push(p[L].value),p[L].value="["+W.join(" ")+"]"}}re("<<");for(var ye=0;ye<p.length;ye++)re("/"+p[ye].key+" "+p[ye].value);re(">>"),at.data.length!==0&&(re("stream"),re(Ze(at.data)),re("endstream"))},xn=m.__private__.putPage=function(N){var V=N.number,ee=N.data,ae=N.objId,pe=N.contentsObjId;ps(ae,!0),re("<</Type /Page"),re("/Parent "+N.rootDictionaryObjId+" 0 R"),re("/Resources "+N.resourceDictionaryObjId+" 0 R"),re("/MediaBox ["+parseFloat(k(N.mediaBox.bottomLeftX))+" "+parseFloat(k(N.mediaBox.bottomLeftY))+" "+k(N.mediaBox.topRightX)+" "+k(N.mediaBox.topRightY)+"]"),N.cropBox!==null&&re("/CropBox ["+k(N.cropBox.bottomLeftX)+" "+k(N.cropBox.bottomLeftY)+" "+k(N.cropBox.topRightX)+" "+k(N.cropBox.topRightY)+"]"),N.bleedBox!==null&&re("/BleedBox ["+k(N.bleedBox.bottomLeftX)+" "+k(N.bleedBox.bottomLeftY)+" "+k(N.bleedBox.topRightX)+" "+k(N.bleedBox.topRightY)+"]"),N.trimBox!==null&&re("/TrimBox ["+k(N.trimBox.bottomLeftX)+" "+k(N.trimBox.bottomLeftY)+" "+k(N.trimBox.topRightX)+" "+k(N.trimBox.topRightY)+"]"),N.artBox!==null&&re("/ArtBox ["+k(N.artBox.bottomLeftX)+" "+k(N.artBox.bottomLeftY)+" "+k(N.artBox.topRightX)+" "+k(N.artBox.topRightY)+"]"),typeof N.userUnit=="number"&&N.userUnit!==1&&re("/UserUnit "+N.userUnit),zt.publish("putPage",{objId:ae,pageContext:St[V],pageNumber:V,page:ee}),re("/Contents "+pe+" 0 R"),re(">>"),re("endobj");var Ne=ee.join(`
`);return x===b.ADVANCED&&(Ne+=`
Q`),ps(pe,!0),Rn({data:Ne,filters:Ds(),objectId:pe}),re("endobj"),ae},La=m.__private__.putPages=function(){var N,V,ee=[];for(N=1;N<=vr;N++)St[N].objId=Wr(),St[N].contentsObjId=Wr();for(N=1;N<=vr;N++)ee.push(xn({number:N,data:De[N],objId:St[N].objId,contentsObjId:St[N].contentsObjId,mediaBox:St[N].mediaBox,cropBox:St[N].cropBox,bleedBox:St[N].bleedBox,trimBox:St[N].trimBox,artBox:St[N].artBox,userUnit:St[N].userUnit,rootDictionaryObjId:ta,resourceDictionaryObjId:ri}));ps(ta,!0),re("<</Type /Pages");var ae="/Kids [";for(V=0;V<vr;V++)ae+=ee[V]+" 0 R ";re(ae+"]"),re("/Count "+vr),re(">>"),re("endobj"),zt.publish("postPutPages")},bo=function(N){zt.publish("putFont",{font:N,out:re,newObject:Ar,putStream:Rn}),N.isAlreadyPutted!==!0&&(N.objectNumber=Ar(),re("<<"),re("/Type /Font"),re("/BaseFont /"+nh(N.postScriptName)),re("/Subtype /Type1"),typeof N.encoding=="string"&&re("/Encoding /"+N.encoding),re("/FirstChar 32"),re("/LastChar 255"),re(">>"),re("endobj"))},Oa=function(){for(var N in er)er.hasOwnProperty(N)&&(h===!1||h===!0&&g.hasOwnProperty(N))&&bo(er[N])},Ma=function(N){N.objectNumber=Ar();var V=[];V.push({key:"Type",value:"/XObject"}),V.push({key:"Subtype",value:"/Form"}),V.push({key:"BBox",value:"["+[k(N.x),k(N.y),k(N.x+N.width),k(N.y+N.height)].join(" ")+"]"}),V.push({key:"Matrix",value:"["+N.matrix.toString()+"]"});var ee=N.pages[1].join(`
`);Rn({data:ee,additionalKeyValues:V,objectId:N.objectNumber}),re("endobj")},wo=function(){for(var N in $r)$r.hasOwnProperty(N)&&Ma($r[N])},ou=function(N,V){var ee,ae=[],pe=1/(V-1);for(ee=0;ee<1;ee+=pe)ae.push(ee);if(ae.push(1),N[0].offset!=0){var Ne={offset:0,color:N[0].color};N.unshift(Ne)}if(N[N.length-1].offset!=1){var Le={offset:1,color:N[N.length-1].color};N.push(Le)}for(var Ze="",at=0,p=0;p<ae.length;p++){for(ee=ae[p];ee>N[at+1].offset;)at++;var E=N[at].offset,L=(ee-E)/(N[at+1].offset-E),W=N[at].color,he=N[at+1].color;Ze+=ie(Math.round((1-L)*W[0]+L*he[0]).toString(16))+ie(Math.round((1-L)*W[1]+L*he[1]).toString(16))+ie(Math.round((1-L)*W[2]+L*he[2]).toString(16))}return Ze.trim()},Af=function(N,V){V||(V=21);var ee=Ar(),ae=ou(N.colors,V),pe=[];pe.push({key:"FunctionType",value:"0"}),pe.push({key:"Domain",value:"[0.0 1.0]"}),pe.push({key:"Size",value:"["+V+"]"}),pe.push({key:"BitsPerSample",value:"8"}),pe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),pe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Rn({data:ae,additionalKeyValues:pe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ee}),re("endobj"),N.objectNumber=Ar(),re("<< /ShadingType "+N.type),re("/ColorSpace /DeviceRGB");var Ne="/Coords ["+k(parseFloat(N.coords[0]))+" "+k(parseFloat(N.coords[1]))+" ";N.type===2?Ne+=k(parseFloat(N.coords[2]))+" "+k(parseFloat(N.coords[3])):Ne+=k(parseFloat(N.coords[2]))+" "+k(parseFloat(N.coords[3]))+" "+k(parseFloat(N.coords[4]))+" "+k(parseFloat(N.coords[5])),re(Ne+="]"),N.matrix&&re("/Matrix ["+N.matrix.toString()+"]"),re("/Function "+ee+" 0 R"),re("/Extend [true true]"),re(">>"),re("endobj")},_l=function(N,V){var ee=Wr(),ae=Ar();V.push({resourcesOid:ee,objectOid:ae}),N.objectNumber=ae;var pe=[];pe.push({key:"Type",value:"/Pattern"}),pe.push({key:"PatternType",value:"1"}),pe.push({key:"PaintType",value:"1"}),pe.push({key:"TilingType",value:"1"}),pe.push({key:"BBox",value:"["+N.boundingBox.map(k).join(" ")+"]"}),pe.push({key:"XStep",value:k(N.xStep)}),pe.push({key:"YStep",value:k(N.yStep)}),pe.push({key:"Resources",value:ee+" 0 R"}),N.matrix&&pe.push({key:"Matrix",value:"["+N.matrix.toString()+"]"}),Rn({data:N.stream,additionalKeyValues:pe,objectId:N.objectNumber}),re("endobj")},No=function(N){var V;for(V in Xt)Xt.hasOwnProperty(V)&&(Xt[V]instanceof Mu?Af(Xt[V]):Xt[V]instanceof _h&&_l(Xt[V],N))},jl=function(N){for(var V in N.objectNumber=Ar(),re("<<"),N)switch(V){case"opacity":re("/ca "+O(N[V]));break;case"stroke-opacity":re("/CA "+O(N[V]))}re(">>"),re("endobj")},_o=function(){var N;for(N in Sr)Sr.hasOwnProperty(N)&&jl(Sr[N])},ni=function(){for(var N in re("/XObject <<"),$r)$r.hasOwnProperty(N)&&$r[N].objectNumber>=0&&re("/"+N+" "+$r[N].objectNumber+" 0 R");zt.publish("putXobjectDict"),re(">>")},lu=function(){Hr.oid=Ar(),re("<<"),re("/Filter /Standard"),re("/V "+Hr.v),re("/R "+Hr.r),re("/U <"+Hr.toHexString(Hr.U)+">"),re("/O <"+Hr.toHexString(Hr.O)+">"),re("/P "+Hr.P),re(">>"),re("endobj")},Nd=function(){for(var N in re("/Font <<"),er)er.hasOwnProperty(N)&&(h===!1||h===!0&&g.hasOwnProperty(N))&&re("/"+N+" "+er[N].objectNumber+" 0 R");re(">>")},_d=function(){if(Object.keys(Xt).length>0){for(var N in re("/Shading <<"),Xt)Xt.hasOwnProperty(N)&&Xt[N]instanceof Mu&&Xt[N].objectNumber>=0&&re("/"+N+" "+Xt[N].objectNumber+" 0 R");zt.publish("putShadingPatternDict"),re(">>")}},jo=function(N){if(Object.keys(Xt).length>0){for(var V in re("/Pattern <<"),Xt)Xt.hasOwnProperty(V)&&Xt[V]instanceof m.TilingPattern&&Xt[V].objectNumber>=0&&Xt[V].objectNumber<N&&re("/"+V+" "+Xt[V].objectNumber+" 0 R");zt.publish("putTilingPatternDict"),re(">>")}},jd=function(){if(Object.keys(Sr).length>0){var N;for(N in re("/ExtGState <<"),Sr)Sr.hasOwnProperty(N)&&Sr[N].objectNumber>=0&&re("/"+N+" "+Sr[N].objectNumber+" 0 R");zt.publish("putGStateDict"),re(">>")}},Er=function(N){ps(N.resourcesOid,!0),re("<<"),re("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Nd(),_d(),jo(N.objectOid),jd(),ni(),re(">>"),re("endobj")},Sl=function(){var N=[];Oa(),_o(),wo(),No(N),zt.publish("putResources"),N.forEach(Er),Er({resourcesOid:ri,objectOid:Number.MAX_SAFE_INTEGER}),zt.publish("postPutResources")},cu=function(){zt.publish("putAdditionalObjects");for(var N=0;N<Me.length;N++){var V=Me[N];ps(V.objId,!0),re(V.content),re("endobj")}zt.publish("postPutAdditionalObjects")},uu=function(N){cr[N.fontName]=cr[N.fontName]||{},cr[N.fontName][N.fontStyle]=N.id},du=function(N,V,ee,ae,pe){var Ne={id:"F"+(Object.keys(er).length+1).toString(10),postScriptName:N,fontName:V,fontStyle:ee,encoding:ae,isStandardFont:pe||!1,metadata:{}};return zt.publish("addFont",{font:Ne,instance:this}),er[Ne.id]=Ne,uu(Ne),Ne.id},Ef=function(N){for(var V=0,ee=Fe.length;V<ee;V++){var ae=du.call(this,N[V][0],N[V][1],N[V][2],Fe[V][3],!0);h===!1&&(g[ae]=!0);var pe=N[V][0].split("-");uu({id:ae,fontName:pe[0],fontStyle:pe[1]||""})}zt.publish("addFonts",{fonts:er,dictionary:cr})},Ls=function(N){return N.foo=function(){try{return N.apply(this,arguments)}catch(ae){var V=ae.stack||"";~V.indexOf(" at ")&&(V=V.split(" at ")[1]);var ee="Error in function "+V.split(`
`)[0].split("<")[0]+": "+ae.message;if(!wt.console)throw new Error(ee);wt.console.error(ee,ae),wt.alert&&alert(ee)}},N.foo.bar=N,N.foo},So=function(N,V){var ee,ae,pe,Ne,Le,Ze,at,p,E;if(pe=(V=V||{}).sourceEncoding||"Unicode",Le=V.outputEncoding,(V.autoencode||Le)&&er[Ft].metadata&&er[Ft].metadata[pe]&&er[Ft].metadata[pe].encoding&&(Ne=er[Ft].metadata[pe].encoding,!Le&&er[Ft].encoding&&(Le=er[Ft].encoding),!Le&&Ne.codePages&&(Le=Ne.codePages[0]),typeof Le=="string"&&(Le=Ne[Le]),Le)){for(at=!1,Ze=[],ee=0,ae=N.length;ee<ae;ee++)(p=Le[N.charCodeAt(ee)])?Ze.push(String.fromCharCode(p)):Ze.push(N[ee]),Ze[ee].charCodeAt(0)>>8&&(at=!0);N=Ze.join("")}for(ee=N.length;at===void 0&&ee!==0;)N.charCodeAt(ee-1)>>8&&(at=!0),ee--;if(!at)return N;for(Ze=V.noBOM?[]:[254,255],ee=0,ae=N.length;ee<ae;ee++){if((E=(p=N.charCodeAt(ee))>>8)>>8)throw new Error("Character at position "+ee+" of string '"+N+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Ze.push(E),Ze.push(p-(E<<8))}return String.fromCharCode.apply(void 0,Ze)},Qn=m.__private__.pdfEscape=m.pdfEscape=function(N,V){return So(N,V).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},si=m.__private__.beginPage=function(N){De[++vr]=[],St[vr]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(N[0]),topRightY:Number(N[1])}},Ao(vr),je(De[J])},Os=function(N,V){var ee,ae,pe;switch(r=V||r,typeof N=="string"&&(ee=v(N.toLowerCase()),Array.isArray(ee)&&(ae=ee[0],pe=ee[1])),Array.isArray(N)&&(ae=N[0]*Xe,pe=N[1]*Xe),isNaN(ae)&&(ae=s[0],pe=s[1]),(ae>14400||pe>14400)&&(yr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ae=Math.min(14400,ae),pe=Math.min(14400,pe)),s=[ae,pe],r.substr(0,1)){case"l":pe>ae&&(s=[pe,ae]);break;case"p":ae>pe&&(s=[pe,ae])}si(s),Pd(ur),re(oi),Ba!==0&&re(Ba+" J"),xu!==0&&re(xu+" j"),zt.publish("addPage",{pageNumber:vr})},Al=function(N){N>0&&N<=vr&&(De.splice(N,1),St.splice(N,1),vr--,J>vr&&(J=vr),this.setPage(J))},Ao=function(N){N>0&&N<=vr&&(J=N)},Sd=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return De.length-1},tr=function(N,V,ee){var ae,pe=void 0;return ee=ee||{},N=N!==void 0?N:er[Ft].fontName,V=V!==void 0?V:er[Ft].fontStyle,ae=N.toLowerCase(),cr[ae]!==void 0&&cr[ae][V]!==void 0?pe=cr[ae][V]:cr[N]!==void 0&&cr[N][V]!==void 0?pe=cr[N][V]:ee.disableWarning===!1&&yr.warn("Unable to look up font label for font '"+N+"', '"+V+"'. Refer to getFontList() for available fonts."),pe||ee.noFallback||(pe=cr.times[V])==null&&(pe=cr.times.normal),pe},El=m.__private__.putInfo=function(){var N=Ar(),V=function(ae){return ae};for(var ee in d!==null&&(V=Hr.encryptor(N,0)),re("<<"),re("/Producer ("+Qn(V("jsPDF "+bt.version))+")"),pt)pt.hasOwnProperty(ee)&&pt[ee]&&re("/"+ee.substr(0,1).toUpperCase()+ee.substr(1)+" ("+Qn(V(pt[ee]))+")");re("/CreationDate ("+Qn(V(de))+")"),re(">>"),re("endobj")},ra=m.__private__.putCatalog=function(N){var V=(N=N||{}).rootDictionaryObjId||ta;switch(Ar(),re("<<"),re("/Type /Catalog"),re("/Pages "+V+" 0 R"),Ye||(Ye="fullwidth"),Ye){case"fullwidth":re("/OpenAction [3 0 R /FitH null]");break;case"fullheight":re("/OpenAction [3 0 R /FitV null]");break;case"fullpage":re("/OpenAction [3 0 R /Fit]");break;case"original":re("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ee=""+Ye;ee.substr(ee.length-1)==="%"&&(Ye=parseInt(Ye)/100),typeof Ye=="number"&&re("/OpenAction [3 0 R /XYZ null null "+O(Ye)+"]")}switch(Lt||(Lt="continuous"),Lt){case"continuous":re("/PageLayout /OneColumn");break;case"single":re("/PageLayout /SinglePage");break;case"two":case"twoleft":re("/PageLayout /TwoColumnLeft");break;case"tworight":re("/PageLayout /TwoColumnRight")}jt&&re("/PageMode /"+jt),zt.publish("putCatalog"),re(">>"),re("endobj")},Eo=m.__private__.putTrailer=function(){re("trailer"),re("<<"),re("/Size "+(ue+1)),re("/Root "+ue+" 0 R"),re("/Info "+(ue-1)+" 0 R"),d!==null&&re("/Encrypt "+Hr.oid+" 0 R"),re("/ID [ <"+ne+"> <"+ne+"> ]"),re(">>")},kf=m.__private__.putHeader=function(){re("%PDF-"+w),re("%ºß¬à")},Ad=m.__private__.putXRef=function(){var N="0000000000";re("xref"),re("0 "+(ue+1)),re("0000000000 65535 f ");for(var V=1;V<=ue;V++)typeof ge[V]=="function"?re((N+ge[V]()).slice(-10)+" 00000 n "):ge[V]!==void 0?re((N+ge[V]).slice(-10)+" 00000 n "):re("0000000000 00000 n ")},na=m.__private__.buildDocument=function(){dt(),je(we),zt.publish("buildDocument"),kf(),La(),cu(),Sl(),d!==null&&lu(),El(),ra();var N=be;return Ad(),Eo(),re("startxref"),re(""+N),re("%%EOF"),je(De[J]),we.join(`
`)},kl=m.__private__.getBlob=function(N){return new Blob([it(N)],{type:"application/pdf"})},Tl=m.output=m.__private__.output=Ls(function(N,V){switch(typeof(V=V||{})=="string"?V={filename:V}:V.filename=V.filename||"generated.pdf",N){case void 0:return na();case"save":m.save(V.filename);break;case"arraybuffer":return it(na());case"blob":return kl(na());case"bloburi":case"bloburl":if(wt.URL!==void 0&&typeof wt.URL.createObjectURL=="function")return wt.URL&&wt.URL.createObjectURL(kl(na()))||void 0;yr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ee="",ae=na();try{ee=Lb(ae)}catch{ee=Lb(unescape(encodeURIComponent(ae)))}return"data:application/pdf;filename="+V.filename+";base64,"+ee;case"pdfobjectnewwindow":if(Object.prototype.toString.call(wt)==="[object Window]"){var pe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ne=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';V.pdfObjectUrl&&(pe=V.pdfObjectUrl,Ne="");var Le='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+pe+'"'+Ne+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(V)+");<\/script></body></html>",Ze=wt.open();return Ze!==null&&Ze.document.write(Le),Ze}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(wt)==="[object Window]"){var at='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(V.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+V.filename+'" width="500px" height="400px" /></body></html>',p=wt.open();if(p!==null){p.document.write(at);var E=this;p.document.documentElement.querySelector("#pdfViewer").onload=function(){p.document.title=V.filename,p.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(E.output("bloburl"))}}return p}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(wt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var L='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",V)+'"></iframe></body></html>',W=wt.open();if(W!==null&&(W.document.write(L),W.document.title=V.filename),W||typeof safari>"u")return W;break;case"datauri":case"dataurl":return wt.document.location.href=this.output("datauristring",V);default:return null}}),Ed=function(N){return Array.isArray(Da)===!0&&Da.indexOf(N)>-1};switch(n){case"pt":Xe=1;break;case"mm":Xe=72/25.4;break;case"cm":Xe=72/2.54;break;case"in":Xe=72;break;case"px":Xe=Ed("px_scaling")==1?.75:96/72;break;case"pc":case"em":Xe=12;break;case"ex":Xe=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Xe=n}var Hr=null;Se(),Y();var Ii=function(N){return d!==null?Hr.encryptor(N,0):function(V){return V}},hu=m.__private__.getPageInfo=m.getPageInfo=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:St[N].objId,pageNumber:N,pageContext:St[N]}},At=m.__private__.getPageInfoByObjId=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var V in St)if(St[V].objId===N)break;return hu(V)},kd=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:St[J].objId,pageNumber:J,pageContext:St[J]}};m.addPage=function(){return Os.apply(this,arguments),this},m.setPage=function(){return Ao.apply(this,arguments),je.call(this,De[J]),this},m.insertPage=function(N){return this.addPage(),this.movePage(J,N),this},m.movePage=function(N,V){var ee,ae;if(N>V){ee=De[N],ae=St[N];for(var pe=N;pe>V;pe--)De[pe]=De[pe-1],St[pe]=St[pe-1];De[V]=ee,St[V]=ae,this.setPage(V)}else if(N<V){ee=De[N],ae=St[N];for(var Ne=N;Ne<V;Ne++)De[Ne]=De[Ne+1],St[Ne]=St[Ne+1];De[V]=ee,St[V]=ae,this.setPage(V)}return this},m.deletePage=function(){return Al.apply(this,arguments),this},m.__private__.text=m.text=function(N,V,ee,ae,pe){var Ne,Le,Ze,at,p,E,L,W,he,ye=(ae=ae||{}).scope||this;if(typeof N=="number"&&typeof V=="number"&&(typeof ee=="string"||Array.isArray(ee))){var Oe=ee;ee=V,V=N,N=Oe}if(arguments[3]instanceof ht?(A("The transform parameter of text() with a Matrix value"),he=pe):(Ze=arguments[4],at=arguments[5],or(L=arguments[3])==="object"&&L!==null||(typeof Ze=="string"&&(at=Ze,Ze=null),typeof L=="string"&&(at=L,L=null),typeof L=="number"&&(Ze=L,L=null),ae={flags:L,angle:Ze,align:at})),isNaN(V)||isNaN(ee)||N==null)throw new Error("Invalid arguments passed to jsPDF.text");if(N.length===0)return ye;var Tt="",rr=!1,It=typeof ae.lineHeightFactor=="number"?ae.lineHeightFactor:sa,pr=ye.internal.scaleFactor;function Zr(br){return br=br.split("	").join(Array(ae.TabLen||9).join(" ")),Qn(br,L)}function Li(br){for(var wr,tn=br.concat(),vn=[],Ro=tn.length;Ro--;)typeof(wr=tn.shift())=="string"?vn.push(wr):Array.isArray(br)&&(wr.length===1||wr[1]===void 0&&wr[2]===void 0)?vn.push(wr[0]):vn.push([wr[0],wr[1],wr[2]]);return vn}function Dn(br,wr){var tn;if(typeof br=="string")tn=wr(br)[0];else if(Array.isArray(br)){for(var vn,Ro,Of=br.concat(),zd=[],eg=Of.length;eg--;)typeof(vn=Of.shift())=="string"?zd.push(wr(vn)[0]):Array.isArray(vn)&&typeof vn[0]=="string"&&(Ro=wr(vn[0],vn[1],vn[2]),zd.push([Ro[0],Ro[1],Ro[2]]));tn=zd}return tn}var ca=!1,To=!0;if(typeof N=="string")ca=!0;else if(Array.isArray(N)){var If=N.concat();Le=[];for(var Dd,Ln=If.length;Ln--;)(typeof(Dd=If.shift())!="string"||Array.isArray(Dd)&&typeof Dd[0]!="string")&&(To=!1);ca=To}if(ca===!1)throw new Error('Type of text must be string or Array. "'+N+'" is not recognized.');typeof N=="string"&&(N=N.match(/[\r?\n]/)?N.split(/\r\n|\r|\n/g):[N]);var Ld=ze/ye.internal.scaleFactor,Od=Ld*(It-1);switch(ae.baseline){case"bottom":ee-=Od;break;case"top":ee+=Ld-Od;break;case"hanging":ee+=Ld-2*Od;break;case"middle":ee+=Ld/2-Od}if((E=ae.maxWidth||0)>0&&(typeof N=="string"?N=ye.splitTextToSize(N,E):Object.prototype.toString.call(N)==="[object Array]"&&(N=N.reduce(function(br,wr){return br.concat(ye.splitTextToSize(wr,E))},[]))),Ne={text:N,x:V,y:ee,options:ae,mutex:{pdfEscape:Qn,activeFontKey:Ft,fonts:er,activeFontSize:ze}},zt.publish("preProcessText",Ne),N=Ne.text,Ze=(ae=Ne.options).angle,!(he instanceof ht)&&Ze&&typeof Ze=="number"){Ze*=Math.PI/180,ae.rotationDirection===0&&(Ze=-Ze),x===b.ADVANCED&&(Ze=-Ze);var Md=Math.cos(Ze),Cf=Math.sin(Ze);he=new ht(Md,Cf,-Cf,Md,0,0)}else Ze&&Ze instanceof ht&&(he=Ze);x!==b.ADVANCED||he||(he=ei),(p=ae.charSpace||oa)!==void 0&&(Tt+=k(R(p))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(W=ae.horizontalScale)!==void 0&&(Tt+=k(100*W)+` Tz
`),ae.lang;var Fs=-1,r1=ae.renderingMode!==void 0?ae.renderingMode:ae.stroke,Pf=ye.internal.getCurrentPageInfo().pageContext;switch(r1){case 0:case!1:case"fill":Fs=0;break;case 1:case!0:case"stroke":Fs=1;break;case 2:case"fillThenStroke":Fs=2;break;case 3:case"invisible":Fs=3;break;case 4:case"fillAndAddForClipping":Fs=4;break;case 5:case"strokeAndAddPathForClipping":Fs=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Fs=6;break;case 7:case"addToPathForClipping":Fs=7}var Qp=Pf.usedRenderingMode!==void 0?Pf.usedRenderingMode:-1;Fs!==-1?Tt+=Fs+` Tr
`:Qp!==-1&&(Tt+=`0 Tr
`),Fs!==-1&&(Pf.usedRenderingMode=Fs),at=ae.align||"left";var Oi,Fd=ze*It,Jp=ye.internal.pageSize.getWidth(),Xp=er[Ft];p=ae.charSpace||oa,E=ae.maxWidth||0,L=Object.assign({autoencode:!0,noBOM:!0},ae.flags);var Fl=[],wu=function(br){return ye.getStringUnitWidth(br,{font:Xp,charSpace:p,fontSize:ze,doKerning:!1})*ze/pr};if(Object.prototype.toString.call(N)==="[object Array]"){var Vs;Le=Li(N),at!=="left"&&(Oi=Le.map(wu));var xs,Vl=0;if(at==="right"){V-=Oi[0],N=[],Ln=Le.length;for(var Io=0;Io<Ln;Io++)Io===0?(xs=ys(V),Vs=Pi(ee)):(xs=R(Vl-Oi[Io]),Vs=-Fd),N.push([Le[Io],xs,Vs]),Vl=Oi[Io]}else if(at==="center"){V-=Oi[0]/2,N=[],Ln=Le.length;for(var Co=0;Co<Ln;Co++)Co===0?(xs=ys(V),Vs=Pi(ee)):(xs=R((Vl-Oi[Co])/2),Vs=-Fd),N.push([Le[Co],xs,Vs]),Vl=Oi[Co]}else if(at==="left"){N=[],Ln=Le.length;for(var Vd=0;Vd<Ln;Vd++)N.push(Le[Vd])}else if(at==="justify"&&Xp.encoding==="Identity-H"){N=[],Ln=Le.length,E=E!==0?E:Jp;for(var Po=0,en=0;en<Ln;en++)if(Vs=en===0?Pi(ee):-Fd,xs=en===0?ys(V):Po,en<Ln-1){var Rf=R((E-Oi[en])/(Le[en].split(" ").length-1)),vs=Le[en].split(" ");N.push([vs[0]+" ",xs,Vs]),Po=0;for(var Mi=1;Mi<vs.length;Mi++){var Bd=(wu(vs[Mi-1]+" "+vs[Mi])-wu(vs[Mi]))*pr+Rf;Mi==vs.length-1?N.push([vs[Mi],Bd,0]):N.push([vs[Mi]+" ",Bd,0]),Po-=Bd}}else N.push([Le[en],xs,Vs]);N.push(["",Po,0])}else{if(at!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(N=[],Ln=Le.length,E=E!==0?E:Jp,en=0;en<Ln;en++)Vs=en===0?Pi(ee):-Fd,xs=en===0?ys(V):0,en<Ln-1?Fl.push(k(R((E-Oi[en])/(Le[en].split(" ").length-1)))):Fl.push(0),N.push([Le[en],xs,Vs])}}var Zp=typeof ae.R2L=="boolean"?ae.R2L:lt;Zp===!0&&(N=Dn(N,function(br,wr,tn){return[br.split("").reverse().join(""),wr,tn]})),Ne={text:N,x:V,y:ee,options:ae,mutex:{pdfEscape:Qn,activeFontKey:Ft,fonts:er,activeFontSize:ze}},zt.publish("postProcessText",Ne),N=Ne.text,rr=Ne.mutex.isHex||!1;var Df=er[Ft].encoding;Df!=="WinAnsiEncoding"&&Df!=="StandardEncoding"||(N=Dn(N,function(br,wr,tn){return[Zr(br),wr,tn]})),Le=Li(N),N=[];for(var Nu,_u,Bl,ju=0,Ud=1,Su=Array.isArray(Le[0])?Ud:ju,Ul="",Lf=function(br,wr,tn){var vn="";return tn instanceof ht?(tn=typeof ae.angle=="number"?mr(tn,new ht(1,0,0,1,br,wr)):mr(new ht(1,0,0,1,br,wr),tn),x===b.ADVANCED&&(tn=mr(new ht(1,0,0,-1,0,0),tn)),vn=tn.join(" ")+` Tm
`):vn=k(br)+" "+k(wr)+` Td
`,vn},Fi=0;Fi<Le.length;Fi++){switch(Ul="",Su){case Ud:Bl=(rr?"<":"(")+Le[Fi][0]+(rr?">":")"),Nu=parseFloat(Le[Fi][1]),_u=parseFloat(Le[Fi][2]);break;case ju:Bl=(rr?"<":"(")+Le[Fi]+(rr?">":")"),Nu=ys(V),_u=Pi(ee)}Fl!==void 0&&Fl[Fi]!==void 0&&(Ul=Fl[Fi]+` Tw
`),Fi===0?N.push(Ul+Lf(Nu,_u,he)+Bl):Su===ju?N.push(Ul+Bl):Su===Ud&&N.push(Ul+Lf(Nu,_u,he)+Bl)}N=Su===ju?N.join(` Tj
T* `):N.join(` Tj
`),N+=` Tj
`;var Vi=`BT
/`;return Vi+=Ft+" "+ze+` Tf
`,Vi+=k(ze*It)+` TL
`,Vi+=Va+`
`,Vi+=Tt,Vi+=N,re(Vi+="ET"),g[Ft]=!0,ye};var Fa=m.__private__.clip=m.clip=function(N){return re(N==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return Fa("evenodd")},m.__private__.discardPath=m.discardPath=function(){return re("n"),this};var Ci=m.__private__.isValidStyle=function(N){var V=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(N)!==-1&&(V=!0),V};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(N){return Ci(N)&&(u=N),this};var Td=m.__private__.getStyle=m.getStyle=function(N){var V=u;switch(N){case"D":case"S":V="S";break;case"F":V="f";break;case"FD":case"DF":V="B";break;case"f":case"f*":case"B":case"B*":V=N}return V},Id=m.close=function(){return re("h"),this};m.stroke=function(){return re("S"),this},m.fill=function(N){return gs("f",N),this},m.fillEvenOdd=function(N){return gs("f*",N),this},m.fillStroke=function(N){return gs("B",N),this},m.fillStrokeEvenOdd=function(N){return gs("B*",N),this};var gs=function(N,V){or(V)==="object"?Il(V,N):re(N)},fu=function(N){N===null||x===b.ADVANCED&&N===void 0||(N=Td(N),re(N))};function Tf(N,V,ee,ae,pe){var Ne=new _h(V||this.boundingBox,ee||this.xStep,ae||this.yStep,this.gState,pe||this.matrix);Ne.stream=this.stream;var Le=N+"$$"+this.cloneIndex+++"$$";return ln(Le,Ne),Ne}var Il=function(N,V){var ee=ea[N.key],ae=Xt[ee];if(ae instanceof Mu)re("q"),re(Cl(V)),ae.gState&&m.setGState(ae.gState),re(N.matrix.toString()+" cm"),re("/"+ee+" sh"),re("Q");else if(ae instanceof _h){var pe=new ht(1,0,0,-1,0,la());N.matrix&&(pe=pe.multiply(N.matrix||ei),ee=Tf.call(ae,N.key,N.boundingBox,N.xStep,N.yStep,pe).id),re("q"),re("/Pattern cs"),re("/"+ee+" scn"),ae.gState&&m.setGState(ae.gState),re(V),re("Q")}},Cl=function(N){switch(N){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Pl=m.moveTo=function(N,V){return re(k(R(N))+" "+k(G(V))+" m"),this},ii=m.lineTo=function(N,V){return re(k(R(N))+" "+k(G(V))+" l"),this},Ms=m.curveTo=function(N,V,ee,ae,pe,Ne){return re([k(R(N)),k(G(V)),k(R(ee)),k(G(ae)),k(R(pe)),k(G(Ne)),"c"].join(" ")),this};m.__private__.line=m.line=function(N,V,ee,ae,pe){if(isNaN(N)||isNaN(V)||isNaN(ee)||isNaN(ae)||!Ci(pe))throw new Error("Invalid arguments passed to jsPDF.line");return x===b.COMPAT?this.lines([[ee-N,ae-V]],N,V,[1,1],pe||"S"):this.lines([[ee-N,ae-V]],N,V,[1,1]).stroke()},m.__private__.lines=m.lines=function(N,V,ee,ae,pe,Ne){var Le,Ze,at,p,E,L,W,he,ye,Oe,Tt,rr;if(typeof N=="number"&&(rr=ee,ee=V,V=N,N=rr),ae=ae||[1,1],Ne=Ne||!1,isNaN(V)||isNaN(ee)||!Array.isArray(N)||!Array.isArray(ae)||!Ci(pe)||typeof Ne!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Pl(V,ee),Le=ae[0],Ze=ae[1],p=N.length,Oe=V,Tt=ee,at=0;at<p;at++)(E=N[at]).length===2?(Oe=E[0]*Le+Oe,Tt=E[1]*Ze+Tt,ii(Oe,Tt)):(L=E[0]*Le+Oe,W=E[1]*Ze+Tt,he=E[2]*Le+Oe,ye=E[3]*Ze+Tt,Oe=E[4]*Le+Oe,Tt=E[5]*Ze+Tt,Ms(L,W,he,ye,Oe,Tt));return Ne&&Id(),fu(pe),this},m.path=function(N){for(var V=0;V<N.length;V++){var ee=N[V],ae=ee.c;switch(ee.op){case"m":Pl(ae[0],ae[1]);break;case"l":ii(ae[0],ae[1]);break;case"c":Ms.apply(this,ae);break;case"h":Id()}}return this},m.__private__.rect=m.rect=function(N,V,ee,ae,pe){if(isNaN(N)||isNaN(V)||isNaN(ee)||isNaN(ae)||!Ci(pe))throw new Error("Invalid arguments passed to jsPDF.rect");return x===b.COMPAT&&(ae=-ae),re([k(R(N)),k(G(V)),k(R(ee)),k(R(ae)),"re"].join(" ")),fu(pe),this},m.__private__.triangle=m.triangle=function(N,V,ee,ae,pe,Ne,Le){if(isNaN(N)||isNaN(V)||isNaN(ee)||isNaN(ae)||isNaN(pe)||isNaN(Ne)||!Ci(Le))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ee-N,ae-V],[pe-ee,Ne-ae],[N-pe,V-Ne]],N,V,[1,1],Le,!0),this},m.__private__.roundedRect=m.roundedRect=function(N,V,ee,ae,pe,Ne,Le){if(isNaN(N)||isNaN(V)||isNaN(ee)||isNaN(ae)||isNaN(pe)||isNaN(Ne)||!Ci(Le))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ze=4/3*(Math.SQRT2-1);return pe=Math.min(pe,.5*ee),Ne=Math.min(Ne,.5*ae),this.lines([[ee-2*pe,0],[pe*Ze,0,pe,Ne-Ne*Ze,pe,Ne],[0,ae-2*Ne],[0,Ne*Ze,-pe*Ze,Ne,-pe,Ne],[2*pe-ee,0],[-pe*Ze,0,-pe,-Ne*Ze,-pe,-Ne],[0,2*Ne-ae],[0,-Ne*Ze,pe*Ze,-Ne,pe,-Ne]],N+pe,V,[1,1],Le,!0),this},m.__private__.ellipse=m.ellipse=function(N,V,ee,ae,pe){if(isNaN(N)||isNaN(V)||isNaN(ee)||isNaN(ae)||!Ci(pe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ne=4/3*(Math.SQRT2-1)*ee,Le=4/3*(Math.SQRT2-1)*ae;return Pl(N+ee,V),Ms(N+ee,V-Le,N+Ne,V-ae,N,V-ae),Ms(N-Ne,V-ae,N-ee,V-Le,N-ee,V),Ms(N-ee,V+Le,N-Ne,V+ae,N,V+ae),Ms(N+Ne,V+ae,N+ee,V+Le,N+ee,V),fu(pe),this},m.__private__.circle=m.circle=function(N,V,ee,ae){if(isNaN(N)||isNaN(V)||isNaN(ee)||!Ci(ae))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(N,V,ee,ee,ae)},m.setFont=function(N,V,ee){return ee&&(V=$(V,ee)),Ft=tr(N,V,{disableWarning:!1}),this};var Cd=m.__private__.getFont=m.getFont=function(){return er[tr.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var N,V,ee={};for(N in cr)if(cr.hasOwnProperty(N))for(V in ee[N]=[],cr[N])cr[N].hasOwnProperty(V)&&ee[N].push(V);return ee},m.addFont=function(N,V,ee,ae,pe){var Ne=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ne.indexOf(arguments[3])!==-1?pe=arguments[3]:arguments[3]&&Ne.indexOf(arguments[3])==-1&&(ee=$(ee,ae)),pe=pe||"Identity-H",du.call(this,N,V,ee,pe)};var sa,ur=t.lineWidth||.200025,Rl=m.__private__.getLineWidth=m.getLineWidth=function(){return ur},Pd=m.__private__.setLineWidth=m.setLineWidth=function(N){return ur=N,re(k(R(N))+" w"),this};m.__private__.setLineDash=bt.API.setLineDash=bt.API.setLineDashPattern=function(N,V){if(N=N||[],V=V||0,isNaN(V)||!Array.isArray(N))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return N=N.map(function(ee){return k(R(ee))}).join(" "),V=k(R(V)),re("["+N+"] "+V+" d"),this};var mu=m.__private__.getLineHeight=m.getLineHeight=function(){return ze*sa};m.__private__.getLineHeight=m.getLineHeight=function(){return ze*sa};var pu=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(N){return typeof(N=N||1.15)=="number"&&(sa=N),this},gu=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return sa};pu(t.lineHeight);var ys=m.__private__.getHorizontalCoordinate=function(N){return R(N)},Pi=m.__private__.getVerticalCoordinate=function(N){return x===b.ADVANCED?N:St[J].mediaBox.topRightY-St[J].mediaBox.bottomLeftY-R(N)},ai=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(N){return k(ys(N))},ia=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(N){return k(Pi(N))},oi=t.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return Yn(oi)},m.__private__.setStrokeColor=m.setDrawColor=function(N,V,ee,ae){return oi=Rs({ch1:N,ch2:V,ch3:ee,ch4:ae,pdfColorType:"draw",precision:2}),re(oi),this};var aa=t.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return Yn(aa)},m.__private__.setFillColor=m.setFillColor=function(N,V,ee,ae){return aa=Rs({ch1:N,ch2:V,ch3:ee,ch4:ae,pdfColorType:"fill",precision:2}),re(aa),this};var Va=t.textColor||"0 g",yu=m.__private__.getTextColor=m.getTextColor=function(){return Yn(Va)};m.__private__.setTextColor=m.setTextColor=function(N,V,ee,ae){return Va=Rs({ch1:N,ch2:V,ch3:ee,ch4:ae,pdfColorType:"text",precision:3}),this};var oa=t.charSpace,Rd=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(oa||0)};m.__private__.setCharSpace=m.setCharSpace=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return oa=N,this};var Ba=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(N){var V=m.CapJoinStyles[N];if(V===void 0)throw new Error("Line cap style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ba=V,re(V+" J"),this};var xu=0;m.__private__.setLineJoin=m.setLineJoin=function(N){var V=m.CapJoinStyles[N];if(V===void 0)throw new Error("Line join style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return xu=V,re(V+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(N){if(N=N||0,isNaN(N))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return re(k(R(N))+" M"),this},m.GState=Wy,m.setGState=function(N){(N=typeof N=="string"?Sr[Ps[N]]:vu(null,N)).equals(ms)||(re("/"+N.id+" gs"),ms=N)};var vu=function(N,V){if(!N||!Ps[N]){var ee=!1;for(var ae in Sr)if(Sr.hasOwnProperty(ae)&&Sr[ae].equals(V)){ee=!0;break}if(ee)V=Sr[ae];else{var pe="GS"+(Object.keys(Sr).length+1).toString(10);Sr[pe]=V,V.id=pe}return N&&(Ps[N]=V.id),zt.publish("addGState",V),V}};m.addGState=function(N,V){return vu(N,V),this},m.saveGraphicsState=function(){return re("q"),Ti.push({key:Ft,size:ze,color:Va}),this},m.restoreGraphicsState=function(){re("Q");var N=Ti.pop();return Ft=N.key,ze=N.size,Va=N.color,ms=null,this},m.setCurrentTransformationMatrix=function(N){return re(N.toString()+" cm"),this},m.comment=function(N){return re("#"+N),this};var Ri=function(N,V){var ee=N||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ee},set:function(Ne){isNaN(Ne)||(ee=parseFloat(Ne))}});var ae=V||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ae},set:function(Ne){isNaN(Ne)||(ae=parseFloat(Ne))}});var pe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return pe},set:function(Ne){pe=Ne.toString()}}),this},Dl=function(N,V,ee,ae){Ri.call(this,N,V),this.type="rect";var pe=ee||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return pe},set:function(Le){isNaN(Le)||(pe=parseFloat(Le))}});var Ne=ae||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ne},set:function(Le){isNaN(Le)||(Ne=parseFloat(Le))}}),this},Ll=function(){this.page=vr,this.currentPage=J,this.pages=De.slice(0),this.pagesContext=St.slice(0),this.x=Sn,this.y=Ut,this.matrix=Cs,this.width=Di(J),this.height=la(J),this.outputDestination=$e,this.id="",this.objectNumber=-1};Ll.prototype.restore=function(){vr=this.page,J=this.currentPage,St=this.pagesContext,De=this.pages,Sn=this.x,Ut=this.y,Cs=this.matrix,Ml(J,this.width),li(J,this.height),$e=this.outputDestination};var Ol=function(N,V,ee,ae,pe){Kn.push(new Ll),vr=J=0,De=[],Sn=N,Ut=V,Cs=pe,si([ee,ae])},bu=function(N){if(Zs[N])Kn.pop().restore();else{var V=new Ll,ee="Xo"+(Object.keys($r).length+1).toString(10);V.id=ee,Zs[N]=ee,$r[ee]=V,zt.publish("addFormObject",V),Kn.pop().restore()}};for(var ko in m.beginFormObject=function(N,V,ee,ae,pe){return Ol(N,V,ee,ae,pe),this},m.endFormObject=function(N){return bu(N),this},m.doFormObject=function(N,V){var ee=$r[Zs[N]];return re("q"),re(V.toString()+" cm"),re("/"+ee.id+" Do"),re("Q"),this},m.getFormObject=function(N){var V=$r[Zs[N]];return{x:V.x,y:V.y,width:V.width,height:V.height,matrix:V.matrix}},m.save=function(N,V){return N=N||"generated.pdf",(V=V||{}).returnPromise=V.returnPromise||!1,V.returnPromise===!1?(Lu(kl(na()),N),typeof Lu.unload=="function"&&wt.setTimeout&&setTimeout(Lu.unload,911),this):new Promise(function(ee,ae){try{var pe=Lu(kl(na()),N);typeof Lu.unload=="function"&&wt.setTimeout&&setTimeout(Lu.unload,911),ee(pe)}catch(Ne){ae(Ne.message)}})},bt.API)bt.API.hasOwnProperty(ko)&&(ko==="events"&&bt.API.events.length?function(N,V){var ee,ae,pe;for(pe=V.length-1;pe!==-1;pe--)ee=V[pe][0],ae=V[pe][1],N.subscribe.apply(N,[ee].concat(typeof ae=="function"?[ae]:ae))}(zt,bt.API.events):m[ko]=bt.API[ko]);var Di=m.getPageWidth=function(N){return(St[N=N||J].mediaBox.topRightX-St[N].mediaBox.bottomLeftX)/Xe},Ml=m.setPageWidth=function(N,V){St[N].mediaBox.topRightX=V*Xe+St[N].mediaBox.bottomLeftX},la=m.getPageHeight=function(N){return(St[N=N||J].mediaBox.topRightY-St[N].mediaBox.bottomLeftY)/Xe},li=m.setPageHeight=function(N,V){St[N].mediaBox.topRightY=V*Xe+St[N].mediaBox.bottomLeftY};return m.internal={pdfEscape:Qn,getStyle:Td,getFont:Cd,getFontSize:Ke,getCharSpace:Rd,getTextColor:yu,getLineHeight:mu,getLineHeightFactor:gu,getLineWidth:Rl,write:kt,getHorizontalCoordinate:ys,getVerticalCoordinate:Pi,getCoordinateString:ai,getVerticalCoordinateString:ia,collections:{},newObject:Ar,newAdditionalObject:ti,newObjectDeferred:Wr,newObjectDeferredBegin:ps,getFilters:Ds,putStream:Rn,events:zt,scaleFactor:Xe,pageSize:{getWidth:function(){return Di(J)},setWidth:function(N){Ml(J,N)},getHeight:function(){return la(J)},setHeight:function(N){li(J,N)}},encryptionOptions:d,encryption:Hr,getEncryptor:Ii,output:Tl,getNumberOfPages:Sd,pages:De,out:re,f2:O,f3:S,getPageInfo:hu,getPageInfoByObjId:At,getCurrentPageInfo:kd,getPDFVersion:_,Point:Ri,Rectangle:Dl,Matrix:ht,hasHotfix:Ed},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return Di(J)},set:function(N){Ml(J,N)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return la(J)},set:function(N){li(J,N)},enumerable:!0,configurable:!0}),Ef.call(m,Fe),Ft="F1",Os(s,r),zt.publish("initialized"),m}rh.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},rh.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},rh.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},rh.prototype.processOwnerPassword=function(t,e){return Mb(Ob(e).substr(0,5),t)},rh.prototype.encryptor=function(t,e){var r=Ob(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return Mb(r,n)}},Wy.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||or(t)!==or(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},bt.API={events:[]},bt.version="3.0.1";var Kr=bt.API,PN=1,wd=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Qd=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Dt=function(t){return t.toFixed(2)},tc=function(t){return t.toFixed(5)};Kr.__acroform__={};var Xs=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},z3=function(t){return t*PN},qa=function(t){var e=new FP,r=nt.internal.getHeight(t)||0,n=nt.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Dt(n)),Number(Dt(r))],e},IX=Kr.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},CX=Kr.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},PX=Kr.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},sn=Kr.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return PX(t,e-1)},an=Kr.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return IX(t,e-1)},on=Kr.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return CX(t,e-1)},RX=Kr.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,s=t[0],i=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=n(i+l)||0,c.upperRight_X=r(s+o)||0,c.upperRight_Y=n(i)||0,[Number(Dt(c.lowerLeft_X)),Number(Dt(c.lowerLeft_Y)),Number(Dt(c.upperRight_X)),Number(Dt(c.upperRight_Y))]},DX=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=Fb(t,r),s=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+s+" "+Dt(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var i=qa(t);return i.scope=t.scope,i.stream=e.join(`
`),i}},Fb=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},s=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");s=t.multiline?s.map(function(S){return S.split(`
`)}):s.map(function(S){return[S]});var i=r,o=nt.internal.getHeight(t)||0;o=o<0?-o:o;var l=nt.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(S,R,C){if(S+1<s.length){var G=R+" "+s[S+1][0];return t0(G,t,C).width<=l-4}return!1};i++;e:for(;i>0;){e="",i--;var u,d,h=t0("3",t,i).height,g=t.multiline?o-i:(o-h)/2,m=g+=2,w=0,_=0,T=0;if(i<=0){e=`(...) Tj
`,e+="% Width of Text: "+t0(e,t,i=12).width+", FieldWidth:"+l+`
`;break}for(var v="",b=0,x=0;x<s.length;x++)if(s.hasOwnProperty(x)){var P=!1;if(s[x].length!==1&&T!==s[x].length-1){if((h+2)*(b+2)+2>o)continue e;v+=s[x][T],P=!0,_=x,x--}else{v=(v+=s[x][T]+" ").substr(v.length-1)==" "?v.substr(0,v.length-1):v;var F=parseInt(x),$=c(F,v,i),k=x>=s.length-1;if($&&!k){v+=" ",T=0;continue}if($||k){if(k)_=F;else if(t.multiline&&(h+2)*(b+2)+2>o)continue e}else{if(!t.multiline||(h+2)*(b+2)+2>o)continue e;_=F}}for(var A="",I=w;I<=_;I++){var O=s[I];if(t.multiline){if(I===_){A+=O[T]+" ",T=(T+1)%O.length;continue}if(I===w){A+=O[O.length-1]+" ";continue}}A+=O[0]+" "}switch(A=A.substr(A.length-1)==" "?A.substr(0,A.length-1):A,d=t0(A,t,i).width,t.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;case"left":default:u=2}e+=Dt(u)+" "+Dt(m)+` Td
`,e+="("+wd(A)+`) Tj
`,e+=-Dt(u)+` 0 Td
`,m=-(i+2),d=0,w=P?_:_+1,b++,v=""}break}return n.text=e,n.fontSize=i,n},t0=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),s=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},LX={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},OX=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},MX=function(t,e){for(var r in t)if(t.hasOwnProperty(r)){var n=r,s=t[r];e.internal.newObjectDeferredBegin(s.objId,!0),or(s)==="object"&&typeof s.putStream=="function"&&s.putStream(),delete t[n]}},FX=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Pa.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(LX)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");PN=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new VP,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var i=n[s];i.objId=void 0,i.hasAnnotation&&OX(i,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,s){var i=!n;for(var o in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=RX(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=nt.createDefaultAppearanceStream(l),or(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=DX(l);c.push({key:"AP",value:"<</N "+d+">>"}),s.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var h="";for(var g in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(g)){var m=l.appearanceStreamContent[g];if(h+="/"+g+" ",h+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var o in m)if(m.hasOwnProperty(o)){var w=m[o];typeof w=="function"&&(w=w.call(s,l)),h+="/"+o+" "+w+" ",s.internal.acroformPlugin.xForms.indexOf(w)>=0||s.internal.acroformPlugin.xForms.push(w)}}else typeof(w=m)=="function"&&(w=w.call(s,l)),h+="/"+o+" "+w,s.internal.acroformPlugin.xForms.indexOf(w)>=0||s.internal.acroformPlugin.xForms.push(w);h+=">>"}c.push({key:"AP",value:`<<
`+h+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}i&&MX(s.internal.acroformPlugin.xForms,s)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},MP=Kr.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(o){return o};if(Array.isArray(t)){for(var s="[",i=0;i<t.length;i++)switch(i!==0&&(s+=" "),or(t[i])){case"boolean":case"number":case"object":s+=t[i].toString();break;case"string":t[i].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),s+="("+wd(n(t[i].toString()))+")"):s+=t[i].toString()}return s+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Rv=function(t,e,r){var n=function(s){return s};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),t="("+wd(n(t))+")"},ro=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ro.prototype.toString=function(){return this.objId+" 0 R"},ro.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},ro.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],s=this[n];s&&(Array.isArray(s)?t.push({key:n,value:MP(s,this.objId,this.scope)}):s instanceof ro?(s.scope=this.scope,t.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&t.push({key:n,value:s}))}return t};var FP=function(){ro.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Xs(FP,ro);var VP=function(){ro.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+wd(r(t))+")"}},set:function(r){t=r}})};Xs(VP,ro);var Pa=function t(){ro.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute F supplied.');e=v}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!sn(e,3)},set:function(v){v?this.F=an(e,3):this.F=on(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute Ff supplied.');r=v}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(v){n=v!==void 0?v:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(v){n[0]=v}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(v){n[1]=v}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(v){n[2]=v}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(v){n[3]=v}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(v){switch(v){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=v;break;default:throw new Error('Invalid value "'+v+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Hy)return;i="FieldObject"+t.FieldNum++}var v=function(b){return b};return this.scope&&(v=this.scope.internal.getEncryptor(this.objId)),"("+wd(v(i))+")"},set:function(v){i=v.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(v){i=v}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(v){o=v}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(v){l=v}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(v){c=v}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/PN:u},set:function(v){u=v}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(v){d=v}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof Hy||this instanceof Xu))return Rv(h,this.objId,this.scope)},set:function(v){v=v.toString(),h=v}});var g=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof In?g:Rv(g,this.objId,this.scope)},set:function(v){v=v.toString(),g=this instanceof In?v:v.substr(0,1)==="("?Qd(v.substr(1,v.length-2)):Qd(v)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof In?Qd(g.substr(1,g.length-1)):g},set:function(v){v=v.toString(),g=this instanceof In?"/"+v:v}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(v){this.V=v}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof In?m:Rv(m,this.objId,this.scope)},set:function(v){v=v.toString(),m=this instanceof In?v:v.substr(0,1)==="("?Qd(v.substr(1,v.length-2)):Qd(v)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof In?Qd(m.substr(1,m.length-1)):m},set:function(v){v=v.toString(),m=this instanceof In?"/"+v:v}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var w,_=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return _},set:function(v){v=!!v,_=v}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(w)return w},set:function(v){w=v}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,1)},set:function(v){v?this.Ff=an(this.Ff,1):this.Ff=on(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,2)},set:function(v){v?this.Ff=an(this.Ff,2):this.Ff=on(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,3)},set:function(v){v?this.Ff=an(this.Ff,3):this.Ff=on(this.Ff,3)}});var T=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(T!==null)return T},set:function(v){if([0,1,2].indexOf(v)===-1)throw new Error('Invalid value "'+v+'" for attribute Q supplied.');T=v}}),Object.defineProperty(this,"textAlign",{get:function(){var v;switch(T){case 0:default:v="left";break;case 1:v="center";break;case 2:v="right"}return v},configurable:!0,enumerable:!0,set:function(v){switch(v){case"right":case 2:T=2;break;case"center":case 1:T=1;break;case"left":case 0:default:T=0}}})};Xs(Pa,ro);var Mh=function(){Pa.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return MP(e,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=function(i,o,l){l||(l=1);for(var c,u=[];c=o.exec(i);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),e=s}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,18)},set:function(r){r?this.Ff=an(this.Ff,18):this.Ff=on(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=an(this.Ff,19):this.Ff=on(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,20)},set:function(r){r?(this.Ff=an(this.Ff,20),e.sort()):this.Ff=on(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,22)},set:function(r){r?this.Ff=an(this.Ff,22):this.Ff=on(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,23)},set:function(r){r?this.Ff=an(this.Ff,23):this.Ff=on(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,27)},set:function(r){r?this.Ff=an(this.Ff,27):this.Ff=on(this.Ff,27)}}),this.hasAppearanceStream=!1};Xs(Mh,Pa);var Fh=function(){Mh.call(this),this.fontName="helvetica",this.combo=!1};Xs(Fh,Mh);var Vh=function(){Fh.call(this),this.combo=!0};Xs(Vh,Fh);var C0=function(){Vh.call(this),this.edit=!0};Xs(C0,Vh);var In=function(){Pa.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,15)},set:function(r){r?this.Ff=an(this.Ff,15):this.Ff=on(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,16)},set:function(r){r?this.Ff=an(this.Ff,16):this.Ff=on(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,17)},set:function(r){r?this.Ff=an(this.Ff,17):this.Ff=on(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,26)},set:function(r){r?this.Ff=an(this.Ff,26):this.Ff=on(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,s=[];for(n in s.push("<<"),e)s.push("/"+n+" ("+wd(r(e[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){or(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Xs(In,Pa);var P0=function(){In.call(this),this.pushButton=!0};Xs(P0,In);var Bh=function(){In.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Xs(Bh,In);var Hy=function(){var t,e;Pa.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(s){e=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),n)o.push("/"+i+" ("+wd(s(n[i]))+")");return o.push(">>"),o.join(`
`)},set:function(s){or(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=nt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Xs(Hy,Pa),Bh.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},Bh.prototype.createOption=function(t){var e=new Hy;return e.Parent=this,e.optionName=t,this.Kids.push(e),VX.call(this.scope,e),e};var R0=function(){In.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=nt.CheckBox.createAppearanceStream()};Xs(R0,In);var Xu=function(){Pa.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,13)},set:function(e){e?this.Ff=an(this.Ff,13):this.Ff=on(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,21)},set:function(e){e?this.Ff=an(this.Ff,21):this.Ff=on(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,23)},set:function(e){e?this.Ff=an(this.Ff,23):this.Ff=on(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,24)},set:function(e){e?this.Ff=an(this.Ff,24):this.Ff=on(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,25)},set:function(e){e?this.Ff=an(this.Ff,25):this.Ff=on(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,26)},set:function(e){e?this.Ff=an(this.Ff,26):this.Ff=on(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Xs(Xu,Pa);var D0=function(){Xu.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,14)},set:function(t){t?this.Ff=an(this.Ff,14):this.Ff=on(this.Ff,14)}}),this.password=!0};Xs(D0,Xu);var nt={CheckBox:{createAppearanceStream:function(){return{N:{On:nt.CheckBox.YesNormal},D:{On:nt.CheckBox.YesPushDown,Off:nt.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=qa(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,s=t.scope.__private__.encodeColorString(t.color),i=Fb(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Dt(nt.internal.getWidth(t))+" "+Dt(nt.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Dt(i.fontSize)+" Tf "+s),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=qa(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),s=[],i=nt.internal.getHeight(t),o=nt.internal.getWidth(t),l=Fb(t,t.caption);return s.push("1 g"),s.push("0 0 "+Dt(o)+" "+Dt(i)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+Dt(o-1)+" "+Dt(i-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+Dt(l.fontSize)+" Tf "+n),s.push(l.text),s.push("ET"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(t){var e=qa(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Dt(nt.internal.getWidth(t))+" "+Dt(nt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:nt.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=nt.RadioButton.Circle.YesNormal,e.D[t]=nt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=qa(t);e.scope=t.scope;var r=[],n=nt.internal.getWidth(t)<=nt.internal.getHeight(t)?nt.internal.getWidth(t)/4:nt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=nt.internal.Bezier_C,i=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+tc(nt.internal.getWidth(t)/2)+" "+tc(nt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=qa(t);e.scope=t.scope;var r=[],n=nt.internal.getWidth(t)<=nt.internal.getHeight(t)?nt.internal.getWidth(t)/4:nt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),i=Number((s*nt.internal.Bezier_C).toFixed(5)),o=Number((n*nt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+tc(nt.internal.getWidth(t)/2)+" "+tc(nt.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+tc(nt.internal.getWidth(t)/2)+" "+tc(nt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=qa(t);e.scope=t.scope;var r=[],n=nt.internal.getWidth(t)<=nt.internal.getHeight(t)?nt.internal.getWidth(t)/4:nt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),i=Number((s*nt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+tc(nt.internal.getWidth(t)/2)+" "+tc(nt.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:nt.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=nt.RadioButton.Cross.YesNormal,e.D[t]=nt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=qa(t);e.scope=t.scope;var r=[],n=nt.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Dt(nt.internal.getWidth(t)-2)+" "+Dt(nt.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Dt(n.x1.x)+" "+Dt(n.x1.y)+" m"),r.push(Dt(n.x2.x)+" "+Dt(n.x2.y)+" l"),r.push(Dt(n.x4.x)+" "+Dt(n.x4.y)+" m"),r.push(Dt(n.x3.x)+" "+Dt(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=qa(t);e.scope=t.scope;var r=nt.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+Dt(nt.internal.getWidth(t))+" "+Dt(nt.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Dt(nt.internal.getWidth(t)-2)+" "+Dt(nt.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(Dt(r.x1.x)+" "+Dt(r.x1.y)+" m"),n.push(Dt(r.x2.x)+" "+Dt(r.x2.y)+" l"),n.push(Dt(r.x4.x)+" "+Dt(r.x4.y)+" m"),n.push(Dt(r.x3.x)+" "+Dt(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=qa(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Dt(nt.internal.getWidth(t))+" "+Dt(nt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};nt.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=nt.internal.getWidth(t),r=nt.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},nt.internal.getWidth=function(t){var e=0;return or(t)==="object"&&(e=z3(t.Rect[2])),e},nt.internal.getHeight=function(t){var e=0;return or(t)==="object"&&(e=z3(t.Rect[3])),e};var VX=Kr.addField=function(t){if(FX(this,t),!(t instanceof Pa))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Kr.AcroFormChoiceField=Mh,Kr.AcroFormListBox=Fh,Kr.AcroFormComboBox=Vh,Kr.AcroFormEditBox=C0,Kr.AcroFormButton=In,Kr.AcroFormPushButton=P0,Kr.AcroFormRadioButton=Bh,Kr.AcroFormCheckBox=R0,Kr.AcroFormTextField=Xu,Kr.AcroFormPasswordField=D0,Kr.AcroFormAppearance=nt,Kr.AcroForm={ChoiceField:Mh,ListBox:Fh,ComboBox:Vh,EditBox:C0,Button:In,PushButton:P0,RadioButton:Bh,CheckBox:R0,TextField:Xu,PasswordField:D0,Appearance:nt},bt.AcroForm={ChoiceField:Mh,ListBox:Fh,ComboBox:Vh,EditBox:C0,Button:In,PushButton:P0,RadioButton:Bh,CheckBox:R0,TextField:Xu,PasswordField:D0,Appearance:nt};function BP(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){t.__addimage__={};var e="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(S,R){var C,G,de,ne,X,Y=e;if((R=R||e)==="RGBA"||S.data!==void 0&&S.data instanceof Uint8ClampedArray&&"height"in S&&"width"in S)return"RGBA";if($(S))for(X in r)for(de=r[X],C=0;C<de.length;C+=1){for(ne=!0,G=0;G<de[C].length;G+=1)if(de[C][G]!==void 0&&de[C][G]!==S[G]){ne=!1;break}if(ne===!0){Y=X;break}}else for(X in r)for(de=r[X],C=0;C<de.length;C+=1){for(ne=!0,G=0;G<de[C].length;G+=1)if(de[C][G]!==void 0&&de[C][G]!==S.charCodeAt(G)){ne=!1;break}if(ne===!0){Y=X;break}}return Y===e&&R!==e&&(Y=R),Y},s=function S(R){for(var C=this.internal.write,G=this.internal.putStream,de=(0,this.internal.getFilters)();de.indexOf("FlateEncode")!==-1;)de.splice(de.indexOf("FlateEncode"),1);R.objectId=this.internal.newObject();var ne=[];if(ne.push({key:"Type",value:"/XObject"}),ne.push({key:"Subtype",value:"/Image"}),ne.push({key:"Width",value:R.width}),ne.push({key:"Height",value:R.height}),R.colorSpace===T.INDEXED?ne.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(R.palette.length/3-1)+" "+("sMask"in R&&R.sMask!==void 0?R.objectId+2:R.objectId+1)+" 0 R]"}):(ne.push({key:"ColorSpace",value:"/"+R.colorSpace}),R.colorSpace===T.DEVICE_CMYK&&ne.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ne.push({key:"BitsPerComponent",value:R.bitsPerComponent}),"decodeParameters"in R&&R.decodeParameters!==void 0&&ne.push({key:"DecodeParms",value:"<<"+R.decodeParameters+">>"}),"transparency"in R&&Array.isArray(R.transparency)){for(var X="",Y=0,Q=R.transparency.length;Y<Q;Y++)X+=R.transparency[Y]+" "+R.transparency[Y]+" ";ne.push({key:"Mask",value:"["+X+"]"})}R.sMask!==void 0&&ne.push({key:"SMask",value:R.objectId+1+" 0 R"});var se=R.filter!==void 0?["/"+R.filter]:void 0;if(G({data:R.data,additionalKeyValues:ne,alreadyAppliedFilters:se,objectId:R.objectId}),C("endobj"),"sMask"in R&&R.sMask!==void 0){var Se="/Predictor "+R.predictor+" /Colors 1 /BitsPerComponent "+R.bitsPerComponent+" /Columns "+R.width,U={width:R.width,height:R.height,colorSpace:"DeviceGray",bitsPerComponent:R.bitsPerComponent,decodeParameters:Se,data:R.sMask};"filter"in R&&(U.filter=R.filter),S.call(this,U)}if(R.colorSpace===T.INDEXED){var J=this.internal.newObject();G({data:A(new Uint8Array(R.palette)),objectId:J}),C("endobj")}},i=function(){var S=this.internal.collections.addImage_images;for(var R in S)s.call(this,S[R])},o=function(){var S,R=this.internal.collections.addImage_images,C=this.internal.write;for(var G in R)C("/I"+(S=R[G]).index,S.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var S=this.internal.collections.addImage_images;return l.call(this),S},u=function(){return Object.keys(this.internal.collections.addImage_images).length},d=function(S){return typeof t["process"+S.toUpperCase()]=="function"},h=function(S){return or(S)==="object"&&S.nodeType===1},g=function(S,R){if(S.nodeName==="IMG"&&S.hasAttribute("src")){var C=""+S.getAttribute("src");if(C.indexOf("data:image/")===0)return Fm(unescape(C).split("base64,").pop());var G=t.loadFile(C,!0);if(G!==void 0)return G}if(S.nodeName==="CANVAS"){if(S.width===0||S.height===0)throw new Error("Given canvas must have data. Canvas width: "+S.width+", height: "+S.height);var de;switch(R){case"PNG":de="image/png";break;case"WEBP":de="image/webp";break;case"JPEG":case"JPG":default:de="image/jpeg"}return Fm(S.toDataURL(de,1).split("base64,").pop())}},m=function(S){var R=this.internal.collections.addImage_images;if(R){for(var C in R)if(S===R[C].alias)return R[C]}},w=function(S,R,C){return S||R||(S=-96,R=-96),S<0&&(S=-1*C.width*72/S/this.internal.scaleFactor),R<0&&(R=-1*C.height*72/R/this.internal.scaleFactor),S===0&&(S=R*C.width/C.height),R===0&&(R=S*C.height/C.width),[S,R]},_=function(S,R,C,G,de,ne){var X=w.call(this,C,G,de),Y=this.internal.getCoordinateString,Q=this.internal.getVerticalCoordinateString,se=c.call(this);if(C=X[0],G=X[1],se[de.index]=de,ne){ne*=Math.PI/180;var Se=Math.cos(ne),U=Math.sin(ne),J=function(ie){return ie.toFixed(4)},te=[J(Se),J(U),J(-1*U),J(Se),0,0,"cm"]}this.internal.write("q"),ne?(this.internal.write([1,"0","0",1,Y(S),Q(R+G),"cm"].join(" ")),this.internal.write(te.join(" ")),this.internal.write([Y(C),"0","0",Y(G),"0","0","cm"].join(" "))):this.internal.write([Y(C),"0","0",Y(G),Y(S),Q(R+G),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+de.index+" Do"),this.internal.write("Q")},T=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var v=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=t.__addimage__.sHashCode=function(S){var R,C,G=0;if(typeof S=="string")for(C=S.length,R=0;R<C;R++)G=(G<<5)-G+S.charCodeAt(R),G|=0;else if($(S))for(C=S.byteLength/2,R=0;R<C;R++)G=(G<<5)-G+S[R],G|=0;return G},x=t.__addimage__.validateStringAsBase64=function(S){(S=S||"").toString().trim();var R=!0;return S.length===0&&(R=!1),S.length%4!=0&&(R=!1),/^[A-Za-z0-9+/]+$/.test(S.substr(0,S.length-2))===!1&&(R=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(S.substr(-2))===!1&&(R=!1),R},P=t.__addimage__.extractImageFromDataUrl=function(S){if(S==null||!(S=S.trim()).startsWith("data:"))return null;var R=S.indexOf(",");return R<0?null:S.substring(0,R).trim().endsWith("base64")?S.substring(R+1):null},F=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(S){return F()&&S instanceof ArrayBuffer};var $=t.__addimage__.isArrayBufferView=function(S){return F()&&typeof Uint32Array<"u"&&(S instanceof Int8Array||S instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&S instanceof Uint8ClampedArray||S instanceof Int16Array||S instanceof Uint16Array||S instanceof Int32Array||S instanceof Uint32Array||S instanceof Float32Array||S instanceof Float64Array)},k=t.__addimage__.binaryStringToUint8Array=function(S){for(var R=S.length,C=new Uint8Array(R),G=0;G<R;G++)C[G]=S.charCodeAt(G);return C},A=t.__addimage__.arrayBufferToBinaryString=function(S){for(var R="",C=$(S)?S:new Uint8Array(S),G=0;G<C.length;G+=8192)R+=String.fromCharCode.apply(null,C.subarray(G,G+8192));return R};t.addImage=function(){var S,R,C,G,de,ne,X,Y,Q;if(typeof arguments[1]=="number"?(R=e,C=arguments[1],G=arguments[2],de=arguments[3],ne=arguments[4],X=arguments[5],Y=arguments[6],Q=arguments[7]):(R=arguments[1],C=arguments[2],G=arguments[3],de=arguments[4],ne=arguments[5],X=arguments[6],Y=arguments[7],Q=arguments[8]),or(S=arguments[0])==="object"&&!h(S)&&"imageData"in S){var se=S;S=se.imageData,R=se.format||R||e,C=se.x||C||0,G=se.y||G||0,de=se.w||se.width||de,ne=se.h||se.height||ne,X=se.alias||X,Y=se.compression||Y,Q=se.rotation||se.angle||Q}var Se=this.internal.getFilters();if(Y===void 0&&Se.indexOf("FlateEncode")!==-1&&(Y="SLOW"),isNaN(C)||isNaN(G))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var U=I.call(this,S,R,X,Y);return _.call(this,C,G,de,ne,U,Q),this};var I=function(S,R,C,G){var de,ne,X;if(typeof S=="string"&&n(S)===e){S=unescape(S);var Y=O(S,!1);(Y!==""||(Y=t.loadFile(S,!0))!==void 0)&&(S=Y)}if(h(S)&&(S=g(S,R)),R=n(S,R),!d(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(((X=C)==null||X.length===0)&&(C=function(Q){return typeof Q=="string"||$(Q)?b(Q):$(Q.data)?b(Q.data):null}(S)),(de=m.call(this,C))||(F()&&(S instanceof Uint8Array||R==="RGBA"||(ne=S,S=k(S))),de=this["process"+R.toUpperCase()](S,u.call(this),C,function(Q){return Q&&typeof Q=="string"&&(Q=Q.toUpperCase()),Q in t.image_compression?Q:v.NONE}(G),ne)),!de)throw new Error("An unknown error occurred whilst processing the image.");return de},O=t.__addimage__.convertBase64ToBinaryString=function(S,R){R=typeof R!="boolean"||R;var C,G="";if(typeof S=="string"){var de;C=(de=P(S))!==null&&de!==void 0?de:S;try{G=Fm(C)}catch(ne){if(R)throw x(C)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ne.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return G};t.getImageProperties=function(S){var R,C,G="";if(h(S)&&(S=g(S)),typeof S=="string"&&n(S)===e&&((G=O(S,!1))===""&&(G=t.loadFile(S)||""),S=G),C=n(S),!d(C))throw new Error("addImage does not support files of type '"+C+"', please ensure that a plugin for '"+C+"' support is added.");if(!F()||S instanceof Uint8Array||(S=k(S)),!(R=this["process"+C.toUpperCase()](S)))throw new Error("An unknown error occurred whilst processing the image");return R.fileType=C,R}})(bt.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};bt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,s,i,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,h=0;h<u.length&&!d;h++)switch((n=u[h]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var g=0;g<u.length;g++){n=u[g];var m=this.internal.pdfEscape,w=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var _=this.internal.newAdditionalObject(),T=this.internal.newAdditionalObject(),v=this.internal.getEncryptor(_.objId),b=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+m(v(n.contents))+")",i+=" /Popup "+T.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+m(v(b))+") >>",_.content=i;var x=_.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+x,n.open&&(i+=" /Open true"),i+=" >>",T.content=i,this.internal.write(_.objId,"0 R",T.objId,"0 R");break;case"freetext":s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var P=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+m(w(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+P+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var F=this.annotations._nameMap[n.options.name];n.options.pageNumber=F.page,n.options.top=F.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+m(w(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var $=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+$+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,s,i,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+s),h:u(n+i)},options:o,type:"link"})},t.textWithLink=function(r,n,s,i){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var d=this.splitTextToSize(r,l).length;o=Math.ceil(u*d)}else l=c,o=u;return this.text(r,n,s,i),s+=.2*u,i.align==="center"&&(n-=c/2),i.align==="right"&&(n-=c),this.link(n,s-u,l,o,i),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(bt.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];t.__arabicParser__={};var i=t.__arabicParser__.isInArabicSubstitutionA=function(_){return e[_.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(_){return typeof _=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(_)},l=t.__arabicParser__.isArabicEndLetter=function(_){return o(_)&&i(_)&&e[_.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(_){return o(_)&&s.indexOf(_.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(_){return o(_)&&i(_)&&e[_.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(_){return o(_)&&i(_)&&e[_.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(_){return o(_)&&i(_)&&e[_.charCodeAt(0)].length>=3};var d=t.__arabicParser__.arabicLetterHasMedialForm=function(_){return o(_)&&i(_)&&e[_.charCodeAt(0)].length==4},h=t.__arabicParser__.resolveLigatures=function(_){var T=0,v=r,b="",x=0;for(T=0;T<_.length;T+=1)v[_.charCodeAt(T)]!==void 0?(x++,typeof(v=v[_.charCodeAt(T)])=="number"&&(b+=String.fromCharCode(v),v=r,x=0),T===_.length-1&&(v=r,b+=_.charAt(T-(x-1)),T-=x-1,x=0)):(v=r,b+=_.charAt(T-x),T-=x,x=0);return b};t.__arabicParser__.isArabicDiacritic=function(_){return _!==void 0&&n[_.charCodeAt(0)]!==void 0};var g=t.__arabicParser__.getCorrectForm=function(_,T,v){return o(_)?i(_)===!1?-1:!u(_)||!o(T)&&!o(v)||!o(v)&&l(T)||l(_)&&!o(T)||l(_)&&c(T)||l(_)&&l(T)?0:d(_)&&o(T)&&!l(T)&&o(v)&&u(v)?3:l(_)||!o(v)?1:2:-1},m=function(_){var T=0,v=0,b=0,x="",P="",F="",$=(_=_||"").split("\\s+"),k=[];for(T=0;T<$.length;T+=1){for(k.push(""),v=0;v<$[T].length;v+=1)x=$[T][v],P=$[T][v-1],F=$[T][v+1],o(x)?(b=g(x,P,F),k[T]+=b!==-1?String.fromCharCode(e[x.charCodeAt(0)][b]):x):k[T]+=x;k[T]=h(k[T])}return k.join(" ")},w=t.__arabicParser__.processArabic=t.processArabic=function(){var _,T=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,v=[];if(Array.isArray(T)){var b=0;for(v=[],b=0;b<T.length;b+=1)Array.isArray(T[b])?v.push([m(T[b][0]),T[b][1],T[b][2]]):v.push([m(T[b])]);_=v}else _=m(T);return typeof arguments[0]=="string"?_:(arguments[0].text=_,arguments[0])};t.events.push(["preProcessText",w])}(bt.API),bt.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(bt.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(_){c=_}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(_){u=_}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(_){d=_}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(_){h=_}});var g=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return g},set:function(_){g=_}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(_){m=_}});var w=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return w},set:function(_){w=_}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),h=u.font||this.getFont(),g=u.scaleFactor||this.internal.scaleFactor,m=0,w=0,_=0,T=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var v=u.maxWidth;v>0?typeof c=="string"?c=this.splitTextToSize(c,v):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(x,P){return x.concat(T.splitTextToSize(P,v))},[])):c=Array.isArray(c)?c:[c];for(var b=0;b<c.length;b++)m<(_=this.getStringUnitWidth(c[b],{font:h})*d)&&(m=_);return m!==0&&(w=c.length),{w:m/=g,h:Math.max((w*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/g,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,h=this.internal.__cell__.margins||e,g=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=h.top,m&&g&&(this.printHeaderRow(c.lineNumber,!0),c.y+=g[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,d,h,g){if(n.call(this),!d)throw new Error("No data for PDF table.");var m,w,_,T,v=[],b=[],x=[],P={},F={},$=[],k=[],A=(g=g||{}).autoSize||!1,I=g.printHeaders!==!1,O=g.css&&g.css["font-size"]!==void 0?16*g.css["font-size"]:g.fontSize||12,S=g.margins||Object.assign({width:this.getPageWidth()},e),R=typeof g.padding=="number"?g.padding:3,C=g.headerBackgroundColor||"#c8c8c8",G=g.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=I,this.internal.__cell__.margins=S,this.internal.__cell__.table_font_size=O,this.internal.__cell__.padding=R,this.internal.__cell__.headerBackgroundColor=C,this.internal.__cell__.headerTextColor=G,this.setFontSize(O),h==null)b=v=Object.keys(d[0]),x=v.map(function(){return"left"});else if(Array.isArray(h)&&or(h[0])==="object")for(v=h.map(function(se){return se.name}),b=h.map(function(se){return se.prompt||se.name||""}),x=h.map(function(se){return se.align||"left"}),m=0;m<h.length;m+=1)F[h[m].name]=h[m].width*(19.049976/25.4);else Array.isArray(h)&&typeof h[0]=="string"&&(b=v=h,x=v.map(function(){return"left"}));if(A||Array.isArray(h)&&typeof h[0]=="string")for(m=0;m<v.length;m+=1){for(P[T=v[m]]=d.map(function(se){return se[T]}),this.setFont(void 0,"bold"),$.push(this.getTextDimensions(b[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),w=P[T],this.setFont(void 0,"normal"),_=0;_<w.length;_+=1)$.push(this.getTextDimensions(w[_],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);F[T]=Math.max.apply(null,$)+R+R,$=[]}if(I){var de={};for(m=0;m<v.length;m+=1)de[v[m]]={},de[v[m]].text=b[m],de[v[m]].align=x[m];var ne=l.call(this,de,F);k=v.map(function(se){return new i(c,u,F[se],ne,de[se].text,void 0,de[se].align)}),this.setTableHeaderRow(k),this.printHeaderRow(1,!1)}var X=h.reduce(function(se,Se){return se[Se.name]=Se.align,se},{});for(m=0;m<d.length;m+=1){"rowStart"in g&&g.rowStart instanceof Function&&g.rowStart({row:m,data:d[m]},this);var Y=l.call(this,d[m],F);for(_=0;_<v.length;_+=1){var Q=d[m][v[_]];"cellStart"in g&&g.cellStart instanceof Function&&g.cellStart({row:m,col:_,data:Q},this),o.call(this,new i(c,u,F[v[_]],Y,Q,m+2,X[v[_]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,g=this.internal.scaleFactor;return Object.keys(c).map(function(m){var w=c[m];return this.splitTextToSize(w.hasOwnProperty("text")?w.text:w,u[m]-d-d)},this).map(function(m){return this.getLineHeightFactor()*m.length*h/g+d+d},this).reduce(function(m,w){return Math.max(m,w)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var g=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){d=this.internal.__cell__.tableHeaderRow[m].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,g.push(d)),d.lineNumber=c;var w=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(w)}g.length>0&&this.setTableHeaderRow(g),this.setFont(void 0,"normal"),r=!1}}(bt.API);var UP={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},zP=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Vb=BP(zP),qP=[100,200,300,400,500,600,700,800,900],BX=BP(qP);function Bb(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return UP[i=i||"normal"]?i:"normal"}(t.style),n=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(t.weight),s=function(i){return typeof Vb[i=i||"normal"]=="number"?i:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:s,src:t.src||[],ref:t.ref||{name:e,style:[s,r,n].join(" ")}}}function q3(t,e,r,n){var s;for(s=r;s>=0&&s<e.length;s+=n)if(t[e[s]])return t[e[s]];for(s=r;s>=0&&s<e.length;s-=n)if(t[e[s]])return t[e[s]]}var UX={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},$3={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function W3(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function zX(t,e,r){for(var n=(r=r||{}).defaultFontFamily||"times",s=Object.assign({},UX,r.genericFontFamilies||{}),i=null,o=null,l=0;l<e.length;++l)if(s[(i=Bb(e[l])).family]&&(i.family=s[i.family]),t.hasOwnProperty(i.family)){o=t[i.family];break}if(!(o=o||t[n]))throw new Error("Could not find a font-family for the rule '"+W3(i)+"' and default family '"+n+"'.");if(o=function(c,u){if(u[c])return u[c];var d=Vb[c],h=d<=Vb.normal?-1:1,g=q3(u,zP,d,h);if(!g)throw new Error("Could not find a matching font-stretch value for "+c);return g}(i.stretch,o),o=function(c,u){if(u[c])return u[c];for(var d=UP[c],h=0;h<d.length;++h)if(u[d[h]])return u[d[h]];throw new Error("Could not find a matching font-style for "+c)}(i.style,o),!(o=function(c,u){if(u[c])return u[c];if(c===400&&u[500])return u[500];if(c===500&&u[400])return u[400];var d=BX[c],h=q3(u,qP,d,c<400?-1:1);if(!h)throw new Error("Could not find a matching font-weight for value "+c);return h}(i.weight,o)))throw new Error("Failed to resolve a font for the rule '"+W3(i)+"'.");return o}function H3(t){return t.trimLeft()}function qX(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function $X(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var r0,G3,K3,Dv=["times"];(function(t){var e,r,n,s,i,o,l,c,u,d=function(U){return U=U||{},this.isStrokeTransparent=U.isStrokeTransparent||!1,this.strokeOpacity=U.strokeOpacity||1,this.strokeStyle=U.strokeStyle||"#000000",this.fillStyle=U.fillStyle||"#000000",this.isFillTransparent=U.isFillTransparent||!1,this.fillOpacity=U.fillOpacity||1,this.font=U.font||"10px sans-serif",this.textBaseline=U.textBaseline||"alphabetic",this.textAlign=U.textAlign||"left",this.lineWidth=U.lineWidth||1,this.lineJoin=U.lineJoin||"miter",this.lineCap=U.lineCap||"butt",this.path=U.path||[],this.transform=U.transform!==void 0?U.transform.clone():new c,this.globalCompositeOperation=U.globalCompositeOperation||"normal",this.globalAlpha=U.globalAlpha||1,this.clip_path=U.clip_path||[],this.currentPoint=U.currentPoint||new o,this.miterLimit=U.miterLimit||10,this.lastPoint=U.lastPoint||new o,this.lineDashOffset=U.lineDashOffset||0,this.lineDash=U.lineDash||[],this.margin=U.margin||[0,0,0,0],this.prevPageLastElemOffset=U.prevPageLastElemOffset||0,this.ignoreClearRect=typeof U.ignoreClearRect!="boolean"||U.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new h(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var h=function(U){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var J=U;Object.defineProperty(this,"pdf",{get:function(){return J}});var te=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return te},set:function(je){te=!!je}});var ie=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ie},set:function(je){ie=!!je}});var ue=0;Object.defineProperty(this,"posX",{get:function(){return ue},set:function(je){isNaN(je)||(ue=je)}});var ge=0;Object.defineProperty(this,"posY",{get:function(){return ge},set:function(je){isNaN(je)||(ge=je)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(je){var re;typeof je=="number"?re=[je,je,je,je]:((re=new Array(4))[0]=je[0],re[1]=je.length>=2?je[1]:re[0],re[2]=je.length>=3?je[2]:re[0],re[3]=je.length>=4?je[3]:re[1]),u.margin=re}});var we=!1;Object.defineProperty(this,"autoPaging",{get:function(){return we},set:function(je){we=je}});var be=0;Object.defineProperty(this,"lastBreak",{get:function(){return be},set:function(je){be=je}});var Me=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Me},set:function(je){Me=je}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(je){je instanceof d&&(u=je)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(je){u.path=je}});var De=[];Object.defineProperty(this,"ctxStack",{get:function(){return De},set:function(je){De=je}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(je){var re;re=g(je),this.ctx.fillStyle=re.style,this.ctx.isFillTransparent=re.a===0,this.ctx.fillOpacity=re.a,this.pdf.setFillColor(re.r,re.g,re.b,{a:re.a}),this.pdf.setTextColor(re.r,re.g,re.b,{a:re.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(je){var re=g(je);this.ctx.strokeStyle=re.style,this.ctx.isStrokeTransparent=re.a===0,this.ctx.strokeOpacity=re.a,re.a===0?this.pdf.setDrawColor(255,255,255):(re.a,this.pdf.setDrawColor(re.r,re.g,re.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(je){["butt","round","square"].indexOf(je)!==-1&&(this.ctx.lineCap=je,this.pdf.setLineCap(je))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(je){isNaN(je)||(this.ctx.lineWidth=je,this.pdf.setLineWidth(je))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(je){["bevel","round","miter"].indexOf(je)!==-1&&(this.ctx.lineJoin=je,this.pdf.setLineJoin(je))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(je){isNaN(je)||(this.ctx.miterLimit=je,this.pdf.setMiterLimit(je))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(je){this.ctx.textBaseline=je}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(je){["right","end","center","left","start"].indexOf(je)!==-1&&(this.ctx.textAlign=je)}});var He=null;function $e(je,re){if(He===null){var kt=function(it){var Fe=[];return Object.keys(it).forEach(function(ze){it[ze].forEach(function(Ye){var Ke=null;switch(Ye){case"bold":Ke={family:ze,weight:"bold"};break;case"italic":Ke={family:ze,style:"italic"};break;case"bolditalic":Ke={family:ze,weight:"bold",style:"italic"};break;case"":case"normal":Ke={family:ze}}Ke!==null&&(Ke.ref={name:ze,style:Ye},Fe.push(Ke))})}),Fe}(je.getFontList());He=function(it){for(var Fe={},ze=0;ze<it.length;++ze){var Ye=Bb(it[ze]),Ke=Ye.family,lt=Ye.stretch,jt=Ye.style,Pt=Ye.weight;Fe[Ke]=Fe[Ke]||{},Fe[Ke][lt]=Fe[Ke][lt]||{},Fe[Ke][lt][jt]=Fe[Ke][lt][jt]||{},Fe[Ke][lt][jt][Pt]=Ye}return Fe}(kt.concat(re))}return He}var dt=null;Object.defineProperty(this,"fontFaces",{get:function(){return dt},set:function(je){He=null,dt=je}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(je){var re;if(this.ctx.font=je,(re=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(je))!==null){var kt=re[1];re[2];var it=re[3],Fe=re[4];re[5];var ze=re[6],Ye=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Fe)[2];Fe=Math.floor(Ye==="px"?parseFloat(Fe)*this.pdf.internal.scaleFactor:Ye==="em"?parseFloat(Fe)*this.pdf.getFontSize():parseFloat(Fe)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Fe);var Ke=function(pt){var Ft,Xe,Sn=[],Ut=pt.trim();if(Ut==="")return Dv;if(Ut in $3)return[$3[Ut]];for(;Ut!=="";){switch(Xe=null,Ft=(Ut=H3(Ut)).charAt(0)){case'"':case"'":Xe=qX(Ut.substring(1),Ft);break;default:Xe=$X(Ut)}if(Xe===null||(Sn.push(Xe[0]),(Ut=H3(Xe[1]))!==""&&Ut.charAt(0)!==","))return Dv;Ut=Ut.replace(/^,/,"")}return Sn}(ze);if(this.fontFaces){var lt=zX($e(this.pdf,this.fontFaces),Ke.map(function(pt){return{family:pt,stretch:"normal",weight:it,style:kt}}));this.pdf.setFont(lt.ref.name,lt.ref.style)}else{var jt="";(it==="bold"||parseInt(it,10)>=700||kt==="bold")&&(jt="bold"),kt==="italic"&&(jt+="italic"),jt.length===0&&(jt="normal");for(var Pt="",Lt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},xt=0;xt<Ke.length;xt++){if(this.pdf.internal.getFont(Ke[xt],jt,{noFallback:!0,disableWarning:!0})!==void 0){Pt=Ke[xt];break}if(jt==="bolditalic"&&this.pdf.internal.getFont(Ke[xt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Pt=Ke[xt],jt="bold";else if(this.pdf.internal.getFont(Ke[xt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Pt=Ke[xt],jt="normal";break}}if(Pt===""){for(var Rt=0;Rt<Ke.length;Rt++)if(Lt[Ke[Rt]]){Pt=Lt[Ke[Rt]];break}}Pt=Pt===""?"Times":Pt,this.pdf.setFont(Pt,jt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(je){this.ctx.globalCompositeOperation=je}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(je){this.ctx.globalAlpha=je}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(je){this.ctx.lineDashOffset=je,Se.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(je){this.ctx.lineDash=je,Se.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(je){this.ctx.ignoreClearRect=!!je}})};h.prototype.setLineDash=function(U){this.lineDash=U},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){P.call(this,"fill",!1)},h.prototype.stroke=function(){P.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(U,J){if(isNaN(U)||isNaN(J))throw yr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var te=this.ctx.transform.applyToPoint(new o(U,J));this.path.push({type:"mt",x:te.x,y:te.y}),this.ctx.lastPoint=new o(U,J)},h.prototype.closePath=function(){var U=new o(0,0),J=0;for(J=this.path.length-1;J!==-1;J--)if(this.path[J].type==="begin"&&or(this.path[J+1])==="object"&&typeof this.path[J+1].x=="number"){U=new o(this.path[J+1].x,this.path[J+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(U.x,U.y)},h.prototype.lineTo=function(U,J){if(isNaN(U)||isNaN(J))throw yr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var te=this.ctx.transform.applyToPoint(new o(U,J));this.path.push({type:"lt",x:te.x,y:te.y}),this.ctx.lastPoint=new o(te.x,te.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),P.call(this,null,!0)},h.prototype.quadraticCurveTo=function(U,J,te,ie){if(isNaN(te)||isNaN(ie)||isNaN(U)||isNaN(J))throw yr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ue=this.ctx.transform.applyToPoint(new o(te,ie)),ge=this.ctx.transform.applyToPoint(new o(U,J));this.path.push({type:"qct",x1:ge.x,y1:ge.y,x:ue.x,y:ue.y}),this.ctx.lastPoint=new o(ue.x,ue.y)},h.prototype.bezierCurveTo=function(U,J,te,ie,ue,ge){if(isNaN(ue)||isNaN(ge)||isNaN(U)||isNaN(J)||isNaN(te)||isNaN(ie))throw yr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var we=this.ctx.transform.applyToPoint(new o(ue,ge)),be=this.ctx.transform.applyToPoint(new o(U,J)),Me=this.ctx.transform.applyToPoint(new o(te,ie));this.path.push({type:"bct",x1:be.x,y1:be.y,x2:Me.x,y2:Me.y,x:we.x,y:we.y}),this.ctx.lastPoint=new o(we.x,we.y)},h.prototype.arc=function(U,J,te,ie,ue,ge){if(isNaN(U)||isNaN(J)||isNaN(te)||isNaN(ie)||isNaN(ue))throw yr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ge=!!ge,!this.ctx.transform.isIdentity){var we=this.ctx.transform.applyToPoint(new o(U,J));U=we.x,J=we.y;var be=this.ctx.transform.applyToPoint(new o(0,te)),Me=this.ctx.transform.applyToPoint(new o(0,0));te=Math.sqrt(Math.pow(be.x-Me.x,2)+Math.pow(be.y-Me.y,2))}Math.abs(ue-ie)>=2*Math.PI&&(ie=0,ue=2*Math.PI),this.path.push({type:"arc",x:U,y:J,radius:te,startAngle:ie,endAngle:ue,counterclockwise:ge})},h.prototype.arcTo=function(U,J,te,ie,ue){throw new Error("arcTo not implemented.")},h.prototype.rect=function(U,J,te,ie){if(isNaN(U)||isNaN(J)||isNaN(te)||isNaN(ie))throw yr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(U,J),this.lineTo(U+te,J),this.lineTo(U+te,J+ie),this.lineTo(U,J+ie),this.lineTo(U,J),this.lineTo(U+te,J),this.lineTo(U,J)},h.prototype.fillRect=function(U,J,te,ie){if(isNaN(U)||isNaN(J)||isNaN(te)||isNaN(ie))throw yr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var ue={};this.lineCap!=="butt"&&(ue.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ue.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(U,J,te,ie),this.fill(),ue.hasOwnProperty("lineCap")&&(this.lineCap=ue.lineCap),ue.hasOwnProperty("lineJoin")&&(this.lineJoin=ue.lineJoin)}},h.prototype.strokeRect=function(U,J,te,ie){if(isNaN(U)||isNaN(J)||isNaN(te)||isNaN(ie))throw yr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");w.call(this)||(this.beginPath(),this.rect(U,J,te,ie),this.stroke())},h.prototype.clearRect=function(U,J,te,ie){if(isNaN(U)||isNaN(J)||isNaN(te)||isNaN(ie))throw yr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(U,J,te,ie))},h.prototype.save=function(U){U=typeof U!="boolean"||U;for(var J=this.pdf.internal.getCurrentPageInfo().pageNumber,te=0;te<this.pdf.internal.getNumberOfPages();te++)this.pdf.setPage(te+1),this.pdf.internal.out("q");if(this.pdf.setPage(J),U){this.ctx.fontSize=this.pdf.internal.getFontSize();var ie=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ie}},h.prototype.restore=function(U){U=typeof U!="boolean"||U;for(var J=this.pdf.internal.getCurrentPageInfo().pageNumber,te=0;te<this.pdf.internal.getNumberOfPages();te++)this.pdf.setPage(te+1),this.pdf.internal.out("Q");this.pdf.setPage(J),U&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var g=function(U){var J,te,ie,ue;if(U.isCanvasGradient===!0&&(U=U.getColor()),!U)return{r:0,g:0,b:0,a:0,style:U};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(U))J=0,te=0,ie=0,ue=0;else{var ge=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(U);if(ge!==null)J=parseInt(ge[1]),te=parseInt(ge[2]),ie=parseInt(ge[3]),ue=1;else if((ge=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(U))!==null)J=parseInt(ge[1]),te=parseInt(ge[2]),ie=parseInt(ge[3]),ue=parseFloat(ge[4]);else{if(ue=1,typeof U=="string"&&U.charAt(0)!=="#"){var we=new DP(U);U=we.ok?we.toHex():"#000000"}U.length===4?(J=U.substring(1,2),J+=J,te=U.substring(2,3),te+=te,ie=U.substring(3,4),ie+=ie):(J=U.substring(1,3),te=U.substring(3,5),ie=U.substring(5,7)),J=parseInt(J,16),te=parseInt(te,16),ie=parseInt(ie,16)}}return{r:J,g:te,b:ie,a:ue,style:U}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},w=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(U,J,te,ie){if(isNaN(J)||isNaN(te)||typeof U!="string")throw yr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ie=isNaN(ie)?void 0:ie,!m.call(this)){var ue=Y(this.ctx.transform.rotation),ge=this.ctx.transform.scaleX;R.call(this,{text:U,x:J,y:te,scale:ge,angle:ue,align:this.textAlign,maxWidth:ie})}},h.prototype.strokeText=function(U,J,te,ie){if(isNaN(J)||isNaN(te)||typeof U!="string")throw yr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!w.call(this)){ie=isNaN(ie)?void 0:ie;var ue=Y(this.ctx.transform.rotation),ge=this.ctx.transform.scaleX;R.call(this,{text:U,x:J,y:te,scale:ge,renderingMode:"stroke",angle:ue,align:this.textAlign,maxWidth:ie})}},h.prototype.measureText=function(U){if(typeof U!="string")throw yr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var J=this.pdf,te=this.pdf.internal.scaleFactor,ie=J.internal.getFontSize(),ue=J.getStringUnitWidth(U)*ie/J.internal.scaleFactor,ge=function(we){var be=(we=we||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return be}}),this};return new ge({width:ue*=Math.round(96*te/72*1e4)/1e4})},h.prototype.scale=function(U,J){if(isNaN(U)||isNaN(J))throw yr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var te=new c(U,0,0,J,0,0);this.ctx.transform=this.ctx.transform.multiply(te)},h.prototype.rotate=function(U){if(isNaN(U))throw yr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var J=new c(Math.cos(U),Math.sin(U),-Math.sin(U),Math.cos(U),0,0);this.ctx.transform=this.ctx.transform.multiply(J)},h.prototype.translate=function(U,J){if(isNaN(U)||isNaN(J))throw yr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var te=new c(1,0,0,1,U,J);this.ctx.transform=this.ctx.transform.multiply(te)},h.prototype.transform=function(U,J,te,ie,ue,ge){if(isNaN(U)||isNaN(J)||isNaN(te)||isNaN(ie)||isNaN(ue)||isNaN(ge))throw yr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var we=new c(U,J,te,ie,ue,ge);this.ctx.transform=this.ctx.transform.multiply(we)},h.prototype.setTransform=function(U,J,te,ie,ue,ge){U=isNaN(U)?1:U,J=isNaN(J)?0:J,te=isNaN(te)?0:te,ie=isNaN(ie)?1:ie,ue=isNaN(ue)?0:ue,ge=isNaN(ge)?0:ge,this.ctx.transform=new c(U,J,te,ie,ue,ge)};var _=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(U,J,te,ie,ue,ge,we,be,Me){var De=this.pdf.getImageProperties(U),He=1,$e=1,dt=1,je=1;ie!==void 0&&be!==void 0&&(dt=be/ie,je=Me/ue,He=De.width/ie*be/ie,$e=De.height/ue*Me/ue),ge===void 0&&(ge=J,we=te,J=0,te=0),ie!==void 0&&be===void 0&&(be=ie,Me=ue),ie===void 0&&be===void 0&&(be=De.width,Me=De.height);for(var re,kt=this.ctx.transform.decompose(),it=Y(kt.rotate.shx),Fe=new c,ze=(Fe=(Fe=(Fe=Fe.multiply(kt.translate)).multiply(kt.skew)).multiply(kt.scale)).applyToRectangle(new l(ge-J*dt,we-te*je,ie*He,ue*$e)),Ye=T.call(this,ze),Ke=[],lt=0;lt<Ye.length;lt+=1)Ke.indexOf(Ye[lt])===-1&&Ke.push(Ye[lt]);if(x(Ke),this.autoPaging)for(var jt=Ke[0],Pt=Ke[Ke.length-1],Lt=jt;Lt<Pt+1;Lt++){this.pdf.setPage(Lt);var xt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Rt=Lt===1?this.posY+this.margin[0]:this.margin[0],pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ft=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Xe=Lt===1?0:pt+(Lt-2)*Ft;if(this.ctx.clip_path.length!==0){var Sn=this.path;re=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(re,this.posX+this.margin[3],-Xe+Rt+this.ctx.prevPageLastElemOffset),F.call(this,"fill",!0),this.path=Sn}var Ut=JSON.parse(JSON.stringify(ze));Ut=b([Ut],this.posX+this.margin[3],-Xe+Rt+this.ctx.prevPageLastElemOffset)[0];var Cs=(Lt>jt||Lt<Pt)&&_.call(this);Cs&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],xt,Ft,null).clip().discardPath()),this.pdf.addImage(U,"JPEG",Ut.x,Ut.y,Ut.w,Ut.h,null,null,it),Cs&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(U,"JPEG",ze.x,ze.y,ze.w,ze.h,null,null,it)};var T=function(U,J,te){var ie=[];J=J||this.pdf.internal.pageSize.width,te=te||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ue=this.posY+this.ctx.prevPageLastElemOffset;switch(U.type){default:case"mt":case"lt":ie.push(Math.floor((U.y+ue)/te)+1);break;case"arc":ie.push(Math.floor((U.y+ue-U.radius)/te)+1),ie.push(Math.floor((U.y+ue+U.radius)/te)+1);break;case"qct":var ge=Q(this.ctx.lastPoint.x,this.ctx.lastPoint.y,U.x1,U.y1,U.x,U.y);ie.push(Math.floor((ge.y+ue)/te)+1),ie.push(Math.floor((ge.y+ge.h+ue)/te)+1);break;case"bct":var we=se(this.ctx.lastPoint.x,this.ctx.lastPoint.y,U.x1,U.y1,U.x2,U.y2,U.x,U.y);ie.push(Math.floor((we.y+ue)/te)+1),ie.push(Math.floor((we.y+we.h+ue)/te)+1);break;case"rect":ie.push(Math.floor((U.y+ue)/te)+1),ie.push(Math.floor((U.y+U.h+ue)/te)+1)}for(var be=0;be<ie.length;be+=1)for(;this.pdf.internal.getNumberOfPages()<ie[be];)v.call(this);return ie},v=function(){var U=this.fillStyle,J=this.strokeStyle,te=this.font,ie=this.lineCap,ue=this.lineWidth,ge=this.lineJoin;this.pdf.addPage(),this.fillStyle=U,this.strokeStyle=J,this.font=te,this.lineCap=ie,this.lineWidth=ue,this.lineJoin=ge},b=function(U,J,te){for(var ie=0;ie<U.length;ie++)switch(U[ie].type){case"bct":U[ie].x2+=J,U[ie].y2+=te;case"qct":U[ie].x1+=J,U[ie].y1+=te;case"mt":case"lt":case"arc":default:U[ie].x+=J,U[ie].y+=te}return U},x=function(U){return U.sort(function(J,te){return J-te})},P=function(U,J){for(var te,ie,ue=this.fillStyle,ge=this.strokeStyle,we=this.lineCap,be=this.lineWidth,Me=Math.abs(be*this.ctx.transform.scaleX),De=this.lineJoin,He=JSON.parse(JSON.stringify(this.path)),$e=JSON.parse(JSON.stringify(this.path)),dt=[],je=0;je<$e.length;je++)if($e[je].x!==void 0)for(var re=T.call(this,$e[je]),kt=0;kt<re.length;kt+=1)dt.indexOf(re[kt])===-1&&dt.push(re[kt]);for(var it=0;it<dt.length;it++)for(;this.pdf.internal.getNumberOfPages()<dt[it];)v.call(this);if(x(dt),this.autoPaging)for(var Fe=dt[0],ze=dt[dt.length-1],Ye=Fe;Ye<ze+1;Ye++){this.pdf.setPage(Ye),this.fillStyle=ue,this.strokeStyle=ge,this.lineCap=we,this.lineWidth=Me,this.lineJoin=De;var Ke=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],lt=Ye===1?this.posY+this.margin[0]:this.margin[0],jt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Pt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Lt=Ye===1?0:jt+(Ye-2)*Pt;if(this.ctx.clip_path.length!==0){var xt=this.path;te=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(te,this.posX+this.margin[3],-Lt+lt+this.ctx.prevPageLastElemOffset),F.call(this,U,!0),this.path=xt}if(ie=JSON.parse(JSON.stringify(He)),this.path=b(ie,this.posX+this.margin[3],-Lt+lt+this.ctx.prevPageLastElemOffset),J===!1||Ye===0){var Rt=(Ye>Fe||Ye<ze)&&_.call(this);Rt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ke,Pt,null).clip().discardPath()),F.call(this,U,J),Rt&&this.pdf.restoreGraphicsState()}this.lineWidth=be}else this.lineWidth=Me,F.call(this,U,J),this.lineWidth=be;this.path=He},F=function(U,J){if((U!=="stroke"||J||!w.call(this))&&(U==="stroke"||J||!m.call(this))){for(var te,ie,ue=[],ge=this.path,we=0;we<ge.length;we++){var be=ge[we];switch(be.type){case"begin":ue.push({begin:!0});break;case"close":ue.push({close:!0});break;case"mt":ue.push({start:be,deltas:[],abs:[]});break;case"lt":var Me=ue.length;if(ge[we-1]&&!isNaN(ge[we-1].x)&&(te=[be.x-ge[we-1].x,be.y-ge[we-1].y],Me>0)){for(;Me>=0;Me--)if(ue[Me-1].close!==!0&&ue[Me-1].begin!==!0){ue[Me-1].deltas.push(te),ue[Me-1].abs.push(be);break}}break;case"bct":te=[be.x1-ge[we-1].x,be.y1-ge[we-1].y,be.x2-ge[we-1].x,be.y2-ge[we-1].y,be.x-ge[we-1].x,be.y-ge[we-1].y],ue[ue.length-1].deltas.push(te);break;case"qct":var De=ge[we-1].x+2/3*(be.x1-ge[we-1].x),He=ge[we-1].y+2/3*(be.y1-ge[we-1].y),$e=be.x+2/3*(be.x1-be.x),dt=be.y+2/3*(be.y1-be.y),je=be.x,re=be.y;te=[De-ge[we-1].x,He-ge[we-1].y,$e-ge[we-1].x,dt-ge[we-1].y,je-ge[we-1].x,re-ge[we-1].y],ue[ue.length-1].deltas.push(te);break;case"arc":ue.push({deltas:[],abs:[],arc:!0}),Array.isArray(ue[ue.length-1].abs)&&ue[ue.length-1].abs.push(be)}}ie=J?null:U==="stroke"?"stroke":"fill";for(var kt=!1,it=0;it<ue.length;it++)if(ue[it].arc)for(var Fe=ue[it].abs,ze=0;ze<Fe.length;ze++){var Ye=Fe[ze];Ye.type==="arc"?A.call(this,Ye.x,Ye.y,Ye.radius,Ye.startAngle,Ye.endAngle,Ye.counterclockwise,void 0,J,!kt):C.call(this,Ye.x,Ye.y),kt=!0}else if(ue[it].close===!0)this.pdf.internal.out("h"),kt=!1;else if(ue[it].begin!==!0){var Ke=ue[it].start.x,lt=ue[it].start.y;G.call(this,ue[it].deltas,Ke,lt),kt=!0}ie&&I.call(this,ie),J&&O.call(this)}},$=function(U){var J=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,te=J*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return U-te;case"top":return U+J-te;case"hanging":return U+J-2*te;case"middle":return U+J/2-te;case"ideographic":return U;case"alphabetic":default:return U}},k=function(U){return U+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var U=function(){};return U.colorStops=[],U.addColorStop=function(J,te){this.colorStops.push([J,te])},U.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},U.isCanvasGradient=!0,U},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var A=function(U,J,te,ie,ue,ge,we,be,Me){for(var De=ne.call(this,te,ie,ue,ge),He=0;He<De.length;He++){var $e=De[He];He===0&&(Me?S.call(this,$e.x1+U,$e.y1+J):C.call(this,$e.x1+U,$e.y1+J)),de.call(this,U,J,$e.x2,$e.y2,$e.x3,$e.y3,$e.x4,$e.y4)}be?O.call(this):I.call(this,we)},I=function(U){switch(U){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},O=function(){this.pdf.clip(),this.pdf.discardPath()},S=function(U,J){this.pdf.internal.out(r(U)+" "+n(J)+" m")},R=function(U){var J;switch(U.align){case"right":case"end":J="right";break;case"center":J="center";break;case"left":case"start":default:J="left"}var te=this.pdf.getTextDimensions(U.text),ie=$.call(this,U.y),ue=k.call(this,ie)-te.h,ge=this.ctx.transform.applyToPoint(new o(U.x,ie)),we=this.ctx.transform.decompose(),be=new c;be=(be=(be=be.multiply(we.translate)).multiply(we.skew)).multiply(we.scale);for(var Me,De,He,$e=this.ctx.transform.applyToRectangle(new l(U.x,ie,te.w,te.h)),dt=be.applyToRectangle(new l(U.x,ue,te.w,te.h)),je=T.call(this,dt),re=[],kt=0;kt<je.length;kt+=1)re.indexOf(je[kt])===-1&&re.push(je[kt]);if(x(re),this.autoPaging)for(var it=re[0],Fe=re[re.length-1],ze=it;ze<Fe+1;ze++){this.pdf.setPage(ze);var Ye=ze===1?this.posY+this.margin[0]:this.margin[0],Ke=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],lt=this.pdf.internal.pageSize.height-this.margin[2],jt=lt-this.margin[0],Pt=this.pdf.internal.pageSize.width-this.margin[1],Lt=Pt-this.margin[3],xt=ze===1?0:Ke+(ze-2)*jt;if(this.ctx.clip_path.length!==0){var Rt=this.path;Me=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(Me,this.posX+this.margin[3],-1*xt+Ye),F.call(this,"fill",!0),this.path=Rt}var pt=b([JSON.parse(JSON.stringify(dt))],this.posX+this.margin[3],-xt+Ye+this.ctx.prevPageLastElemOffset)[0];U.scale>=.01&&(De=this.pdf.internal.getFontSize(),this.pdf.setFontSize(De*U.scale),He=this.lineWidth,this.lineWidth=He*U.scale);var Ft=this.autoPaging!=="text";if(Ft||pt.y+pt.h<=lt){if(Ft||pt.y>=Ye&&pt.x<=Pt){var Xe=Ft?U.text:this.pdf.splitTextToSize(U.text,U.maxWidth||Pt-pt.x)[0],Sn=b([JSON.parse(JSON.stringify($e))],this.posX+this.margin[3],-xt+Ye+this.ctx.prevPageLastElemOffset)[0],Ut=Ft&&(ze>it||ze<Fe)&&_.call(this);Ut&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Lt,jt,null).clip().discardPath()),this.pdf.text(Xe,Sn.x,Sn.y,{angle:U.angle,align:J,renderingMode:U.renderingMode}),Ut&&this.pdf.restoreGraphicsState()}}else pt.y<lt&&(this.ctx.prevPageLastElemOffset+=lt-pt.y);U.scale>=.01&&(this.pdf.setFontSize(De),this.lineWidth=He)}else U.scale>=.01&&(De=this.pdf.internal.getFontSize(),this.pdf.setFontSize(De*U.scale),He=this.lineWidth,this.lineWidth=He*U.scale),this.pdf.text(U.text,ge.x+this.posX,ge.y+this.posY,{angle:U.angle,align:J,renderingMode:U.renderingMode,maxWidth:U.maxWidth}),U.scale>=.01&&(this.pdf.setFontSize(De),this.lineWidth=He)},C=function(U,J,te,ie){te=te||0,ie=ie||0,this.pdf.internal.out(r(U+te)+" "+n(J+ie)+" l")},G=function(U,J,te){return this.pdf.lines(U,J,te,null,null)},de=function(U,J,te,ie,ue,ge,we,be){this.pdf.internal.out([e(s(te+U)),e(i(ie+J)),e(s(ue+U)),e(i(ge+J)),e(s(we+U)),e(i(be+J)),"c"].join(" "))},ne=function(U,J,te,ie){for(var ue=2*Math.PI,ge=Math.PI/2;J>te;)J-=ue;var we=Math.abs(te-J);we<ue&&ie&&(we=ue-we);for(var be=[],Me=ie?-1:1,De=J;we>1e-5;){var He=De+Me*Math.min(we,ge);be.push(X.call(this,U,De,He)),we-=Math.abs(He-De),De=He}return be},X=function(U,J,te){var ie=(te-J)/2,ue=U*Math.cos(ie),ge=U*Math.sin(ie),we=ue,be=-ge,Me=we*we+be*be,De=Me+we*ue+be*ge,He=4/3*(Math.sqrt(2*Me*De)-De)/(we*ge-be*ue),$e=we-He*be,dt=be+He*we,je=$e,re=-dt,kt=ie+J,it=Math.cos(kt),Fe=Math.sin(kt);return{x1:U*Math.cos(J),y1:U*Math.sin(J),x2:$e*it-dt*Fe,y2:$e*Fe+dt*it,x3:je*it-re*Fe,y3:je*Fe+re*it,x4:U*Math.cos(te),y4:U*Math.sin(te)}},Y=function(U){return 180*U/Math.PI},Q=function(U,J,te,ie,ue,ge){var we=U+.5*(te-U),be=J+.5*(ie-J),Me=ue+.5*(te-ue),De=ge+.5*(ie-ge),He=Math.min(U,ue,we,Me),$e=Math.max(U,ue,we,Me),dt=Math.min(J,ge,be,De),je=Math.max(J,ge,be,De);return new l(He,dt,$e-He,je-dt)},se=function(U,J,te,ie,ue,ge,we,be){var Me,De,He,$e,dt,je,re,kt,it,Fe,ze,Ye,Ke,lt,jt=te-U,Pt=ie-J,Lt=ue-te,xt=ge-ie,Rt=we-ue,pt=be-ge;for(De=0;De<41;De++)it=(re=(He=U+(Me=De/40)*jt)+Me*((dt=te+Me*Lt)-He))+Me*(dt+Me*(ue+Me*Rt-dt)-re),Fe=(kt=($e=J+Me*Pt)+Me*((je=ie+Me*xt)-$e))+Me*(je+Me*(ge+Me*pt-je)-kt),De==0?(ze=it,Ye=Fe,Ke=it,lt=Fe):(ze=Math.min(ze,it),Ye=Math.min(Ye,Fe),Ke=Math.max(Ke,it),lt=Math.max(lt,Fe));return new l(Math.round(ze),Math.round(Ye),Math.round(Ke-ze),Math.round(lt-Ye))},Se=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var U,J,te=(U=this.ctx.lineDash,J=this.ctx.lineDashOffset,JSON.stringify({lineDash:U,lineDashOffset:J}));this.prevLineDash!==te&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=te)}}})(bt.API),function(t){var e=function(i){var o,l,c,u,d,h,g,m,w,_;for(l=[],c=0,u=(i+=o="\0\0\0\0".slice(i.length%4||4)).length;u>c;c+=4)(d=(i.charCodeAt(c)<<24)+(i.charCodeAt(c+1)<<16)+(i.charCodeAt(c+2)<<8)+i.charCodeAt(c+3))!==0?(h=(d=((d=((d=((d=(d-(_=d%85))/85)-(w=d%85))/85)-(m=d%85))/85)-(g=d%85))/85)%85,l.push(h+33,g+33,m+33,w+33,_+33)):l.push(122);return function(T,v){for(var b=v;b>0;b--)T.pop()}(l,o.length),String.fromCharCode.apply(String,l)+"~>"},r=function(i){var o,l,c,u,d,h=String,g="length",m=255,w="charCodeAt",_="slice",T="replace";for(i[_](-2),i=i[_](0,-2)[T](/\s/g,"")[T]("z","!!!!!"),c=[],u=0,d=(i+=o="uuuuu"[_](i[g]%5||5))[g];d>u;u+=5)l=52200625*(i[w](u)-33)+614125*(i[w](u+1)-33)+7225*(i[w](u+2)-33)+85*(i[w](u+3)-33)+(i[w](u+4)-33),c.push(m&l>>24,m&l>>16,m&l>>8,m&l);return function(v,b){for(var x=b;x>0;x--)v.pop()}(c,o[g]),h.fromCharCode.apply(h,c)},n=function(i){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),o.test(i)===!1)return"";for(var l="",c=0;c<i.length;c+=2)l+=String.fromCharCode("0x"+(i[c]+i[c+1]));return l},s=function(i){for(var o=new Uint8Array(i.length),l=i.length;l--;)o[l]=i.charCodeAt(l);return i=(o=Db(o)).reduce(function(c,u){return c+String.fromCharCode(u)},"")};t.processDataByFilters=function(i,o){var l=0,c=i||"",u=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(d){return("0"+d.charCodeAt().toString(16)).slice(-2)}).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=s(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}}(bt.API),function(t){t.loadFile=function(e,r,n){return function(s,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,d){var h=new XMLHttpRequest,g=0,m=function(w){var _=w.length,T=[],v=String.fromCharCode;for(g=0;g<_;g+=1)T.push(v(255&w.charCodeAt(g)));return T.join("")};if(h.open("GET",c,!u),h.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(h.onload=function(){h.status===200?d(m(this.responseText)):d(void 0)}),h.send(null),u&&h.status===200)return m(h.responseText)}(s,i,o)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(bt.API),function(t){function e(){return(wt.html2canvas?Promise.resolve(wt.html2canvas):vp(()=>import("./html2canvas.esm-e0a7d97b.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(wt.DOMPurify?Promise.resolve(wt.DOMPurify):vp(()=>import("./purify.es-31816194.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var l=or(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},s=function(o,l){var c=document.createElement(o);for(var u in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[u]=l.style[u];return c},i=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),u=o.convert(Promise.resolve(),c);return u=(u=u.setProgress(1,o,1,[o])).set(l)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(o,l){return o.__proto__=l||i.prototype,o},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(o,l){return this.then(function(){switch(l=l||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(r).then(function(c){return this.set({src:s("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},i.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(u,d){for(var h=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),g=u.firstChild;g;g=g.nextSibling)d!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||h.appendChild(c(g,d));return u.nodeType===1&&(u.nodeName==="CANVAS"?(h.width=u.width,h.height=u.height,h.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(h.value=u.value),h.addEventListener("load",function(){h.scrollTop=u.scrollTop,h.scrollLeft=u.scrollLeft},!0)),h}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=this.opt.jsPDF,u=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var g=0;g<u.length;++g){var m=u[g],w=m.src.find(function(_){return _.format==="truetype"});w&&c.addFont(w.url,m.ref.name,m.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,c.context2d.save(!0),l(this.prop.container,h)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},i.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},i.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},i.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(o){if(n(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in i.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},i.prototype.get=function(o,l){return this.then(function(){var c=o in i.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},i.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},i.prototype.setPageSize=function(o){function l(c,u){return Math.floor(c*u/72*96)}return this.then(function(){(o=o||bt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},i.prototype.setProgress=function(o,l,c,u){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(o,l,c,u){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},i.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(u,d){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(h){return c.updateProgress(null,u),h}).then(u,d).then(function(h){return c.updateProgress(1),h})})},i.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then,o&&(o=o.bind(this)),l&&(l=l.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),d=c.call(u,o,l);return i.convert(d,this.__proto__)},i.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},i.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},i.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return i.convert(l,this)},i.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},i.prototype.error=function(o){return this.then(function(){throw new Error(o)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,bt.getPageSize=function(o,l,c){if(or(o)==="object"){var u=o;o=u.orientation,l=u.unit||l,c=u.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var d,h=(""+c).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+l}var m,w=0,_=0;if(g.hasOwnProperty(h))w=g[h][1]/d,_=g[h][0]/d;else try{w=c[1],_=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",_>w&&(m=_,_=w,w=m);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",w>_&&(m=_,_=w,w=m)}return{width:_,height:w,unit:l,k:d,orientation:o}},t.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(Bb):null;var c=new i(l);return l.worker?c:c.from(o).doCallback()}}(bt.API),bt.API.addJS=function(t){return K3=t,this.internal.events.subscribe("postPutResources",function(){r0=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(r0+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),G3=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+K3+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){r0!==void 0&&G3!==void 0&&this.internal.out("/Names <</JavaScript "+r0+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),i=0;i<s.length;i++){var o=s[i],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(i=0;i<u;i++){var h=r.internal.newObject();d.push(h);var g=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+g.objId+" 0 R /XYZ null null null]>> endobj")}var m=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<d.length;i++)r.internal.write("(page_"+(i+1)+")"+d[i]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+m+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,i){var o={title:s,options:i,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var o=n.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var i=0;i<s.children.length;i++)n.count++,this.count_r(n,s.children[i]);return n.count}}])}(bt.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,s,i,o,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=function(h){for(var g,m=256*h.charCodeAt(4)+h.charCodeAt(5),w=h.length,_={width:0,height:0,numcomponents:1},T=4;T<w;T+=2){if(T+=m,e.indexOf(h.charCodeAt(T+1))!==-1){g=256*h.charCodeAt(T+5)+h.charCodeAt(T+6),_={width:256*h.charCodeAt(T+7)+h.charCodeAt(T+8),height:g,numcomponents:h.charCodeAt(T+9)};break}m=256*h.charCodeAt(T+2)+h.charCodeAt(T+3)}return _}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:s}}return d}}(bt.API);var Jd,n0,Y3,Q3,J3,WX=function(){var t,e,r;function n(i){var o,l,c,u,d,h,g,m,w,_,T,v,b,x;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},h=null;;){switch(o=this.readUInt32(),w=(function(){var P,F;for(F=[],P=0;P<4;++P)F.push(String.fromCharCode(this.data[this.pos++]));return F}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":h&&this.animation.frames.push(h),this.pos+=4,h={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},d=this.readUInt16(),u=this.readUInt16()||100,h.delay=1e3*d/u,h.disposeOp=this.data[this.pos++],h.blendOp=this.data[this.pos++],h.data=[];break;case"IDAT":case"fdAT":for(w==="fdAT"&&(this.pos+=4,o-=4),i=(h!=null?h.data:void 0)||this.imgData,v=0;0<=o?v<o:v>o;0<=o?++v:--v)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((_=c-this.transparency.indexed.length)>0)for(b=0;0<=_?b<_:b>_;0<=_?++b:--b)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":g=(T=this.read(o)).indexOf(0),m=String.fromCharCode.apply(String,T.slice(0,g)),this.text[m]=String.fromCharCode.apply(String,T.slice(g+1));break;case"IEND":return h&&this.animation.frames.push(h),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(x=this.colorType)===4||x===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(i){var o,l;for(l=[],o=0;0<=i?o<i:o>i;0<=i?++o:--o)l.push(this.data[this.pos++]);return l},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(i){var o=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*o),c=0,u=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function d(h,g,m,w){var _,T,v,b,x,P,F,$,k,A,I,O,S,R,C,G,de,ne,X,Y,Q,se=Math.ceil((u.width-h)/m),Se=Math.ceil((u.height-g)/w),U=u.width==se&&u.height==Se;for(R=o*se,O=U?l:new Uint8Array(R*Se),P=i.length,S=0,T=0;S<Se&&c<P;){switch(i[c++]){case 0:for(b=de=0;de<R;b=de+=1)O[T++]=i[c++];break;case 1:for(b=ne=0;ne<R;b=ne+=1)_=i[c++],x=b<o?0:O[T-o],O[T++]=(_+x)%256;break;case 2:for(b=X=0;X<R;b=X+=1)_=i[c++],v=(b-b%o)/o,C=S&&O[(S-1)*R+v*o+b%o],O[T++]=(C+_)%256;break;case 3:for(b=Y=0;Y<R;b=Y+=1)_=i[c++],v=(b-b%o)/o,x=b<o?0:O[T-o],C=S&&O[(S-1)*R+v*o+b%o],O[T++]=(_+Math.floor((x+C)/2))%256;break;case 4:for(b=Q=0;Q<R;b=Q+=1)_=i[c++],v=(b-b%o)/o,x=b<o?0:O[T-o],S===0?C=G=0:(C=O[(S-1)*R+v*o+b%o],G=v&&O[(S-1)*R+(v-1)*o+b%o]),F=x+C-G,$=Math.abs(F-x),A=Math.abs(F-C),I=Math.abs(F-G),k=$<=A&&$<=I?x:A<=I?C:G,O[T++]=(_+k)%256;break;default:throw new Error("Invalid filter algorithm: "+i[c-1])}if(!U){var J=((g+S*w)*u.width+h)*o,te=S*R;for(b=0;b<se;b+=1){for(var ie=0;ie<o;ie+=1)l[J++]=O[te++];J+=(m-1)*o}}S++}}return i=_X(i),u.interlaceMethod==1?(d(0,0,8,8),d(4,0,8,8),d(0,4,4,8),d(2,0,4,4),d(0,2,2,4),d(1,0,2,2),d(0,1,1,2)):d(0,0,1,1),l},n.prototype.decodePalette=function(){var i,o,l,c,u,d,h,g,m;for(l=this.palette,d=this.transparency.indexed||[],u=new Uint8Array((d.length||0)+l.length),c=0,i=0,o=h=0,g=l.length;h<g;o=h+=3)u[c++]=l[o],u[c++]=l[o+1],u[c++]=l[o+2],u[c++]=(m=d[i++])!=null?m:255;return u},n.prototype.copyToImageData=function(i,o){var l,c,u,d,h,g,m,w,_,T,v;if(c=this.colors,_=null,l=this.hasAlphaChannel,this.palette.length&&(_=(v=this._decodedPalette)!=null?v:this._decodedPalette=this.decodePalette(),c=4,l=!0),w=(u=i.data||i).length,h=_||o,d=g=0,c===1)for(;d<w;)m=_?4*o[d/4]:g,T=h[m++],u[d++]=T,u[d++]=T,u[d++]=T,u[d++]=l?h[m++]:255,g=m;else for(;d<w;)m=_?4*o[d/4]:g,u[d++]=h[m++],u[d++]=h[m++],u[d++]=h[m++],u[d++]=l?h[m++]:255,g=m},n.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var s=function(){if(Object.prototype.toString.call(wt)==="[object Window]"){try{e=wt.document.createElement("canvas"),r=e.getContext("2d")}catch{return!1}return!0}return!1};return s(),t=function(i){var o;if(s()===!0)return r.width=i.width,r.height=i.height,r.clearRect(0,0,i.width,i.height),r.putImageData(i,0,0),(o=new Image).src=e.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(i){var o,l,c,u,d,h,g,m;if(this.animation){for(m=[],l=d=0,h=(g=this.animation.frames).length;d<h;l=++d)o=g[l],c=i.createImageData(o.width,o.height),u=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(c,u),o.imageData=c,m.push(o.image=t(c));return m}},n.prototype.renderFrame=function(i,o){var l,c,u;return l=(c=this.animation.frames)[o],u=c[o-1],o===0&&i.clearRect(0,0,this.width,this.height),(u!=null?u.disposeOp:void 0)===1?i.clearRect(u.xOffset,u.yOffset,u.width,u.height):(u!=null?u.disposeOp:void 0)===2&&i.putImageData(u.imageData,u.xOffset,u.yOffset),l.blendOp===0&&i.clearRect(l.xOffset,l.yOffset,l.width,l.height),i.drawImage(l.image,l.xOffset,l.yOffset)},n.prototype.animate=function(i){var o,l,c,u,d,h,g=this;return l=0,h=this.animation,u=h.numFrames,c=h.frames,d=h.numPlays,(o=function(){var m,w;if(m=l++%u,w=c[m],g.renderFrame(i,m),u>1&&l/u<d)return g.animation._timeout=setTimeout(o,w.delay)})()},n.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},n.prototype.render=function(i){var o,l;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,o=i.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(l=o.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),o.putImageData(l,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function HX(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,s=t[e++],i=s>>7,o=1<<(7&s)+1;t[e++],t[e++];var l=null,c=null;i&&(l=e,c=o,e+=3*o);var u=!0,d=[],h=0,g=null,m=0,w=null;for(this.width=r,this.height=n;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,w=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((S=t[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var _=t[e++];h=t[e++]|t[e++]<<8,g=t[e++],!(1&_)&&(g=null),m=_>>2&7,e++;break;case 254:for(;;){if(!((S=t[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var T=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,x=t[e++]|t[e++]<<8,P=t[e++],F=P>>6&1,$=1<<(7&P)+1,k=l,A=c,I=!1;P>>7&&(I=!0,k=e,A=$,e+=3*$);var O=e;for(e++;;){var S;if(!((S=t[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}d.push({x:T,y:v,width:b,height:x,has_local_palette:I,palette_offset:k,palette_size:A,data_offset:O,data_length:e-O,transparent_index:g,interlaced:!!F,delay:h,disposal:m});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return w},this.frameInfo=function(R){if(R<0||R>=d.length)throw new Error("Frame index out of range.");return d[R]},this.decodeAndBlitFrameBGRA=function(R,C){var G=this.frameInfo(R),de=G.width*G.height,ne=new Uint8Array(de);X3(t,G.data_offset,ne,de);var X=G.palette_offset,Y=G.transparent_index;Y===null&&(Y=256);var Q=G.width,se=r-Q,Se=Q,U=4*(G.y*r+G.x),J=4*((G.y+G.height)*r+G.x),te=U,ie=4*se;G.interlaced===!0&&(ie+=4*r*7);for(var ue=8,ge=0,we=ne.length;ge<we;++ge){var be=ne[ge];if(Se===0&&(Se=Q,(te+=ie)>=J&&(ie=4*se+4*r*(ue-1),te=U+(Q+se)*(ue<<1),ue>>=1)),be===Y)te+=4;else{var Me=t[X+3*be],De=t[X+3*be+1],He=t[X+3*be+2];C[te++]=He,C[te++]=De,C[te++]=Me,C[te++]=255}--Se}},this.decodeAndBlitFrameRGBA=function(R,C){var G=this.frameInfo(R),de=G.width*G.height,ne=new Uint8Array(de);X3(t,G.data_offset,ne,de);var X=G.palette_offset,Y=G.transparent_index;Y===null&&(Y=256);var Q=G.width,se=r-Q,Se=Q,U=4*(G.y*r+G.x),J=4*((G.y+G.height)*r+G.x),te=U,ie=4*se;G.interlaced===!0&&(ie+=4*r*7);for(var ue=8,ge=0,we=ne.length;ge<we;++ge){var be=ne[ge];if(Se===0&&(Se=Q,(te+=ie)>=J&&(ie=4*se+4*r*(ue-1),te=U+(Q+se)*(ue<<1),ue>>=1)),be===Y)te+=4;else{var Me=t[X+3*be],De=t[X+3*be+1],He=t[X+3*be+2];C[te++]=Me,C[te++]=De,C[te++]=He,C[te++]=255}--Se}}}function X3(t,e,r,n){for(var s=t[e++],i=1<<s,o=i+1,l=o+1,c=s+1,u=(1<<c)-1,d=0,h=0,g=0,m=t[e++],w=new Int32Array(4096),_=null;;){for(;d<16&&m!==0;)h|=t[e++]<<d,d+=8,m===1?m=t[e++]:--m;if(d<c)break;var T=h&u;if(h>>=c,d-=c,T!==i){if(T===o)break;for(var v=T<l?T:_,b=0,x=v;x>i;)x=w[x]>>8,++b;var P=x;if(g+b+(v!==T?1:0)>n)return void yr.log("Warning, gif stream longer than expected.");r[g++]=P;var F=g+=b;for(v!==T&&(r[g++]=P),x=v;b--;)x=w[x],r[--F]=255&x,x>>=8;_!==null&&l<4096&&(w[l++]=_<<8|P,l>=u+1&&c<12&&(++c,u=u<<1|1)),_=T}else l=o+1,u=(1<<(c=s+1))-1,_=null}return g!==n&&yr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Lv(t){var e,r,n,s,i,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),h=new Array(65535),g=new Array(65535),m=new Array(64),w=new Array(64),_=[],T=0,v=7,b=new Array(64),x=new Array(64),P=new Array(64),F=new Array(256),$=new Array(2048),k=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],A=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],I=[0,1,2,3,4,5,6,7,8,9,10,11],O=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],S=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],R=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],C=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],de=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ne(U,J){for(var te=0,ie=0,ue=new Array,ge=1;ge<=16;ge++){for(var we=1;we<=U[ge];we++)ue[J[ie]]=[],ue[J[ie]][0]=te,ue[J[ie]][1]=ge,ie++,te++;te*=2}return ue}function X(U){for(var J=U[0],te=U[1]-1;te>=0;)J&1<<te&&(T|=1<<v),te--,--v<0&&(T==255?(Y(255),Y(0)):Y(T),v=7,T=0)}function Y(U){_.push(U)}function Q(U){Y(U>>8&255),Y(255&U)}function se(U,J,te,ie,ue){for(var ge,we=ue[0],be=ue[240],Me=function(Fe,ze){var Ye,Ke,lt,jt,Pt,Lt,xt,Rt,pt,Ft,Xe=0;for(pt=0;pt<8;++pt){Ye=Fe[Xe],Ke=Fe[Xe+1],lt=Fe[Xe+2],jt=Fe[Xe+3],Pt=Fe[Xe+4],Lt=Fe[Xe+5],xt=Fe[Xe+6];var Sn=Ye+(Rt=Fe[Xe+7]),Ut=Ye-Rt,Cs=Ke+xt,er=Ke-xt,cr=lt+Lt,Ti=lt-Lt,Xt=jt+Pt,ea=jt-Pt,Sr=Sn+Xt,Ps=Sn-Xt,ms=Cs+cr,vr=Cs-cr;Fe[Xe]=Sr+ms,Fe[Xe+4]=Sr-ms;var St=.707106781*(vr+Ps);Fe[Xe+2]=Ps+St,Fe[Xe+6]=Ps-St;var zt=.382683433*((Sr=ea+Ti)-(vr=er+Ut)),Da=.5411961*Sr+zt,$r=1.306562965*vr+zt,Zs=.707106781*(ms=Ti+er),Kn=Ut+Zs,ht=Ut-Zs;Fe[Xe+5]=ht+Da,Fe[Xe+3]=ht-Da,Fe[Xe+1]=Kn+$r,Fe[Xe+7]=Kn-$r,Xe+=8}for(Xe=0,pt=0;pt<8;++pt){Ye=Fe[Xe],Ke=Fe[Xe+8],lt=Fe[Xe+16],jt=Fe[Xe+24],Pt=Fe[Xe+32],Lt=Fe[Xe+40],xt=Fe[Xe+48];var mr=Ye+(Rt=Fe[Xe+56]),ei=Ye-Rt,ln=Ke+xt,Ar=Ke-xt,Wr=lt+Lt,ps=lt-Lt,ti=jt+Pt,ta=jt-Pt,ri=mr+ti,Yn=mr-ti,Rs=ln+Wr,Ds=ln-Wr;Fe[Xe]=ri+Rs,Fe[Xe+32]=ri-Rs;var Rn=.707106781*(Ds+Yn);Fe[Xe+16]=Yn+Rn,Fe[Xe+48]=Yn-Rn;var xn=.382683433*((ri=ta+ps)-(Ds=Ar+ei)),La=.5411961*ri+xn,bo=1.306562965*Ds+xn,Oa=.707106781*(Rs=ps+Ar),Ma=ei+Oa,wo=ei-Oa;Fe[Xe+40]=wo+La,Fe[Xe+24]=wo-La,Fe[Xe+8]=Ma+bo,Fe[Xe+56]=Ma-bo,Xe++}for(pt=0;pt<64;++pt)Ft=Fe[pt]*ze[pt],m[pt]=Ft>0?Ft+.5|0:Ft-.5|0;return m}(U,J),De=0;De<64;++De)w[k[De]]=Me[De];var He=w[0]-te;te=w[0],He==0?X(ie[0]):(X(ie[g[ge=32767+He]]),X(h[ge]));for(var $e=63;$e>0&&w[$e]==0;)$e--;if($e==0)return X(we),te;for(var dt,je=1;je<=$e;){for(var re=je;w[je]==0&&je<=$e;)++je;var kt=je-re;if(kt>=16){dt=kt>>4;for(var it=1;it<=dt;++it)X(be);kt&=15}ge=32767+w[je],X(ue[(kt<<4)+g[ge]]),X(h[ge]),je++}return $e!=63&&X(we),te}function Se(U){U=Math.min(Math.max(U,1),100),i!=U&&(function(J){for(var te=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ie=0;ie<64;ie++){var ue=o((te[ie]*J+50)/100);ue=Math.min(Math.max(ue,1),255),l[k[ie]]=ue}for(var ge=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],we=0;we<64;we++){var be=o((ge[we]*J+50)/100);be=Math.min(Math.max(be,1),255),c[k[we]]=be}for(var Me=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],De=0,He=0;He<8;He++)for(var $e=0;$e<8;$e++)u[De]=1/(l[k[De]]*Me[He]*Me[$e]*8),d[De]=1/(c[k[De]]*Me[He]*Me[$e]*8),De++}(U<50?Math.floor(5e3/U):Math.floor(200-2*U)),i=U)}this.encode=function(U,J){J&&Se(J),_=new Array,T=0,v=7,Q(65496),Q(65504),Q(16),Y(74),Y(70),Y(73),Y(70),Y(0),Y(1),Y(1),Y(0),Q(1),Q(1),Y(0),Y(0),function(){Q(65499),Q(132),Y(0);for(var Ke=0;Ke<64;Ke++)Y(l[Ke]);Y(1);for(var lt=0;lt<64;lt++)Y(c[lt])}(),function(Ke,lt){Q(65472),Q(17),Y(8),Q(lt),Q(Ke),Y(3),Y(1),Y(17),Y(0),Y(2),Y(17),Y(1),Y(3),Y(17),Y(1)}(U.width,U.height),function(){Q(65476),Q(418),Y(0);for(var Ke=0;Ke<16;Ke++)Y(A[Ke+1]);for(var lt=0;lt<=11;lt++)Y(I[lt]);Y(16);for(var jt=0;jt<16;jt++)Y(O[jt+1]);for(var Pt=0;Pt<=161;Pt++)Y(S[Pt]);Y(1);for(var Lt=0;Lt<16;Lt++)Y(R[Lt+1]);for(var xt=0;xt<=11;xt++)Y(C[xt]);Y(17);for(var Rt=0;Rt<16;Rt++)Y(G[Rt+1]);for(var pt=0;pt<=161;pt++)Y(de[pt])}(),Q(65498),Q(12),Y(3),Y(1),Y(0),Y(2),Y(17),Y(3),Y(17),Y(0),Y(63),Y(0);var te=0,ie=0,ue=0;T=0,v=7,this.encode.displayName="_encode_";for(var ge,we,be,Me,De,He,$e,dt,je,re=U.data,kt=U.width,it=U.height,Fe=4*kt,ze=0;ze<it;){for(ge=0;ge<Fe;){for(De=Fe*ze+ge,$e=-1,dt=0,je=0;je<64;je++)He=De+(dt=je>>3)*Fe+($e=4*(7&je)),ze+dt>=it&&(He-=Fe*(ze+1+dt-it)),ge+$e>=Fe&&(He-=ge+$e-Fe+4),we=re[He++],be=re[He++],Me=re[He++],b[je]=($[we]+$[be+256>>0]+$[Me+512>>0]>>16)-128,x[je]=($[we+768>>0]+$[be+1024>>0]+$[Me+1280>>0]>>16)-128,P[je]=($[we+1280>>0]+$[be+1536>>0]+$[Me+1792>>0]>>16)-128;te=se(b,u,te,e,n),ie=se(x,d,ie,r,s),ue=se(P,d,ue,r,s),ge+=32}ze+=8}if(v>=0){var Ye=[];Ye[1]=v+1,Ye[0]=(1<<v+1)-1,X(Ye)}return Q(65497),new Uint8Array(_)},t=t||50,function(){for(var U=String.fromCharCode,J=0;J<256;J++)F[J]=U(J)}(),e=ne(A,I),r=ne(R,C),n=ne(O,S),s=ne(G,de),function(){for(var U=1,J=2,te=1;te<=15;te++){for(var ie=U;ie<J;ie++)g[32767+ie]=te,h[32767+ie]=[],h[32767+ie][1]=te,h[32767+ie][0]=ie;for(var ue=-(J-1);ue<=-U;ue++)g[32767+ue]=te,h[32767+ue]=[],h[32767+ue][1]=te,h[32767+ue][0]=J-1+ue;U<<=1,J<<=1}}(),function(){for(var U=0;U<256;U++)$[U]=19595*U,$[U+256>>0]=38470*U,$[U+512>>0]=7471*U+32768,$[U+768>>0]=-11059*U,$[U+1024>>0]=-21709*U,$[U+1280>>0]=32768*U+8421375,$[U+1536>>0]=-27439*U,$[U+1792>>0]=-5329*U}(),Se(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ma(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Z3(t){function e(A){if(!A)throw Error("assert :P")}function r(A,I,O){for(var S=0;4>S;S++)if(A[I+S]!=O.charCodeAt(S))return!0;return!1}function n(A,I,O,S,R){for(var C=0;C<R;C++)A[I+C]=O[S+C]}function s(A,I,O,S){for(var R=0;R<S;R++)A[I+R]=O}function i(A){return new Int32Array(A)}function o(A,I){for(var O=[],S=0;S<A;S++)O.push(new I);return O}function l(A,I){var O=[];return function S(R,C,G){for(var de=G[C],ne=0;ne<de&&(R.push(G.length>C+1?[]:new I),!(G.length<C+1));ne++)S(R[ne],C+1,G)}(O,0,A),O}var c=function(){var A=this;function I(f,y){for(var j=1<<y-1>>>0;f&j;)j>>>=1;return j?(f&j-1)+j:f}function O(f,y,j,D,B){e(!(D%j));do f[y+(D-=j)]=B;while(0<D)}function S(f,y,j,D,B){if(e(2328>=B),512>=B)var z=i(512);else if((z=i(B))==null)return 0;return function(q,H,K,Z,le,xe){var ve,me,Ie=H,_e=1<<K,ce=i(16),fe=i(16);for(e(le!=0),e(Z!=null),e(q!=null),e(0<K),me=0;me<le;++me){if(15<Z[me])return 0;++ce[Z[me]]}if(ce[0]==le)return 0;for(fe[1]=0,ve=1;15>ve;++ve){if(ce[ve]>1<<ve)return 0;fe[ve+1]=fe[ve]+ce[ve]}for(me=0;me<le;++me)ve=Z[me],0<Z[me]&&(xe[fe[ve]++]=me);if(fe[15]==1)return(Z=new R).g=0,Z.value=xe[0],O(q,Ie,1,_e,Z),_e;var ke,Re=-1,Te=_e-1,et=0,Ge=1,gt=1,Qe=1<<K;for(me=0,ve=1,le=2;ve<=K;++ve,le<<=1){if(Ge+=gt<<=1,0>(gt-=ce[ve]))return 0;for(;0<ce[ve];--ce[ve])(Z=new R).g=ve,Z.value=xe[me++],O(q,Ie+et,le,Qe,Z),et=I(et,ve)}for(ve=K+1,le=2;15>=ve;++ve,le<<=1){if(Ge+=gt<<=1,0>(gt-=ce[ve]))return 0;for(;0<ce[ve];--ce[ve]){if(Z=new R,(et&Te)!=Re){for(Ie+=Qe,ke=1<<(Re=ve)-K;15>Re&&!(0>=(ke-=ce[Re]));)++Re,ke<<=1;_e+=Qe=1<<(ke=Re-K),q[H+(Re=et&Te)].g=ke+K,q[H+Re].value=Ie-H-Re}Z.g=ve-K,Z.value=xe[me++],O(q,Ie+(et>>K),le,Qe,Z),et=I(et,ve)}}return Ge!=2*fe[15]-1?0:_e}(f,y,j,D,B,z)}function R(){this.value=this.g=0}function C(){this.value=this.g=0}function G(){this.G=o(5,R),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Ln,C)}function de(f,y,j,D){e(f!=null),e(y!=null),e(2147483648>D),f.Ca=254,f.I=0,f.b=-8,f.Ka=0,f.oa=y,f.pa=j,f.Jd=y,f.Yc=j+D,f.Zc=4<=D?j+D-4+1:j,ge(f)}function ne(f,y){for(var j=0;0<y--;)j|=be(f,128)<<y;return j}function X(f,y){var j=ne(f,y);return we(f)?-j:j}function Y(f,y,j,D){var B,z=0;for(e(f!=null),e(y!=null),e(4294967288>D),f.Sb=D,f.Ra=0,f.u=0,f.h=0,4<D&&(D=4),B=0;B<D;++B)z+=y[j+B]<<8*B;f.Ra=z,f.bb=D,f.oa=y,f.pa=j}function Q(f){for(;8<=f.u&&f.bb<f.Sb;)f.Ra>>>=8,f.Ra+=f.oa[f.pa+f.bb]<<Md-8>>>0,++f.bb,f.u-=8;te(f)&&(f.h=1,f.u=0)}function se(f,y){if(e(0<=y),!f.h&&y<=Od){var j=J(f)&Ld[y];return f.u+=y,Q(f),j}return f.h=1,f.u=0}function Se(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function U(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function J(f){return f.Ra>>>(f.u&Md-1)>>>0}function te(f){return e(f.bb<=f.Sb),f.h||f.bb==f.Sb&&f.u>Md}function ie(f,y){f.u=y,f.h=te(f)}function ue(f){f.u>=Cf&&(e(f.u>=Cf),Q(f))}function ge(f){e(f!=null&&f.oa!=null),f.pa<f.Zc?(f.I=(f.oa[f.pa++]|f.I<<8)>>>0,f.b+=8):(e(f!=null&&f.oa!=null),f.pa<f.Yc?(f.b+=8,f.I=f.oa[f.pa++]|f.I<<8):f.Ka?f.b=0:(f.I<<=8,f.b+=8,f.Ka=1))}function we(f){return ne(f,1)}function be(f,y){var j=f.Ca;0>f.b&&ge(f);var D=f.b,B=j*y>>>8,z=(f.I>>>D>B)+0;for(z?(j-=B,f.I-=B+1<<D>>>0):j=B+1,D=j,B=0;256<=D;)B+=8,D>>=8;return D=7^B+Fs[D],f.b-=D,f.Ca=(j<<D)-1,z}function Me(f,y,j){f[y+0]=j>>24&255,f[y+1]=j>>16&255,f[y+2]=j>>8&255,f[y+3]=j>>0&255}function De(f,y){return f[y+0]<<0|f[y+1]<<8}function He(f,y){return De(f,y)|f[y+2]<<16}function $e(f,y){return De(f,y)|De(f,y+2)<<16}function dt(f,y){var j=1<<y;return e(f!=null),e(0<y),f.X=i(j),f.X==null?0:(f.Mb=32-y,f.Xa=y,1)}function je(f,y){e(f!=null),e(y!=null),e(f.Xa==y.Xa),n(y.X,0,f.X,0,1<<y.Xa)}function re(){this.X=[],this.Xa=this.Mb=0}function kt(f,y,j,D){e(j!=null),e(D!=null);var B=j[0],z=D[0];return B==0&&(B=(f*z+y/2)/y),z==0&&(z=(y*B+f/2)/f),0>=B||0>=z?0:(j[0]=B,D[0]=z,1)}function it(f,y){return f+(1<<y)-1>>>y}function Fe(f,y){return((4278255360&f)+(4278255360&y)>>>0&4278255360)+((16711935&f)+(16711935&y)>>>0&16711935)>>>0}function ze(f,y){A[y]=function(j,D,B,z,q,H,K){var Z;for(Z=0;Z<q;++Z){var le=A[f](H[K+Z-1],B,z+Z);H[K+Z]=Fe(j[D+Z],le)}}}function Ye(){this.ud=this.hd=this.jd=0}function Ke(f,y){return((4278124286&(f^y))>>>1)+(f&y)>>>0}function lt(f){return 0<=f&&256>f?f:0>f?0:255<f?255:void 0}function jt(f,y){return lt(f+(f-y+.5>>1))}function Pt(f,y,j){return Math.abs(y-j)-Math.abs(f-j)}function Lt(f,y,j,D,B,z,q){for(D=z[q-1],j=0;j<B;++j)z[q+j]=D=Fe(f[y+j],D)}function xt(f,y,j,D,B){var z;for(z=0;z<j;++z){var q=f[y+z],H=q>>8&255,K=16711935&(K=(K=16711935&q)+((H<<16)+H));D[B+z]=(4278255360&q)+K>>>0}}function Rt(f,y){y.jd=f>>0&255,y.hd=f>>8&255,y.ud=f>>16&255}function pt(f,y,j,D,B,z){var q;for(q=0;q<D;++q){var H=y[j+q],K=H>>>8,Z=H,le=255&(le=(le=H>>>16)+((f.jd<<24>>24)*(K<<24>>24)>>>5));Z=255&(Z=(Z=Z+((f.hd<<24>>24)*(K<<24>>24)>>>5))+((f.ud<<24>>24)*(le<<24>>24)>>>5)),B[z+q]=(4278255360&H)+(le<<16)+Z}}function Ft(f,y,j,D,B){A[y]=function(z,q,H,K,Z,le,xe,ve,me){for(K=xe;K<ve;++K)for(xe=0;xe<me;++xe)Z[le++]=B(H[D(z[q++])])},A[f]=function(z,q,H,K,Z,le,xe){var ve=8>>z.b,me=z.Ea,Ie=z.K[0],_e=z.w;if(8>ve)for(z=(1<<z.b)-1,_e=(1<<ve)-1;q<H;++q){var ce,fe=0;for(ce=0;ce<me;++ce)ce&z||(fe=D(K[Z++])),le[xe++]=B(Ie[fe&_e]),fe>>=ve}else A["VP8LMapColor"+j](K,Z,Ie,_e,le,xe,q,H,me)}}function Xe(f,y,j,D,B){for(j=y+j;y<j;){var z=f[y++];D[B++]=z>>16&255,D[B++]=z>>8&255,D[B++]=z>>0&255}}function Sn(f,y,j,D,B){for(j=y+j;y<j;){var z=f[y++];D[B++]=z>>16&255,D[B++]=z>>8&255,D[B++]=z>>0&255,D[B++]=z>>24&255}}function Ut(f,y,j,D,B){for(j=y+j;y<j;){var z=(q=f[y++])>>16&240|q>>12&15,q=q>>0&240|q>>28&15;D[B++]=z,D[B++]=q}}function Cs(f,y,j,D,B){for(j=y+j;y<j;){var z=(q=f[y++])>>16&248|q>>13&7,q=q>>5&224|q>>3&31;D[B++]=z,D[B++]=q}}function er(f,y,j,D,B){for(j=y+j;y<j;){var z=f[y++];D[B++]=z>>0&255,D[B++]=z>>8&255,D[B++]=z>>16&255}}function cr(f,y,j,D,B,z){if(z==0)for(j=y+j;y<j;)Me(D,((z=f[y++])[0]>>24|z[1]>>8&65280|z[2]<<8&16711680|z[3]<<24)>>>0),B+=32;else n(D,B,f,y,j)}function Ti(f,y){A[y][0]=A[f+"0"],A[y][1]=A[f+"1"],A[y][2]=A[f+"2"],A[y][3]=A[f+"3"],A[y][4]=A[f+"4"],A[y][5]=A[f+"5"],A[y][6]=A[f+"6"],A[y][7]=A[f+"7"],A[y][8]=A[f+"8"],A[y][9]=A[f+"9"],A[y][10]=A[f+"10"],A[y][11]=A[f+"11"],A[y][12]=A[f+"12"],A[y][13]=A[f+"13"],A[y][14]=A[f+"0"],A[y][15]=A[f+"0"]}function Xt(f){return f==i1||f==a1||f==ag||f==o1}function ea(){this.eb=[],this.size=this.A=this.fb=0}function Sr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Ps(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ea,this.f.kb=new Sr,this.sd=null}function ms(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function vr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function St(f){return alert("todo:WebPSamplerProcessPlane"),f.T}function zt(f,y){var j=f.T,D=y.ba.f.RGBA,B=D.eb,z=D.fb+f.ka*D.A,q=Ui[y.ba.S],H=f.y,K=f.O,Z=f.f,le=f.N,xe=f.ea,ve=f.W,me=y.cc,Ie=y.dc,_e=y.Mc,ce=y.Nc,fe=f.ka,ke=f.ka+f.T,Re=f.U,Te=Re+1>>1;for(fe==0?q(H,K,null,null,Z,le,xe,ve,Z,le,xe,ve,B,z,null,null,Re):(q(y.ec,y.fc,H,K,me,Ie,_e,ce,Z,le,xe,ve,B,z-D.A,B,z,Re),++j);fe+2<ke;fe+=2)me=Z,Ie=le,_e=xe,ce=ve,le+=f.Rc,ve+=f.Rc,z+=2*D.A,q(H,(K+=2*f.fa)-f.fa,H,K,me,Ie,_e,ce,Z,le,xe,ve,B,z-D.A,B,z,Re);return K+=f.fa,f.j+ke<f.o?(n(y.ec,y.fc,H,K,Re),n(y.cc,y.dc,Z,le,Te),n(y.Mc,y.Nc,xe,ve,Te),j--):1&ke||q(H,K,null,null,Z,le,xe,ve,Z,le,xe,ve,B,z+D.A,null,null,Re),j}function Da(f,y,j){var D=f.F,B=[f.J];if(D!=null){var z=f.U,q=y.ba.S,H=q==ig||q==ag;y=y.ba.f.RGBA;var K=[0],Z=f.ka;K[0]=f.T,f.Kb&&(Z==0?--K[0]:(--Z,B[0]-=f.width),f.j+f.ka+f.T==f.o&&(K[0]=f.o-f.j-Z));var le=y.eb;Z=y.fb+Z*y.A,f=wr(D,B[0],f.width,z,K,le,Z+(H?0:3),y.A),e(j==K),f&&Xt(q)&&Vi(le,Z,H,z,K,y.A)}return 0}function $r(f){var y=f.ma,j=y.ba.S,D=11>j,B=j==ng||j==sg||j==ig||j==s1||j==12||Xt(j);if(y.memory=null,y.Ib=null,y.Jb=null,y.Nd=null,!To(y.Oa,f,B?11:12))return 0;if(B&&Xt(j)&&Le(),f.da)alert("todo:use_scaling");else{if(D){if(y.Ib=St,f.Kb){if(j=f.U+1>>1,y.memory=i(f.U+2*j),y.memory==null)return 0;y.ec=y.memory,y.fc=0,y.cc=y.ec,y.dc=y.fc+f.U,y.Mc=y.cc,y.Nc=y.dc+j,y.Ib=zt,Le()}}else alert("todo:EmitYUV");B&&(y.Jb=Da,D&&pe())}if(D&&!qN){for(f=0;256>f;++f)SR[f]=89858*(f-128)+lg>>og,kR[f]=-22014*(f-128)+lg,ER[f]=-45773*(f-128),AR[f]=113618*(f-128)+lg>>og;for(f=Ff;f<u1;++f)y=76283*(f-16)+lg>>og,TR[f-Ff]=It(y,255),IR[f-Ff]=It(y+8>>4,15);qN=1}return 1}function Zs(f){var y=f.ma,j=f.U,D=f.T;return e(!(1&f.ka)),0>=j||0>=D?0:(j=y.Ib(f,y),y.Jb!=null&&y.Jb(f,y,j),y.Dc+=j,1)}function Kn(f){f.ma.memory=null}function ht(f,y,j,D){return se(f,8)!=47?0:(y[0]=se(f,14)+1,j[0]=se(f,14)+1,D[0]=se(f,1),se(f,3)!=0?0:!f.h)}function mr(f,y){if(4>f)return f+1;var j=f-2>>1;return(2+(1&f)<<j)+se(y,j)+1}function ei(f,y){return 120<y?y-120:1<=(j=((j=dR[y-1])>>4)*f+(8-(15&j)))?j:1;var j}function ln(f,y,j){var D=J(j),B=f[y+=255&D].g-8;return 0<B&&(ie(j,j.u+8),D=J(j),y+=f[y].value,y+=D&(1<<B)-1),ie(j,j.u+f[y].g),f[y].value}function Ar(f,y,j){return j.g+=f.g,j.value+=f.value<<y>>>0,e(8>=j.g),f.g}function Wr(f,y,j){var D=f.xc;return e((y=D==0?0:f.vc[f.md*(j>>D)+(y>>D)])<f.Wb),f.Ya[y]}function ps(f,y,j,D){var B=f.ab,z=f.c*y,q=f.C;y=q+y;var H=j,K=D;for(D=f.Ta,j=f.Ua;0<B--;){var Z=f.gc[B],le=q,xe=y,ve=H,me=K,Ie=(K=D,H=j,Z.Ea);switch(e(le<xe),e(xe<=Z.nc),Z.hc){case 2:Qp(ve,me,(xe-le)*Ie,K,H);break;case 0:var _e=le,ce=xe,fe=K,ke=H,Re=(Qe=Z).Ea;_e==0&&(r1(ve,me,null,null,1,fe,ke),Lt(ve,me+1,0,0,Re-1,fe,ke+1),me+=Re,ke+=Re,++_e);for(var Te=1<<Qe.b,et=Te-1,Ge=it(Re,Qe.b),gt=Qe.K,Qe=Qe.w+(_e>>Qe.b)*Ge;_e<ce;){var Zt=gt,nr=Qe,Yt=1;for(Pf(ve,me,fe,ke-Re,1,fe,ke);Yt<Re;){var $t=(Yt&~et)+Te;$t>Re&&($t=Re),(0,Fl[Zt[nr++]>>8&15])(ve,me+ +Yt,fe,ke+Yt-Re,$t-Yt,fe,ke+Yt),Yt=$t}me+=Re,ke+=Re,++_e&et||(Qe+=Ge)}xe!=Z.nc&&n(K,H-Ie,K,H+(xe-le-1)*Ie,Ie);break;case 1:for(Ie=ve,ce=me,Re=(ve=Z.Ea)-(ke=ve&~(fe=(me=1<<Z.b)-1)),_e=it(ve,Z.b),Te=Z.K,Z=Z.w+(le>>Z.b)*_e;le<xe;){for(et=Te,Ge=Z,gt=new Ye,Qe=ce+ke,Zt=ce+ve;ce<Qe;)Rt(et[Ge++],gt),wu(gt,Ie,ce,me,K,H),ce+=me,H+=me;ce<Zt&&(Rt(et[Ge++],gt),wu(gt,Ie,ce,Re,K,H),ce+=Re,H+=Re),++le&fe||(Z+=_e)}break;case 3:if(ve==K&&me==H&&0<Z.b){for(ce=K,ve=Ie=H+(xe-le)*Ie-(ke=(xe-le)*it(Z.Ea,Z.b)),me=K,fe=H,_e=[],ke=(Re=ke)-1;0<=ke;--ke)_e[ke]=me[fe+ke];for(ke=Re-1;0<=ke;--ke)ce[ve+ke]=_e[ke];Oi(Z,le,xe,K,Ie,K,H)}else Oi(Z,le,xe,ve,me,K,H)}H=D,K=j}K!=j&&n(D,j,H,K,z)}function ti(f,y){var j=f.V,D=f.Ba+f.c*f.C,B=y-f.C;if(e(y<=f.l.o),e(16>=B),0<B){var z=f.l,q=f.Ta,H=f.Ua,K=z.width;if(ps(f,B,j,D),B=H=[H],e((j=f.C)<(D=y)),e(z.v<z.va),D>z.o&&(D=z.o),j<z.j){var Z=z.j-j;j=z.j,B[0]+=Z*K}if(j>=D?j=0:(B[0]+=4*z.v,z.ka=j-z.j,z.U=z.va-z.v,z.T=D-j,j=1),j){if(H=H[0],11>(j=f.ca).S){var le=j.f.RGBA,xe=(D=j.S,B=z.U,z=z.T,Z=le.eb,le.A),ve=z;for(le=le.fb+f.Ma*le.A;0<ve--;){var me=q,Ie=H,_e=B,ce=Z,fe=le;switch(D){case rg:Vs(me,Ie,_e,ce,fe);break;case ng:xs(me,Ie,_e,ce,fe);break;case i1:xs(me,Ie,_e,ce,fe),Vi(ce,fe,0,_e,1,0);break;case RN:Co(me,Ie,_e,ce,fe);break;case sg:cr(me,Ie,_e,ce,fe,1);break;case a1:cr(me,Ie,_e,ce,fe,1),Vi(ce,fe,0,_e,1,0);break;case ig:cr(me,Ie,_e,ce,fe,0);break;case ag:cr(me,Ie,_e,ce,fe,0),Vi(ce,fe,1,_e,1,0);break;case s1:Vl(me,Ie,_e,ce,fe);break;case o1:Vl(me,Ie,_e,ce,fe),br(ce,fe,_e,1,0);break;case DN:Io(me,Ie,_e,ce,fe);break;default:e(0)}H+=K,le+=xe}f.Ma+=z}else alert("todo:EmitRescaledRowsYUVA");e(f.Ma<=j.height)}}f.C=y,e(f.C<=f.i)}function ta(f){var y;if(0<f.ua)return 0;for(y=0;y<f.Wb;++y){var j=f.Ya[y].G,D=f.Ya[y].H;if(0<j[1][D[1]+0].g||0<j[2][D[2]+0].g||0<j[3][D[3]+0].g)return 0}return 1}function ri(f,y,j,D,B,z){if(f.Z!=0){var q=f.qd,H=f.rd;for(e(ql[f.Z]!=null);y<j;++y)ql[f.Z](q,H,D,B,D,B,z),q=D,H=B,B+=z;f.qd=q,f.rd=H}}function Yn(f,y){var j=f.l.ma,D=j.Z==0||j.Z==1?f.l.j:f.C;if(D=f.C<D?D:f.C,e(y<=f.l.o),y>D){var B=f.l.width,z=j.ca,q=j.tb+B*D,H=f.V,K=f.Ba+f.c*D,Z=f.gc;e(f.ab==1),e(Z[0].hc==3),Jp(Z[0],D,y,H,K,z,q),ri(j,D,y,z,q,B)}f.C=f.Ma=y}function Rs(f,y,j,D,B,z,q){var H=f.$/D,K=f.$%D,Z=f.m,le=f.s,xe=j+f.$,ve=xe;B=j+D*B;var me=j+D*z,Ie=280+le.ua,_e=f.Pb?H:16777216,ce=0<le.ua?le.Wa:null,fe=le.wc,ke=xe<me?Wr(le,K,H):null;e(f.C<z),e(me<=B);var Re=!1;e:for(;;){for(;Re||xe<me;){var Te=0;if(H>=_e){var et=xe-j;e((_e=f).Pb),_e.wd=_e.m,_e.xd=et,0<_e.s.ua&&je(_e.s.Wa,_e.s.vb),_e=H+fR}if(K&fe||(ke=Wr(le,K,H)),e(ke!=null),ke.Qb&&(y[xe]=ke.qb,Re=!0),!Re)if(ue(Z),ke.jc){Te=Z,et=y;var Ge=xe,gt=ke.pd[J(Te)&Ln-1];e(ke.jc),256>gt.g?(ie(Te,Te.u+gt.g),et[Ge]=gt.value,Te=0):(ie(Te,Te.u+gt.g-256),e(256<=gt.value),Te=gt.value),Te==0&&(Re=!0)}else Te=ln(ke.G[0],ke.H[0],Z);if(Z.h)break;if(Re||256>Te){if(!Re)if(ke.nd)y[xe]=(ke.qb|Te<<8)>>>0;else{if(ue(Z),Re=ln(ke.G[1],ke.H[1],Z),ue(Z),et=ln(ke.G[2],ke.H[2],Z),Ge=ln(ke.G[3],ke.H[3],Z),Z.h)break;y[xe]=(Ge<<24|Re<<16|Te<<8|et)>>>0}if(Re=!1,++xe,++K>=D&&(K=0,++H,q!=null&&H<=z&&!(H%16)&&q(f,H),ce!=null))for(;ve<xe;)Te=y[ve++],ce.X[(506832829*Te&4294967295)>>>ce.Mb]=Te}else if(280>Te){if(Te=mr(Te-256,Z),et=ln(ke.G[4],ke.H[4],Z),ue(Z),et=ei(D,et=mr(et,Z)),Z.h)break;if(xe-j<et||B-xe<Te)break e;for(Ge=0;Ge<Te;++Ge)y[xe+Ge]=y[xe+Ge-et];for(xe+=Te,K+=Te;K>=D;)K-=D,++H,q!=null&&H<=z&&!(H%16)&&q(f,H);if(e(xe<=B),K&fe&&(ke=Wr(le,K,H)),ce!=null)for(;ve<xe;)Te=y[ve++],ce.X[(506832829*Te&4294967295)>>>ce.Mb]=Te}else{if(!(Te<Ie))break e;for(Re=Te-280,e(ce!=null);ve<xe;)Te=y[ve++],ce.X[(506832829*Te&4294967295)>>>ce.Mb]=Te;Te=xe,e(!(Re>>>(et=ce).Xa)),y[Te]=et.X[Re],Re=!0}Re||e(Z.h==te(Z))}if(f.Pb&&Z.h&&xe<B)e(f.m.h),f.a=5,f.m=f.wd,f.$=f.xd,0<f.s.ua&&je(f.s.vb,f.s.Wa);else{if(Z.h)break e;q!=null&&q(f,H>z?z:H),f.a=0,f.$=xe-j}return 1}return f.a=3,0}function Ds(f){e(f!=null),f.vc=null,f.yc=null,f.Ya=null;var y=f.Wa;y!=null&&(y.X=null),f.vb=null,e(f!=null)}function Rn(){var f=new bu;return f==null?null:(f.a=0,f.xb=MN,Ti("Predictor","VP8LPredictors"),Ti("Predictor","VP8LPredictors_C"),Ti("PredictorAdd","VP8LPredictorsAdd"),Ti("PredictorAdd","VP8LPredictorsAdd_C"),Qp=xt,wu=pt,Vs=Xe,xs=Sn,Vl=Ut,Io=Cs,Co=er,A.VP8LMapColor32b=Fd,A.VP8LMapColor8b=Xp,f)}function xn(f,y,j,D,B){var z=1,q=[f],H=[y],K=D.m,Z=D.s,le=null,xe=0;e:for(;;){if(j)for(;z&&se(K,1);){var ve=q,me=H,Ie=D,_e=1,ce=Ie.m,fe=Ie.gc[Ie.ab],ke=se(ce,2);if(Ie.Oc&1<<ke)z=0;else{switch(Ie.Oc|=1<<ke,fe.hc=ke,fe.Ea=ve[0],fe.nc=me[0],fe.K=[null],++Ie.ab,e(4>=Ie.ab),ke){case 0:case 1:fe.b=se(ce,3)+2,_e=xn(it(fe.Ea,fe.b),it(fe.nc,fe.b),0,Ie,fe.K),fe.K=fe.K[0];break;case 3:var Re,Te=se(ce,8)+1,et=16<Te?0:4<Te?1:2<Te?2:3;if(ve[0]=it(fe.Ea,et),fe.b=et,Re=_e=xn(Te,1,0,Ie,fe.K)){var Ge,gt=Te,Qe=fe,Zt=1<<(8>>Qe.b),nr=i(Zt);if(nr==null)Re=0;else{var Yt=Qe.K[0],$t=Qe.w;for(nr[0]=Qe.K[0][0],Ge=1;Ge<1*gt;++Ge)nr[Ge]=Fe(Yt[$t+Ge],nr[Ge-1]);for(;Ge<4*Zt;++Ge)nr[Ge]=0;Qe.K[0]=null,Qe.K[0]=nr,Re=1}}_e=Re;break;case 2:break;default:e(0)}z=_e}}if(q=q[0],H=H[0],z&&se(K,1)&&!(z=1<=(xe=se(K,4))&&11>=xe)){D.a=3;break e}var gr;if(gr=z)t:{var dr,Ot,cn,Bs=D,un=q,Us=H,sr=xe,ui=j,di=Bs.m,An=Bs.s,On=[null],bs=1,zi=0,Ua=hR[sr];r:for(;;){if(ui&&se(di,1)){var En=se(di,3)+2,Lo=it(un,En),Au=it(Us,En),qd=Lo*Au;if(!xn(Lo,Au,0,Bs,On))break r;for(On=On[0],An.xc=En,dr=0;dr<qd;++dr){var $l=On[dr]>>8&65535;On[dr]=$l,$l>=bs&&(bs=$l+1)}}if(di.h)break r;for(Ot=0;5>Ot;++Ot){var Gr=LN[Ot];!Ot&&0<sr&&(Gr+=1<<sr),zi<Gr&&(zi=Gr)}var d1=o(bs*Ua,R),HN=bs,GN=o(HN,G);if(GN==null)var ug=null;else e(65536>=HN),ug=GN;var Vf=i(zi);if(ug==null||Vf==null||d1==null){Bs.a=1;break r}var dg=d1;for(dr=cn=0;dr<bs;++dr){var da=ug[dr],$d=da.G,Wd=da.H,KN=0,hg=1,YN=0;for(Ot=0;5>Ot;++Ot){Gr=LN[Ot],$d[Ot]=dg,Wd[Ot]=cn,!Ot&&0<sr&&(Gr+=1<<sr);s:{var fg,h1=Gr,mg=Bs,Bf=Vf,RR=dg,DR=cn,f1=0,Wl=mg.m,LR=se(Wl,1);if(s(Bf,0,0,h1),LR){var OR=se(Wl,1)+1,MR=se(Wl,1),QN=se(Wl,MR==0?1:8);Bf[QN]=1,OR==2&&(Bf[QN=se(Wl,8)]=1);var pg=1}else{var JN=i(19),XN=se(Wl,4)+4;if(19<XN){mg.a=3;var gg=0;break s}for(fg=0;fg<XN;++fg)JN[uR[fg]]=se(Wl,3);var m1=void 0,Uf=void 0,ZN=mg,FR=JN,yg=h1,e_=Bf,p1=0,Hl=ZN.m,t_=8,r_=o(128,R);n:for(;S(r_,0,7,FR,19);){if(se(Hl,1)){var VR=2+2*se(Hl,3);if((m1=2+se(Hl,VR))>yg)break n}else m1=yg;for(Uf=0;Uf<yg&&m1--;){ue(Hl);var n_=r_[0+(127&J(Hl))];ie(Hl,Hl.u+n_.g);var Hd=n_.value;if(16>Hd)e_[Uf++]=Hd,Hd!=0&&(t_=Hd);else{var BR=Hd==16,s_=Hd-16,UR=lR[s_],i_=se(Hl,oR[s_])+UR;if(Uf+i_>yg)break n;for(var zR=BR?t_:0;0<i_--;)e_[Uf++]=zR}}p1=1;break n}p1||(ZN.a=3),pg=p1}(pg=pg&&!Wl.h)&&(f1=S(RR,DR,8,Bf,h1)),pg&&f1!=0?gg=f1:(mg.a=3,gg=0)}if(gg==0)break r;if(hg&&cR[Ot]==1&&(hg=dg[cn].g==0),KN+=dg[cn].g,cn+=gg,3>=Ot){var zf,g1=Vf[0];for(zf=1;zf<Gr;++zf)Vf[zf]>g1&&(g1=Vf[zf]);YN+=g1}}if(da.nd=hg,da.Qb=0,hg&&(da.qb=($d[3][Wd[3]+0].value<<24|$d[1][Wd[1]+0].value<<16|$d[2][Wd[2]+0].value)>>>0,KN==0&&256>$d[0][Wd[0]+0].value&&(da.Qb=1,da.qb+=$d[0][Wd[0]+0].value<<8)),da.jc=!da.Qb&&6>YN,da.jc){var xg,Oo=da;for(xg=0;xg<Ln;++xg){var Gl=xg,Kl=Oo.pd[Gl],vg=Oo.G[0][Oo.H[0]+Gl];256<=vg.value?(Kl.g=vg.g+256,Kl.value=vg.value):(Kl.g=0,Kl.value=0,Gl>>=Ar(vg,8,Kl),Gl>>=Ar(Oo.G[1][Oo.H[1]+Gl],16,Kl),Gl>>=Ar(Oo.G[2][Oo.H[2]+Gl],0,Kl),Ar(Oo.G[3][Oo.H[3]+Gl],24,Kl))}}}An.vc=On,An.Wb=bs,An.Ya=ug,An.yc=d1,gr=1;break t}gr=0}if(!(z=gr)){D.a=3;break e}if(0<xe){if(Z.ua=1<<xe,!dt(Z.Wa,xe)){D.a=1,z=0;break e}}else Z.ua=0;var y1=D,a_=q,qR=H,x1=y1.s,v1=x1.xc;if(y1.c=a_,y1.i=qR,x1.md=it(a_,v1),x1.wc=v1==0?-1:(1<<v1)-1,j){D.xb=bR;break e}if((le=i(q*H))==null){D.a=1,z=0;break e}z=(z=Rs(D,le,0,q,H,H,null))&&!K.h;break e}return z?(B!=null?B[0]=le:(e(le==null),e(j)),D.$=0,j||Ds(Z)):Ds(Z),z}function La(f,y){var j=f.c*f.i,D=j+y+16*y;return e(f.c<=y),f.V=i(D),f.V==null?(f.Ta=null,f.Ua=0,f.a=1,0):(f.Ta=f.V,f.Ua=f.Ba+j+y,1)}function bo(f,y){var j=f.C,D=y-j,B=f.V,z=f.Ba+f.c*j;for(e(y<=f.l.o);0<D;){var q=16<D?16:D,H=f.l.ma,K=f.l.width,Z=K*q,le=H.ca,xe=H.tb+K*j,ve=f.Ta,me=f.Ua;ps(f,q,B,z),tn(ve,me,le,xe,Z),ri(H,j,j+q,le,xe,K),D-=q,B+=q*f.c,j+=q}e(j==y),f.C=f.Ma=y}function Oa(){this.ub=this.yd=this.td=this.Rb=0}function Ma(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function wo(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function ou(){this.Yb=function(){var f=[];return function y(j,D,B){for(var z=B[D],q=0;q<z&&(j.push(B.length>D+1?[]:0),!(B.length<D+1));q++)y(j[q],D+1,B)}(f,0,[3,11]),f}()}function Af(){this.jb=i(3),this.Wc=l([4,8],ou),this.Xc=l([4,17],ou)}function _l(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function No(){this.ld=this.La=this.dd=this.tc=0}function jl(){this.Na=this.la=0}function _o(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ni(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function lu(){this.uc=this.M=this.Nb=0,this.wa=Array(new No),this.Y=0,this.ya=Array(new ni),this.aa=0,this.l=new jo}function Nd(){this.y=i(16),this.f=i(8),this.ea=i(8)}function _d(){this.cb=this.a=0,this.sc="",this.m=new Se,this.Od=new Oa,this.Kc=new Ma,this.ed=new _l,this.Qa=new wo,this.Ic=this.$c=this.Aa=0,this.D=new lu,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,Se),this.ia=0,this.pb=o(4,_o),this.Pa=new Af,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Nd),this.Hd=0,this.rb=Array(new jl),this.sb=0,this.wa=Array(new No),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ni),this.L=this.aa=0,this.gd=l([4,2],No),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function jo(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function jd(){var f=new _d;return f!=null&&(f.a=0,f.sc="OK",f.cb=0,f.Xb=0,Mf||(Mf=uu)),f}function Er(f,y,j){return f.a==0&&(f.a=y,f.sc=j,f.cb=0),0}function Sl(f,y,j){return 3<=j&&f[y+0]==157&&f[y+1]==1&&f[y+2]==42}function cu(f,y){if(f==null)return 0;if(f.a=0,f.sc="OK",y==null)return Er(f,2,"null VP8Io passed to VP8GetHeaders()");var j=y.data,D=y.w,B=y.ha;if(4>B)return Er(f,7,"Truncated header.");var z=j[D+0]|j[D+1]<<8|j[D+2]<<16,q=f.Od;if(q.Rb=!(1&z),q.td=z>>1&7,q.yd=z>>4&1,q.ub=z>>5,3<q.td)return Er(f,3,"Incorrect keyframe parameters.");if(!q.yd)return Er(f,4,"Frame not displayable.");D+=3,B-=3;var H=f.Kc;if(q.Rb){if(7>B)return Er(f,7,"cannot parse picture header");if(!Sl(j,D,B))return Er(f,3,"Bad code word");H.c=16383&(j[D+4]<<8|j[D+3]),H.Td=j[D+4]>>6,H.i=16383&(j[D+6]<<8|j[D+5]),H.Ud=j[D+6]>>6,D+=7,B-=7,f.za=H.c+15>>4,f.Ub=H.i+15>>4,y.width=H.c,y.height=H.i,y.Da=0,y.j=0,y.v=0,y.va=y.width,y.o=y.height,y.da=0,y.ib=y.width,y.hb=y.height,y.U=y.width,y.T=y.height,s((z=f.Pa).jb,0,255,z.jb.length),e((z=f.Qa)!=null),z.Cb=0,z.Bb=0,z.Fb=1,s(z.Zb,0,0,z.Zb.length),s(z.Lb,0,0,z.Lb)}if(q.ub>B)return Er(f,7,"bad partition length");de(z=f.m,j,D,q.ub),D+=q.ub,B-=q.ub,q.Rb&&(H.Ld=we(z),H.Kd=we(z)),H=f.Qa;var K,Z=f.Pa;if(e(z!=null),e(H!=null),H.Cb=we(z),H.Cb){if(H.Bb=we(z),we(z)){for(H.Fb=we(z),K=0;4>K;++K)H.Zb[K]=we(z)?X(z,7):0;for(K=0;4>K;++K)H.Lb[K]=we(z)?X(z,6):0}if(H.Bb)for(K=0;3>K;++K)Z.jb[K]=we(z)?ne(z,8):255}else H.Bb=0;if(z.Ka)return Er(f,3,"cannot parse segment header");if((H=f.ed).zd=we(z),H.Tb=ne(z,6),H.wb=ne(z,3),H.Pc=we(z),H.Pc&&we(z)){for(Z=0;4>Z;++Z)we(z)&&(H.vd[Z]=X(z,6));for(Z=0;4>Z;++Z)we(z)&&(H.od[Z]=X(z,6))}if(f.L=H.Tb==0?0:H.zd?1:2,z.Ka)return Er(f,3,"cannot parse filter header");var le=B;if(B=K=D,D=K+le,H=le,f.Xb=(1<<ne(f.m,2))-1,le<3*(Z=f.Xb))j=7;else{for(K+=3*Z,H-=3*Z,le=0;le<Z;++le){var xe=j[B+0]|j[B+1]<<8|j[B+2]<<16;xe>H&&(xe=H),de(f.Jc[+le],j,K,xe),K+=xe,H-=xe,B+=3}de(f.Jc[+Z],j,K,H),j=K<D?0:5}if(j!=0)return Er(f,j,"cannot parse partitions");for(j=ne(K=f.m,7),B=we(K)?X(K,4):0,D=we(K)?X(K,4):0,H=we(K)?X(K,4):0,Z=we(K)?X(K,4):0,K=we(K)?X(K,4):0,le=f.Qa,xe=0;4>xe;++xe){if(le.Cb){var ve=le.Zb[xe];le.Fb||(ve+=j)}else{if(0<xe){f.pb[xe]=f.pb[0];continue}ve=j}var me=f.pb[xe];me.Sc[0]=l1[It(ve+B,127)],me.Sc[1]=c1[It(ve+0,127)],me.Eb[0]=2*l1[It(ve+D,127)],me.Eb[1]=101581*c1[It(ve+H,127)]>>16,8>me.Eb[1]&&(me.Eb[1]=8),me.Qc[0]=l1[It(ve+Z,117)],me.Qc[1]=c1[It(ve+K,127)],me.lc=ve+K}if(!q.Rb)return Er(f,4,"Not a key frame.");for(we(z),q=f.Pa,j=0;4>j;++j){for(B=0;8>B;++B)for(D=0;3>D;++D)for(H=0;11>H;++H)Z=be(z,xR[j][B][D][H])?ne(z,8):gR[j][B][D][H],q.Wc[j][B].Yb[D][H]=Z;for(B=0;17>B;++B)q.Xc[j][B]=q.Wc[j][vR[B]]}return f.kc=we(z),f.kc&&(f.Bd=ne(z,8)),f.cb=1}function uu(f,y,j,D,B,z,q){var H=y[B].Yb[j];for(j=0;16>B;++B){if(!be(f,H[j+0]))return B;for(;!be(f,H[j+1]);)if(H=y[++B].Yb[0],j=0,B==16)return 16;var K=y[B+1].Yb;if(be(f,H[j+2])){var Z=f,le=0;if(be(Z,(ve=H)[(xe=j)+3]))if(be(Z,ve[xe+6])){for(H=0,xe=2*(le=be(Z,ve[xe+8]))+(ve=be(Z,ve[xe+9+le])),le=0,ve=mR[xe];ve[H];++H)le+=le+be(Z,ve[H]);le+=3+(8<<xe)}else be(Z,ve[xe+7])?(le=7+2*be(Z,165),le+=be(Z,145)):le=5+be(Z,159);else le=be(Z,ve[xe+4])?3+be(Z,ve[xe+5]):2;H=K[2]}else le=1,H=K[1];K=q+pR[B],0>(Z=f).b&&ge(Z);var xe,ve=Z.b,me=(xe=Z.Ca>>1)-(Z.I>>ve)>>31;--Z.b,Z.Ca+=me,Z.Ca|=1,Z.I-=(xe+1&me)<<ve,z[K]=((le^me)-me)*D[(0<B)+0]}return 16}function du(f){var y=f.rb[f.sb-1];y.la=0,y.Na=0,s(f.zc,0,0,f.zc.length),f.ja=0}function Ef(f,y){if(f==null)return 0;if(y==null)return Er(f,2,"NULL VP8Io parameter in VP8Decode().");if(!f.cb&&!cu(f,y))return 0;if(e(f.cb),y.ac==null||y.ac(y)){y.ob&&(f.L=0);var j=cg[f.L];if(f.L==2?(f.yb=0,f.zb=0):(f.yb=y.v-j>>4,f.zb=y.j-j>>4,0>f.yb&&(f.yb=0),0>f.zb&&(f.zb=0)),f.Va=y.o+15+j>>4,f.Hb=y.va+15+j>>4,f.Hb>f.za&&(f.Hb=f.za),f.Va>f.Ub&&(f.Va=f.Ub),0<f.L){var D=f.ed;for(j=0;4>j;++j){var B;if(f.Qa.Cb){var z=f.Qa.Lb[j];f.Qa.Fb||(z+=D.Tb)}else z=D.Tb;for(B=0;1>=B;++B){var q=f.gd[j][B],H=z;if(D.Pc&&(H+=D.vd[0],B&&(H+=D.od[0])),0<(H=0>H?0:63<H?63:H)){var K=H;0<D.wb&&(K=4<D.wb?K>>2:K>>1)>9-D.wb&&(K=9-D.wb),1>K&&(K=1),q.dd=K,q.tc=2*H+K,q.ld=40<=H?2:15<=H?1:0}else q.tc=0;q.La=B}}}j=0}else Er(f,6,"Frame setup failed"),j=f.a;if(j=j==0){if(j){f.$c=0,0<f.Aa||(f.Ic=PR);e:{j=f.Ic,D=4*(K=f.za);var Z=32*K,le=K+1,xe=0<f.L?K*(0<f.Aa?2:1):0,ve=(f.Aa==2?2:1)*K;if((q=D+832+(B=3*(16*j+cg[f.L])/2*Z)+(z=f.Fa!=null&&0<f.Fa.length?f.Kc.c*f.Kc.i:0))!=q)j=0;else{if(q>f.Vb){if(f.Vb=0,f.Ec=i(q),f.Fc=0,f.Ec==null){j=Er(f,1,"no memory during frame initialization.");break e}f.Vb=q}q=f.Ec,H=f.Fc,f.Ac=q,f.Bc=H,H+=D,f.Gd=o(Z,Nd),f.Hd=0,f.rb=o(le+1,jl),f.sb=1,f.wa=xe?o(xe,No):null,f.Y=0,f.D.Nb=0,f.D.wa=f.wa,f.D.Y=f.Y,0<f.Aa&&(f.D.Y+=K),e(!0),f.oc=q,f.pc=H,H+=832,f.ya=o(ve,ni),f.aa=0,f.D.ya=f.ya,f.D.aa=f.aa,f.Aa==2&&(f.D.aa+=K),f.R=16*K,f.B=8*K,K=(Z=cg[f.L])*f.R,Z=Z/2*f.B,f.sa=q,f.ta=H+K,f.qa=f.sa,f.ra=f.ta+16*j*f.R+Z,f.Ha=f.qa,f.Ia=f.ra+8*j*f.B+Z,f.$c=0,H+=B,f.mb=z?q:null,f.nb=z?H:null,e(H+z<=f.Fc+f.Vb),du(f),s(f.Ac,f.Bc,0,D),j=1}}if(j){if(y.ka=0,y.y=f.sa,y.O=f.ta,y.f=f.qa,y.N=f.ra,y.ea=f.Ha,y.Vd=f.Ia,y.fa=f.R,y.Rc=f.B,y.F=null,y.J=0,!eg){for(j=-255;255>=j;++j)vn[255+j]=0>j?-j:j;for(j=-1020;1020>=j;++j)Ro[1020+j]=-128>j?-128:127<j?127:j;for(j=-112;112>=j;++j)Of[112+j]=-16>j?-16:15<j?15:j;for(j=-255;510>=j;++j)zd[255+j]=0>j?0:255<j?255:j;eg=1}Vd=El,Po=Al,Rf=Ao,vs=Sd,Mi=tr,en=Os,Bd=aa,Zp=Va,Df=Rd,Nu=Ba,_u=yu,Bl=oa,ju=xu,Ud=vu,Su=gu,Ul=ys,Lf=Pi,Fi=ai,ua[0]=Ci,ua[1]=Eo,ua[2]=kd,ua[3]=Fa,ua[4]=Td,ua[5]=gs,ua[6]=Id,ua[7]=fu,ua[8]=Il,ua[9]=Tf,zl[0]=Ed,zl[1]=Ad,zl[2]=na,zl[3]=kl,zl[4]=Hr,zl[5]=Ii,zl[6]=hu,Do[0]=Ms,Do[1]=kf,Do[2]=Cl,Do[3]=Pl,Do[4]=sa,Do[5]=Cd,Do[6]=ur,j=1}else j=0}j&&(j=function(me,Ie){for(me.M=0;me.M<me.Va;++me.M){var _e,ce=me.Jc[me.M&me.Xb],fe=me.m,ke=me;for(_e=0;_e<ke.za;++_e){var Re=fe,Te=ke,et=Te.Ac,Ge=Te.Bc+4*_e,gt=Te.zc,Qe=Te.ya[Te.aa+_e];if(Te.Qa.Bb?Qe.$b=be(Re,Te.Pa.jb[0])?2+be(Re,Te.Pa.jb[2]):be(Re,Te.Pa.jb[1]):Qe.$b=0,Te.kc&&(Qe.Ad=be(Re,Te.Bd)),Qe.Za=!be(Re,145)+0,Qe.Za){var Zt=Qe.Ob,nr=0;for(Te=0;4>Te;++Te){var Yt,$t=gt[0+Te];for(Yt=0;4>Yt;++Yt){$t=yR[et[Ge+Yt]][$t];for(var gr=ON[be(Re,$t[0])];0<gr;)gr=ON[2*gr+be(Re,$t[gr])];$t=-gr,et[Ge+Yt]=$t}n(Zt,nr,et,Ge,4),nr+=4,gt[0+Te]=$t}}else $t=be(Re,156)?be(Re,128)?1:3:be(Re,163)?2:0,Qe.Ob[0]=$t,s(et,Ge,$t,4),s(gt,0,$t,4);Qe.Dd=be(Re,142)?be(Re,114)?be(Re,183)?1:3:2:0}if(ke.m.Ka)return Er(me,7,"Premature end-of-partition0 encountered.");for(;me.ja<me.za;++me.ja){if(ke=ce,Re=(fe=me).rb[fe.sb-1],et=fe.rb[fe.sb+fe.ja],_e=fe.ya[fe.aa+fe.ja],Ge=fe.kc?_e.Ad:0)Re.la=et.la=0,_e.Za||(Re.Na=et.Na=0),_e.Hc=0,_e.Gc=0,_e.ia=0;else{var dr,Ot;if(Re=et,et=ke,Ge=fe.Pa.Xc,gt=fe.ya[fe.aa+fe.ja],Qe=fe.pb[gt.$b],Te=gt.ad,Zt=0,nr=fe.rb[fe.sb-1],$t=Yt=0,s(Te,Zt,0,384),gt.Za)var cn=0,Bs=Ge[3];else{gr=i(16);var un=Re.Na+nr.Na;if(un=Mf(et,Ge[1],un,Qe.Eb,0,gr,0),Re.Na=nr.Na=(0<un)+0,1<un)Vd(gr,0,Te,Zt);else{var Us=gr[0]+3>>3;for(gr=0;256>gr;gr+=16)Te[Zt+gr]=Us}cn=1,Bs=Ge[0]}var sr=15&Re.la,ui=15&nr.la;for(gr=0;4>gr;++gr){var di=1&ui;for(Us=Ot=0;4>Us;++Us)sr=sr>>1|(di=(un=Mf(et,Bs,un=di+(1&sr),Qe.Sc,cn,Te,Zt))>cn)<<7,Ot=Ot<<2|(3<un?3:1<un?2:Te[Zt+0]!=0),Zt+=16;sr>>=4,ui=ui>>1|di<<7,Yt=(Yt<<8|Ot)>>>0}for(Bs=sr,cn=ui>>4,dr=0;4>dr;dr+=2){for(Ot=0,sr=Re.la>>4+dr,ui=nr.la>>4+dr,gr=0;2>gr;++gr){for(di=1&ui,Us=0;2>Us;++Us)un=di+(1&sr),sr=sr>>1|(di=0<(un=Mf(et,Ge[2],un,Qe.Qc,0,Te,Zt)))<<3,Ot=Ot<<2|(3<un?3:1<un?2:Te[Zt+0]!=0),Zt+=16;sr>>=2,ui=ui>>1|di<<5}$t|=Ot<<4*dr,Bs|=sr<<4<<dr,cn|=(240&ui)<<dr}Re.la=Bs,nr.la=cn,gt.Hc=Yt,gt.Gc=$t,gt.ia=43690&$t?0:Qe.ia,Ge=!(Yt|$t)}if(0<fe.L&&(fe.wa[fe.Y+fe.ja]=fe.gd[_e.$b][_e.Za],fe.wa[fe.Y+fe.ja].La|=!Ge),ke.Ka)return Er(me,7,"Premature end-of-file encountered.")}if(du(me),fe=Ie,ke=1,_e=(ce=me).D,Re=0<ce.L&&ce.M>=ce.zb&&ce.M<=ce.Va,ce.Aa==0)e:{if(_e.M=ce.M,_e.uc=Re,Dn(ce,_e),ke=1,_e=(Ot=ce.D).Nb,Re=($t=cg[ce.L])*ce.R,et=$t/2*ce.B,gr=16*_e*ce.R,Us=8*_e*ce.B,Ge=ce.sa,gt=ce.ta-Re+gr,Qe=ce.qa,Te=ce.ra-et+Us,Zt=ce.Ha,nr=ce.Ia-et+Us,ui=(sr=Ot.M)==0,Yt=sr>=ce.Va-1,ce.Aa==2&&Dn(ce,Ot),Ot.uc)for(di=(un=ce).D.M,e(un.D.uc),Ot=un.yb;Ot<un.Hb;++Ot){cn=Ot,Bs=di;var An=(On=(Gr=un).D).Nb;dr=Gr.R;var On=On.wa[On.Y+cn],bs=Gr.sa,zi=Gr.ta+16*An*dr+16*cn,Ua=On.dd,En=On.tc;if(En!=0)if(e(3<=En),Gr.L==1)0<cn&&Ul(bs,zi,dr,En+4),On.La&&Fi(bs,zi,dr,En),0<Bs&&Su(bs,zi,dr,En+4),On.La&&Lf(bs,zi,dr,En);else{var Lo=Gr.B,Au=Gr.qa,qd=Gr.ra+8*An*Lo+8*cn,$l=Gr.Ha,Gr=Gr.Ia+8*An*Lo+8*cn;An=On.ld,0<cn&&(Zp(bs,zi,dr,En+4,Ua,An),Nu(Au,qd,$l,Gr,Lo,En+4,Ua,An)),On.La&&(Bl(bs,zi,dr,En,Ua,An),Ud(Au,qd,$l,Gr,Lo,En,Ua,An)),0<Bs&&(Bd(bs,zi,dr,En+4,Ua,An),Df(Au,qd,$l,Gr,Lo,En+4,Ua,An)),On.La&&(_u(bs,zi,dr,En,Ua,An),ju(Au,qd,$l,Gr,Lo,En,Ua,An))}}if(ce.ia&&alert("todo:DitherRow"),fe.put!=null){if(Ot=16*sr,sr=16*(sr+1),ui?(fe.y=ce.sa,fe.O=ce.ta+gr,fe.f=ce.qa,fe.N=ce.ra+Us,fe.ea=ce.Ha,fe.W=ce.Ia+Us):(Ot-=$t,fe.y=Ge,fe.O=gt,fe.f=Qe,fe.N=Te,fe.ea=Zt,fe.W=nr),Yt||(sr-=$t),sr>fe.o&&(sr=fe.o),fe.F=null,fe.J=null,ce.Fa!=null&&0<ce.Fa.length&&Ot<sr&&(fe.J=li(ce,fe,Ot,sr-Ot),fe.F=ce.mb,fe.F==null&&fe.F.length==0)){ke=Er(ce,3,"Could not decode alpha data.");break e}Ot<fe.j&&($t=fe.j-Ot,Ot=fe.j,e(!(1&$t)),fe.O+=ce.R*$t,fe.N+=ce.B*($t>>1),fe.W+=ce.B*($t>>1),fe.F!=null&&(fe.J+=fe.width*$t)),Ot<sr&&(fe.O+=fe.v,fe.N+=fe.v>>1,fe.W+=fe.v>>1,fe.F!=null&&(fe.J+=fe.v),fe.ka=Ot-fe.j,fe.U=fe.va-fe.v,fe.T=sr-Ot,ke=fe.put(fe))}_e+1!=ce.Ic||Yt||(n(ce.sa,ce.ta-Re,Ge,gt+16*ce.R,Re),n(ce.qa,ce.ra-et,Qe,Te+8*ce.B,et),n(ce.Ha,ce.Ia-et,Zt,nr+8*ce.B,et))}if(!ke)return Er(me,6,"Output aborted.")}return 1}(f,y)),y.bc!=null&&y.bc(y),j&=1}return j?(f.cb=0,j):0}function Ls(f,y,j,D,B){B=f[y+j+32*D]+(B>>3),f[y+j+32*D]=-256&B?0>B?0:255:B}function So(f,y,j,D,B,z){Ls(f,y,0,j,D+B),Ls(f,y,1,j,D+z),Ls(f,y,2,j,D-z),Ls(f,y,3,j,D-B)}function Qn(f){return(20091*f>>16)+f}function si(f,y,j,D){var B,z=0,q=i(16);for(B=0;4>B;++B){var H=f[y+0]+f[y+8],K=f[y+0]-f[y+8],Z=(35468*f[y+4]>>16)-Qn(f[y+12]),le=Qn(f[y+4])+(35468*f[y+12]>>16);q[z+0]=H+le,q[z+1]=K+Z,q[z+2]=K-Z,q[z+3]=H-le,z+=4,y++}for(B=z=0;4>B;++B)H=(f=q[z+0]+4)+q[z+8],K=f-q[z+8],Z=(35468*q[z+4]>>16)-Qn(q[z+12]),Ls(j,D,0,0,H+(le=Qn(q[z+4])+(35468*q[z+12]>>16))),Ls(j,D,1,0,K+Z),Ls(j,D,2,0,K-Z),Ls(j,D,3,0,H-le),z++,D+=32}function Os(f,y,j,D){var B=f[y+0]+4,z=35468*f[y+4]>>16,q=Qn(f[y+4]),H=35468*f[y+1]>>16;So(j,D,0,B+q,f=Qn(f[y+1]),H),So(j,D,1,B+z,f,H),So(j,D,2,B-z,f,H),So(j,D,3,B-q,f,H)}function Al(f,y,j,D,B){si(f,y,j,D),B&&si(f,y+16,j,D+4)}function Ao(f,y,j,D){Po(f,y+0,j,D,1),Po(f,y+32,j,D+128,1)}function Sd(f,y,j,D){var B;for(f=f[y+0]+4,B=0;4>B;++B)for(y=0;4>y;++y)Ls(j,D,y,B,f)}function tr(f,y,j,D){f[y+0]&&vs(f,y+0,j,D),f[y+16]&&vs(f,y+16,j,D+4),f[y+32]&&vs(f,y+32,j,D+128),f[y+48]&&vs(f,y+48,j,D+128+4)}function El(f,y,j,D){var B,z=i(16);for(B=0;4>B;++B){var q=f[y+0+B]+f[y+12+B],H=f[y+4+B]+f[y+8+B],K=f[y+4+B]-f[y+8+B],Z=f[y+0+B]-f[y+12+B];z[0+B]=q+H,z[8+B]=q-H,z[4+B]=Z+K,z[12+B]=Z-K}for(B=0;4>B;++B)q=(f=z[0+4*B]+3)+z[3+4*B],H=z[1+4*B]+z[2+4*B],K=z[1+4*B]-z[2+4*B],Z=f-z[3+4*B],j[D+0]=q+H>>3,j[D+16]=Z+K>>3,j[D+32]=q-H>>3,j[D+48]=Z-K>>3,D+=64}function ra(f,y,j){var D,B=y-32,z=ci,q=255-f[B-1];for(D=0;D<j;++D){var H,K=z,Z=q+f[y-1];for(H=0;H<j;++H)f[y+H]=K[Z+f[B+H]];y+=32}}function Eo(f,y){ra(f,y,4)}function kf(f,y){ra(f,y,8)}function Ad(f,y){ra(f,y,16)}function na(f,y){var j;for(j=0;16>j;++j)n(f,y+32*j,f,y-32,16)}function kl(f,y){var j;for(j=16;0<j;--j)s(f,y,f[y-1],16),y+=32}function Tl(f,y,j){var D;for(D=0;16>D;++D)s(y,j+32*D,f,16)}function Ed(f,y){var j,D=16;for(j=0;16>j;++j)D+=f[y-1+32*j]+f[y+j-32];Tl(D>>5,f,y)}function Hr(f,y){var j,D=8;for(j=0;16>j;++j)D+=f[y-1+32*j];Tl(D>>4,f,y)}function Ii(f,y){var j,D=8;for(j=0;16>j;++j)D+=f[y+j-32];Tl(D>>4,f,y)}function hu(f,y){Tl(128,f,y)}function At(f,y,j){return f+2*y+j+2>>2}function kd(f,y){var j,D=y-32;for(D=new Uint8Array([At(f[D-1],f[D+0],f[D+1]),At(f[D+0],f[D+1],f[D+2]),At(f[D+1],f[D+2],f[D+3]),At(f[D+2],f[D+3],f[D+4])]),j=0;4>j;++j)n(f,y+32*j,D,0,D.length)}function Fa(f,y){var j=f[y-1],D=f[y-1+32],B=f[y-1+64],z=f[y-1+96];Me(f,y+0,16843009*At(f[y-1-32],j,D)),Me(f,y+32,16843009*At(j,D,B)),Me(f,y+64,16843009*At(D,B,z)),Me(f,y+96,16843009*At(B,z,z))}function Ci(f,y){var j,D=4;for(j=0;4>j;++j)D+=f[y+j-32]+f[y-1+32*j];for(D>>=3,j=0;4>j;++j)s(f,y+32*j,D,4)}function Td(f,y){var j=f[y-1+0],D=f[y-1+32],B=f[y-1+64],z=f[y-1-32],q=f[y+0-32],H=f[y+1-32],K=f[y+2-32],Z=f[y+3-32];f[y+0+96]=At(D,B,f[y-1+96]),f[y+1+96]=f[y+0+64]=At(j,D,B),f[y+2+96]=f[y+1+64]=f[y+0+32]=At(z,j,D),f[y+3+96]=f[y+2+64]=f[y+1+32]=f[y+0+0]=At(q,z,j),f[y+3+64]=f[y+2+32]=f[y+1+0]=At(H,q,z),f[y+3+32]=f[y+2+0]=At(K,H,q),f[y+3+0]=At(Z,K,H)}function Id(f,y){var j=f[y+1-32],D=f[y+2-32],B=f[y+3-32],z=f[y+4-32],q=f[y+5-32],H=f[y+6-32],K=f[y+7-32];f[y+0+0]=At(f[y+0-32],j,D),f[y+1+0]=f[y+0+32]=At(j,D,B),f[y+2+0]=f[y+1+32]=f[y+0+64]=At(D,B,z),f[y+3+0]=f[y+2+32]=f[y+1+64]=f[y+0+96]=At(B,z,q),f[y+3+32]=f[y+2+64]=f[y+1+96]=At(z,q,H),f[y+3+64]=f[y+2+96]=At(q,H,K),f[y+3+96]=At(H,K,K)}function gs(f,y){var j=f[y-1+0],D=f[y-1+32],B=f[y-1+64],z=f[y-1-32],q=f[y+0-32],H=f[y+1-32],K=f[y+2-32],Z=f[y+3-32];f[y+0+0]=f[y+1+64]=z+q+1>>1,f[y+1+0]=f[y+2+64]=q+H+1>>1,f[y+2+0]=f[y+3+64]=H+K+1>>1,f[y+3+0]=K+Z+1>>1,f[y+0+96]=At(B,D,j),f[y+0+64]=At(D,j,z),f[y+0+32]=f[y+1+96]=At(j,z,q),f[y+1+32]=f[y+2+96]=At(z,q,H),f[y+2+32]=f[y+3+96]=At(q,H,K),f[y+3+32]=At(H,K,Z)}function fu(f,y){var j=f[y+0-32],D=f[y+1-32],B=f[y+2-32],z=f[y+3-32],q=f[y+4-32],H=f[y+5-32],K=f[y+6-32],Z=f[y+7-32];f[y+0+0]=j+D+1>>1,f[y+1+0]=f[y+0+64]=D+B+1>>1,f[y+2+0]=f[y+1+64]=B+z+1>>1,f[y+3+0]=f[y+2+64]=z+q+1>>1,f[y+0+32]=At(j,D,B),f[y+1+32]=f[y+0+96]=At(D,B,z),f[y+2+32]=f[y+1+96]=At(B,z,q),f[y+3+32]=f[y+2+96]=At(z,q,H),f[y+3+64]=At(q,H,K),f[y+3+96]=At(H,K,Z)}function Tf(f,y){var j=f[y-1+0],D=f[y-1+32],B=f[y-1+64],z=f[y-1+96];f[y+0+0]=j+D+1>>1,f[y+2+0]=f[y+0+32]=D+B+1>>1,f[y+2+32]=f[y+0+64]=B+z+1>>1,f[y+1+0]=At(j,D,B),f[y+3+0]=f[y+1+32]=At(D,B,z),f[y+3+32]=f[y+1+64]=At(B,z,z),f[y+3+64]=f[y+2+64]=f[y+0+96]=f[y+1+96]=f[y+2+96]=f[y+3+96]=z}function Il(f,y){var j=f[y-1+0],D=f[y-1+32],B=f[y-1+64],z=f[y-1+96],q=f[y-1-32],H=f[y+0-32],K=f[y+1-32],Z=f[y+2-32];f[y+0+0]=f[y+2+32]=j+q+1>>1,f[y+0+32]=f[y+2+64]=D+j+1>>1,f[y+0+64]=f[y+2+96]=B+D+1>>1,f[y+0+96]=z+B+1>>1,f[y+3+0]=At(H,K,Z),f[y+2+0]=At(q,H,K),f[y+1+0]=f[y+3+32]=At(j,q,H),f[y+1+32]=f[y+3+64]=At(D,j,q),f[y+1+64]=f[y+3+96]=At(B,D,j),f[y+1+96]=At(z,B,D)}function Cl(f,y){var j;for(j=0;8>j;++j)n(f,y+32*j,f,y-32,8)}function Pl(f,y){var j;for(j=0;8>j;++j)s(f,y,f[y-1],8),y+=32}function ii(f,y,j){var D;for(D=0;8>D;++D)s(y,j+32*D,f,8)}function Ms(f,y){var j,D=8;for(j=0;8>j;++j)D+=f[y+j-32]+f[y-1+32*j];ii(D>>4,f,y)}function Cd(f,y){var j,D=4;for(j=0;8>j;++j)D+=f[y+j-32];ii(D>>3,f,y)}function sa(f,y){var j,D=4;for(j=0;8>j;++j)D+=f[y-1+32*j];ii(D>>3,f,y)}function ur(f,y){ii(128,f,y)}function Rl(f,y,j){var D=f[y-j],B=f[y+0],z=3*(B-D)+n1[1020+f[y-2*j]-f[y+j]],q=tg[112+(z+4>>3)];f[y-j]=ci[255+D+tg[112+(z+3>>3)]],f[y+0]=ci[255+B-q]}function Pd(f,y,j,D){var B=f[y+0],z=f[y+j];return Bi[255+f[y-2*j]-f[y-j]]>D||Bi[255+z-B]>D}function mu(f,y,j,D){return 4*Bi[255+f[y-j]-f[y+0]]+Bi[255+f[y-2*j]-f[y+j]]<=D}function pu(f,y,j,D,B){var z=f[y-3*j],q=f[y-2*j],H=f[y-j],K=f[y+0],Z=f[y+j],le=f[y+2*j],xe=f[y+3*j];return 4*Bi[255+H-K]+Bi[255+q-Z]>D?0:Bi[255+f[y-4*j]-z]<=B&&Bi[255+z-q]<=B&&Bi[255+q-H]<=B&&Bi[255+xe-le]<=B&&Bi[255+le-Z]<=B&&Bi[255+Z-K]<=B}function gu(f,y,j,D){var B=2*D+1;for(D=0;16>D;++D)mu(f,y+D,j,B)&&Rl(f,y+D,j)}function ys(f,y,j,D){var B=2*D+1;for(D=0;16>D;++D)mu(f,y+D*j,1,B)&&Rl(f,y+D*j,1)}function Pi(f,y,j,D){var B;for(B=3;0<B;--B)gu(f,y+=4*j,j,D)}function ai(f,y,j,D){var B;for(B=3;0<B;--B)ys(f,y+=4,j,D)}function ia(f,y,j,D,B,z,q,H){for(z=2*z+1;0<B--;){if(pu(f,y,j,z,q))if(Pd(f,y,j,H))Rl(f,y,j);else{var K=f,Z=y,le=j,xe=K[Z-2*le],ve=K[Z-le],me=K[Z+0],Ie=K[Z+le],_e=K[Z+2*le],ce=27*(ke=n1[1020+3*(me-ve)+n1[1020+xe-Ie]])+63>>7,fe=18*ke+63>>7,ke=9*ke+63>>7;K[Z-3*le]=ci[255+K[Z-3*le]+ke],K[Z-2*le]=ci[255+xe+fe],K[Z-le]=ci[255+ve+ce],K[Z+0]=ci[255+me-ce],K[Z+le]=ci[255+Ie-fe],K[Z+2*le]=ci[255+_e-ke]}y+=D}}function oi(f,y,j,D,B,z,q,H){for(z=2*z+1;0<B--;){if(pu(f,y,j,z,q))if(Pd(f,y,j,H))Rl(f,y,j);else{var K=f,Z=y,le=j,xe=K[Z-le],ve=K[Z+0],me=K[Z+le],Ie=tg[112+((_e=3*(ve-xe))+4>>3)],_e=tg[112+(_e+3>>3)],ce=Ie+1>>1;K[Z-2*le]=ci[255+K[Z-2*le]+ce],K[Z-le]=ci[255+xe+_e],K[Z+0]=ci[255+ve-Ie],K[Z+le]=ci[255+me-ce]}y+=D}}function aa(f,y,j,D,B,z){ia(f,y,j,1,16,D,B,z)}function Va(f,y,j,D,B,z){ia(f,y,1,j,16,D,B,z)}function yu(f,y,j,D,B,z){var q;for(q=3;0<q;--q)oi(f,y+=4*j,j,1,16,D,B,z)}function oa(f,y,j,D,B,z){var q;for(q=3;0<q;--q)oi(f,y+=4,1,j,16,D,B,z)}function Rd(f,y,j,D,B,z,q,H){ia(f,y,B,1,8,z,q,H),ia(j,D,B,1,8,z,q,H)}function Ba(f,y,j,D,B,z,q,H){ia(f,y,1,B,8,z,q,H),ia(j,D,1,B,8,z,q,H)}function xu(f,y,j,D,B,z,q,H){oi(f,y+4*B,B,1,8,z,q,H),oi(j,D+4*B,B,1,8,z,q,H)}function vu(f,y,j,D,B,z,q,H){oi(f,y+4,1,B,8,z,q,H),oi(j,D+4,1,B,8,z,q,H)}function Ri(){this.ba=new Ps,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new vr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Dl(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ll(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ol(){this.ua=0,this.Wa=new re,this.vb=new re,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new G,this.yc=new R}function bu(){this.xb=this.a=0,this.l=new jo,this.ca=new Ps,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new U,this.Pb=0,this.wd=new U,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ol,this.ab=0,this.gc=o(4,Ll),this.Oc=0}function ko(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new jo,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Di(f,y,j,D,B,z,q){for(f=f==null?0:f[y+0],y=0;y<q;++y)B[z+y]=f+j[D+y]&255,f=B[z+y]}function Ml(f,y,j,D,B,z,q){var H;if(f==null)Di(null,null,j,D,B,z,q);else for(H=0;H<q;++H)B[z+H]=f[y+H]+j[D+H]&255}function la(f,y,j,D,B,z,q){if(f==null)Di(null,null,j,D,B,z,q);else{var H,K=f[y+0],Z=K,le=K;for(H=0;H<q;++H)Z=le+(K=f[y+H])-Z,le=j[D+H]+(-256&Z?0>Z?0:255:Z)&255,Z=K,B[z+H]=le}}function li(f,y,j,D){var B=y.width,z=y.o;if(e(f!=null&&y!=null),0>j||0>=D||j+D>z)return null;if(!f.Cc){if(f.ga==null){var q;if(f.ga=new ko,(q=f.ga==null)||(q=y.width*y.o,e(f.Gb.length==0),f.Gb=i(q),f.Uc=0,f.Gb==null?q=0:(f.mb=f.Gb,f.nb=f.Uc,f.rc=null,q=1),q=!q),!q){q=f.ga;var H=f.Fa,K=f.P,Z=f.qc,le=f.mb,xe=f.nb,ve=K+1,me=Z-1,Ie=q.l;if(e(H!=null&&le!=null&&y!=null),ql[0]=null,ql[1]=Di,ql[2]=Ml,ql[3]=la,q.ca=le,q.tb=xe,q.c=y.width,q.i=y.height,e(0<q.c&&0<q.i),1>=Z)y=0;else if(q.$a=H[K+0]>>0&3,q.Z=H[K+0]>>2&3,q.Lc=H[K+0]>>4&3,K=H[K+0]>>6&3,0>q.$a||1<q.$a||4<=q.Z||1<q.Lc||K)y=0;else if(Ie.put=Zs,Ie.ac=$r,Ie.bc=Kn,Ie.ma=q,Ie.width=y.width,Ie.height=y.height,Ie.Da=y.Da,Ie.v=y.v,Ie.va=y.va,Ie.j=y.j,Ie.o=y.o,q.$a)e:{e(q.$a==1),y=Rn();t:for(;;){if(y==null){y=0;break e}if(e(q!=null),q.mc=y,y.c=q.c,y.i=q.i,y.l=q.l,y.l.ma=q,y.l.width=q.c,y.l.height=q.i,y.a=0,Y(y.m,H,ve,me),!xn(q.c,q.i,1,y,null)||(y.ab==1&&y.gc[0].hc==3&&ta(y.s)?(q.ic=1,H=y.c*y.i,y.Ta=null,y.Ua=0,y.V=i(H),y.Ba=0,y.V==null?(y.a=1,y=0):y=1):(q.ic=0,y=La(y,q.c)),!y))break t;y=1;break e}q.mc=null,y=0}else y=me>=q.c*q.i;q=!y}if(q)return null;f.ga.Lc!=1?f.Ga=0:D=z-j}e(f.ga!=null),e(j+D<=z);e:{if(y=(H=f.ga).c,z=H.l.o,H.$a==0){if(ve=f.rc,me=f.Vc,Ie=f.Fa,K=f.P+1+j*y,Z=f.mb,le=f.nb+j*y,e(K<=f.P+f.qc),H.Z!=0)for(e(ql[H.Z]!=null),q=0;q<D;++q)ql[H.Z](ve,me,Ie,K,Z,le,y),ve=Z,me=le,le+=y,K+=y;else for(q=0;q<D;++q)n(Z,le,Ie,K,y),ve=Z,me=le,le+=y,K+=y;f.rc=ve,f.Vc=me}else{if(e(H.mc!=null),y=j+D,e((q=H.mc)!=null),e(y<=q.i),q.C>=y)y=1;else if(H.ic||pe(),H.ic){H=q.V,ve=q.Ba,me=q.c;var _e=q.i,ce=(Ie=1,K=q.$/me,Z=q.$%me,le=q.m,xe=q.s,q.$),fe=me*_e,ke=me*y,Re=xe.wc,Te=ce<ke?Wr(xe,Z,K):null;e(ce<=fe),e(y<=_e),e(ta(xe));t:for(;;){for(;!le.h&&ce<ke;){if(Z&Re||(Te=Wr(xe,Z,K)),e(Te!=null),ue(le),256>(_e=ln(Te.G[0],Te.H[0],le)))H[ve+ce]=_e,++ce,++Z>=me&&(Z=0,++K<=y&&!(K%16)&&Yn(q,K));else{if(!(280>_e)){Ie=0;break t}_e=mr(_e-256,le);var et,Ge=ln(Te.G[4],Te.H[4],le);if(ue(le),!(ce>=(Ge=ei(me,Ge=mr(Ge,le)))&&fe-ce>=_e)){Ie=0;break t}for(et=0;et<_e;++et)H[ve+ce+et]=H[ve+ce+et-Ge];for(ce+=_e,Z+=_e;Z>=me;)Z-=me,++K<=y&&!(K%16)&&Yn(q,K);ce<ke&&Z&Re&&(Te=Wr(xe,Z,K))}e(le.h==te(le))}Yn(q,K>y?y:K);break t}!Ie||le.h&&ce<fe?(Ie=0,q.a=le.h?5:3):q.$=ce,y=Ie}else y=Rs(q,q.V,q.Ba,q.c,q.i,y,bo);if(!y){D=0;break e}}j+D>=z&&(f.Cc=1),D=1}if(!D)return null;if(f.Cc&&((D=f.ga)!=null&&(D.mc=null),f.ga=null,0<f.Ga))return alert("todo:WebPDequantizeLevels"),null}return f.nb+j*B}function N(f,y,j,D,B,z){for(;0<B--;){var q,H=f,K=y+(j?1:0),Z=f,le=y+(j?0:3);for(q=0;q<D;++q){var xe=Z[le+4*q];xe!=255&&(xe*=32897,H[K+4*q+0]=H[K+4*q+0]*xe>>23,H[K+4*q+1]=H[K+4*q+1]*xe>>23,H[K+4*q+2]=H[K+4*q+2]*xe>>23)}y+=z}}function V(f,y,j,D,B){for(;0<D--;){var z;for(z=0;z<j;++z){var q=f[y+2*z+0],H=15&(Z=f[y+2*z+1]),K=4369*H,Z=(240&Z|Z>>4)*K>>16;f[y+2*z+0]=(240&q|q>>4)*K>>16&240|(15&q|q<<4)*K>>16>>4&15,f[y+2*z+1]=240&Z|H}y+=B}}function ee(f,y,j,D,B,z,q,H){var K,Z,le=255;for(Z=0;Z<B;++Z){for(K=0;K<D;++K){var xe=f[y+K];z[q+4*K]=xe,le&=xe}y+=j,q+=H}return le!=255}function ae(f,y,j,D,B){var z;for(z=0;z<B;++z)j[D+z]=f[y+z]>>8}function pe(){Vi=N,br=V,wr=ee,tn=ae}function Ne(f,y,j){A[f]=function(D,B,z,q,H,K,Z,le,xe,ve,me,Ie,_e,ce,fe,ke,Re){var Te,et=Re-1>>1,Ge=H[K+0]|Z[le+0]<<16,gt=xe[ve+0]|me[Ie+0]<<16;e(D!=null);var Qe=3*Ge+gt+131074>>2;for(y(D[B+0],255&Qe,Qe>>16,_e,ce),z!=null&&(Qe=3*gt+Ge+131074>>2,y(z[q+0],255&Qe,Qe>>16,fe,ke)),Te=1;Te<=et;++Te){var Zt=H[K+Te]|Z[le+Te]<<16,nr=xe[ve+Te]|me[Ie+Te]<<16,Yt=Ge+Zt+gt+nr+524296,$t=Yt+2*(Zt+gt)>>3;Qe=$t+Ge>>1,Ge=(Yt=Yt+2*(Ge+nr)>>3)+Zt>>1,y(D[B+2*Te-1],255&Qe,Qe>>16,_e,ce+(2*Te-1)*j),y(D[B+2*Te-0],255&Ge,Ge>>16,_e,ce+(2*Te-0)*j),z!=null&&(Qe=Yt+gt>>1,Ge=$t+nr>>1,y(z[q+2*Te-1],255&Qe,Qe>>16,fe,ke+(2*Te-1)*j),y(z[q+2*Te+0],255&Ge,Ge>>16,fe,ke+(2*Te+0)*j)),Ge=Zt,gt=nr}1&Re||(Qe=3*Ge+gt+131074>>2,y(D[B+Re-1],255&Qe,Qe>>16,_e,ce+(Re-1)*j),z!=null&&(Qe=3*gt+Ge+131074>>2,y(z[q+Re-1],255&Qe,Qe>>16,fe,ke+(Re-1)*j)))}}function Le(){Ui[rg]=wR,Ui[ng]=FN,Ui[RN]=NR,Ui[sg]=VN,Ui[ig]=BN,Ui[s1]=UN,Ui[DN]=_R,Ui[i1]=FN,Ui[a1]=VN,Ui[ag]=BN,Ui[o1]=UN}function Ze(f){return f&~jR?0>f?0:255:f>>zN}function at(f,y){return Ze((19077*f>>8)+(26149*y>>8)-14234)}function p(f,y,j){return Ze((19077*f>>8)-(6419*y>>8)-(13320*j>>8)+8708)}function E(f,y){return Ze((19077*f>>8)+(33050*y>>8)-17685)}function L(f,y,j,D,B){D[B+0]=at(f,j),D[B+1]=p(f,y,j),D[B+2]=E(f,y)}function W(f,y,j,D,B){D[B+0]=E(f,y),D[B+1]=p(f,y,j),D[B+2]=at(f,j)}function he(f,y,j,D,B){var z=p(f,y,j);y=z<<3&224|E(f,y)>>3,D[B+0]=248&at(f,j)|z>>5,D[B+1]=y}function ye(f,y,j,D,B){var z=240&E(f,y)|15;D[B+0]=240&at(f,j)|p(f,y,j)>>4,D[B+1]=z}function Oe(f,y,j,D,B){D[B+0]=255,L(f,y,j,D,B+1)}function Tt(f,y,j,D,B){W(f,y,j,D,B),D[B+3]=255}function rr(f,y,j,D,B){L(f,y,j,D,B),D[B+3]=255}function It(f,y){return 0>f?0:f>y?y:f}function pr(f,y,j){A[f]=function(D,B,z,q,H,K,Z,le,xe){for(var ve=le+(-2&xe)*j;le!=ve;)y(D[B+0],z[q+0],H[K+0],Z,le),y(D[B+1],z[q+0],H[K+0],Z,le+j),B+=2,++q,++K,le+=2*j;1&xe&&y(D[B+0],z[q+0],H[K+0],Z,le)}}function Zr(f,y,j){return j==0?f==0?y==0?6:5:y==0?4:0:j}function Li(f,y,j,D,B){switch(f>>>30){case 3:Po(y,j,D,B,0);break;case 2:en(y,j,D,B);break;case 1:vs(y,j,D,B)}}function Dn(f,y){var j,D,B=y.M,z=y.Nb,q=f.oc,H=f.pc+40,K=f.oc,Z=f.pc+584,le=f.oc,xe=f.pc+600;for(j=0;16>j;++j)q[H+32*j-1]=129;for(j=0;8>j;++j)K[Z+32*j-1]=129,le[xe+32*j-1]=129;for(0<B?q[H-1-32]=K[Z-1-32]=le[xe-1-32]=129:(s(q,H-32-1,127,21),s(K,Z-32-1,127,9),s(le,xe-32-1,127,9)),D=0;D<f.za;++D){var ve=y.ya[y.aa+D];if(0<D){for(j=-1;16>j;++j)n(q,H+32*j-4,q,H+32*j+12,4);for(j=-1;8>j;++j)n(K,Z+32*j-4,K,Z+32*j+4,4),n(le,xe+32*j-4,le,xe+32*j+4,4)}var me=f.Gd,Ie=f.Hd+D,_e=ve.ad,ce=ve.Hc;if(0<B&&(n(q,H-32,me[Ie].y,0,16),n(K,Z-32,me[Ie].f,0,8),n(le,xe-32,me[Ie].ea,0,8)),ve.Za){var fe=q,ke=H-32+16;for(0<B&&(D>=f.za-1?s(fe,ke,me[Ie].y[15],4):n(fe,ke,me[Ie+1].y,0,4)),j=0;4>j;j++)fe[ke+128+j]=fe[ke+256+j]=fe[ke+384+j]=fe[ke+0+j];for(j=0;16>j;++j,ce<<=2)fe=q,ke=H+$N[j],ua[ve.Ob[j]](fe,ke),Li(ce,_e,16*+j,fe,ke)}else if(fe=Zr(D,B,ve.Ob[0]),zl[fe](q,H),ce!=0)for(j=0;16>j;++j,ce<<=2)Li(ce,_e,16*+j,q,H+$N[j]);for(j=ve.Gc,fe=Zr(D,B,ve.Dd),Do[fe](K,Z),Do[fe](le,xe),ce=_e,fe=K,ke=Z,255&(ve=j>>0)&&(170&ve?Rf(ce,256,fe,ke):Mi(ce,256,fe,ke)),ve=le,ce=xe,255&(j>>=8)&&(170&j?Rf(_e,320,ve,ce):Mi(_e,320,ve,ce)),B<f.Ub-1&&(n(me[Ie].y,0,q,H+480,16),n(me[Ie].f,0,K,Z+224,8),n(me[Ie].ea,0,le,xe+224,8)),j=8*z*f.B,me=f.sa,Ie=f.ta+16*D+16*z*f.R,_e=f.qa,ve=f.ra+8*D+j,ce=f.Ha,fe=f.Ia+8*D+j,j=0;16>j;++j)n(me,Ie+j*f.R,q,H+32*j,16);for(j=0;8>j;++j)n(_e,ve+j*f.B,K,Z+32*j,8),n(ce,fe+j*f.B,le,xe+32*j,8)}}function ca(f,y,j,D,B,z,q,H,K){var Z=[0],le=[0],xe=0,ve=K!=null?K.kd:0,me=K??new Dl;if(f==null||12>j)return 7;me.data=f,me.w=y,me.ha=j,y=[y],j=[j],me.gb=[me.gb];e:{var Ie=y,_e=j,ce=me.gb;if(e(f!=null),e(_e!=null),e(ce!=null),ce[0]=0,12<=_e[0]&&!r(f,Ie[0],"RIFF")){if(r(f,Ie[0]+8,"WEBP")){ce=3;break e}var fe=$e(f,Ie[0]+4);if(12>fe||4294967286<fe){ce=3;break e}if(ve&&fe>_e[0]-8){ce=7;break e}ce[0]=fe,Ie[0]+=12,_e[0]-=12}ce=0}if(ce!=0)return ce;for(fe=0<me.gb[0],j=j[0];;){e:{var ke=f;_e=y,ce=j;var Re=Z,Te=le,et=Ie=[0];if((Qe=xe=[xe])[0]=0,8>ce[0])ce=7;else{if(!r(ke,_e[0],"VP8X")){if($e(ke,_e[0]+4)!=10){ce=3;break e}if(18>ce[0]){ce=7;break e}var Ge=$e(ke,_e[0]+8),gt=1+He(ke,_e[0]+12);if(2147483648<=gt*(ke=1+He(ke,_e[0]+15))){ce=3;break e}et!=null&&(et[0]=Ge),Re!=null&&(Re[0]=gt),Te!=null&&(Te[0]=ke),_e[0]+=18,ce[0]-=18,Qe[0]=1}ce=0}}if(xe=xe[0],Ie=Ie[0],ce!=0)return ce;if(_e=!!(2&Ie),!fe&&xe)return 3;if(z!=null&&(z[0]=!!(16&Ie)),q!=null&&(q[0]=_e),H!=null&&(H[0]=0),q=Z[0],Ie=le[0],xe&&_e&&K==null){ce=0;break}if(4>j){ce=7;break}if(fe&&xe||!fe&&!xe&&!r(f,y[0],"ALPH")){j=[j],me.na=[me.na],me.P=[me.P],me.Sa=[me.Sa];e:{Ge=f,ce=y,fe=j;var Qe=me.gb;Re=me.na,Te=me.P,et=me.Sa,gt=22,e(Ge!=null),e(fe!=null),ke=ce[0];var Zt=fe[0];for(e(Re!=null),e(et!=null),Re[0]=null,Te[0]=null,et[0]=0;;){if(ce[0]=ke,fe[0]=Zt,8>Zt){ce=7;break e}var nr=$e(Ge,ke+4);if(4294967286<nr){ce=3;break e}var Yt=8+nr+1&-2;if(gt+=Yt,0<Qe&&gt>Qe){ce=3;break e}if(!r(Ge,ke,"VP8 ")||!r(Ge,ke,"VP8L")){ce=0;break e}if(Zt[0]<Yt){ce=7;break e}r(Ge,ke,"ALPH")||(Re[0]=Ge,Te[0]=ke+8,et[0]=nr),ke+=Yt,Zt-=Yt}}if(j=j[0],me.na=me.na[0],me.P=me.P[0],me.Sa=me.Sa[0],ce!=0)break}j=[j],me.Ja=[me.Ja],me.xa=[me.xa];e:if(Qe=f,ce=y,fe=j,Re=me.gb[0],Te=me.Ja,et=me.xa,Ge=ce[0],ke=!r(Qe,Ge,"VP8 "),gt=!r(Qe,Ge,"VP8L"),e(Qe!=null),e(fe!=null),e(Te!=null),e(et!=null),8>fe[0])ce=7;else{if(ke||gt){if(Qe=$e(Qe,Ge+4),12<=Re&&Qe>Re-12){ce=3;break e}if(ve&&Qe>fe[0]-8){ce=7;break e}Te[0]=Qe,ce[0]+=8,fe[0]-=8,et[0]=gt}else et[0]=5<=fe[0]&&Qe[Ge+0]==47&&!(Qe[Ge+4]>>5),Te[0]=fe[0];ce=0}if(j=j[0],me.Ja=me.Ja[0],me.xa=me.xa[0],y=y[0],ce!=0)break;if(4294967286<me.Ja)return 3;if(H==null||_e||(H[0]=me.xa?2:1),q=[q],Ie=[Ie],me.xa){if(5>j){ce=7;break}H=q,ve=Ie,_e=z,f==null||5>j?f=0:5<=j&&f[y+0]==47&&!(f[y+4]>>5)?(fe=[0],Qe=[0],Re=[0],Y(Te=new U,f,y,j),ht(Te,fe,Qe,Re)?(H!=null&&(H[0]=fe[0]),ve!=null&&(ve[0]=Qe[0]),_e!=null&&(_e[0]=Re[0]),f=1):f=0):f=0}else{if(10>j){ce=7;break}H=Ie,f==null||10>j||!Sl(f,y+3,j-3)?f=0:(ve=f[y+0]|f[y+1]<<8|f[y+2]<<16,_e=16383&(f[y+7]<<8|f[y+6]),f=16383&(f[y+9]<<8|f[y+8]),1&ve||3<(ve>>1&7)||!(ve>>4&1)||ve>>5>=me.Ja||!_e||!f?f=0:(q&&(q[0]=_e),H&&(H[0]=f),f=1))}if(!f||(q=q[0],Ie=Ie[0],xe&&(Z[0]!=q||le[0]!=Ie)))return 3;K!=null&&(K[0]=me,K.offset=y-K.w,e(4294967286>y-K.w),e(K.offset==K.ha-j));break}return ce==0||ce==7&&xe&&K==null?(z!=null&&(z[0]|=me.na!=null&&0<me.na.length),D!=null&&(D[0]=q),B!=null&&(B[0]=Ie),0):ce}function To(f,y,j){var D=y.width,B=y.height,z=0,q=0,H=D,K=B;if(y.Da=f!=null&&0<f.Da,y.Da&&(H=f.cd,K=f.bd,z=f.v,q=f.j,11>j||(z&=-2,q&=-2),0>z||0>q||0>=H||0>=K||z+H>D||q+K>B))return 0;if(y.v=z,y.j=q,y.va=z+H,y.o=q+K,y.U=H,y.T=K,y.da=f!=null&&0<f.da,y.da){if(!kt(H,K,j=[f.ib],z=[f.hb]))return 0;y.ib=j[0],y.hb=z[0]}return y.ob=f!=null&&f.ob,y.Kb=f==null||!f.Sd,y.da&&(y.ob=y.ib<3*D/4&&y.hb<3*B/4,y.Kb=0),1}function If(f){if(f==null)return 2;if(11>f.S){var y=f.f.RGBA;y.fb+=(f.height-1)*y.A,y.A=-y.A}else y=f.f.kb,f=f.height,y.O+=(f-1)*y.fa,y.fa=-y.fa,y.N+=(f-1>>1)*y.Ab,y.Ab=-y.Ab,y.W+=(f-1>>1)*y.Db,y.Db=-y.Db,y.F!=null&&(y.J+=(f-1)*y.lb,y.lb=-y.lb);return 0}function Dd(f,y,j,D){if(D==null||0>=f||0>=y)return 2;if(j!=null){if(j.Da){var B=j.cd,z=j.bd,q=-2&j.v,H=-2&j.j;if(0>q||0>H||0>=B||0>=z||q+B>f||H+z>y)return 2;f=B,y=z}if(j.da){if(!kt(f,y,B=[j.ib],z=[j.hb]))return 2;f=B[0],y=z[0]}}D.width=f,D.height=y;e:{var K=D.width,Z=D.height;if(f=D.S,0>=K||0>=Z||!(f>=rg&&13>f))f=2;else{if(0>=D.Rd&&D.sd==null){q=z=B=y=0;var le=(H=K*WN[f])*Z;if(11>f||(z=(Z+1)/2*(y=(K+1)/2),f==12&&(q=(B=K)*Z)),(Z=i(le+2*z+q))==null){f=1;break e}D.sd=Z,11>f?((K=D.f.RGBA).eb=Z,K.fb=0,K.A=H,K.size=le):((K=D.f.kb).y=Z,K.O=0,K.fa=H,K.Fd=le,K.f=Z,K.N=0+le,K.Ab=y,K.Cd=z,K.ea=Z,K.W=0+le+z,K.Db=y,K.Ed=z,f==12&&(K.F=Z,K.J=0+le+2*z),K.Tc=q,K.lb=B)}if(y=1,B=D.S,z=D.width,q=D.height,B>=rg&&13>B)if(11>B)f=D.f.RGBA,y&=(H=Math.abs(f.A))*(q-1)+z<=f.size,y&=H>=z*WN[B],y&=f.eb!=null;else{f=D.f.kb,H=(z+1)/2,le=(q+1)/2,K=Math.abs(f.fa),Z=Math.abs(f.Ab);var xe=Math.abs(f.Db),ve=Math.abs(f.lb),me=ve*(q-1)+z;y&=K*(q-1)+z<=f.Fd,y&=Z*(le-1)+H<=f.Cd,y=(y&=xe*(le-1)+H<=f.Ed)&K>=z&Z>=H&xe>=H,y&=f.y!=null,y&=f.f!=null,y&=f.ea!=null,B==12&&(y&=ve>=z,y&=me<=f.Tc,y&=f.F!=null)}else y=0;f=y?0:2}}return f!=0||j!=null&&j.fd&&(f=If(D)),f}var Ln=64,Ld=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Od=24,Md=32,Cf=8,Fs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ze("Predictor0","PredictorAdd0"),A.Predictor0=function(){return 4278190080},A.Predictor1=function(f){return f},A.Predictor2=function(f,y,j){return y[j+0]},A.Predictor3=function(f,y,j){return y[j+1]},A.Predictor4=function(f,y,j){return y[j-1]},A.Predictor5=function(f,y,j){return Ke(Ke(f,y[j+1]),y[j+0])},A.Predictor6=function(f,y,j){return Ke(f,y[j-1])},A.Predictor7=function(f,y,j){return Ke(f,y[j+0])},A.Predictor8=function(f,y,j){return Ke(y[j-1],y[j+0])},A.Predictor9=function(f,y,j){return Ke(y[j+0],y[j+1])},A.Predictor10=function(f,y,j){return Ke(Ke(f,y[j-1]),Ke(y[j+0],y[j+1]))},A.Predictor11=function(f,y,j){var D=y[j+0];return 0>=Pt(D>>24&255,f>>24&255,(y=y[j-1])>>24&255)+Pt(D>>16&255,f>>16&255,y>>16&255)+Pt(D>>8&255,f>>8&255,y>>8&255)+Pt(255&D,255&f,255&y)?D:f},A.Predictor12=function(f,y,j){var D=y[j+0];return(lt((f>>24&255)+(D>>24&255)-((y=y[j-1])>>24&255))<<24|lt((f>>16&255)+(D>>16&255)-(y>>16&255))<<16|lt((f>>8&255)+(D>>8&255)-(y>>8&255))<<8|lt((255&f)+(255&D)-(255&y)))>>>0},A.Predictor13=function(f,y,j){var D=y[j-1];return(jt((f=Ke(f,y[j+0]))>>24&255,D>>24&255)<<24|jt(f>>16&255,D>>16&255)<<16|jt(f>>8&255,D>>8&255)<<8|jt(f>>0&255,D>>0&255))>>>0};var r1=A.PredictorAdd0;A.PredictorAdd1=Lt,ze("Predictor2","PredictorAdd2"),ze("Predictor3","PredictorAdd3"),ze("Predictor4","PredictorAdd4"),ze("Predictor5","PredictorAdd5"),ze("Predictor6","PredictorAdd6"),ze("Predictor7","PredictorAdd7"),ze("Predictor8","PredictorAdd8"),ze("Predictor9","PredictorAdd9"),ze("Predictor10","PredictorAdd10"),ze("Predictor11","PredictorAdd11"),ze("Predictor12","PredictorAdd12"),ze("Predictor13","PredictorAdd13");var Pf=A.PredictorAdd2;Ft("ColorIndexInverseTransform","MapARGB","32b",function(f){return f>>8&255},function(f){return f}),Ft("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(f){return f},function(f){return f>>8&255});var Qp,Oi=A.ColorIndexInverseTransform,Fd=A.MapARGB,Jp=A.VP8LColorIndexInverseTransformAlpha,Xp=A.MapAlpha,Fl=A.VP8LPredictorsAdd=[];Fl.length=16,(A.VP8LPredictors=[]).length=16,(A.VP8LPredictorsAdd_C=[]).length=16,(A.VP8LPredictors_C=[]).length=16;var wu,Vs,xs,Vl,Io,Co,Vd,Po,en,Rf,vs,Mi,Bd,Zp,Df,Nu,_u,Bl,ju,Ud,Su,Ul,Lf,Fi,Vi,br,wr,tn,vn=i(511),Ro=i(2041),Of=i(225),zd=i(767),eg=0,n1=Ro,tg=Of,ci=zd,Bi=vn,rg=0,ng=1,RN=2,sg=3,ig=4,s1=5,DN=6,i1=7,a1=8,ag=9,o1=10,oR=[2,3,7],lR=[3,3,11],LN=[280,256,256,256,40],cR=[0,1,1,1,0],uR=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],dR=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],hR=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],fR=8,l1=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],c1=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Mf=null,mR=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],pR=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],ON=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],gR=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],yR=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],xR=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],vR=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],zl=[],ua=[],Do=[],bR=1,MN=2,ql=[],Ui=[];Ne("UpsampleRgbLinePair",L,3),Ne("UpsampleBgrLinePair",W,3),Ne("UpsampleRgbaLinePair",rr,4),Ne("UpsampleBgraLinePair",Tt,4),Ne("UpsampleArgbLinePair",Oe,4),Ne("UpsampleRgba4444LinePair",ye,2),Ne("UpsampleRgb565LinePair",he,2);var wR=A.UpsampleRgbLinePair,NR=A.UpsampleBgrLinePair,FN=A.UpsampleRgbaLinePair,VN=A.UpsampleBgraLinePair,BN=A.UpsampleArgbLinePair,UN=A.UpsampleRgba4444LinePair,_R=A.UpsampleRgb565LinePair,og=16,lg=1<<og-1,Ff=-227,u1=482,zN=6,jR=(256<<zN)-1,qN=0,SR=i(256),AR=i(256),ER=i(256),kR=i(256),TR=i(u1-Ff),IR=i(u1-Ff);pr("YuvToRgbRow",L,3),pr("YuvToBgrRow",W,3),pr("YuvToRgbaRow",rr,4),pr("YuvToBgraRow",Tt,4),pr("YuvToArgbRow",Oe,4),pr("YuvToRgba4444Row",ye,2),pr("YuvToRgb565Row",he,2);var $N=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],cg=[0,2,8],CR=[8,7,6,4,4,2,2,2,1,1,1,1],PR=1;this.WebPDecodeRGBA=function(f,y,j,D,B){var z=ng,q=new Ri,H=new Ps;q.ba=H,H.S=z,H.width=[H.width],H.height=[H.height];var K=H.width,Z=H.height,le=new ms;if(le==null||f==null)var xe=2;else e(le!=null),xe=ca(f,y,j,le.width,le.height,le.Pd,le.Qd,le.format,null);if(xe!=0?K=0:(K!=null&&(K[0]=le.width[0]),Z!=null&&(Z[0]=le.height[0]),K=1),K){H.width=H.width[0],H.height=H.height[0],D!=null&&(D[0]=H.width),B!=null&&(B[0]=H.height);e:{if(D=new jo,(B=new Dl).data=f,B.w=y,B.ha=j,B.kd=1,y=[0],e(B!=null),((f=ca(B.data,B.w,B.ha,null,null,null,y,null,B))==0||f==7)&&y[0]&&(f=4),(y=f)==0){if(e(q!=null),D.data=B.data,D.w=B.w+B.offset,D.ha=B.ha-B.offset,D.put=Zs,D.ac=$r,D.bc=Kn,D.ma=q,B.xa){if((f=Rn())==null){q=1;break e}if(function(ve,me){var Ie=[0],_e=[0],ce=[0];t:for(;;){if(ve==null)return 0;if(me==null)return ve.a=2,0;if(ve.l=me,ve.a=0,Y(ve.m,me.data,me.w,me.ha),!ht(ve.m,Ie,_e,ce)){ve.a=3;break t}if(ve.xb=MN,me.width=Ie[0],me.height=_e[0],!xn(Ie[0],_e[0],1,ve,null))break t;return 1}return e(ve.a!=0),0}(f,D)){if(D=(y=Dd(D.width,D.height,q.Oa,q.ba))==0){t:{D=f;r:for(;;){if(D==null){D=0;break t}if(e(D.s.yc!=null),e(D.s.Ya!=null),e(0<D.s.Wb),e((j=D.l)!=null),e((B=j.ma)!=null),D.xb!=0){if(D.ca=B.ba,D.tb=B.tb,e(D.ca!=null),!To(B.Oa,j,sg)){D.a=2;break r}if(!La(D,j.width)||j.da)break r;if((j.da||Xt(D.ca.S))&&pe(),11>D.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),D.ca.f.kb.F!=null&&pe()),D.Pb&&0<D.s.ua&&D.s.vb.X==null&&!dt(D.s.vb,D.s.Wa.Xa)){D.a=1;break r}D.xb=0}if(!Rs(D,D.V,D.Ba,D.c,D.i,j.o,ti))break r;B.Dc=D.Ma,D=1;break t}e(D.a!=0),D=0}D=!D}D&&(y=f.a)}else y=f.a}else{if((f=new jd)==null){q=1;break e}if(f.Fa=B.na,f.P=B.P,f.qc=B.Sa,cu(f,D)){if((y=Dd(D.width,D.height,q.Oa,q.ba))==0){if(f.Aa=0,j=q.Oa,e((B=f)!=null),j!=null){if(0<(K=0>(K=j.Md)?0:100<K?255:255*K/100)){for(Z=le=0;4>Z;++Z)12>(xe=B.pb[Z]).lc&&(xe.ia=K*CR[0>xe.lc?0:xe.lc]>>3),le|=xe.ia;le&&(alert("todo:VP8InitRandom"),B.ia=1)}B.Ga=j.Id,100<B.Ga?B.Ga=100:0>B.Ga&&(B.Ga=0)}Ef(f,D)||(y=f.a)}}else y=f.a}y==0&&q.Oa!=null&&q.Oa.fd&&(y=If(q.ba))}q=y}z=q!=0?null:11>z?H.f.RGBA.eb:H.f.kb.y}else z=null;return z};var WN=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(A,I){for(var O="",S=0;S<4;S++)O+=String.fromCharCode(A[I++]);return O}function d(A,I){return(A[I+0]<<0|A[I+1]<<8|A[I+2]<<16)>>>0}function h(A,I){return(A[I+0]<<0|A[I+1]<<8|A[I+2]<<16|A[I+3]<<24)>>>0}new c;var g=[0],m=[0],w=[],_=new c,T=t,v=function(A,I){var O={},S=0,R=!1,C=0,G=0;if(O.frames=[],!function(J,te,ie,ue){for(var ge=0;ge<ue;ge++)if(J[te+ge]!=ie.charCodeAt(ge))return!0;return!1}(A,I,"RIFF",4)){for(h(A,I+=4),I+=8;I<A.length;){var de=u(A,I),ne=h(A,I+=4);I+=4;var X=ne+(1&ne);switch(de){case"VP8 ":case"VP8L":O.frames[S]===void 0&&(O.frames[S]={}),(se=O.frames[S]).src_off=R?G:I-8,se.src_size=C+ne+8,S++,R&&(R=!1,C=0,G=0);break;case"VP8X":(se=O.header={}).feature_flags=A[I];var Y=I+4;se.canvas_width=1+d(A,Y),Y+=3,se.canvas_height=1+d(A,Y),Y+=3;break;case"ALPH":R=!0,C=X+8,G=I-8;break;case"ANIM":(se=O.header).bgcolor=h(A,I),Y=I+4,se.loop_count=(Se=A)[(U=Y)+0]<<0|Se[U+1]<<8,Y+=2;break;case"ANMF":var Q,se;(se=O.frames[S]={}).offset_x=2*d(A,I),I+=3,se.offset_y=2*d(A,I),I+=3,se.width=1+d(A,I),I+=3,se.height=1+d(A,I),I+=3,se.duration=d(A,I),I+=3,Q=A[I++],se.dispose=1&Q,se.blend=Q>>1&1}de!="ANMF"&&(I+=X)}var Se,U;return O}}(T,0);v.response=T,v.rgbaoutput=!0,v.dataurl=!1;var b=v.header?v.header:null,x=v.frames?v.frames:null;if(b){b.loop_counter=b.loop_count,g=[b.canvas_height],m=[b.canvas_width];for(var P=0;P<x.length&&x[P].blend!=0;P++);}var F=x[0],$=_.WebPDecodeRGBA(T,F.src_off,F.src_size,m,g);F.rgba=$,F.imgwidth=m[0],F.imgheight=g[0];for(var k=0;k<m[0]*g[0]*4;k++)w[k]=$[k];return this.width=m,this.height=g,this.data=w,this}(function(t){var e=function(){return typeof Db=="function"},r=function(g,m,w,_){var T=4,v=o;switch(_){case t.image_compression.FAST:T=1,v=i;break;case t.image_compression.MEDIUM:T=6,v=l;break;case t.image_compression.SLOW:T=9,v=c}g=n(g,m,w,v);var b=Db(g,{level:T});return t.__addimage__.arrayBufferToBinaryString(b)},n=function(g,m,w,_){for(var T,v,b,x=g.length/m,P=new Uint8Array(g.length+x),F=d(),$=0;$<x;$+=1){if(b=$*m,T=g.subarray(b,b+m),_)P.set(_(T,w,v),b+$);else{for(var k,A=F.length,I=[];k<A;k+=1)I[k]=F[k](T,w,v);var O=h(I.concat());P.set(I[O],b+$)}v=T}return P},s=function(g){var m=Array.apply([],g);return m.unshift(0),m},i=function(g,m){var w,_=[],T=g.length;_[0]=1;for(var v=0;v<T;v+=1)w=g[v-m]||0,_[v+1]=g[v]-w+256&255;return _},o=function(g,m,w){var _,T=[],v=g.length;T[0]=2;for(var b=0;b<v;b+=1)_=w&&w[b]||0,T[b+1]=g[b]-_+256&255;return T},l=function(g,m,w){var _,T,v=[],b=g.length;v[0]=3;for(var x=0;x<b;x+=1)_=g[x-m]||0,T=w&&w[x]||0,v[x+1]=g[x]+256-(_+T>>>1)&255;return v},c=function(g,m,w){var _,T,v,b,x=[],P=g.length;x[0]=4;for(var F=0;F<P;F+=1)_=g[F-m]||0,T=w&&w[F]||0,v=w&&w[F-m]||0,b=u(_,T,v),x[F+1]=g[F]-b+256&255;return x},u=function(g,m,w){if(g===m&&m===w)return g;var _=Math.abs(m-w),T=Math.abs(g-w),v=Math.abs(g+m-w-w);return _<=T&&_<=v?g:T<=v?m:w},d=function(){return[s,i,o,l,c]},h=function(g){var m=g.map(function(w){return w.reduce(function(_,T){return _+Math.abs(T)},0)});return m.indexOf(Math.min.apply(null,m))};t.processPNG=function(g,m,w,_){var T,v,b,x,P,F,$,k,A,I,O,S,R,C,G,de=this.decode.FLATE_DECODE,ne="";if(this.__addimage__.isArrayBuffer(g)&&(g=new Uint8Array(g)),this.__addimage__.isArrayBufferView(g)){if(g=(b=new WX(g)).imgData,v=b.bits,T=b.colorSpace,P=b.colors,[4,6].indexOf(b.colorType)!==-1){if(b.bits===8){A=(k=b.pixelBitlength==32?new Uint32Array(b.decodePixels().buffer):b.pixelBitlength==16?new Uint16Array(b.decodePixels().buffer):new Uint8Array(b.decodePixels().buffer)).length,O=new Uint8Array(A*b.colors),I=new Uint8Array(A);var X,Y=b.pixelBitlength-b.bits;for(C=0,G=0;C<A;C++){for(R=k[C],X=0;X<Y;)O[G++]=R>>>X&255,X+=b.bits;I[C]=R>>>X&255}}if(b.bits===16){A=(k=new Uint32Array(b.decodePixels().buffer)).length,O=new Uint8Array(A*(32/b.pixelBitlength)*b.colors),I=new Uint8Array(A*(32/b.pixelBitlength)),S=b.colors>1,C=0,G=0;for(var Q=0;C<A;)R=k[C++],O[G++]=R>>>0&255,S&&(O[G++]=R>>>16&255,R=k[C++],O[G++]=R>>>0&255),I[Q++]=R>>>16&255;v=8}_!==t.image_compression.NONE&&e()?(g=r(O,b.width*b.colors,b.colors,_),$=r(I,b.width,1,_)):(g=O,$=I,de=void 0)}if(b.colorType===3&&(T=this.color_spaces.INDEXED,F=b.palette,b.transparency.indexed)){var se=b.transparency.indexed,Se=0;for(C=0,A=se.length;C<A;++C)Se+=se[C];if((Se/=255)===A-1&&se.indexOf(0)!==-1)x=[se.indexOf(0)];else if(Se!==A){for(k=b.decodePixels(),I=new Uint8Array(k.length),C=0,A=k.length;C<A;C++)I[C]=se[k[C]];$=r(I,b.width,1)}}var U=function(J){var te;switch(J){case t.image_compression.FAST:te=11;break;case t.image_compression.MEDIUM:te=13;break;case t.image_compression.SLOW:te=14;break;default:te=12}return te}(_);return de===this.decode.FLATE_DECODE&&(ne="/Predictor "+U+" "),ne+="/Colors "+P+" /BitsPerComponent "+v+" /Columns "+b.width,(this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),($&&this.__addimage__.isArrayBuffer($)||this.__addimage__.isArrayBufferView($))&&($=this.__addimage__.arrayBufferToBinaryString($)),{alias:w,data:g,index:m,filter:de,decodeParameters:ne,transparency:x,palette:F,sMask:$,predictor:U,width:b.width,height:b.height,bitsPerComponent:v,colorSpace:T}}}})(bt.API),function(t){t.processGIF89A=function(e,r,n,s){var i=new HX(e),o=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},d=new Lv(100).encode(u,100);return t.processJPEG.call(this,d,r,n,s)},t.processGIF87A=t.processGIF89A}(bt.API),ma.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:s,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ma.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){yr.log("bit decode error:"+r)}},ma.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<e;s++)for(var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},ma.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<t;s++){var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*s*4,l=i>>4,c=15&i,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*s+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},ma.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(s<this.palette.length){var o=this.palette[s];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}t!==0&&(this.pos+=4-t)}},ma.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&e)/e*255|0,l=(i>>5&e)/e*255|0,c=(i>>10&e)/e*255|0,u=i>>15?255:0,d=n*this.width*4+4*s;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=u}this.pos+=t}},ma.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/e*255|0,d=s*this.width*4+4*i;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=t}},ma.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=i,this.data[o+1]=s,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},ma.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=i,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=o}},ma.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,s){var i=new ma(e,!1),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},u=new Lv(100).encode(c,100);return t.processJPEG.call(this,u,r,n,s)}}(bt.API),Z3.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,s){var i=new Z3(e),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},u=new Lv(100).encode(c,100);return t.processJPEG.call(this,u,r,n,s)}}(bt.API),bt.API.processRGBA=function(t,e,r){for(var n=t.data,s=n.length,i=new Uint8Array(s/4*3),o=new Uint8Array(s/4),l=0,c=0,u=0;u<s;u+=4){var d=n[u],h=n[u+1],g=n[u+2],m=n[u+3];i[l++]=d,i[l++]=h,i[l++]=g,o[c++]=m}var w=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:w,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},bt.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Jd=bt.API,n0=Jd.getCharWidthsArray=function(t,e){var r,n,s=(e=e||{}).font||this.internal.getFont(),i=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:s.metadata.Unicode.kerning,d=u.fof?u.fof:1,h=e.doKerning!==!1,g=0,m=t.length,w=0,_=l[0]||c,T=[];for(r=0;r<m;r++)n=t.charCodeAt(r),typeof s.metadata.widthOfString=="function"?T.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+o*(1e3/i)||0)/1e3):(g=h&&or(u[n])==="object"&&!isNaN(parseInt(u[n][w],10))?u[n][w]/d:0,T.push((l[n]||_)/c+g)),w=n;return T},Y3=Jd.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),s=e.charSpace||this.internal.getCharSpace();return Jd.processArabic&&(t=Jd.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,s)/r:n0.apply(this,arguments).reduce(function(i,o){return i+o},0)},Q3=function(t,e,r,n){for(var s=[],i=0,o=t.length,l=0;i!==o&&l+e[i]<r;)l+=e[i],i++;s.push(t.slice(0,i));var c=i;for(l=0;i!==o;)l+e[i]>n&&(s.push(t.slice(c,i)),l=0,c=i),l+=e[i],i++;return c!==i&&s.push(t.slice(c,i)),s},J3=function(t,e,r){r||(r={});var n,s,i,o,l,c,u,d=[],h=[d],g=r.textIndent||0,m=0,w=0,_=t.split(" "),T=n0.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?_[0].length+2:r.lineIndent||0){var v=Array(c).join(" "),b=[];_.map(function(P){(P=P.split(/\s*\n/)).length>1?b=b.concat(P.map(function(F,$){return($&&F.length?`
`:"")+F})):b.push(P[0])}),_=b,c=Y3.apply(this,[v,r])}for(i=0,o=_.length;i<o;i++){var x=0;if(n=_[i],c&&n[0]==`
`&&(n=n.substr(1),x=1),g+m+(w=(s=n0.apply(this,[n,r])).reduce(function(P,F){return P+F},0))>e||x){if(w>e){for(l=Q3.apply(this,[n,s,e-(g+m),e]),d.push(l.shift()),d=[l.pop()];l.length;)h.push([l.shift()]);w=s.slice(n.length-(d[0]?d[0].length:0)).reduce(function(P,F){return P+F},0)}else d=[n];h.push(d),g=w+c,m=T}else d.push(n),g+=m+w,m=T}return u=c?function(P,F){return(F?v:"")+P.join(" ")}:function(P){return P.join(" ")},h.map(u)},Jd.splitTextToSize=function(t,e,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var h=this.internal.getFont(d.fontName,d.fontStyle);return h.metadata.Unicode?{widths:h.metadata.Unicode.widths||{0:1},kerning:h.metadata.Unicode.kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/s;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,i.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(J3.apply(this,[n[l],o,i]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",r={},n={},s=0;s<e.length;s++)r[e[s]]="0123456789abcdef"[s],n["0123456789abcdef"[s]]=e[s];var i=function(h){return"0x"+parseInt(h,10).toString(16)},o=t.__fontmetrics__.compress=function(h){var g,m,w,_,T=["{"];for(var v in h){if(g=h[v],isNaN(parseInt(v,10))?m="'"+v+"'":(v=parseInt(v,10),m=(m=i(v).slice(2)).slice(0,-1)+n[m.slice(-1)]),typeof g=="number")g<0?(w=i(g).slice(3),_="-"):(w=i(g).slice(2),_=""),w=_+w.slice(0,-1)+n[w.slice(-1)];else{if(or(g)!=="object")throw new Error("Don't know what to do with value type "+or(g)+".");w=o(g)}T.push(m+w)}return T.push("}"),T.join("")},l=t.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,m,w,_,T={},v=1,b=T,x=[],P="",F="",$=h.length-1,k=1;k<$;k+=1)(_=h[k])=="'"?g?(w=g.join(""),g=void 0):g=[]:g?g.push(_):_=="{"?(x.push([b,w]),b={},w=void 0):_=="}"?((m=x.pop())[0][m[1]]=b,w=void 0,b=m[0]):_=="-"?v=-1:w===void 0?r.hasOwnProperty(_)?(P+=r[_],w=parseInt(P,16)*v,v=1,P=""):P+=_:r.hasOwnProperty(_)?(F+=r[_],b[w]=parseInt(F,16)*v,v=1,w=void 0,F=""):F+=_;return T},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},d={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(h){var g=h.font,m=d.Unicode[g.postScriptName];m&&(g.metadata.Unicode={},g.metadata.Unicode.widths=m.widths,g.metadata.Unicode.kerning=m.kerning);var w=u.Unicode[g.postScriptName];w&&(g.metadata.Unicode.encoding=w,g.encoding=w.codePages[0])}])}(bt.API),function(t){var e=function(r){for(var n=r.length,s=new Uint8Array(n),i=0;i<n;i++)s[i]=r.charCodeAt(i);return s};t.API.events.push(["addFont",function(r){var n=void 0,s=r.font,i=r.instance;if(!s.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=i.existsFileInVFS(s.postScriptName)===!1?i.loadFile(s.postScriptName):i.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(Fm(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(s,n)}}])}(bt),function(t){function e(){return(wt.canvg?Promise.resolve(wt.canvg):vp(()=>import("./index.es-c8815aba.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}bt.API.addSvgAsImage=function(r,n,s,i,o,l,c,u){if(isNaN(n)||isNaN(s))throw yr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(o))throw yr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=i,d.height=o;var h=d.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,d.width,d.height);var g={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return e().then(function(w){return w.fromString(h,r,g)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(w){return w.render(g)}).then(function(){m.addImage(d.toDataURL("image/jpeg",1),n,s,i,o,c,u)})}}(),bt.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(e,r);return this},bt.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,s,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,d=0,h=0;function g(w,_){var T,v=!1;for(T=0;T<w.length;T+=1)w[T]===_&&(v=!0);return v}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var m=l.length;for(h=0;h<m;h+=1)r[l[h]].value=r[l[h]].defaultValue,r[l[h]].explicitSet=!1}if(or(t)==="object"){for(s in t)if(i=t[s],g(l,s)&&i!==void 0){if(r[s].type==="boolean"&&typeof i=="boolean")r[s].value=i;else if(r[s].type==="name"&&g(r[s].valueSet,i))r[s].value=i;else if(r[s].type==="integer"&&Number.isInteger(i))r[s].value=i;else if(r[s].type==="array"){for(u=0;u<i.length;u+=1)if(n=!0,i[u].length===1&&typeof i[u][0]=="number")c.push(String(i[u]-1));else if(i[u].length>1){for(d=0;d<i[u].length;d+=1)typeof i[u][d]!="number"&&(n=!1);n===!0&&c.push([i[u][0]-1,i[u][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var w,_=[];for(w in r)r[w].explicitSet===!0&&(r[w].type==="name"?_.push("/"+w+" /"+r[w].value):_.push("/"+w+" "+r[w].value));_.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+_.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=i.length+o.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(s+i+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(bt.API),function(t){var e=t.API,r=e.pdfEscape16=function(i,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],h=0,g=i.length;h<g;++h){if(l=o.metadata.characterToGlyph(i.charCodeAt(h)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=i.charCodeAt(h),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},n=function(i){var o,l,c,u,d,h,g;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],h=0,g=(l=Object.keys(i).sort(function(m,w){return m-w})).length;h<g;h++)o=l[h],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(u=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var h=l.metadata.Unicode.widths,g=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),m="",w=0;w<g.length;w++)m+=String.fromCharCode(g[w]);var _=u();d({data:m,addLength1:!0,objectId:_}),c("endobj");var T=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:T}),c("endobj");var v=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+nh(l.fontName)),c("/FontFile2 "+_+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var b=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+nh(l.fontName)),c("/FontDescriptor "+v+" 0 R"),c("/W "+t.API.PDFObject.convert(h)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+T+" 0 R"),c("/BaseFont /"+nh(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+b+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),e.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var h=l.metadata.rawData,g="",m=0;m<h.length;m++)g+=String.fromCharCode(h[m]);var w=u();d({data:g,addLength1:!0,objectId:w}),c("endobj");var _=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:_}),c("endobj");var T=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+w+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+nh(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var v=0;v<l.metadata.hmtx.widths.length;v++)l.metadata.hmtx.widths[v]=parseInt(l.metadata.hmtx.widths[v]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+_+" 0 R/BaseFont/"+nh(l.fontName)+"/FontDescriptor "+T+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var s=function(i){var o,l=i.text||"",c=i.x,u=i.y,d=i.options||{},h=i.mutex||{},g=h.pdfEscape,m=h.activeFontKey,w=h.fonts,_=m,T="",v=0,b="",x=w[_].encoding;if(w[_].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:h};for(b=l,_=m,Array.isArray(l)&&(b=l[0]),v=0;v<b.length;v+=1)w[_].metadata.hasOwnProperty("cmap")&&(o=w[_].metadata.cmap.unicode.codeMap[b[v].charCodeAt(0)]),o||b[v].charCodeAt(0)<256&&w[_].metadata.hasOwnProperty("Unicode")?T+=b[v]:T+="";var P="";return parseInt(_.slice(1))<14||x==="WinAnsiEncoding"?P=g(T,_).split("").map(function(F){return F.charCodeAt(0).toString(16)}).join(""):x==="Identity-H"&&(P=r(T,w[_])),h.isHex=!0,{text:P,x:c,y:u,options:d,mutex:h}};e.events.push(["postProcessText",function(i){var o=i.text||"",l=[],c={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([s(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(s(Object.assign({},c,{text:o[u]})).text);i.text=l}else i.text=s(Object.assign({},c,{text:o})).text}])}(bt),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(bt.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var s,i,o,l,c,u,d,h=e,g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],w={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},_={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},T=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],v=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),b=!1,x=0;this.__bidiEngine__={};var P=function(S){var R=S.charCodeAt(),C=R>>8,G=_[C];return G!==void 0?h[256*G+(255&R)]:C===252||C===253?"AL":v.test(C)?"L":C===8?"R":"N"},F=function(S){for(var R,C=0;C<S.length;C++){if((R=P(S.charAt(C)))==="L")return!1;if(R==="R")return!0}return!1},$=function(S,R,C,G){var de,ne,X,Y,Q=R[G];switch(Q){case"L":case"R":b=!1;break;case"N":case"AN":break;case"EN":b&&(Q="AN");break;case"AL":b=!0,Q="R";break;case"WS":Q="N";break;case"CS":G<1||G+1>=R.length||(de=C[G-1])!=="EN"&&de!=="AN"||(ne=R[G+1])!=="EN"&&ne!=="AN"?Q="N":b&&(ne="AN"),Q=ne===de?ne:"N";break;case"ES":Q=(de=G>0?C[G-1]:"B")==="EN"&&G+1<R.length&&R[G+1]==="EN"?"EN":"N";break;case"ET":if(G>0&&C[G-1]==="EN"){Q="EN";break}if(b){Q="N";break}for(X=G+1,Y=R.length;X<Y&&R[X]==="ET";)X++;Q=X<Y&&R[X]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(Y=R.length,X=G+1;X<Y&&R[X]==="NSM";)X++;if(X<Y){var se=S[G],Se=se>=1425&&se<=2303||se===64286;if(de=R[X],Se&&(de==="R"||de==="AL")){Q="R";break}}}Q=G<1||(de=R[G-1])==="B"?"N":C[G-1];break;case"B":b=!1,s=!0,Q=x;break;case"S":i=!0,Q="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":b=!1;break;case"BN":Q="N"}return Q},k=function(S,R,C){var G=S.split("");return C&&A(G,C,{hiLevel:x}),G.reverse(),R&&R.reverse(),G.join("")},A=function(S,R,C){var G,de,ne,X,Y,Q=-1,se=S.length,Se=0,U=[],J=x?m:g,te=[];for(b=!1,s=!1,i=!1,de=0;de<se;de++)te[de]=P(S[de]);for(ne=0;ne<se;ne++){if(Y=Se,U[ne]=$(S,te,U,ne),G=240&(Se=J[Y][w[U[ne]]]),Se&=15,R[ne]=X=J[Se][5],G>0)if(G===16){for(de=Q;de<ne;de++)R[de]=1;Q=-1}else Q=-1;if(J[Se][6])Q===-1&&(Q=ne);else if(Q>-1){for(de=Q;de<ne;de++)R[de]=X;Q=-1}te[ne]==="B"&&(R[ne]=0),C.hiLevel|=X}i&&function(ie,ue,ge){for(var we=0;we<ge;we++)if(ie[we]==="S"){ue[we]=x;for(var be=we-1;be>=0&&ie[be]==="WS";be--)ue[be]=x}}(te,R,se)},I=function(S,R,C,G,de){if(!(de.hiLevel<S)){if(S===1&&x===1&&!s)return R.reverse(),void(C&&C.reverse());for(var ne,X,Y,Q,se=R.length,Se=0;Se<se;){if(G[Se]>=S){for(Y=Se+1;Y<se&&G[Y]>=S;)Y++;for(Q=Se,X=Y-1;Q<X;Q++,X--)ne=R[Q],R[Q]=R[X],R[X]=ne,C&&(ne=C[Q],C[Q]=C[X],C[X]=ne);Se=Y}Se++}}},O=function(S,R,C){var G=S.split(""),de={hiLevel:x};return C||(C=[]),A(G,C,de),function(ne,X,Y){if(Y.hiLevel!==0&&d)for(var Q,se=0;se<ne.length;se++)X[se]===1&&(Q=T.indexOf(ne[se]))>=0&&(ne[se]=T[Q+1])}(G,C,de),I(2,G,R,C,de),I(1,G,R,C,de),G.join("")};return this.__bidiEngine__.doBidiReorder=function(S,R,C){if(function(de,ne){if(ne)for(var X=0;X<de.length;X++)ne[X]=X;l===void 0&&(l=F(de)),u===void 0&&(u=F(de))}(S,R),o||!c||u)if(o&&c&&l^u)x=l?1:0,S=k(S,R,C);else if(!o&&c&&u)x=l?1:0,S=O(S,R,C),S=k(S,R);else if(!o||l||c||u){if(o&&!c&&l^u)S=k(S,R),l?(x=0,S=O(S,R,C)):(x=1,S=O(S,R,C),S=k(S,R));else if(o&&l&&!c&&u)x=1,S=O(S,R,C),S=k(S,R);else if(!o&&!c&&l^u){var G=d;l?(x=1,S=O(S,R,C),x=0,d=!1,S=O(S,R,C),d=G):(x=0,S=O(S,R,C),S=k(S,R),x=1,d=!1,S=O(S,R,C),d=G,S=k(S,R))}}else x=0,S=O(S,R,C);else x=l?1:0,S=O(S,R,C);return S},this.__bidiEngine__.setOptions=function(S){S&&(o=S.isInputVisual,c=S.isOutputVisual,l=S.isInputRtl,u=S.isOutputRtl,d=S.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var o=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(o=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?o.push([r.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):o.push([r.doBidiReorder(s[l])]);n.text=o}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(bt),bt.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Jc(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new oZ(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new GX(this.contents),this.head=new YX(this),this.name=new eZ(this),this.cmap=new $P(this),this.toUnicode={},this.hhea=new QX(this),this.maxp=new tZ(this),this.hmtx=new rZ(this),this.post=new XX(this),this.os2=new JX(this),this.loca=new aZ(this),this.glyf=new nZ(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,s,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var s,i,o,l;for(o=0,i=0,l=(e=""+e).length;0<=l?i<l:i>l;i=0<=l?++i:--i)s=e.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var Ra,Jc=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,s;for(s=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(e.charCodeAt(r)));return s},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,s,i,o,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^i)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*s+16777216*i+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,s,i;for(i=[],n=0,s=e.length;n<s;n++)r=e[n],i.push(this.writeByte(r));return i},t}(),GX=function(){var t;function e(r){var n,s,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,i=this.tableCount;0<=i?s<i:s>i;s=0<=i?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,s,i,o,l,c,u,d,h,g,m,w,_;for(_ in m=Object.keys(r).length,c=Math.log(2),h=16*Math.floor(Math.log(m)/c),o=Math.floor(h/c),d=16*m-h,(s=new Jc).writeInt(this.scalarType),s.writeShort(m),s.writeShort(h),s.writeShort(o),s.writeShort(d),i=16*m,u=s.pos+i,l=null,w=[],r)for(g=r[_],s.writeString(_),s.writeInt(t(g)),s.writeInt(u),s.writeInt(g.length),w=w.concat(g),_==="head"&&(l=u),u+=g.length;u%4;)w.push(0),u++;return s.write(w),n=2981146554-t(s.data),s.pos=l+8,s.writeUInt32(n),s.data},t=function(r){var n,s,i,o;for(r=WP.call(r);r.length%4;)r.push(0);for(i=new Jc(r),s=0,n=0,o=r.length;n<o;n=n+=4)s+=i.readUInt32();return 4294967295&s},e}(),KX={}.hasOwnProperty,vo=function(t,e){for(var r in e)KX.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Ra=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var YX=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return vo(e,Ra),e.prototype.tag="head",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},e.prototype.encode=function(r){var n;return(n=new Jc).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},e}(),eA=function(){function t(e,r){var n,s,i,o,l,c,u,d,h,g,m,w,_,T,v,b,x;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),h=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(m=e.readUInt16(),g=m/2,e.pos+=6,i=function(){var P,F;for(F=[],c=P=0;0<=g?P<g:P>g;c=0<=g?++P:--P)F.push(e.readUInt16());return F}(),e.pos+=2,_=function(){var P,F;for(F=[],c=P=0;0<=g?P<g:P>g;c=0<=g?++P:--P)F.push(e.readUInt16());return F}(),u=function(){var P,F;for(F=[],c=P=0;0<=g?P<g:P>g;c=0<=g?++P:--P)F.push(e.readUInt16());return F}(),d=function(){var P,F;for(F=[],c=P=0;0<=g?P<g:P>g;c=0<=g?++P:--P)F.push(e.readUInt16());return F}(),s=(this.length-e.pos+this.offset)/2,l=function(){var P,F;for(F=[],c=P=0;0<=s?P<s:P>s;c=0<=s?++P:--P)F.push(e.readUInt16());return F}(),c=v=0,x=i.length;v<x;c=++v)for(T=i[c],n=b=w=_[c];w<=T?b<=T:b>=T;n=w<=T?++b:--b)d[c]===0?o=n+u[c]:(o=l[d[c]/2+(n-w)-(g-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}e.pos=h}return t.encode=function(e,r){var n,s,i,o,l,c,u,d,h,g,m,w,_,T,v,b,x,P,F,$,k,A,I,O,S,R,C,G,de,ne,X,Y,Q,se,Se,U,J,te,ie,ue,ge,we,be,Me,De,He;switch(G=new Jc,o=Object.keys(e).sort(function($e,dt){return $e-dt}),r){case"macroman":for(_=0,T=function(){var $e=[];for(w=0;w<256;++w)$e.push(0);return $e}(),b={0:0},i={},de=0,Q=o.length;de<Q;de++)b[be=e[s=o[de]]]==null&&(b[be]=++_),i[s]={old:e[s],new:b[e[s]]},T[s]=b[e[s]];return G.writeUInt16(1),G.writeUInt16(0),G.writeUInt32(12),G.writeUInt16(0),G.writeUInt16(262),G.writeUInt16(0),G.write(T),{charMap:i,subtable:G.data,maxGlyphID:_+1};case"unicode":for(R=[],h=[],x=0,b={},n={},v=u=null,ne=0,se=o.length;ne<se;ne++)b[F=e[s=o[ne]]]==null&&(b[F]=++x),n[s]={old:F,new:b[F]},l=b[F]-s,v!=null&&l===u||(v&&h.push(v),R.push(s),u=l),v=s;for(v&&h.push(v),h.push(65535),R.push(65535),O=2*(I=R.length),A=2*Math.pow(Math.log(I)/Math.LN2,2),g=Math.log(A/2)/Math.LN2,k=2*I-A,c=[],$=[],m=[],w=X=0,Se=R.length;X<Se;w=++X){if(S=R[w],d=h[w],S===65535){c.push(0),$.push(0);break}if(S-(C=n[S].new)>=32768)for(c.push(0),$.push(2*(m.length+I-w)),s=Y=S;S<=d?Y<=d:Y>=d;s=S<=d?++Y:--Y)m.push(n[s].new);else c.push(C-S),$.push(0)}for(G.writeUInt16(3),G.writeUInt16(1),G.writeUInt32(12),G.writeUInt16(4),G.writeUInt16(16+8*I+2*m.length),G.writeUInt16(0),G.writeUInt16(O),G.writeUInt16(A),G.writeUInt16(g),G.writeUInt16(k),ge=0,U=h.length;ge<U;ge++)s=h[ge],G.writeUInt16(s);for(G.writeUInt16(0),we=0,J=R.length;we<J;we++)s=R[we],G.writeUInt16(s);for(Me=0,te=c.length;Me<te;Me++)l=c[Me],G.writeUInt16(l);for(De=0,ie=$.length;De<ie;De++)P=$[De],G.writeUInt16(P);for(He=0,ue=m.length;He<ue;He++)_=m[He],G.writeUInt16(_);return{charMap:n,subtable:G.data,maxGlyphID:x+1}}},t}(),$P=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return vo(e,Ra),e.prototype.tag="cmap",e.prototype.parse=function(r){var n,s,i;for(r.pos=this.offset,this.version=r.readUInt16(),i=r.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)n=new eA(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(r,n){var s,i;return n==null&&(n="macroman"),s=eA.encode(r,n),(i=new Jc).writeUInt16(0),i.writeUInt16(1),s.table=i.data.concat(s.subtable),s},e}(),QX=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return vo(e,Ra),e.prototype.tag="hhea",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},e}(),JX=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return vo(e,Ra),e.prototype.tag="OS/2",e.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,s;for(s=[],n=0;n<10;++n)s.push(r.readByte());return s}(),this.charRange=function(){var n,s;for(s=[],n=0;n<4;++n)s.push(r.readInt());return s}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,s;for(s=[],n=0;n<2;n=++n)s.push(r.readInt());return s}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},e}(),XX=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return vo(e,Ra),e.prototype.tag="post",e.prototype.parse=function(r){var n,s,i;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var o;for(s=r.readUInt16(),this.glyphNameIndex=[],o=0;0<=s?o<s:o>s;o=0<=s?++o:--o)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],i=[];r.pos<this.offset+this.length;)n=r.readByte(),i.push(this.names.push(r.readString(n)));return i;case 151552:return s=r.readUInt16(),this.offsets=r.read(s);case 196608:break;case 262144:return this.map=(function(){var l,c,u;for(u=[],o=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;o=0<=c?++l:--l)u.push(r.readUInt32());return u}).call(this)}},e}(),ZX=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},eZ=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return vo(e,Ra),e.prototype.tag="name",e.prototype.parse=function(r){var n,s,i,o,l,c,u,d,h,g,m;for(r.pos=this.offset,r.readShort(),n=r.readShort(),c=r.readShort(),s=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)s.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(u={},o=h=0,g=s.length;h<g;o=++h)i=s[o],r.pos=i.offset,d=r.readString(i.length),l=new ZX(d,i),u[m=i.nameID]==null&&(u[m]=[]),u[i.nameID].push(l);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},e}(),tZ=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return vo(e,Ra),e.prototype.tag="maxp",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},e}(),rZ=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return vo(e,Ra),e.prototype.tag="hmtx",e.prototype.parse=function(r){var n,s,i,o,l,c,u;for(r.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,h;for(h=[],n=d=0;0<=i?d<i:d>i;n=0<=i?++d:--d)h.push(r.readInt16());return h}(),this.widths=(function(){var d,h,g,m;for(m=[],d=0,h=(g=this.metrics).length;d<h;d++)o=g[d],m.push(o.advance);return m}).call(this),s=this.widths[this.widths.length-1],u=[],n=l=0;0<=i?l<i:l>i;n=0<=i?++l:--l)u.push(this.widths.push(s));return u},e.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},e}(),WP=[].slice,nZ=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return vo(e,Ra),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(r){var n,s,i,o,l,c,u,d,h,g;return r in this.cache?this.cache[r]:(o=this.file.loca,n=this.file.contents,s=o.indexOf(r),(i=o.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+s,l=(c=new Jc(n.read(i))).readShort(),d=c.readShort(),g=c.readShort(),u=c.readShort(),h=c.readShort(),this.cache[r]=l===-1?new iZ(c,d,g,u,h):new sZ(c,l,d,g,u,h),this.cache[r]))},e.prototype.encode=function(r,n,s){var i,o,l,c,u;for(l=[],o=[],c=0,u=n.length;c<u;c++)i=r[n[c]],o.push(l.length),i&&(l=l.concat(i.encode(s)));return o.push(l.length),{table:l,offsets:o}},e}(),sZ=function(){function t(e,r,n,s,i,o){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=i,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),iZ=function(){function t(e,r,n,s,i){var o,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Jc(WP.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),aZ=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return vo(e,Ra),e.prototype.tag="loca",e.prototype.parse=function(r){var n,s;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,o;for(o=[],s=0,i=this.length;s<i;s+=2)o.push(2*r.readUInt16());return o}).call(this):(function(){var i,o;for(o=[],s=0,i=this.length;s<i;s+=4)o.push(r.readUInt32());return o}).call(this)},e.prototype.indexOf=function(r){return this.offsets[r]},e.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},e.prototype.encode=function(r,n){for(var s=new Uint32Array(this.offsets.length),i=0,o=0,l=0;l<s.length;++l)if(s[l]=i,o<n.length&&n[o]==l){++o,s[l]=i;var c=this.offsets[l],u=this.offsets[l+1]-c;u>0&&(i+=u)}for(var d=new Array(4*s.length),h=0;h<s.length;++h)d[4*h+3]=255&s[h],d[4*h+2]=(65280&s[h])>>8,d[4*h+1]=(16711680&s[h])>>16,d[4*h]=(4278190080&s[h])>>24;return d},e}(),oZ=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,s,i;for(r in s=this.font.cmap.tables[0].codeMap,e={},i=this.subset)n=i[r],e[r]=s[n];return e},t.prototype.glyphsFor=function(e){var r,n,s,i,o,l,c;for(s={},o=0,l=e.length;o<l;o++)s[i=e[o]]=this.font.glyf.glyphFor(i);for(i in r=[],s)(n=s[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in c=this.glyphsFor(r))n=c[i],s[i]=n;return s},t.prototype.encode=function(e,r){var n,s,i,o,l,c,u,d,h,g,m,w,_,T,v;for(s in n=$P.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),m={0:0},v=n.charMap)m[(c=v[s]).old]=c.new;for(w in g=n.maxGlyphID,o)w in m||(m[w]=g++);return d=function(b){var x,P;for(x in P={},b)P[b[x]]=x;return P}(m),h=Object.keys(d).sort(function(b,x){return b-x}),_=function(){var b,x,P;for(P=[],b=0,x=h.length;b<x;b++)l=h[b],P.push(d[l]);return P}(),i=this.font.glyf.encode(o,_,m),u=this.font.loca.encode(i.offsets,_),T={cmap:this.font.cmap.raw(),glyf:i.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(T["OS/2"]=this.font.os2.raw()),this.font.directory.encode(T)},t}();bt.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,s,i,o;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(e.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in i=["<<"],r)o=r[s],i.push("/"+s+" "+e.convert(o));return i.push(">>"),i.join(`
`)}return""+r},e}();function HP(t,e,r,n,s){n=n||{};var i=1.15,o=s.internal.scaleFactor,l=s.internal.getFontSize()/o,c=s.getLineHeightFactor?s.getLineHeightFactor():i,u=l*c,d=/\r\n|\r|\n/g,h="",g=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(h=typeof t=="string"?t.split(d):t,g=h.length||1),r+=l*(2-i),n.valign==="middle"?r-=g/2*u:n.valign==="bottom"&&(r-=g*u),n.halign==="center"||n.halign==="right"){var m=l;if(n.halign==="center"&&(m*=.5),h&&g>=1){for(var w=0;w<h.length;w++)s.text(h[w],e-s.getStringUnitWidth(h[w])*m,r),r+=u;return s}e-=s.getStringUnitWidth(t)*m}return n.halign==="justify"?s.text(t,e,r,{maxWidth:n.maxWidth||100,align:"justify"}):s.text(t,e,r),s}var tA={},Uh=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:tA=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var n,s,i;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var o=this.jsPDFDocument.internal.getFont(),l=o.fontStyle,c=o.fontName;if(e.font&&(c=e.font),e.fontStyle){l=e.fontStyle;var u=this.getFontList()[c];u&&u.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),l=u[0])}if(this.jsPDFDocument.setFont(c,l),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var d=t.unifyColor(e.fillColor);d&&(n=this.jsPDFDocument).setFillColor.apply(n,d),d=t.unifyColor(e.textColor),d&&(s=this.jsPDFDocument).setTextColor.apply(s,d),d=t.unifyColor(e.lineColor),d&&(i=this.jsPDFDocument).setDrawColor.apply(i,d),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,n){return this.jsPDFDocument.splitTextToSize(e,r,n)},t.prototype.rect=function(e,r,n,s,i){return this.jsPDFDocument.rect(e,r,n,s,i)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return tA||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),Ub=function(t,e){return Ub=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},Ub(t,e)};function GP(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ub(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var KP=function(t){GP(e,t);function e(r){var n=t.call(this)||this;return n._element=r,n}return e}(Array);function lZ(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function cZ(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function Gy(t,e,r){r.applyStyles(e,!0);var n=Array.isArray(t)?t:[t],s=n.map(function(i){return r.getTextWidth(i)}).reduce(function(i,o){return Math.max(i,o)},0);return s}function YP(t,e,r,n){var s=e.settings.tableLineWidth,i=e.settings.tableLineColor;t.applyStyles({lineWidth:s,lineColor:i});var o=QP(s,!1);o&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),n.y-r.y,o)}function QP(t,e){var r=t>0,n=e||e===0;return r&&n?"DF":r?"S":n?"F":null}function t1(t,e){var r,n,s,i;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(n=t.top)!==null&&n!==void 0?n:e,right:(s=t.right)!==null&&s!==void 0?s:e,bottom:(i=t.bottom)!==null&&i!==void 0?i:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function JP(t,e){var r=t1(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function uZ(t,e,r,n,s){var i={},o=1.3333333333333333,l=Ov(e,function(x){return s.getComputedStyle(x).backgroundColor});l!=null&&(i.fillColor=l);var c=Ov(e,function(x){return s.getComputedStyle(x).color});c!=null&&(i.textColor=c);var u=hZ(n,r);u&&(i.cellPadding=u);var d="borderTopColor",h=o*r,g=n.borderTopWidth;if(n.borderBottomWidth===g&&n.borderRightWidth===g&&n.borderLeftWidth===g){var m=(parseFloat(g)||0)/h;m&&(i.lineWidth=m)}else i.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/h,right:(parseFloat(n.borderRightWidth)||0)/h,bottom:(parseFloat(n.borderBottomWidth)||0)/h,left:(parseFloat(n.borderLeftWidth)||0)/h},i.lineWidth.top||(i.lineWidth.right?d="borderRightColor":i.lineWidth.bottom?d="borderBottomColor":i.lineWidth.left&&(d="borderLeftColor"));var w=Ov(e,function(x){return s.getComputedStyle(x)[d]});w!=null&&(i.lineColor=w);var _=["left","right","center","justify"];_.indexOf(n.textAlign)!==-1&&(i.halign=n.textAlign),_=["middle","bottom","top"],_.indexOf(n.verticalAlign)!==-1&&(i.valign=n.verticalAlign);var T=parseInt(n.fontSize||"");isNaN(T)||(i.fontSize=T/o);var v=dZ(n);v&&(i.fontStyle=v);var b=(n.fontFamily||"").toLowerCase();return t.indexOf(b)!==-1&&(i.font=b),i}function dZ(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function Ov(t,e){var r=XP(t,e);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var s=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],i=parseInt(n[4]);return i===0||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?null:s}function XP(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:XP(t.parentElement,e):r}function hZ(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/e),s=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,i=r.map(function(l){return parseInt(l||"0")/n}),o=t1(i,0);return s>o.top&&(o.top=s),s>o.bottom&&(o.bottom=s),o}function ZP(t,e,r,n,s){var i,o;n===void 0&&(n=!1),s===void 0&&(s=!1);var l;typeof e=="string"?l=r.document.querySelector(e):l=e;var c=Object.keys(t.getFontList()),u=t.scaleFactor(),d=[],h=[],g=[];if(!l)return console.error("Html table could not be found with input: ",e),{head:d,body:h,foot:g};for(var m=0;m<l.rows.length;m++){var w=l.rows[m],_=(o=(i=w==null?void 0:w.parentElement)===null||i===void 0?void 0:i.tagName)===null||o===void 0?void 0:o.toLowerCase(),T=fZ(c,u,r,w,n,s);T&&(_==="thead"?d.push(T):_==="tfoot"?g.push(T):h.push(T))}return{head:d,body:h,foot:g}}function fZ(t,e,r,n,s,i){for(var o=new KP(n),l=0;l<n.cells.length;l++){var c=n.cells[l],u=r.getComputedStyle(c);if(s||u.display!=="none"){var d=void 0;i&&(d=uZ(t,c,e,u,r)),o.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:d,_element:c,content:mZ(c)})}}var h=r.getComputedStyle(n);if(o.length>0&&(s||h.display!=="none"))return o}function mZ(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function pZ(t,e,r){for(var n=0,s=[t,e,r];n<s.length;n++){var i=s[n];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function Xo(t,e,r,n,s){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),o=1;o<arguments.length;o++){var l=arguments[o];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(i[c]=l[c])}return i}function gZ(t,e){var r=new Uh(t),n=r.getDocumentOptions(),s=r.getGlobalOptions();pZ(s,n,e);var i=Xo({},s,n,e),o;typeof window<"u"&&(o=window);var l=yZ(s,n,e),c=xZ(s,n,e),u=vZ(r,i),d=wZ(r,i,o);return{id:e.tableId,content:d,hooks:c,styles:l,settings:u}}function yZ(t,e,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},s=function(c){if(c==="columnStyles"){var u=t[c],d=e[c],h=r[c];n.columnStyles=Xo({},u,d,h)}else{var g=[t,e,r],m=g.map(function(w){return w[c]||{}});n[c]=Xo({},m[0],m[1],m[2])}},i=0,o=Object.keys(n);i<o.length;i++){var l=o[i];s(l)}return n}function xZ(t,e,r){for(var n=[t,e,r],s={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,o=n;i<o.length;i++){var l=o[i];l.didParseCell&&s.didParseCell.push(l.didParseCell),l.willDrawCell&&s.willDrawCell.push(l.willDrawCell),l.didDrawCell&&s.didDrawCell.push(l.didDrawCell),l.willDrawPage&&s.willDrawPage.push(l.willDrawPage),l.didDrawPage&&s.didDrawPage.push(l.didDrawPage)}return s}function vZ(t,e){var r,n,s,i,o,l,c,u,d,h,g,m,w=t1(e.margin,40/t.scaleFactor()),_=(r=bZ(t,e.startY))!==null&&r!==void 0?r:w.top,T;e.showFoot===!0?T="everyPage":e.showFoot===!1?T="never":T=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var v;e.showHead===!0?v="everyPage":e.showHead===!1?v="never":v=(s=e.showHead)!==null&&s!==void 0?s:"everyPage";var b=(i=e.useCss)!==null&&i!==void 0?i:!1,x=e.theme||(b?"plain":"striped"),P=!!e.horizontalPageBreak,F=(o=e.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(l=e.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:b,theme:x,startY:_,margin:w,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(u=e.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(d=e.tableWidth)!==null&&d!==void 0?d:"auto",showHead:v,showFoot:T,tableLineWidth:(h=e.tableLineWidth)!==null&&h!==void 0?h:0,tableLineColor:(g=e.tableLineColor)!==null&&g!==void 0?g:200,horizontalPageBreak:P,horizontalPageBreakRepeat:F,horizontalPageBreakBehaviour:(m=e.horizontalPageBreakBehaviour)!==null&&m!==void 0?m:"afterAllRows"}}function bZ(t,e){var r=t.getLastAutoTable(),n=t.scaleFactor(),s=t.pageNumber(),i=!1;if(r&&r.startPageNumber){var o=r.startPageNumber+r.pageNumber-1;i=o===s}return typeof e=="number"?e:(e==null||e===!1)&&i&&(r==null?void 0:r.finalY)!=null?r.finalY+20/n:null}function wZ(t,e,r){var n=e.head||[],s=e.body||[],i=e.foot||[];if(e.html){var o=e.includeHiddenHtml;if(r){var l=ZP(t,e.html,r,o,e.useCss)||{};n=l.head||n,s=l.body||n,i=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=e.columns||NZ(n,s,i);return{columns:c,head:n,body:s,foot:i}}function NZ(t,e,r){var n=t[0]||e[0]||r[0]||[],s=[];return Object.keys(n).filter(function(i){return i!=="_element"}).forEach(function(i){var o=1,l;Array.isArray(n)?l=n[parseInt(i)]:l=n[i],typeof l=="object"&&!Array.isArray(l)&&(o=(l==null?void 0:l.colSpan)||1);for(var c=0;c<o;c++){var u=void 0;Array.isArray(n)?u=s.length:u=i+(c>0?"_".concat(c):"");var d={dataKey:u};s.push(d)}}),s}var zb=function(){function t(e,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=e.getDocument()}return t}(),_Z=function(t){GP(e,t);function e(r,n,s,i,o,l){var c=t.call(this,r,n,l)||this;return c.cell=s,c.row=i,c.column=o,c.section=i.section,c}return e}(zb),jZ=function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,n,s,i,o){for(var l=0,c=r;l<c.length;l++){var u=c[l],d=new _Z(e,this,n,s,i,o),h=u(d)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],h)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var n=0,s=this.hooks.didDrawPage;n<s.length;n++){var i=s[n];i(new zb(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var n=0,s=this.hooks.willDrawPage;n<s.length;n++){var i=s[n];i(new zb(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(s,i){return s+i.wrappedWidth},0);return r}else{var n=this.settings.margin;return e-n.left-n.right}},t}(),eR=function(){function t(e,r,n,s,i){i===void 0&&(i=!1),this.height=0,this.raw=e,e instanceof KP&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=n,this.cells=s,this.spansMultiplePages=i}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(n,s){var i;return Math.max(n,((i=r.cells[s.index])===null||i===void 0?void 0:i.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(n){var s=r.cells[n.index];return s?s.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var n=this;return e.reduce(function(s,i){var o=n.cells[i.index];if(!o)return 0;var l=r.getLineHeight(o.styles.fontSize),c=o.padding("vertical"),u=c+l;return u>s?u:s},0)},t}(),tR=function(){function t(e,r,n){var s;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=e;var i=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,i=(s=e.content)!==null&&s!==void 0?s:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var o=i!=null?""+i:"",l=/\r\n|\r|\n/g;this.text=o.split(l)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var s=this.width-this.padding("horizontal");n=this.x+s/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,s=this.styles.fontSize/e*r,i=n*s+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=t1(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t}(),SZ=function(){function t(e,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=n}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,n=0,s=e.allRows();n<s.length;n++){var i=s[n],o=i.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(r=Math.max(r,o.styles.cellWidth))}return r},t}();function AZ(t,e){EZ(t,e);var r=[],n=0;e.columns.forEach(function(i){var o=i.getMaxCustomCellWidth(e);o?i.width=o:(i.width=i.wrappedWidth,r.push(i)),n+=i.width});var s=e.getWidth(t.pageSize().width)-n;s&&(s=qb(r,s,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),s&&(s=qb(r,s,function(i){return i.minWidth})),s=Math.abs(s),!e.settings.horizontalPageBreak&&s>.1/t.scaleFactor()&&(s=s<1?s:Math.round(s),console.warn("Of the table content, ".concat(s," units width could not fit page"))),TZ(e),IZ(e,t),kZ(e)}function EZ(t,e){var r=t.scaleFactor(),n=e.settings.horizontalPageBreak,s=JP(t,e);e.allRows().forEach(function(i){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],u=i.cells[c.index];if(u){var d=e.hooks.didParseCell;e.callCellHooks(t,d,u,i,c,null);var h=u.padding("horizontal");u.contentWidth=Gy(u.text,u.styles,t)+h;var g=Gy(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,t);if(u.minReadableWidth=g+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||n===!0)u.contentWidth>s?(u.minWidth=s,u.wrappedWidth=s):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var m=10/r;u.minWidth=u.styles.minCellWidth||m,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),e.allRows().forEach(function(i){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],u=i.cells[c.index];if(u&&u.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,u.wrappedWidth),c.minWidth=Math.max(c.minWidth,u.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,u.minReadableWidth);else{var d=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},h=d.cellWidth||d.minCellWidth;h&&typeof h=="number"&&(c.minWidth=h,c.wrappedWidth=h)}u&&(u.colSpan>1&&!c.minWidth&&(c.minWidth=u.minWidth),u.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=u.minWidth))}})}function qb(t,e,r){for(var n=e,s=t.reduce(function(m,w){return m+w.wrappedWidth},0),i=0;i<t.length;i++){var o=t[i],l=o.wrappedWidth/s,c=n*l,u=o.width+c,d=r(o),h=u<d?d:u;e-=h-o.width,o.width=h}if(e=Math.round(e*1e10)/1e10,e){var g=t.filter(function(m){return e<0?m.width>r(m):!0});g.length&&(e=qb(g,e,r))}return e}function kZ(t){for(var e={},r=1,n=t.allRows(),s=0;s<n.length;s++)for(var i=n[s],o=0,l=t.columns;o<l.length;o++){var c=l[o],u=e[c.index];if(r>1)r--,delete i.cells[c.index];else if(u)u.cell.height+=i.height,r=u.cell.colSpan,delete i.cells[c.index],u.left--,u.left<=1&&delete e[c.index];else{var d=i.cells[c.index];if(!d)continue;if(d.height=i.height,d.rowSpan>1){var h=n.length-s,g=d.rowSpan>h?h:d.rowSpan;e[c.index]={cell:d,left:g,row:i}}}}}function TZ(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var n=e[r],s=null,i=0,o=0,l=0;l<t.columns.length;l++){var c=t.columns[l];if(o-=1,o>1&&t.columns[l+1])i+=c.width,delete n.cells[c.index];else if(s){var u=s;delete n.cells[c.index],s=null,u.width=c.width+i}else{var u=n.cells[c.index];if(!u)continue;if(o=u.colSpan,i=0,u.colSpan>1){s=u,i+=c.width;continue}u.width=c.width+i}}}function IZ(t,e){for(var r={count:0,height:0},n=0,s=t.allRows();n<s.length;n++){for(var i=s[n],o=0,l=t.columns;o<l.length;o++){var c=l[o],u=i.cells[c.index];if(u){e.applyStyles(u.styles,!0);var d=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=e.splitTextToSize(u.text,d+1/e.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=rA(u.text,d,u.styles,e,"...");else if(u.styles.overflow==="hidden")u.text=rA(u.text,d,u.styles,e,"");else if(typeof u.styles.overflow=="function"){var h=u.styles.overflow(u.text,d);typeof h=="string"?u.text=[h]:u.text=h}u.contentHeight=u.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var g=u.contentHeight/u.rowSpan;u.rowSpan>1&&r.count*r.height<g*u.rowSpan?r={height:g,count:u.rowSpan}:r&&r.count>0&&r.height>g&&(g=r.height),g>i.height&&(i.height=g)}}r.count--}}function rA(t,e,r,n,s){return t.map(function(i){return CZ(i,e,r,n,s)})}function CZ(t,e,r,n,s){var i=1e4*n.scaleFactor();if(e=Math.ceil(e*i)/i,e>=Gy(t,r,n))return t;for(;e<Gy(t+s,r,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+s}function PZ(t,e){var r=new Uh(t),n=RZ(e,r.scaleFactor()),s=new jZ(e,n);return AZ(r,s),r.applyStyles(r.userStyles),s}function RZ(t,e){var r=t.content,n=LZ(r.columns);if(r.head.length===0){var s=nA(n,"head");s&&r.head.push(s)}if(r.foot.length===0){var s=nA(n,"foot");s&&r.foot.push(s)}var i=t.settings.theme,o=t.styles;return{columns:n,head:Mv("head",r.head,n,o,i,e),body:Mv("body",r.body,n,o,i,e),foot:Mv("foot",r.foot,n,o,i,e)}}function Mv(t,e,r,n,s,i){var o={},l=e.map(function(c,u){for(var d=0,h={},g=0,m=0,w=0,_=r;w<_.length;w++){var T=_[w];if(o[T.index]==null||o[T.index].left===0)if(m===0){var v=void 0;Array.isArray(c)?v=c[T.index-g-d]:v=c[T.dataKey];var b={};typeof v=="object"&&!Array.isArray(v)&&(b=(v==null?void 0:v.styles)||{});var x=OZ(t,T,u,s,n,i,b),P=new tR(v,x,t);h[T.dataKey]=P,h[T.index]=P,m=P.colSpan-1,o[T.index]={left:P.rowSpan-1,times:m}}else m--,g++;else o[T.index].left--,m=o[T.index].times,d++}return new eR(c,u,t,h)});return l}function nA(t,e){var r={};return t.forEach(function(n){if(n.raw!=null){var s=DZ(e,n.raw);s!=null&&(r[n.dataKey]=s)}}),Object.keys(r).length>0?r:null}function DZ(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function LZ(t){return t.map(function(e,r){var n,s;return typeof e=="object"?s=(n=e.dataKey)!==null&&n!==void 0?n:r:s=r,new SZ(s,e,r)})}function OZ(t,e,r,n,s,i,o){var l=cZ(n),c;t==="head"?c=s.headStyles:t==="body"?c=s.bodyStyles:t==="foot"&&(c=s.footStyles);var u=Xo({},l.table,l[t],s.styles,c),d=s.columnStyles[e.dataKey]||s.columnStyles[e.index]||{},h=t==="body"?d:{},g=t==="body"&&r%2===0?Xo({},l.alternateRow,s.alternateRowStyles):{},m=lZ(i),w=Xo({},m,u,g,h);return Xo(w,o)}function MZ(t,e,r){var n;r===void 0&&(r={});var s=JP(t,e),i=new Map,o=[],l=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(g){var m=e.columns.find(function(w){return w.dataKey===g||w.index===g});m&&!i.has(m.index)&&(i.set(m.index,!0),o.push(m.index),l.push(e.columns[m.index]),s-=m.wrappedWidth)});for(var u=!0,d=(n=r==null?void 0:r.start)!==null&&n!==void 0?n:0;d<e.columns.length;){if(i.has(d)){d++;continue}var h=e.columns[d].wrappedWidth;if(u||s>=h)u=!1,o.push(d),l.push(e.columns[d]),s-=h;else break;d++}return{colIndexes:o,columns:l,lastIndex:d-1}}function FZ(t,e){for(var r=[],n=0;n<e.columns.length;n++){var s=MZ(t,e,{start:n});s.columns.length&&(r.push(s),n=s.lastIndex)}return r}function VZ(t,e){var r=e.settings,n=r.startY,s=r.margin,i={x:s.left,y:n},o=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),l=n+s.bottom+o;if(r.pageBreak==="avoid"){var c=e.body,u=c.reduce(function(g,m){return g+m.height},0);l+=u}var d=new Uh(t);(r.pageBreak==="always"||r.startY!=null&&l>d.pageSize().height)&&(nR(d),i.y=s.top),e.callWillDrawPageHooks(d,i);var h=Xo({},i);e.startPageNumber=d.pageNumber(),r.horizontalPageBreak?BZ(d,e,h,i):(d.applyStyles(d.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(g){return yl(d,e,g,i,e.columns)}),d.applyStyles(d.userStyles),e.body.forEach(function(g,m){var w=m===e.body.length-1;Ky(d,e,g,w,h,i,e.columns)}),d.applyStyles(d.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(g){return yl(d,e,g,i,e.columns)})),YP(d,e,h,i),e.callEndPageHooks(d,i),e.finalY=i.y,t.lastAutoTable=e,d.applyStyles(d.userStyles)}function BZ(t,e,r,n){var s=FZ(t,e),i=e.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")s.forEach(function(u,d){t.applyStyles(t.userStyles),d>0?Vm(t,e,r,n,u.columns,!0):sA(t,e,n,u.columns),UZ(t,e,r,n,u.columns),Fv(t,e,n,u.columns)});else for(var o=-1,l=s[0],c=function(){var u=o;if(l){t.applyStyles(t.userStyles);var d=l.columns;o>=0?Vm(t,e,r,n,d,!0):sA(t,e,n,d),u=iA(t,e,o+1,n,d),Fv(t,e,n,d)}var h=u-o;s.slice(1).forEach(function(g){t.applyStyles(t.userStyles),Vm(t,e,r,n,g.columns,!0),iA(t,e,o+1,n,g.columns,h),Fv(t,e,n,g.columns)}),o=u};o<e.body.length-1;)c()}function sA(t,e,r,n){var s=e.settings;t.applyStyles(t.userStyles),(s.showHead==="firstPage"||s.showHead==="everyPage")&&e.head.forEach(function(i){return yl(t,e,i,r,n)})}function UZ(t,e,r,n,s){t.applyStyles(t.userStyles),e.body.forEach(function(i,o){var l=o===e.body.length-1;Ky(t,e,i,l,r,n,s)})}function iA(t,e,r,n,s,i){t.applyStyles(t.userStyles),i=i??e.body.length;var o=Math.min(r+i,e.body.length),l=-1;return e.body.slice(r,o).forEach(function(c,u){var d=r+u===e.body.length-1,h=rR(t,e,d,n);c.canEntireRowFit(h,s)&&(yl(t,e,c,n,s),l=r+u)}),l}function Fv(t,e,r,n){var s=e.settings;t.applyStyles(t.userStyles),(s.showFoot==="lastPage"||s.showFoot==="everyPage")&&e.foot.forEach(function(i){return yl(t,e,i,r,n)})}function zZ(t,e,r){var n=r.getLineHeight(t.styles.fontSize),s=t.padding("vertical"),i=Math.floor((e-s)/n);return Math.max(0,i)}function qZ(t,e,r,n){var s={};t.spansMultiplePages=!0,t.height=0;for(var i=0,o=0,l=r.columns;o<l.length;o++){var c=l[o],u=t.cells[c.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var d=new tR(u.raw,u.styles,u.section);d=Xo(d,u),d.text=[];var h=zZ(u,e,n);u.text.length>h&&(d.text=u.text.splice(h,u.text.length));var g=n.scaleFactor(),m=n.getLineHeightFactor();u.contentHeight=u.getContentHeight(g,m),u.contentHeight>=e&&(u.contentHeight=e,d.styles.minCellHeight-=e),u.contentHeight>t.height&&(t.height=u.contentHeight),d.contentHeight=d.getContentHeight(g,m),d.contentHeight>i&&(i=d.contentHeight),s[c.index]=d}}var w=new eR(t.raw,-1,t.section,s,!0);w.height=i;for(var _=0,T=r.columns;_<T.length;_++){var c=T[_],d=w.cells[c.index];d&&(d.height=w.height);var u=t.cells[c.index];u&&(u.height=t.height)}return w}function $Z(t,e,r,n){var s=t.pageSize().height,i=n.settings.margin,o=i.top+i.bottom,l=s-o;e.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=e.getMinimumRowHeight(n.columns,t),u=c<r;if(c>l)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var d=e.hasRowSpan(n.columns),h=e.getMaxCellHeight(n.columns)>l;return h?(d&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(d||n.settings.rowPageBreak==="avoid")}function Ky(t,e,r,n,s,i,o){var l=rR(t,e,n,i);if(r.canEntireRowFit(l,o))yl(t,e,r,i,o);else if($Z(t,r,l,e)){var c=qZ(r,l,e,t);yl(t,e,r,i,o),Vm(t,e,s,i,o),Ky(t,e,c,n,s,i,o)}else Vm(t,e,s,i,o),Ky(t,e,r,n,s,i,o)}function yl(t,e,r,n,s){n.x=e.settings.margin.left;for(var i=0,o=s;i<o.length;i++){var l=o[i],c=r.cells[l.index];if(!c){n.x+=l.width;continue}t.applyStyles(c.styles),c.x=n.x,c.y=n.y;var u=e.callCellHooks(t,e.hooks.willDrawCell,c,r,l,n);if(u===!1){n.x+=l.width;continue}WZ(t,c,n);var d=c.getTextPos();HP(c.text,d.x,d.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function WZ(t,e,r){var n=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var s=QP(n.lineWidth,n.fillColor);s&&t.rect(e.x,r.y,e.width,e.height,s)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),HZ(t,e,r,n.lineWidth))}function HZ(t,e,r,n){var s,i,o,l;n.top&&(s=r.x,i=r.y,o=r.x+e.width,l=r.y,n.right&&(o+=.5*n.right),n.left&&(s-=.5*n.left),c(n.top,s,i,o,l)),n.bottom&&(s=r.x,i=r.y+e.height,o=r.x+e.width,l=r.y+e.height,n.right&&(o+=.5*n.right),n.left&&(s-=.5*n.left),c(n.bottom,s,i,o,l)),n.left&&(s=r.x,i=r.y,o=r.x,l=r.y+e.height,n.top&&(i-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,s,i,o,l)),n.right&&(s=r.x+e.width,i=r.y,o=r.x+e.width,l=r.y+e.height,n.top&&(i-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,s,i,o,l));function c(u,d,h,g,m){t.getDocument().setLineWidth(u),t.getDocument().line(d,h,g,m,"S")}}function rR(t,e,r,n){var s=e.settings.margin.bottom,i=e.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&r)&&(s+=e.getFootHeight(e.columns)),t.pageSize().height-n.y-s}function Vm(t,e,r,n,s,i){s===void 0&&(s=[]),i===void 0&&(i=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!i&&e.foot.forEach(function(l){return yl(t,e,l,n,s)}),e.callEndPageHooks(t,n);var o=e.settings.margin;YP(t,e,r,n),nR(t),e.pageNumber++,n.x=o.left,n.y=o.top,r.y=o.top,e.callWillDrawPageHooks(t,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(l){return yl(t,e,l,n,s)}),t.applyStyles(t.userStyles))}function nR(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function GZ(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e[0],s=gZ(this,n),i=PZ(this,s);return VZ(this,i),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,n,s){HP(e,r,n,s,this)},t.API.autoTableSetDefaults=function(e){return Uh.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){Uh.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var s=new Uh(this),i=ZP(s,e,window,r,!1),o=i.head,l=i.body,c=((n=o[0])===null||n===void 0?void 0:n.map(function(u){return u.content}))||[];return{columns:c,rows:l,data:l}}}var Vv;try{if(typeof window<"u"&&window){var aA=window,oA=aA.jsPDF||((Vv=aA.jspdf)===null||Vv===void 0?void 0:Vv.jsPDF);oA&&GZ(oA)}}catch(t){console.error("Could not apply autoTable plugin",t)}const KZ=()=>{const[t,e]=M.useState(!1),[r,n]=M.useState(null),[s,i]=M.useState("today"),[o,l]=M.useState({start:Lr(new Date,"yyyy-MM-dd"),end:Lr(new Date,"yyyy-MM-dd")}),[c,u]=M.useState(!1),[d,h]=M.useState({});M.useEffect(()=>{m()},[s,o]);const g=()=>{const x=new Date;switch(s){case"today":return{start:Nh(x),end:Xg(x)};case"yesterday":const P=YQ(x,1);return{start:Nh(P),end:Xg(P)};case"this_week":return{start:ud(x,{weekStartsOn:1}),end:S3(x,{weekStartsOn:1})};case"last_week":const F=JQ(x,1);return{start:ud(F,{weekStartsOn:1}),end:S3(F,{weekStartsOn:1})};case"this_month":return{start:j3(x),end:_3(x)};case"last_month":const $=QQ(x,1);return{start:j3($),end:_3($)};case"custom":return{start:Nh(new Date(o.start)),end:Xg(new Date(o.end))};default:return{start:Nh(x),end:Xg(x)}}},m=async()=>{try{e(!0);const P={dateRange:g(),...d},F=await ls.getOrdersWithFilters(P),$=w(F);n({orders:F,stats:$})}catch(x){console.error("Error generating report:",x),_t.error("Fehler beim Generieren des Berichts")}finally{e(!1)}},w=x=>{const P=x.length,F=x.reduce((R,C)=>R+C.totalAmount,0),$=P>0?F/P:0,k=new Map;x.forEach(R=>{R.items.forEach(C=>{const G=k.get(C.name)||{quantity:0,revenue:0};k.set(C.name,{quantity:G.quantity+C.quantity,revenue:G.revenue+C.price*C.quantity})})});const A=Array.from(k.entries()).map(([R,C])=>({name:R,...C})).sort((R,C)=>C.revenue-R.revenue).slice(0,10),I=x.reduce((R,C)=>(R[C.status]=(R[C.status]||0)+1,R),{}),O=x.reduce((R,C)=>{const G=Lr(C.createdAt,"HH");return R[G]=(R[G]||0)+1,R},{}),S=x.reduce((R,C)=>{var de;const G=((de=C.payment)==null?void 0:de.method)||"unknown";return R[G]=(R[G]||0)+1,R},{});return{totalOrders:P,totalRevenue:F,averageOrderValue:$,topProducts:A,ordersByStatus:I,ordersByHour:O,paymentMethods:S}},_=()=>{const x=g();switch(s){case"today":return"Heute";case"yesterday":return"Gestern";case"this_week":return"Diese Woche";case"last_week":return"Letzte Woche";case"this_month":return"Dieser Monat";case"last_month":return"Letzter Monat";case"custom":return`${Lr(x.start,"dd.MM.yyyy",{locale:Ss})} - ${Lr(x.end,"dd.MM.yyyy",{locale:Ss})}`;default:return"Unbekannt"}},T=async()=>{if(r)try{const x=new bt;x.setFontSize(20),x.setTextColor(212,175,55),x.text("Royal Shisha Bar",20,25),x.setFontSize(16),x.setTextColor(0,0,0),x.text("Bestellbericht",20,40),x.setFontSize(12),x.text(`Zeitraum: ${_()}`,20,50),x.text(`Erstellt am: ${Lr(new Date,"dd.MM.yyyy HH:mm",{locale:Ss})}`,20,60),x.setFontSize(14),x.text("Zusammenfassung",20,80);const P=[["Gesamtbestellungen",r.stats.totalOrders.toString()],["Gesamtumsatz",`${r.stats.totalRevenue.toFixed(2)}€`],["Durchschnittlicher Bestellwert",`${r.stats.averageOrderValue.toFixed(2)}€`]];x.autoTable({startY:85,head:[["Metrik","Wert"]],body:P,theme:"grid",headStyles:{fillColor:[212,175,55]},margin:{left:20},columnStyles:{0:{cellWidth:80},1:{cellWidth:60}}});let F=x.lastAutoTable.finalY+20;x.setFontSize(14),x.text("Bestellungen nach Status",20,F);const $=Object.entries(r.stats.ordersByStatus).map(([O,S])=>[v(O),S.toString()]);x.autoTable({startY:F+5,head:[["Status","Anzahl"]],body:$,theme:"grid",headStyles:{fillColor:[212,175,55]},margin:{left:20},columnStyles:{0:{cellWidth:80},1:{cellWidth:40}}}),F=x.lastAutoTable.finalY+20,x.setFontSize(14),x.text("Top Produkte",20,F);const k=r.stats.topProducts.slice(0,10).map(O=>[O.name,O.quantity.toString(),`${O.revenue.toFixed(2)}€`]);x.autoTable({startY:F+5,head:[["Produkt","Menge","Umsatz"]],body:k,theme:"grid",headStyles:{fillColor:[212,175,55]},margin:{left:20},columnStyles:{0:{cellWidth:80},1:{cellWidth:30},2:{cellWidth:40}}}),x.addPage(),x.setFontSize(16),x.text("Detaillierte Bestellliste",20,25);const A=r.orders.map(O=>[`#${O.id.slice(-8)}`,`Tisch ${O.tableNumber}`,O.customerName||"Anonym",`${O.totalAmount.toFixed(2)}€`,v(O.status),Lr(O.createdAt,"dd.MM HH:mm",{locale:Ss})]);x.autoTable({startY:35,head:[["ID","Tisch","Kunde","Betrag","Status","Zeit"]],body:A,theme:"grid",headStyles:{fillColor:[212,175,55]},margin:{left:20},columnStyles:{0:{cellWidth:25},1:{cellWidth:25},2:{cellWidth:35},3:{cellWidth:25},4:{cellWidth:30},5:{cellWidth:30}},styles:{fontSize:8}});const I=`bestellbericht_${Lr(new Date,"yyyy-MM-dd_HH-mm")}.pdf`;x.save(I),_t.success("PDF-Bericht erfolgreich erstellt!")}catch(x){console.error("Error generating PDF:",x),_t.error("Fehler beim Erstellen des PDF-Berichts")}},v=x=>({pending:"Ausstehend",confirmed:"Bestätigt",preparing:"In Zubereitung",ready:"Bereit",delivered:"Ausgeliefert",cancelled:"Storniert"})[x]||x,b=()=>{if(!r)return;const x=[["Bestellungs-ID","Tisch","Kunde","Telefon","Betrag","Status","Datum","Zeit","Artikel"].join(","),...r.orders.map(k=>[`#${k.id.slice(-8)}`,`Tisch ${k.tableNumber}`,k.customerName||"Anonym",k.customerPhone||"",`${k.totalAmount.toFixed(2)}€`,v(k.status),Lr(k.createdAt,"dd.MM.yyyy",{locale:Ss}),Lr(k.createdAt,"HH:mm",{locale:Ss}),k.items.map(A=>`${A.quantity}x ${A.name}`).join("; ")].map(A=>`"${A}"`).join(","))].join(`
`),P=new Blob([x],{type:"text/csv;charset=utf-8;"}),F=document.createElement("a"),$=URL.createObjectURL(P);F.setAttribute("href",$),F.setAttribute("download",`bestellbericht_${Lr(new Date,"yyyy-MM-dd_HH-mm")}.csv`),F.style.visibility="hidden",document.body.appendChild(F),F.click(),document.body.removeChild(F),_t.success("CSV-Export erfolgreich!")};return t&&!r?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-royal-gold"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-royal font-bold text-royal-charcoal",children:"Bestellberichte"}),a.jsx("p",{className:"text-royal-charcoal/70",children:"Generieren Sie detaillierte Berichte über Bestellungen und Umsätze"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:b,disabled:!r||r.orders.length===0,className:"bg-green-600 text-white px-4 py-2 rounded-royal royal-glow hover:shadow-lg transition-all duration-300 flex items-center space-x-2 disabled:opacity-50",children:[a.jsx(Sa,{className:"w-4 h-4"}),a.jsx("span",{children:"CSV Export"})]}),a.jsxs("button",{onClick:T,disabled:!r||r.orders.length===0,className:"bg-royal-gradient-gold text-royal-charcoal px-4 py-2 rounded-royal royal-glow hover:shadow-lg transition-all duration-300 flex items-center space-x-2 disabled:opacity-50",children:[a.jsx(Ja,{className:"w-4 h-4"}),a.jsx("span",{children:"PDF Download"})]})]})]}),a.jsxs("div",{className:"bg-royal-charcoal-dark p-6 rounded-royal shadow-md border border-royal-gold/30 royal-glow",children:[a.jsx("h3",{className:"text-lg font-semibold text-royal-cream mb-4",children:"Zeitraum auswählen"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3 mb-4",children:[{value:"today",label:"Heute"},{value:"yesterday",label:"Gestern"},{value:"this_week",label:"Diese Woche"},{value:"last_week",label:"Letzte Woche"},{value:"this_month",label:"Dieser Monat"},{value:"last_month",label:"Letzter Monat"},{value:"custom",label:"Benutzerdefiniert"}].map(x=>a.jsx("button",{onClick:()=>i(x.value),className:`px-3 py-2 rounded text-sm font-medium transition-colors ${s===x.value?"bg-royal-gold text-royal-charcoal":"bg-royal-charcoal text-royal-cream hover:bg-royal-charcoal-light"}`,children:x.label},x.value))}),s==="custom"&&a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-1",children:"Von"}),a.jsx("input",{type:"date",value:o.start,onChange:x=>l(P=>({...P,start:x.target.value})),className:"w-full px-3 py-2 bg-royal-charcoal text-royal-cream border border-royal-gold/30 rounded focus:outline-none focus:ring-1 focus:ring-royal-gold"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-1",children:"Bis"}),a.jsx("input",{type:"date",value:o.end,onChange:x=>l(P=>({...P,end:x.target.value})),className:"w-full px-3 py-2 bg-royal-charcoal text-royal-cream border border-royal-gold/30 rounded focus:outline-none focus:ring-1 focus:ring-royal-gold"})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("button",{onClick:()=>u(!c),className:"flex items-center space-x-2 text-royal-gold hover:text-royal-gold/80 transition-colors",children:[a.jsx(Uy,{className:"w-4 h-4"}),a.jsx("span",{children:"Zusätzliche Filter"})]}),a.jsxs("span",{className:"text-royal-cream text-sm",children:["Zeitraum: ",_()]})]}),a.jsxs("button",{onClick:m,disabled:t,className:"bg-royal-purple text-white px-4 py-2 rounded royal-glow hover:shadow-lg transition-all duration-300 flex items-center space-x-2 disabled:opacity-50",children:[t?a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):a.jsx(xp,{className:"w-4 h-4"}),a.jsx("span",{children:"Bericht generieren"})]})]}),c&&a.jsx(oe.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 pt-4 border-t border-royal-gold/20",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-1",children:"Status"}),a.jsxs("select",{value:d.status||"",onChange:x=>h(P=>({...P,status:x.target.value?x.target.value:void 0})),className:"w-full px-3 py-2 bg-royal-charcoal text-royal-cream border border-royal-gold/30 rounded focus:outline-none focus:ring-1 focus:ring-royal-gold",children:[a.jsx("option",{value:"",children:"Alle Status"}),a.jsx("option",{value:"pending",children:"Ausstehend"}),a.jsx("option",{value:"confirmed",children:"Bestätigt"}),a.jsx("option",{value:"preparing",children:"In Zubereitung"}),a.jsx("option",{value:"ready",children:"Bereit"}),a.jsx("option",{value:"delivered",children:"Ausgeliefert"}),a.jsx("option",{value:"cancelled",children:"Storniert"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-1",children:"Tischnummer"}),a.jsx("input",{type:"number",min:"1",placeholder:"z.B. 5",value:d.tableNumber||"",onChange:x=>h(P=>({...P,tableNumber:x.target.value?parseInt(x.target.value):void 0})),className:"w-full px-3 py-2 bg-royal-charcoal text-royal-cream border border-royal-gold/30 rounded focus:outline-none focus:ring-1 focus:ring-royal-gold"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream mb-1",children:"Suche"}),a.jsx("input",{type:"text",placeholder:"Kundenname oder Artikel...",value:d.search||"",onChange:x=>h(P=>({...P,search:x.target.value||void 0})),className:"w-full px-3 py-2 bg-royal-charcoal text-royal-cream border border-royal-gold/30 rounded focus:outline-none focus:ring-1 focus:ring-royal-gold"})]})]})})]}),r&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-royal-charcoal-dark p-6 rounded-royal shadow-md border border-royal-gold/30 royal-glow",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-royal-cream/70",children:"Bestellungen"}),a.jsx("p",{className:"text-2xl font-bold text-royal-cream",children:r.stats.totalOrders})]}),a.jsx(Qu,{className:"w-8 h-8 text-royal-gold"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-royal-charcoal-dark p-6 rounded-royal shadow-md border border-royal-gold/30 royal-glow",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-royal-cream/70",children:"Gesamtumsatz"}),a.jsxs("p",{className:"text-2xl font-bold text-royal-gold",children:[r.stats.totalRevenue.toFixed(2),"€"]})]}),a.jsx(Lh,{className:"w-8 h-8 text-royal-gold"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-royal-charcoal-dark p-6 rounded-royal shadow-md border border-royal-gold/30 royal-glow",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-royal-cream/70",children:"Ø Bestellwert"}),a.jsxs("p",{className:"text-2xl font-bold text-royal-cream",children:[r.stats.averageOrderValue.toFixed(2),"€"]})]}),a.jsx(pl,{className:"w-8 h-8 text-royal-gold"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-royal-charcoal-dark p-6 rounded-royal shadow-md border border-royal-gold/30 royal-glow",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-royal-cream/70",children:"Top Produkte"}),a.jsx("p",{className:"text-2xl font-bold text-royal-cream",children:r.stats.topProducts.length})]}),a.jsx(dP,{className:"w-8 h-8 text-royal-gold"})]})})]}),r&&a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-royal-charcoal-dark p-6 rounded-royal shadow-md border border-royal-gold/30 royal-glow",children:[a.jsxs("h3",{className:"text-lg font-semibold text-royal-cream mb-4 flex items-center",children:[a.jsx(jY,{className:"w-5 h-5 mr-2 text-royal-gold"}),"Top Produkte"]}),a.jsx("div",{className:"space-y-3",children:r.stats.topProducts.slice(0,8).map((x,P)=>a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("span",{className:"text-sm font-medium text-royal-gold",children:["#",P+1]}),a.jsx("span",{className:"text-royal-cream",children:x.name})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-sm text-royal-cream/70",children:[x.quantity,"x"]}),a.jsxs("div",{className:"text-sm font-medium text-royal-gold",children:[x.revenue.toFixed(2),"€"]})]})]},x.name))})]}),a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-royal-charcoal-dark p-6 rounded-royal shadow-md border border-royal-gold/30 royal-glow",children:[a.jsxs("h3",{className:"text-lg font-semibold text-royal-cream mb-4 flex items-center",children:[a.jsx(xp,{className:"w-5 h-5 mr-2 text-royal-gold"}),"Bestellungen nach Status"]}),a.jsx("div",{className:"space-y-3",children:Object.entries(r.stats.ordersByStatus).map(([x,P])=>a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-royal-cream",children:v(x)}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"bg-royal-gold/20 h-2 rounded-full w-20",children:a.jsx("div",{className:"bg-royal-gold h-2 rounded-full",style:{width:`${P/r.stats.totalOrders*100}%`}})}),a.jsx("span",{className:"text-royal-gold font-medium w-8 text-right",children:P})]})]},x))})]})]}),r&&r.orders.length>0&&a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"bg-royal-charcoal-dark rounded-royal shadow-md border border-royal-gold/30 royal-glow overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-royal-gold/20",children:a.jsxs("h3",{className:"text-lg font-semibold text-royal-cream flex items-center",children:[a.jsx(Sa,{className:"w-5 h-5 mr-2 text-royal-gold"}),"Bestelldetails (",r.orders.length," Bestellungen)"]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-royal-gradient-gold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-royal-charcoal font-semibold",children:"ID"}),a.jsx("th",{className:"px-4 py-3 text-left text-royal-charcoal font-semibold",children:"Tisch"}),a.jsx("th",{className:"px-4 py-3 text-left text-royal-charcoal font-semibold",children:"Kunde"}),a.jsx("th",{className:"px-4 py-3 text-left text-royal-charcoal font-semibold",children:"Betrag"}),a.jsx("th",{className:"px-4 py-3 text-left text-royal-charcoal font-semibold",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-royal-charcoal font-semibold",children:"Datum"}),a.jsx("th",{className:"px-4 py-3 text-left text-royal-charcoal font-semibold",children:"Artikel"})]})}),a.jsx("tbody",{className:"divide-y divide-royal-gold/20",children:r.orders.slice(0,50).map(x=>a.jsxs("tr",{className:"hover:bg-royal-charcoal/5 transition-colors",children:[a.jsx("td",{className:"px-4 py-3",children:a.jsxs("span",{className:"font-mono text-sm text-royal-cream/70",children:["#",x.id.slice(-8)]})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("span",{className:"bg-royal-gold/20 text-royal-gold px-2 py-1 rounded-full text-sm font-semibold",children:["Tisch ",x.tableNumber]})}),a.jsx("td",{className:"px-4 py-3 text-royal-cream",children:x.customerName||"Anonym"}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("span",{className:"font-bold text-royal-gold",children:[x.totalAmount.toFixed(2),"€"]})}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:"text-sm text-royal-cream/70",children:v(x.status)})}),a.jsx("td",{className:"px-4 py-3 text-sm text-royal-cream/70",children:Lr(x.createdAt,"dd.MM.yyyy HH:mm",{locale:Ss})}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("div",{className:"text-sm text-royal-cream/70 max-w-xs",children:x.items.map(P=>`${P.quantity}x ${P.name}`).join(", ")})})]},x.id))})]})}),r.orders.length>50&&a.jsxs("div",{className:"p-4 bg-royal-charcoal/30 text-center text-royal-cream/70 text-sm",children:["Zeige die ersten 50 von ",r.orders.length," Bestellungen. Für alle Daten verwenden Sie den PDF- oder CSV-Export."]})]}),r&&r.orders.length===0&&a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-royal-charcoal-dark p-8 rounded-royal shadow-md border border-royal-gold/30 royal-glow text-center",children:[a.jsx(Qu,{className:"w-16 h-16 text-royal-gold/50 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-royal-cream mb-2",children:"Keine Bestellungen gefunden"}),a.jsx("p",{className:"text-royal-cream/70",children:"Für den ausgewählten Zeitraum wurden keine Bestellungen gefunden."})]})]})},YZ=()=>{const{user:t}=yn(),[e,r]=M.useState("dashboard"),[n,s]=M.useState(!1),[i,o]=M.useState([]),[l,c]=M.useState({totalUsers:0,activeUsers:0,totalEvents:0,activeEvents:0,totalRevenue:0,monthlyGrowth:0,thisMonthRevenue:0,lastMonthRevenue:0,revenueGrowth:0,newUsersThisMonth:0,activeUsersCount:0,engagementRate:0,totalOrders:0,pendingOrders:0,deliveredOrders:0,averageOrderValue:0,upcomingEvents:0,totalAttendees:0,eventEngagement:0}),u=async()=>{try{s(!0);const $=await ds.getEvents();o($)}catch($){Ee.error("Failed to load events"),console.error("Error loading events:",$)}finally{s(!1)}},d=async()=>{try{s(!0);const $=await C3.getAnalyticsData();c($)}catch($){console.error("Error loading analytics:",$),Ee.error("Failed to load analytics data")}finally{s(!1)}},h=async()=>{await Promise.all([u(),d()]),Ee.success("Data refreshed successfully")};M.useEffect(()=>{if(t&&t.role==="admin"){u(),d();const $=C3.onAnalyticsChange(k=>{c(k)});return()=>{$()}}},[t]);const g=async $=>{if(window.confirm("Are you sure you want to delete this event?"))try{await ds.deleteEvent($),Ee.success("Event deleted successfully"),u()}catch(k){console.error("Error deleting event:",k),Ee.error("Failed to delete event")}},m=async($,k)=>{try{await ds.toggleEventStatus($,!k),Ee.success(`Event ${k?"deactivated":"activated"} successfully`),u()}catch(A){console.error("Error toggling event status:",A),Ee.error("Failed to update event status")}};if(!t||t.role!=="admin")return a.jsx("div",{className:"min-h-screen bg-royal-charcoal-dark flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Et,{className:"w-16 h-16 text-royal-gold mx-auto mb-4"}),a.jsx("h1",{className:"text-2xl font-bold text-royal-cream mb-2",children:"Access Denied"}),a.jsx("p",{className:"text-royal-cream-light",children:"You need admin privileges to access this page."})]})});const w=[{id:"dashboard",name:"Dashboard",icon:xp},{id:"reservations",name:"Reservations",icon:oY},{id:"tables",name:"Tables",icon:pY},{id:"live-status",name:"Live Status",icon:vY},{id:"integration",name:"Integration",icon:aP},{id:"events",name:"Events",icon:Un},{id:"users",name:"Users",icon:qn},{id:"loyalty",name:"Stempelpass",icon:Et},{id:"analytics",name:"Analytics",icon:pl},{id:"gdpr",name:"GDPR",icon:_n},{id:"settings",name:"Settings",icon:Yc},{id:"menu",name:"Menu",icon:hP},{id:"special-offers",name:"Sonderangebote",icon:Eb},{id:"orders",name:"Orders",icon:Qu},{id:"reports",name:"Berichte",icon:Sa},{id:"bar-operations",name:"Bar Operations",icon:NN},{id:"popup",name:"Popups",icon:oP}],_=()=>a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-royal-cream",children:"Dashboard Overview"}),a.jsxs("button",{onClick:h,className:"flex items-center space-x-2 px-4 py-2 bg-royal-gradient-gold text-royal-charcoal rounded-lg hover:shadow-lg transition-all duration-200",children:[a.jsx(Nr,{className:"w-4 h-4"}),a.jsx("span",{children:"Refresh Data"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20 royal-glow",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream-light text-sm",children:"Total Users"}),a.jsx("p",{className:"text-2xl font-bold text-royal-gold",children:l.totalUsers})]}),a.jsx(qn,{className:"w-8 h-8 text-royal-gold"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20 royal-glow",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream-light text-sm",children:"Active Events"}),a.jsx("p",{className:"text-2xl font-bold text-royal-gold",children:l.activeEvents})]}),a.jsx(Un,{className:"w-8 h-8 text-royal-gold"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20 royal-glow",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream-light text-sm",children:"Total Revenue"}),a.jsxs("p",{className:"text-2xl font-bold text-royal-gold",children:["€",l.totalRevenue.toLocaleString()]})]}),a.jsx(pl,{className:"w-8 h-8 text-royal-gold"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20 royal-glow",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream-light text-sm",children:"Monthly Growth"}),a.jsxs("p",{className:`text-2xl font-bold ${l.monthlyGrowth>=0?"text-green-400":"text-red-400"}`,children:[l.monthlyGrowth>=0?"+":"",l.monthlyGrowth,"%"]})]}),a.jsx(Mm,{className:"w-8 h-8 text-royal-gold"})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20 royal-glow",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream-light text-sm",children:"Total Orders"}),a.jsx("p",{className:"text-xl font-bold text-royal-gold",children:l.totalOrders})]}),a.jsx(Qu,{className:"w-6 h-6 text-royal-gold"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20 royal-glow",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream-light text-sm",children:"Avg Order Value"}),a.jsxs("p",{className:"text-xl font-bold text-royal-gold",children:["€",l.averageOrderValue.toFixed(2)]})]}),a.jsx(xp,{className:"w-6 h-6 text-royal-gold"})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20 royal-glow",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream-light text-sm",children:"Event Attendees"}),a.jsx("p",{className:"text-xl font-bold text-royal-gold",children:l.totalAttendees})]}),a.jsx(qn,{className:"w-6 h-6 text-royal-gold"})]})})]})]}),T=()=>a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-royal-cream",children:"Event Management"}),a.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-royal-gradient-gold text-royal-charcoal rounded-lg hover:shadow-lg transition-all duration-200",children:[a.jsx(Ai,{className:"w-4 h-4"}),a.jsx("span",{children:"Create Event"})]})]}),n?a.jsx(jn,{}):a.jsx("div",{className:"bg-royal-charcoal rounded-lg border border-royal-gold/20 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-royal-charcoal-dark",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-royal-gold uppercase tracking-wider",children:"Event"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-royal-gold uppercase tracking-wider",children:"Date"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-royal-gold uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-royal-gold uppercase tracking-wider",children:"Attendees"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-royal-gold uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-royal-gold/10",children:i.map($=>{var k;return a.jsxs("tr",{className:"hover:bg-royal-charcoal-dark",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-royal-cream",children:$.title}),a.jsx("div",{className:"text-sm text-royal-cream-light",children:$.location})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-royal-cream",children:new Date($.date).toLocaleDateString()}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${$.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:$.isActive?"Active":"Inactive"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-royal-cream",children:((k=$.attendees)==null?void 0:k.length)||0}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:()=>m($.id,$.isActive),className:"text-royal-gold hover:text-royal-cream",children:$.isActive?a.jsx(Gp,{className:"w-4 h-4"}):a.jsx(Ca,{className:"w-4 h-4"})}),a.jsx("button",{className:"text-blue-400 hover:text-blue-300",children:a.jsx(Kp,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>g($.id),className:"text-red-400 hover:text-red-300",children:a.jsx(Qs,{className:"w-4 h-4"})})]})})]},$.id)})})]})})})]}),v=()=>a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-royal-cream",children:"User Management"}),a.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-royal-gradient-gold text-royal-charcoal rounded-lg hover:shadow-lg transition-all duration-200",children:[a.jsx(PY,{className:"w-4 h-4"}),a.jsx("span",{children:"Add User"})]})]}),a.jsxs("div",{className:"bg-royal-charcoal rounded-lg border border-royal-gold/20 p-6",children:[a.jsx("p",{className:"text-royal-cream-light",children:"User management functionality will be implemented here. This will include:"}),a.jsxs("ul",{className:"mt-4 space-y-2 text-royal-cream-light",children:[a.jsx("li",{children:"• View all registered users"}),a.jsx("li",{children:"• Manage user roles and permissions"}),a.jsx("li",{children:"• Ban/unban users"}),a.jsx("li",{children:"• View user activity and statistics"})]})]})]}),b=()=>a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-royal-cream",children:"Analytics & Reports"}),a.jsxs("button",{onClick:h,className:"flex items-center space-x-2 px-4 py-2 bg-royal-gradient-gold text-royal-charcoal rounded-lg hover:shadow-lg transition-all duration-200",children:[a.jsx(Nr,{className:"w-4 h-4"}),a.jsx("span",{children:"Refresh Data"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20 royal-glow",children:[a.jsx("h3",{className:"text-lg font-semibold text-royal-cream mb-4",children:"Revenue Analytics"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-royal-cream-light",children:"This Month"}),a.jsxs("span",{className:"text-royal-gold font-semibold",children:["€",l.thisMonthRevenue.toLocaleString()]})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-royal-cream-light",children:"Last Month"}),a.jsxs("span",{className:"text-royal-gold font-semibold",children:["€",l.lastMonthRevenue.toLocaleString()]})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-royal-cream-light",children:"Growth"}),a.jsxs("span",{className:`font-semibold ${l.revenueGrowth>=0?"text-green-400":"text-red-400"}`,children:[l.revenueGrowth>=0?"+":"",l.revenueGrowth,"%"]})]})]})]}),a.jsxs("div",{className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20 royal-glow",children:[a.jsx("h3",{className:"text-lg font-semibold text-royal-cream mb-4",children:"User Analytics"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-royal-cream-light",children:"New Users (30d)"}),a.jsxs("span",{className:"text-royal-gold font-semibold",children:["+",l.newUsersThisMonth]})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-royal-cream-light",children:"Active Users"}),a.jsx("span",{className:"text-royal-gold font-semibold",children:l.activeUsersCount})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-royal-cream-light",children:"Engagement Rate"}),a.jsxs("span",{className:"text-green-400 font-semibold",children:[l.engagementRate,"%"]})]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20 royal-glow",children:[a.jsx("h3",{className:"text-lg font-semibold text-royal-cream mb-4",children:"Order Analytics"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-royal-cream-light",children:"Total Orders"}),a.jsx("span",{className:"text-royal-gold font-semibold",children:l.totalOrders})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-royal-cream-light",children:"Pending Orders"}),a.jsx("span",{className:"text-yellow-400 font-semibold",children:l.pendingOrders})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-royal-cream-light",children:"Delivered Orders"}),a.jsx("span",{className:"text-green-400 font-semibold",children:l.deliveredOrders})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-royal-cream-light",children:"Average Order Value"}),a.jsxs("span",{className:"text-royal-gold font-semibold",children:["€",l.averageOrderValue.toFixed(2)]})]})]})]}),a.jsxs("div",{className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20 royal-glow",children:[a.jsx("h3",{className:"text-lg font-semibold text-royal-cream mb-4",children:"Event Analytics"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-royal-cream-light",children:"Total Events"}),a.jsx("span",{className:"text-royal-gold font-semibold",children:l.totalEvents})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-royal-cream-light",children:"Upcoming Events"}),a.jsx("span",{className:"text-blue-400 font-semibold",children:l.upcomingEvents})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-royal-cream-light",children:"Total Attendees"}),a.jsx("span",{className:"text-royal-gold font-semibold",children:l.totalAttendees})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-royal-cream-light",children:"Event Engagement"}),a.jsx("span",{className:"text-green-400 font-semibold",children:l.eventEngagement.toFixed(1)})]})]})]})]})]}),x=()=>a.jsxs("div",{className:"space-y-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-royal-cream",children:"System Settings"}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20",children:[a.jsx("h3",{className:"text-lg font-semibold text-royal-cream mb-4",children:"General Settings"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream-light mb-2",children:"Site Name"}),a.jsx("input",{type:"text",defaultValue:"Royal Shisha Bar",className:"w-full px-3 py-2 bg-royal-charcoal-dark border border-royal-gold/30 rounded-lg text-royal-cream focus:outline-none focus:border-royal-gold"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-royal-cream-light mb-2",children:"Contact Email"}),a.jsx("input",{type:"email",defaultValue:"Royal.Waldkraiburg@gmail.com",className:"w-full px-3 py-2 bg-royal-charcoal-dark border border-royal-gold/30 rounded-lg text-royal-cream focus:outline-none focus:border-royal-gold"})]}),a.jsx("button",{className:"w-full px-4 py-2 bg-royal-gradient-gold text-royal-charcoal rounded-lg hover:shadow-lg transition-all duration-200",children:"Save Changes"})]})]}),a.jsxs("div",{className:"bg-royal-charcoal p-6 rounded-lg border border-royal-gold/20",children:[a.jsx("h3",{className:"text-lg font-semibold text-royal-cream mb-4",children:"Security Settings"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-royal-cream-light",children:"Two-Factor Authentication"}),a.jsx("button",{className:"w-12 h-6 bg-royal-gold rounded-full relative",children:a.jsx("div",{className:"w-4 h-4 bg-white rounded-full absolute top-1 right-1"})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-royal-cream-light",children:"Email Notifications"}),a.jsx("button",{className:"w-12 h-6 bg-royal-gold rounded-full relative",children:a.jsx("div",{className:"w-4 h-4 bg-white rounded-full absolute top-1 right-1"})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-royal-cream-light",children:"Maintenance Mode"}),a.jsx("button",{className:"w-12 h-6 bg-gray-600 rounded-full relative",children:a.jsx("div",{className:"w-4 h-4 bg-white rounded-full absolute top-1 left-1"})})]})]})]})]})]}),P=()=>a.jsx("div",{className:"space-y-6",children:a.jsx(mJ,{})}),F=()=>{switch(e){case"dashboard":return _();case"reservations":return a.jsx(KJ,{});case"tables":return a.jsx(aX,{});case"live-status":return a.jsx(oX,{});case"integration":return a.jsx(lX,{});case"events":return T();case"users":return v();case"loyalty":return a.jsx(YJ,{});case"analytics":return b();case"gdpr":return a.jsx(uX,{});case"settings":return x();case"menu":return P();case"special-offers":return a.jsx(yJ,{});case"orders":return a.jsx(HJ,{});case"reports":return a.jsx(KZ,{});case"bar-operations":return a.jsx(cX,{});case"popup":return a.jsx(GJ,{});default:return _()}};return a.jsx("div",{className:"min-h-screen bg-royal-charcoal-dark",children:a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"w-64 bg-royal-charcoal min-h-screen border-r border-royal-gold/20",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-8",children:[a.jsx(Et,{className:"w-8 h-8 text-royal-gold"}),a.jsx("h1",{className:"text-xl font-bold text-royal-cream",children:"Admin Panel"})]}),a.jsx("nav",{className:"space-y-2",children:w.map($=>{const k=$.icon;return a.jsxs("button",{onClick:()=>r($.id),className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-all duration-200 ${e===$.id?"bg-royal-gradient-gold text-royal-charcoal":"text-royal-cream hover:bg-royal-charcoal-dark"}`,children:[a.jsx(k,{className:"w-5 h-5"}),a.jsx("span",{children:$.name})]},$.id)})})]})}),a.jsx("div",{className:"flex-1 p-8",children:a.jsx("div",{className:"max-w-7xl mx-auto",children:F()})})]})})},sR={reservation_processing:{title:"Reservierungsverarbeitung",description:"Wir verarbeiten Ihre persönlichen Daten (Name, E-Mail, Telefon) um Ihre Tischreservierung zu bearbeiten und zu bestätigen.",legalBasis:"Vertragserfüllung (Art. 6 Abs. 1 lit. b DSGVO)",dataTypes:["Name","E-Mail-Adresse","Telefonnummer","Reservierungsdetails"],retention:"3 Jahre nach dem Reservierungsdatum für buchhalterische Zwecke"},order_processing:{title:"Bestellungsverarbeitung",description:"Wir verarbeiten Ihre Daten um Ihre Bestellung zu bearbeiten, die Zahlung zu verarbeiten und die Lieferung zu koordinieren.",legalBasis:"Vertragserfüllung (Art. 6 Abs. 1 lit. b DSGVO)",dataTypes:["Name","E-Mail-Adresse","Telefonnummer","Bestelldetails","Zahlungsinformationen"],retention:"10 Jahre für steuerliche und buchhalterische Zwecke"},loyalty_program:{title:"Treueprogramm",description:"Wir verarbeiten Ihre Daten um Treuepunkte zu verwalten, personalisierte Angebote zu erstellen und Belohnungen zu verwalten.",legalBasis:"Einwilligung (Art. 6 Abs. 1 lit. a DSGVO)",dataTypes:["Name","E-Mail-Adresse","Kaufhistorie","Präferenzen"],retention:"Bis zum Widerruf der Einwilligung oder 2 Jahre nach der letzten Aktivität"},marketing_communications:{title:"Marketing-Kommunikation",description:"Wir möchten Ihnen Informationen über neue Angebote, Veranstaltungen und Promotionen senden.",legalBasis:"Einwilligung (Art. 6 Abs. 1 lit. a DSGVO)",dataTypes:["Name","E-Mail-Adresse","Präferenzen"],retention:"Bis zum Widerruf der Einwilligung"},analytics:{title:"Analyse und Verbesserung",description:"Wir analysieren die Nutzung unserer Dienste um diese zu verbessern und zu optimieren.",legalBasis:"Berechtigtes Interesse (Art. 6 Abs. 1 lit. f DSGVO)",dataTypes:["Nutzungsstatistiken","Anonymisierte Verhaltensdaten"],retention:"2 Jahre in anonymisierter Form"}},QZ=({isOpen:t,purpose:e,onConsent:r,onClose:n,required:s=!1})=>{const i=sR[e];return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(_n,{className:"w-6 h-6 text-blue-600"}),a.jsx("h2",{className:"text-xl font-semibold",children:"Einwilligung zur Datenverarbeitung"})]}),!s&&a.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:a.jsx(Zi,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:i.title}),a.jsx("p",{className:"text-gray-700 mb-4",children:i.description})]}),a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[a.jsxs("h4",{className:"font-medium text-blue-900 mb-2 flex items-center gap-2",children:[a.jsx(zy,{className:"w-4 h-4"}),"Rechtsgrundlage"]}),a.jsx("p",{className:"text-blue-800 text-sm",children:i.legalBasis})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Verarbeitete Datentypen:"}),a.jsx("ul",{className:"list-disc list-inside text-gray-700 text-sm space-y-1",children:i.dataTypes.map((o,l)=>a.jsx("li",{children:o},l))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Speicherdauer:"}),a.jsx("p",{className:"text-gray-700 text-sm",children:i.retention})]}),a.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg",children:[a.jsxs("h4",{className:"font-medium text-amber-900 mb-2 flex items-center gap-2",children:[a.jsx(ml,{className:"w-4 h-4"}),"Ihre Rechte"]}),a.jsx("p",{className:"text-amber-800 text-sm",children:"Sie haben das Recht auf Auskunft, Berichtigung, Löschung, Einschränkung der Verarbeitung, Datenübertragbarkeit und Widerspruch. Bei Einwilligungsbasierter Verarbeitung können Sie Ihre Einwilligung jederzeit widerrufen."})]}),s&&a.jsx("div",{className:"bg-red-50 p-4 rounded-lg",children:a.jsx("p",{className:"text-red-800 text-sm font-medium",children:"Diese Einwilligung ist für die Nutzung des Dienstes erforderlich."})})]}),a.jsxs("div",{className:"flex gap-3 mt-6 pt-4 border-t",children:[a.jsxs("button",{onClick:()=>r(!0),className:"flex-1 bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 flex items-center justify-center gap-2 font-medium transition-colors",children:[a.jsx(wN,{className:"w-4 h-4"}),"Einwilligung erteilen"]}),a.jsx("button",{onClick:()=>r(!1),className:"flex-1 bg-gray-600 text-white py-3 px-4 rounded-lg hover:bg-gray-700 font-medium transition-colors",disabled:s,children:s?"Erforderlich":"Ablehnen"})]})]})})}):null},Bv=()=>new Promise(t=>{const e=Ha();if(e.currentUser!==void 0)t(e.currentUser);else{const r=t5(e,n=>{r(),t(n)})}}),JZ=({purpose:t,onConsentChange:e,required:r=!1,description:n,children:s})=>{const{user:i}=yn(),[o,l]=M.useState(null),[c,u]=M.useState(!1),[d,h]=M.useState(!0),[g,m]=M.useState(null);M.useEffect(()=>{i?w():(h(!1),m("Bitte melden Sie sich an, um fortzufahren."))},[i,t]);const w=async()=>{try{if(h(!0),m(null),!i){m("Bitte melden Sie sich an, um fortzufahren."),e(!1);return}const x=await Bv();console.log("🔍 Loading consent with:",{authStoreUserId:i.id,firebaseUid:x==null?void 0:x.uid,purpose:t,idsMatch:(x==null?void 0:x.uid)===i.id});const P=(x==null?void 0:x.uid)||i.id,F=await ar.getConsentRecord(P,t);l(F),F&&!F.withdrawnAt?e(F.granted):e(!1)}catch(x){console.error("Error loading consent:",x),m("Fehler beim Laden der Einwilligungsdaten"),e(!1)}finally{h(!1)}},_=async x=>{try{if(!i){console.error("❌ No user found for consent"),Ee.error("Bitte melden Sie sich an");return}console.log("🔄 Waiting for Firebase Auth to be ready...");const P=await Bv();if(console.log("🔐 Starting consent process:",{authStoreUserId:i.id,firebaseUid:P==null?void 0:P.uid,purpose:t,granted:x,firebaseAuthState:!!P,userEmail:(P==null?void 0:P.email)||i.email,idsMatch:(P==null?void 0:P.uid)===i.id,tokenPresent:!!(P!=null&&P.accessToken)}),P)try{await P.getIdToken(),console.log("✅ Firebase Auth token retrieved successfully")}catch(F){console.error("❌ Failed to get Firebase Auth token:",F),Ee.error("Authentifizierungstoken ungültig. Bitte melden Sie sich erneut an.");return}if(m(null),P!=null&&P.uid)console.log("✅ Using Firebase UID for consent:",P.uid),await ar.recordConsent(P.uid,t,x);else{console.error("❌ No authenticated Firebase user found"),Ee.error("Authentifizierung fehlgeschlagen. Bitte melden Sie sich erneut an.");return}console.log("✅ Consent recorded, reloading current consent"),await w(),e(x),u(!1),x&&Ee.success("Einwilligung erfolgreich erteilt")}catch(P){console.error("❌ Error recording consent:",P);let F="Fehler beim Speichern der Einwilligung";P instanceof Error&&(P.message.includes("insufficient permissions")?F="Keine Berechtigung. Bitte melden Sie sich erneut an.":P.message.includes("network")?F="Netzwerkfehler. Bitte überprüfen Sie Ihre Internetverbindung.":F=P.message),m(F),Ee.error(F)}},T=async()=>{try{if(!i||!o)return;const x=await Bv(),P=(x==null?void 0:x.uid)||i.id;m(null),await ar.withdrawConsent(P,t),await w(),e(!1),Ee.success("Einwilligung widerrufen")}catch(x){console.error("Error withdrawing consent:",x),m("Fehler beim Widerrufen der Einwilligung"),Ee.error("Fehler beim Widerrufen der Einwilligung")}};if(d)return a.jsxs("div",{className:"animate-pulse bg-royal-charcoal-dark rounded-lg p-4 border border-royal-gold/30",children:[a.jsx("div",{className:"h-4 bg-royal-gold/30 rounded w-3/4 mb-2"}),a.jsx("div",{className:"h-3 bg-royal-gold/30 rounded w-1/2"})]});if(g)return a.jsxs("div",{className:"border border-red-500 rounded-lg p-4 bg-red-50",children:[a.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[a.jsx(ml,{className:"w-5 h-5"}),a.jsx("span",{className:"font-medium",children:"Fehler"})]}),a.jsx("p",{className:"text-red-600 text-sm mt-1",children:g}),a.jsx("button",{onClick:w,className:"mt-2 text-sm text-red-700 underline hover:text-red-800",children:"Erneut versuchen"})]});const v=o&&o.granted&&!o.withdrawnAt,b=sR[t];return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"border border-royal-gold/30 rounded-lg p-4 bg-royal-charcoal-dark",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(_n,{className:`w-5 h-5 mt-0.5 ${v?"text-green-400":"text-royal-gold"}`}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("h3",{className:"font-medium text-royal-cream mb-1",children:[b.title,r&&a.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),a.jsx("p",{className:"text-sm text-royal-cream/70 mb-3",children:n||b.description}),v?a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 text-green-400",children:[a.jsx(wN,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:"Einwilligung erteilt"}),a.jsxs("span",{className:"text-xs text-royal-cream/50",children:["(",new Date(o.timestamp).toLocaleDateString("de-DE"),")"]})]}),!r&&a.jsx("button",{onClick:T,className:"text-sm text-red-400 hover:text-red-300 underline transition-colors",children:"Widerrufen"})]}):a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-royal-cream/60",children:r?"Einwilligung erforderlich":"Keine Einwilligung"}),a.jsx("button",{onClick:()=>u(!0),className:`text-sm px-4 py-2 rounded-lg font-medium transition-colors ${r?"bg-red-600 text-white hover:bg-red-700":"bg-royal-gold text-royal-charcoal hover:bg-royal-gold/90"}`,children:r?"Erforderlich - Klicken":"Einwilligung erteilen"})]})]})]}),s&&v&&a.jsx("div",{className:"mt-4 pt-4 border-t border-royal-gold/30",children:s})]}),a.jsx(QZ,{isOpen:c,purpose:t,onConsent:_,onClose:()=>u(!1),required:r})]})},XZ=({onReservationComplete:t,onCancel:e})=>{const{user:r}=yn(),[n,s]=M.useState(1),[i,o]=M.useState(!1),[l,c]=M.useState([]),[u,d]=M.useState([]),[h,g]=M.useState(null),[m,w]=M.useState(!1),[_,T]=M.useState({date:"",timeSlot:"",partySize:2,customerName:(r==null?void 0:r.name)||"",customerEmail:(r==null?void 0:r.email)||"",customerPhone:"",specialRequests:""}),[v,b]=M.useState({});M.useEffect(()=>{x()},[]);const x=async()=>{try{const Q=await Qr.getTimeSlots();d(Q.filter(se=>se.isActive))}catch(Q){console.error("Error loading time slots:",Q),Ee.error("Failed to load available time slots")}},P=Q=>{const se={};if(Q===1&&(_.date||(se.date="Please select a date"),_.timeSlot||(se.timeSlot="Please select a time slot"),(_.partySize<1||_.partySize>12)&&(se.partySize="Party size must be between 1 and 12")),Q===2&&(h||(se.table="Please select a table")),Q===3){_.customerName.trim()||(se.customerName="Name is required"),_.customerEmail.trim()||(se.customerEmail="Email is required"),_.customerPhone.trim()||(se.customerPhone="Phone number is required");const Se=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;_.customerEmail&&!Se.test(_.customerEmail)&&(se.customerEmail="Please enter a valid email address"),m||(se.consent="Data processing consent is required to create a reservation")}return b(se),Object.keys(se).length===0},F=async()=>{if(P(1)){o(!0);try{const Q={date:new Date(_.date),timeSlot:_.timeSlot,partySize:_.partySize},se=await Qr.getAvailableTables(Q);c(se),s(2)}catch(Q){console.error("Error checking availability:",Q),Ee.error("Failed to check availability")}finally{o(!1)}}},$=Q=>{g(Q),T(se=>({...se,tableId:Q.table.id})),s(3)},k=async()=>{if(!(!P(3)||!r)){o(!0);try{const Q=await Qr.createReservation(_,r.id);Ee.success("Reservation created successfully!"),t==null||t(Q)}catch(Q){console.error("Error creating reservation:",Q),Ee.error(Q.message||"Failed to create reservation")}finally{o(!1)}}},A=Q=>{switch(Q){case"vip":return a.jsx(Et,{className:"w-4 h-4"});case"outdoor":return a.jsx(zn,{className:"w-4 h-4"});case"indoor":default:return a.jsx(Si,{className:"w-4 h-4"})}},I=Q=>{switch(Q){case"vip":return"text-royal-gold";case"outdoor":return"text-green-400";case"indoor":default:return"text-royal-cream"}},O=Q=>{switch(Q){case"vip":return"VIP Bereich";case"outdoor":return"Außenbereich";case"indoor":default:return"Innenbereich"}},S=(Q,se)=>{if(Q==="outdoor"){const Se=se.split("-")[1],U=parseInt(Se.split(":")[0]);return!(U>22||U<6)}return!0},R=Q=>Q.replace("-"," - "),C=()=>new Date().toISOString().split("T")[0],G=()=>{const Q=new Date;return Q.setDate(Q.getDate()+30),Q.toISOString().split("T")[0]},de=()=>a.jsxs(oe.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-royal font-bold text-royal-cream mb-2",children:"Select Date & Time"}),a.jsx("p",{className:"text-royal-cream/70",children:"Choose your preferred date, time, and party size"}),a.jsx("div",{className:"mt-3 p-3 bg-blue-900/30 border border-blue-500/50 rounded-royal",children:a.jsx("p",{className:"text-blue-200 text-sm",children:"ℹ️ Reservierungen sind kostenlos. Maximal 2 aktive Reservierungen pro Konto."})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center space-x-2 text-royal-cream font-medium",children:[a.jsx(Un,{className:"w-4 h-4"}),a.jsx("span",{children:"Date *"})]}),a.jsx("input",{type:"date",value:_.date,min:C(),max:G(),onChange:Q=>T(se=>({...se,date:Q.target.value})),className:"w-full p-3 border border-royal-gold/30 rounded-royal bg-royal-charcoal text-royal-cream focus:outline-none focus:ring-2 focus:ring-royal-gold/50"}),v.date&&a.jsxs("p",{className:"text-red-400 text-sm flex items-center",children:[a.jsx(_s,{className:"w-4 h-4 mr-1"}),v.date]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center space-x-2 text-royal-cream font-medium",children:[a.jsx(Rr,{className:"w-4 h-4"}),a.jsx("span",{children:"Time Slot *"})]}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:u.map(Q=>a.jsx("button",{type:"button",onClick:()=>T(se=>({...se,timeSlot:`${Q.startTime}-${Q.endTime}`})),className:`p-3 rounded-royal border-2 transition-all duration-200 ${_.timeSlot===`${Q.startTime}-${Q.endTime}`?"border-royal-gold bg-royal-gold/10 text-royal-gold":"border-royal-gold/30 bg-royal-charcoal text-royal-cream hover:border-royal-gold/50"}`,children:a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"font-medium",children:[Q.startTime," - ",Q.endTime]}),a.jsxs("div",{className:"text-xs opacity-70",children:[Q.duration," minutes"]})]})},Q.id))}),v.timeSlot&&a.jsxs("p",{className:"text-red-400 text-sm flex items-center",children:[a.jsx(_s,{className:"w-4 h-4 mr-1"}),v.timeSlot]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center space-x-2 text-royal-cream font-medium",children:[a.jsx(qn,{className:"w-4 h-4"}),a.jsx("span",{children:"Party Size *"})]}),a.jsx("select",{value:_.partySize,onChange:Q=>T(se=>({...se,partySize:parseInt(Q.target.value)})),className:"w-full p-3 border border-royal-gold/30 rounded-royal bg-royal-charcoal text-royal-cream focus:outline-none focus:ring-2 focus:ring-royal-gold/50",children:Array.from({length:12},(Q,se)=>se+1).map(Q=>a.jsxs("option",{value:Q,children:[Q," ",Q===1?"Person":"People"]},Q))}),v.partySize&&a.jsxs("p",{className:"text-red-400 text-sm flex items-center",children:[a.jsx(_s,{className:"w-4 h-4 mr-1"}),v.partySize]})]}),a.jsx("button",{onClick:F,disabled:i,className:"w-full bg-royal-gradient-gold text-royal-charcoal py-3 px-6 rounded-royal font-semibold hover:shadow-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:i?a.jsx(jn,{}):"Check Availability"})]}),ne=()=>a.jsxs(oe.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-royal font-bold text-royal-cream mb-2",children:"Select Your Table"}),a.jsxs("p",{className:"text-royal-cream/70",children:[_.date," • ",R(_.timeSlot)," •"," ",_.partySize," ",_.partySize===1?"person":"people"]})]}),!S("outdoor",_.timeSlot)&&a.jsxs("div",{className:"bg-amber-900/30 border border-amber-500/50 rounded-royal p-4 mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 text-amber-300",children:[a.jsx(_s,{className:"w-5 h-5"}),a.jsx("span",{className:"font-medium",children:"Hinweis:"})]}),a.jsx("p",{className:"text-amber-200 text-sm mt-1",children:"Der Außenbereich schließt um 22:00 Uhr. Für diese Uhrzeit sind nur Tische im Innenbereich verfügbar."})]}),l.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(_s,{className:"w-12 h-12 text-royal-cream/50 mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-royal-cream mb-2",children:"No Tables Available"}),a.jsx("p",{className:"text-royal-cream/70 mb-4",children:"Sorry, no tables are available for your selected time and party size."}),a.jsx("button",{onClick:()=>s(1),className:"bg-royal-gradient-gold text-royal-charcoal py-2 px-6 rounded-royal font-semibold hover:shadow-lg transition-all duration-200",children:"Try Different Time"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.map(Q=>a.jsxs(oe.button,{onClick:()=>$(Q),disabled:!Q.available,className:`p-4 rounded-royal border-2 text-left transition-all duration-200 ${Q.available?"border-royal-gold/30 bg-royal-charcoal hover:border-royal-gold hover:bg-royal-gold/5":"border-red-400/30 bg-red-900/20 opacity-50 cursor-not-allowed"}`,whileHover:Q.available?{scale:1.02}:{},whileTap:Q.available?{scale:.98}:{},children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[A(Q.table.location),a.jsxs("span",{className:"font-semibold text-royal-cream",children:["Table ",Q.table.number]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-green-400 font-bold text-sm",children:"KOSTENLOS"}),a.jsx("div",{className:"text-xs text-royal-cream/70",children:"keine Reservierungsgebühr"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-royal-cream/70",children:"Capacity:"}),a.jsxs("span",{className:"text-royal-cream",children:[Q.table.capacity," people"]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-royal-cream/70",children:"Location:"}),a.jsx("span",{className:`capitalize ${I(Q.table.location)}`,children:O(Q.table.location)})]}),Q.table.amenities.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:Q.table.amenities.map(se=>a.jsx("span",{className:"px-2 py-1 bg-royal-gold/20 text-royal-gold text-xs rounded-full",children:se.replace("_"," ")},se))})]}),!Q.available&&a.jsx("div",{className:"mt-2 text-red-400 text-sm font-medium",children:"Not Available"})]},Q.table.id))}),a.jsx("div",{className:"flex space-x-4",children:a.jsx("button",{onClick:()=>s(1),className:"flex-1 bg-royal-charcoal-dark text-royal-cream py-3 px-6 rounded-royal font-semibold border border-royal-gold/30 hover:bg-royal-charcoal transition-all duration-200",children:"Back"})})]}),X=()=>a.jsxs(oe.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-royal font-bold text-royal-cream mb-2",children:"Confirm Your Details"}),a.jsx("p",{className:"text-royal-cream/70",children:"Please provide your contact information"})]}),h&&a.jsxs("div",{className:"bg-royal-charcoal-dark rounded-royal p-4 border border-royal-gold/30",children:[a.jsx("h3",{className:"font-semibold text-royal-cream mb-3",children:"Reservation Summary"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-royal-cream/70",children:"Date:"}),a.jsx("span",{className:"text-royal-cream",children:new Date(_.date).toLocaleDateString()})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-royal-cream/70",children:"Time:"}),a.jsx("span",{className:"text-royal-cream",children:R(_.timeSlot)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-royal-cream/70",children:"Table:"}),a.jsxs("span",{className:"text-royal-cream",children:["Table ",h.table.number," (",h.table.location,")"]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-royal-cream/70",children:"Party Size:"}),a.jsxs("span",{className:"text-royal-cream",children:[_.partySize," people"]})]}),a.jsxs("div",{className:"flex justify-between font-semibold border-t border-royal-gold/30 pt-2",children:[a.jsx("span",{className:"text-royal-cream",children:"Reservierung:"}),a.jsx("span",{className:"text-green-400",children:"KOSTENLOS"})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-royal-cream font-medium",children:"Full Name *"}),a.jsx("input",{type:"text",value:_.customerName,onChange:Q=>T(se=>({...se,customerName:Q.target.value})),className:"w-full p-3 border border-royal-gold/30 rounded-royal bg-royal-charcoal text-royal-cream focus:outline-none focus:ring-2 focus:ring-royal-gold/50",placeholder:"Enter your full name"}),v.customerName&&a.jsxs("p",{className:"text-red-400 text-sm flex items-center",children:[a.jsx(_s,{className:"w-4 h-4 mr-1"}),v.customerName]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-royal-cream font-medium",children:"Email Address *"}),a.jsx("input",{type:"email",value:_.customerEmail,onChange:Q=>T(se=>({...se,customerEmail:Q.target.value})),className:"w-full p-3 border border-royal-gold/30 rounded-royal bg-royal-charcoal text-royal-cream focus:outline-none focus:ring-2 focus:ring-royal-gold/50",placeholder:"Enter your email address"}),v.customerEmail&&a.jsxs("p",{className:"text-red-400 text-sm flex items-center",children:[a.jsx(_s,{className:"w-4 h-4 mr-1"}),v.customerEmail]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-royal-cream font-medium",children:"Phone Number *"}),a.jsx("input",{type:"tel",value:_.customerPhone,onChange:Q=>T(se=>({...se,customerPhone:Q.target.value})),className:"w-full p-3 border border-royal-gold/30 rounded-royal bg-royal-charcoal text-royal-cream focus:outline-none focus:ring-2 focus:ring-royal-gold/50",placeholder:"Enter your phone number"}),v.customerPhone&&a.jsxs("p",{className:"text-red-400 text-sm flex items-center",children:[a.jsx(_s,{className:"w-4 h-4 mr-1"}),v.customerPhone]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-royal-cream font-medium",children:"Special Requests"}),a.jsx("textarea",{value:_.specialRequests,onChange:Q=>T(se=>({...se,specialRequests:Q.target.value})),className:"w-full p-3 border border-royal-gold/30 rounded-royal bg-royal-charcoal text-royal-cream focus:outline-none focus:ring-2 focus:ring-royal-gold/50 h-20 resize-none",placeholder:"Any special requests or dietary requirements..."})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx(JZ,{purpose:"reservation_processing",required:!0,onConsentChange:w,description:"We need to process your personal data to create and manage your reservation."}),v.consent&&a.jsxs("p",{className:"text-red-400 text-sm flex items-center",children:[a.jsx(_s,{className:"w-4 h-4 mr-1"}),v.consent]})]}),a.jsxs("div",{className:"flex space-x-4",children:[a.jsx("button",{onClick:()=>s(2),className:"flex-1 bg-royal-charcoal-dark text-royal-cream py-3 px-6 rounded-royal font-semibold border border-royal-gold/30 hover:bg-royal-charcoal transition-all duration-200",children:"Back"}),a.jsx("button",{onClick:k,disabled:i||!m,className:"flex-1 bg-royal-gradient-gold text-royal-charcoal py-3 px-6 rounded-royal font-semibold hover:shadow-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:i?a.jsx(jn,{}):"Confirm Reservation"})]})]}),Y=()=>a.jsx("div",{className:"flex items-center justify-center space-x-4 mb-8",children:[1,2,3].map(Q=>a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-semibold ${n>=Q?"bg-royal-gold text-royal-charcoal":"bg-royal-charcoal-dark text-royal-cream border border-royal-gold/30"}`,children:n>Q?a.jsx(wN,{className:"w-4 h-4"}):Q}),Q<3&&a.jsx("div",{className:`w-12 h-0.5 mx-2 ${n>Q?"bg-royal-gold":"bg-royal-gold/30"}`})]},Q))});return r?a.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[Y(),a.jsxs("div",{className:"bg-royal-charcoal rounded-royal p-6 border border-royal-gold/30 royal-glow",children:[n===1&&de(),n===2&&ne(),n===3&&X()]}),e&&a.jsx("div",{className:"text-center mt-6",children:a.jsx("button",{onClick:e,className:"text-royal-cream/70 hover:text-royal-cream transition-colors",children:"Cancel Reservation"})})]}):a.jsxs("div",{className:"text-center py-8",children:[a.jsx(_s,{className:"w-12 h-12 text-royal-cream/50 mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-royal-cream mb-2",children:"Login Required"}),a.jsx("p",{className:"text-royal-cream/70",children:"Please log in to make a reservation."})]})},lA=({reservationId:t,tableNumber:e,className:r=""})=>{const[n,s]=M.useState([]),[i,o]=M.useState(!0),[l,c]=M.useState(!1),[u,d]=M.useState(!1);M.useEffect(()=>((async()=>{try{o(!0);const R=await $y.getRecentOrdersForReservation(t);s(R)}catch(R){console.error("Error loading reservation orders:",R)}finally{o(!1)}})(),ls.onOrdersChangeWithFilters({dateRange:{start:new Date(new Date().setHours(0,0,0,0)),end:new Date(new Date().setHours(23,59,59,999))}},R=>{const C=R.filter(G=>G.reservationId===t||G.tableNumber===e);s(C)})),[t,e]);const h=O=>{switch(O){case"pending":return a.jsx(Rr,{className:"w-4 h-4 text-yellow-500"});case"confirmed":return a.jsx(xr,{className:"w-4 h-4 text-blue-500"});case"preparing":return a.jsx(NN,{className:"w-4 h-4 text-orange-500"});case"ready":return a.jsx(_s,{className:"w-4 h-4 text-green-500"});case"delivered":return a.jsx(IY,{className:"w-4 h-4 text-green-600"});case"cancelled":return a.jsx(Zi,{className:"w-4 h-4 text-red-500"});default:return a.jsx(Rr,{className:"w-4 h-4 text-gray-500"})}},g=O=>{switch(O){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"confirmed":return"bg-blue-100 text-blue-800 border-blue-200";case"preparing":return"bg-orange-100 text-orange-800 border-orange-200";case"ready":return"bg-green-100 text-green-800 border-green-200";case"delivered":return"bg-emerald-100 text-emerald-800 border-emerald-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},m=O=>({pending:"Bestellt",confirmed:"Bestätigt",preparing:"In Zubereitung",ready:"Bereit",delivered:"Serviert",cancelled:"Storniert"})[O]||O,w=O=>{switch(O){case"paid":return a.jsx(m3,{className:"w-4 h-4 text-green-500"});case"unpaid":return a.jsx(T0,{className:"w-4 h-4 text-yellow-500"});case"refunded":return a.jsx(AY,{className:"w-4 h-4 text-blue-500"});case"partial":return a.jsx(_s,{className:"w-4 h-4 text-orange-500"});default:return a.jsx(T0,{className:"w-4 h-4 text-gray-500"})}},_=O=>{switch(O){case"paid":return"bg-green-100 text-green-800 border-green-200";case"unpaid":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"refunded":return"bg-blue-100 text-blue-800 border-blue-200";case"partial":return"bg-orange-100 text-orange-800 border-orange-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},T=O=>({paid:"Bezahlt",unpaid:"Offen",refunded:"Erstattet",partial:"Teilweise"})[O]||O,v=n.filter(O=>O.status!=="cancelled"),b=v.filter(O=>{var S;return((S=O.payment)==null?void 0:S.status)==="unpaid"}),x=v.filter(O=>{var S;return((S=O.payment)==null?void 0:S.status)==="paid"}),P=b.reduce((O,S)=>O+S.totalAmount,0),F=x.reduce((O,S)=>O+S.totalAmount,0),$=P+F,k=u?x:b,A=k.length>0,I=b.length>0;return i?a.jsx("div",{className:`p-4 ${r}`,children:a.jsxs("div",{className:"animate-pulse",children:[a.jsx("div",{className:"h-4 bg-royal-gold/20 rounded w-1/3 mb-2"}),a.jsx("div",{className:"h-3 bg-royal-gold/10 rounded w-1/2"})]})}):!I&&!x.length?a.jsx("div",{className:`p-4 border-t border-royal-gold/30 ${r}`,children:a.jsxs("div",{className:"flex items-center justify-between text-royal-cream/70 text-sm",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(x3,{className:"w-4 h-4"}),a.jsx("span",{children:"Noch keine Bestellungen"})]}),a.jsx("span",{className:"text-royal-gold font-bold",children:"0,00€"})]})}):a.jsxs("div",{className:`border-t border-royal-gold/30 ${r}`,children:[a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(x3,{className:"w-5 h-5 text-royal-gold"}),a.jsx("h4",{className:"font-semibold text-royal-cream",children:u?"Bezahlte Bestellungen":"Offene Rechnung"})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-royal-gold font-bold text-lg",children:[u?F.toFixed(2):P.toFixed(2),"€"]}),a.jsxs("div",{className:"text-royal-cream/60 text-xs",children:[k.length," Bestellung",k.length!==1?"en":""]})]})]}),(I||x.length>0)&&a.jsxs("div",{className:"flex items-center justify-between mb-3 p-3 bg-royal-charcoal-dark rounded-royal border border-royal-gold/20",children:[a.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[I&&a.jsxs("div",{className:"flex items-center space-x-1 text-yellow-400",children:[a.jsx(T0,{className:"w-4 h-4"}),a.jsxs("span",{children:["Offen: ",P.toFixed(2),"€"]})]}),x.length>0&&a.jsxs("div",{className:"flex items-center space-x-1 text-green-400",children:[a.jsx(m3,{className:"w-4 h-4"}),a.jsxs("span",{children:["Bezahlt: ",F.toFixed(2),"€"]})]})]}),a.jsxs("div",{className:"text-royal-cream font-medium text-sm",children:["Gesamt: ",$.toFixed(2),"€"]})]}),I&&x.length>0&&a.jsxs("div",{className:"flex bg-royal-charcoal-dark rounded-royal p-1 mb-3",children:[a.jsxs("button",{onClick:()=>d(!1),className:`flex-1 py-2 px-3 rounded text-sm font-medium transition-colors ${u?"text-royal-cream/80 hover:text-royal-cream":"bg-royal-gold text-royal-charcoal"}`,children:["Offene (",b.length,")"]}),a.jsxs("button",{onClick:()=>d(!0),className:`flex-1 py-2 px-3 rounded text-sm font-medium transition-colors ${u?"bg-royal-gold text-royal-charcoal":"text-royal-cream/80 hover:text-royal-cream"}`,children:["Bezahlt (",x.length,")"]})]}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:k.map(O=>{var S,R,C;return a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:`flex items-center space-x-1 px-2 py-1 rounded-full text-xs border ${g(O.status)}`,children:[h(O.status),a.jsx("span",{children:m(O.status)})]}),a.jsxs("div",{className:`flex items-center space-x-1 px-2 py-1 rounded-full text-xs border ${_(((S=O.payment)==null?void 0:S.status)||"unpaid")}`,children:[w(((R=O.payment)==null?void 0:R.status)||"unpaid"),a.jsx("span",{children:T(((C=O.payment)==null?void 0:C.status)||"unpaid")})]})]},O.id)})}),A&&a.jsx("button",{onClick:()=>c(!l),className:"w-full text-royal-cream/80 hover:text-royal-gold transition-colors text-sm font-medium",children:l?"Details ausblenden":"Details anzeigen"})]}),a.jsx(po,{children:l&&a.jsx(oe.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:a.jsx("div",{className:"px-4 pb-4 space-y-4",children:k.map(O=>{var S,R,C,G;return a.jsxs(oe.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-royal-charcoal-dark rounded-royal p-4 border border-royal-gold/20",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[h(O.status),a.jsxs("span",{className:"text-royal-cream font-medium",children:["Bestellung #",O.id.slice(-6)]})]}),a.jsxs("div",{className:"text-royal-gold font-bold",children:[O.totalAmount.toFixed(2),"€"]})]}),a.jsx("div",{className:"space-y-2",children:O.items.map((de,ne)=>a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("span",{className:"text-royal-cream/80",children:[de.quantity,"x"]}),a.jsx("span",{className:"text-royal-cream",children:de.name}),(de.category.toLowerCase()==="shisha"||de.category.toLowerCase()==="tobacco")&&a.jsx("span",{title:"Loyalty Punkte",children:a.jsx(Et,{className:"w-3 h-3 text-royal-purple"})})]}),a.jsxs("span",{className:"text-royal-cream/80",children:[(de.price*de.quantity).toFixed(2),"€"]})]},ne))}),a.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-royal-gold/20",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs border ${g(O.status)}`,children:m(O.status)}),a.jsxs("span",{className:`inline-block px-2 py-1 rounded-full text-xs border ${_(((S=O.payment)==null?void 0:S.status)||"unpaid")}`,children:[w(((R=O.payment)==null?void 0:R.status)||"unpaid"),a.jsx("span",{className:"ml-1",children:T(((C=O.payment)==null?void 0:C.status)||"unpaid")})]})]}),a.jsx("span",{className:"text-royal-cream/60 text-xs",children:new Date(O.createdAt).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})})]}),((G=O.payment)==null?void 0:G.status)==="paid"&&O.payment.paidAt&&a.jsxs("div",{className:"mt-3 p-2 bg-green-900/20 rounded border border-green-500/20",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-green-400",children:"Bezahlt am:"}),a.jsx("span",{className:"text-royal-cream",children:new Date(O.payment.paidAt).toLocaleString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]}),O.payment.method&&a.jsxs("div",{className:"flex items-center justify-between text-sm mt-1",children:[a.jsx("span",{className:"text-green-400",children:"Zahlungsart:"}),a.jsx("span",{className:"text-royal-cream",children:O.payment.method==="cash"?"Bar":O.payment.method==="card"?"Karte":O.payment.method==="bank_transfer"?"Überweisung":O.payment.method==="mobile_payment"?"Mobile":O.payment.method})]})]}),O.specialInstructions&&a.jsxs("div",{className:"mt-3 p-2 bg-royal-charcoal rounded border border-royal-gold/10",children:[a.jsx("span",{className:"text-royal-cream/60 text-xs uppercase tracking-wide",children:"Anweisungen:"}),a.jsx("p",{className:"text-royal-cream text-sm",children:O.specialInstructions})]}),O.loyaltyDiscount&&a.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[a.jsxs("div",{className:"flex items-center space-x-2 text-royal-purple",children:[a.jsx(Et,{className:"w-4 h-4"}),a.jsx("span",{children:"Loyalty Rabatt"})]}),a.jsxs("span",{className:"text-royal-purple font-medium",children:["-",O.loyaltyDiscount.amount.toFixed(2),"€"]})]})]},O.id)})})})})]})},ZZ=()=>{const{user:t}=yn(),[e,r]=M.useState(!1),[n,s]=M.useState([]),[i,o]=M.useState(!0),[l,c]=M.useState(null);M.useEffect(()=>{t&&u()},[t]);const u=async()=>{if(t)try{o(!0);const v=await Qr.getUserReservations(t.id);s(v)}catch(v){console.error("Error loading user reservations:",v),Ee.error("Failed to load your reservations")}finally{o(!1)}},d=()=>{r(!1),u(),Ee.success("Reservation created successfully!")},h=v=>{switch(v){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"confirmed":return"bg-blue-100 text-blue-800 border-blue-200";case"seated":return"bg-green-100 text-green-800 border-green-200";case"completed":return"bg-emerald-100 text-emerald-800 border-emerald-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";case"no_show":return"bg-gray-100 text-gray-800 border-gray-200";case"expired":return"bg-orange-100 text-orange-800 border-orange-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},g=v=>v.replace("_"," ").replace(/\b\w/g,b=>b.toUpperCase()),m=v=>{const b=new Date,P=(new Date(v.date).getTime()-b.getTime())/(1e3*60*60);return["pending","confirmed"].includes(v.status)&&P>2},w=async v=>{try{await Qr.cancelReservation(v,"Cancelled by customer"),Ee.success("Reservation cancelled successfully"),u()}catch(b){console.error("Error cancelling reservation:",b),Ee.error("Failed to cancel reservation")}},_=v=>{var b;return a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-royal-charcoal rounded-royal p-6 border border-royal-gold/30 royal-glow",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold text-royal-cream mb-2",children:["Table ",v.tableNumber]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center text-royal-cream/80 text-sm",children:[a.jsx(Un,{className:"w-4 h-4 mr-2"}),Lr(v.date,"EEEE, dd.MM.yyyy",{locale:Ss})]}),a.jsxs("div",{className:"flex items-center text-royal-cream/80 text-sm",children:[a.jsx(Rr,{className:"w-4 h-4 mr-2"}),v.timeSlot.replace("-"," - ")]}),a.jsxs("div",{className:"flex items-center text-royal-cream/80 text-sm",children:[a.jsx(qn,{className:"w-4 h-4 mr-2"}),v.partySize," ",v.partySize===1?"person":"people"]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-medium border ${h(v.status)}`,children:g(v.status)}),v.totalAmount&&a.jsxs("div",{className:"text-royal-gold font-semibold mt-2",children:["€",v.totalAmount.toFixed(2)]})]})]}),v.specialRequests&&a.jsxs("div",{className:"mb-4 p-3 bg-royal-charcoal-dark rounded-royal border border-royal-gold/20",children:[a.jsx("p",{className:"text-royal-cream/70 text-xs uppercase tracking-wide mb-1",children:"Special Requests"}),a.jsx("p",{className:"text-royal-cream text-sm",children:v.specialRequests})]}),(v.status==="confirmed"||v.status==="seated"||v.status==="completed")&&a.jsx(lA,{reservationId:v.id,customerName:v.customerName,tableNumber:v.tableNumber}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"text-royal-cream/60 text-xs",children:["Reservation #",(b=v.id)==null?void 0:b.slice(-8)]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("button",{onClick:()=>c(v),className:"flex items-center space-x-1 px-3 py-1 text-royal-cream hover:text-royal-gold transition-colors text-sm",children:[a.jsx(Ca,{className:"w-4 h-4"}),a.jsx("span",{children:"View"})]}),m(v)&&a.jsxs("button",{onClick:()=>w(v.id),className:"flex items-center space-x-1 px-3 py-1 text-red-400 hover:text-red-300 transition-colors text-sm",children:[a.jsx(Zi,{className:"w-4 h-4"}),a.jsx("span",{children:"Cancel"})]})]})]})]},v.id)},T=()=>l?a.jsx(oe.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>c(null),children:a.jsxs("div",{className:"bg-royal-charcoal rounded-royal p-6 border border-royal-gold/30 max-w-md w-full max-h-[90vh] overflow-y-auto",onClick:v=>v.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-xl font-royal font-bold text-royal-cream",children:"Reservation Details"}),a.jsx("button",{onClick:()=>c(null),className:"p-2 hover:bg-royal-charcoal-dark rounded-royal transition-colors",children:a.jsx(Zi,{className:"w-5 h-5 text-royal-cream"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream/70 text-sm",children:"Date"}),a.jsx("p",{className:"text-royal-cream font-medium",children:Lr(l.date,"dd.MM.yyyy",{locale:Ss})})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream/70 text-sm",children:"Time"}),a.jsx("p",{className:"text-royal-cream font-medium",children:l.timeSlot.replace("-"," - ")})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream/70 text-sm",children:"Table"}),a.jsxs("p",{className:"text-royal-cream font-medium",children:["Table ",l.tableNumber]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream/70 text-sm",children:"Party Size"}),a.jsxs("p",{className:"text-royal-cream font-medium",children:[l.partySize," people"]})]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream/70 text-sm",children:"Status"}),a.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-medium border ${h(l.status)} mt-1`,children:g(l.status)})]}),l.specialRequests&&a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream/70 text-sm mb-2",children:"Special Requests"}),a.jsx("p",{className:"text-royal-cream bg-royal-charcoal-dark p-3 rounded-royal border border-royal-gold/20",children:l.specialRequests})]}),l.totalAmount&&a.jsx("div",{className:"border-t border-royal-gold/30 pt-4",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-royal-cream",children:"Reservation Fee:"}),a.jsxs("span",{className:"text-royal-gold font-bold text-lg",children:["€",l.totalAmount.toFixed(2)]})]})}),(l.status==="confirmed"||l.status==="seated"||l.status==="completed")&&a.jsx(lA,{reservationId:l.id,customerName:l.customerName,tableNumber:l.tableNumber,className:"border-t border-royal-gold/30 mt-4"}),a.jsxs("div",{className:"text-center text-royal-cream/60 text-xs pt-4 border-t border-royal-gold/30",children:[a.jsxs("p",{children:["Reservation ID: ",l.id]}),a.jsxs("p",{children:["Created:"," ",Lr(l.createdAt,"dd.MM.yyyy HH:mm",{locale:Ss})]})]})]})]})}):null;return t?a.jsx("div",{className:"min-h-screen bg-royal-gradient-cream pt-20",children:a.jsx("div",{className:"container mx-auto px-4 py-8",children:e?a.jsxs("div",{children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("button",{onClick:()=>r(!1),className:"flex items-center space-x-2 text-royal-charcoal hover:text-royal-charcoal/80 transition-colors mb-4",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),a.jsx("span",{children:"Back to Reservations"})]}),a.jsx("h1",{className:"text-4xl font-royal font-bold text-royal-charcoal mb-2",children:"Make a Reservation"}),a.jsx("p",{className:"text-royal-charcoal/70",children:"Reserve your table at Royal Shisha Bar"})]}),a.jsx(XZ,{onReservationComplete:d,onCancel:()=>r(!1)})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-8",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-royal font-bold text-royal-charcoal mb-2",children:"Your Reservations"}),a.jsx("p",{className:"text-royal-charcoal/70",children:"Manage your table reservations at Royal Shisha Bar"})]}),a.jsxs("button",{onClick:()=>r(!0),className:"flex items-center space-x-2 bg-royal-gradient-gold text-royal-charcoal px-6 py-3 rounded-royal font-semibold hover:shadow-lg transition-all duration-200",children:[a.jsx(Ai,{className:"w-5 h-5"}),a.jsx("span",{children:"New Reservation"})]})]}),i?a.jsx("div",{className:"flex justify-center items-center min-h-64",children:a.jsx(jn,{})}):n.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(_)}):a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-16",children:[a.jsx(Un,{className:"w-16 h-16 text-royal-charcoal/50 mx-auto mb-6"}),a.jsx("h3",{className:"text-2xl font-semibold text-royal-charcoal mb-4",children:"No Reservations Yet"}),a.jsx("p",{className:"text-royal-charcoal/70 mb-8 max-w-md mx-auto",children:"You haven't made any reservations yet. Book your table now and enjoy our premium shisha experience."}),a.jsx("button",{onClick:()=>r(!0),className:"bg-royal-gradient-gold text-royal-charcoal px-8 py-3 rounded-royal font-semibold hover:shadow-lg transition-all duration-200",children:"Make Your First Reservation"})]}),T()]})})}):a.jsx("div",{className:"min-h-screen bg-royal-gradient-cream pt-20",children:a.jsx("div",{className:"container mx-auto px-4 py-12",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Et,{className:"w-16 h-16 text-royal-gold mx-auto mb-4"}),a.jsx("h1",{className:"text-3xl font-royal font-bold text-royal-charcoal mb-4",children:"Login Required"}),a.jsx("p",{className:"text-royal-charcoal/70 mb-8",children:"Please log in to view and manage your reservations."}),a.jsx("a",{href:"/auth",className:"bg-royal-gradient-gold text-royal-charcoal px-8 py-3 rounded-royal font-semibold hover:shadow-lg transition-all duration-200",children:"Login / Register"})]})})})},eee=()=>{const t=Ap(),{user:e,isAuthenticated:r}=yn(),[n,s]=M.useState(null),[i,o]=M.useState([]),[l,c]=M.useState(!1),[u,d]=M.useState(!1),[h,g]=M.useState(!1),[m,w]=M.useState("");M.useEffect(()=>{r&&e&&(e.phone?_(e.phone):g(!0))},[r,e]);const _=async F=>{c(!0);try{const $=await ks.searchLoyaltyCardByPhone(F);if($)s($),b($.id),_t.success("Ihr Stempelpass wurde gefunden!");else{const k=await ks.getOrCreateLoyaltyCard(F,e.name);s(k),b(k.id),_t.success("Neuer Stempelpass erstellt!")}}catch($){console.error("Error searching user loyalty card:",$),_t.error("Fehler beim Laden Ihres Stempelpasses")}finally{c(!1)}},T=async()=>{if(!m.trim()){_t.error("Bitte geben Sie eine Telefonnummer ein");return}c(!0);try{await Ka.updateUserProfile(e.id,{phone:m.trim()}),yn.getState().setUser({...e,phone:m.trim()}),await _(m.trim()),g(!1),w("")}catch(F){console.error("Error updating phone:",F),_t.error("Fehler beim Aktualisieren der Telefonnummer")}finally{c(!1)}},v=async F=>{s(F),b(F.id)},b=async F=>{c(!0);try{const $=await ks.getLoyaltyTransactions(F);o($)}catch($){console.error("Error loading transactions:",$)}finally{c(!1)}},x=F=>{switch(F){case"stamp_earned":return a.jsx(zn,{className:"w-4 h-4 text-royal-purple"});case"free_shisha_earned":return a.jsx(Ki,{className:"w-4 h-4 text-royal-purple-light"});case"free_shisha_redeemed":return a.jsx(Ki,{className:"w-4 h-4 text-royal-gold"});default:return a.jsx(zn,{className:"w-4 h-4 text-royal-purple"})}},P=F=>{switch(F){case"stamp_earned":return"bg-royal-purple/10 border-royal-purple/20";case"free_shisha_earned":return"bg-royal-purple-light/10 border-royal-purple-light/20";case"free_shisha_redeemed":return"bg-royal-gold/10 border-royal-gold/20";default:return"bg-royal-purple/10 border-royal-purple/20"}};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-royal-cream to-royal-purple/5",children:[a.jsx("div",{className:"bg-gradient-to-r from-royal-purple to-royal-purple-light text-white py-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("button",{onClick:()=>t(-1),className:"flex items-center space-x-2 text-royal-cream hover:text-white mb-4 transition-colors",children:[a.jsx(tY,{className:"w-5 h-5"}),a.jsx("span",{children:"Zurück"})]}),a.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsx(Et,{className:"w-8 h-8 text-royal-gold"}),a.jsx("h1",{className:"text-3xl md:text-4xl font-royal font-bold",children:"Royal Stempelpass"})]}),a.jsx("p",{className:"text-royal-cream-light text-lg",children:"Sammeln Sie Stempel und erhalten Sie gratis Shishas"})]})}),a.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a.jsxs("div",{className:"space-y-8",children:[r&&h&&a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-royal p-6 shadow-lg border border-royal-purple/20",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("div",{className:"w-16 h-16 bg-royal-purple/20 rounded-full flex items-center justify-center mx-auto mb-3",children:a.jsx(RY,{className:"w-8 h-8 text-royal-purple"})}),a.jsx("h3",{className:"text-xl font-royal font-bold text-royal-purple mb-2",children:"Telefonnummer hinzufügen"}),a.jsx("p",{className:"text-royal-charcoal/70 mb-4",children:"Um Ihren Stempelpass zu verwalten, benötigen wir Ihre Telefonnummer"})]}),a.jsxs("div",{className:"max-w-sm mx-auto",children:[a.jsxs("div",{className:"relative mb-4",children:[a.jsx(Hn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-royal-purple/60 w-5 h-5"}),a.jsx("input",{type:"tel",value:m,onChange:F=>w(F.target.value),placeholder:"z.B. +49 123 4567890",className:"w-full pl-12 pr-4 py-3 border-2 border-royal-purple/20 rounded-royal focus:outline-none focus:border-royal-purple focus:ring-2 focus:ring-royal-purple/20 bg-white text-royal-charcoal placeholder-royal-charcoal/50 transition-all duration-200",disabled:l})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsxs(oe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:T,disabled:l||!m.trim(),className:"flex-1 bg-royal-purple text-white py-3 px-6 rounded-royal font-medium hover:bg-royal-purple-light transition-colors duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2 royal-glow",children:[l?a.jsx(jn,{size:"sm"}):a.jsx(Hn,{className:"w-5 h-5"}),a.jsx("span",{children:l?"Aktualisiere...":"Hinzufügen"})]}),a.jsx("button",{onClick:()=>g(!1),className:"px-6 py-3 border-2 border-royal-charcoal/30 text-royal-charcoal/70 rounded-royal hover:bg-royal-charcoal/5 transition-colors duration-300 font-medium",children:"Später"})]})]})]}),a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-royal p-6 shadow-lg border border-royal-purple/20",children:[a.jsx("h2",{className:"text-2xl font-royal font-bold text-royal-purple mb-4",children:"So funktioniert's"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-royal-purple/20 rounded-full flex items-center justify-center mx-auto mb-3",children:a.jsx(zn,{className:"w-8 h-8 text-royal-purple"})}),a.jsx("h3",{className:"font-bold text-royal-charcoal mb-2",children:"Sammeln"}),a.jsx("p",{className:"text-sm text-royal-charcoal/70",children:"Für jede bestellte Shisha erhalten Sie einen Stempel"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-royal-purple/20 rounded-full flex items-center justify-center mx-auto mb-3",children:a.jsx(Et,{className:"w-8 h-8 text-royal-purple"})}),a.jsx("h3",{className:"font-bold text-royal-charcoal mb-2",children:"10 Stempel"}),a.jsx("p",{className:"text-sm text-royal-charcoal/70",children:"Bei 10 Stempeln erhalten Sie eine gratis Shisha"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-royal-purple/20 rounded-full flex items-center justify-center mx-auto mb-3",children:a.jsx(Ki,{className:"w-8 h-8 text-royal-purple"})}),a.jsx("h3",{className:"font-bold text-royal-charcoal mb-2",children:"Einlösen"}),a.jsx("p",{className:"text-sm text-royal-charcoal/70",children:"Lösen Sie Ihre gratis Shisha bei Ihrer nächsten Bestellung ein"})]})]})]}),!n&&!h?a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:a.jsx(bP,{onCardSelected:v,showCreateNew:!0,onCreateNew:()=>{}})}):n?a.jsxs("div",{className:"space-y-6",children:[r&&e&&a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-royal-purple/10 border border-royal-purple/20 rounded-royal p-4",children:a.jsxs("p",{className:"text-royal-purple font-medium text-center",children:["Willkommen zurück, ",e.name,"! Hier ist Ihr Stempelpass:"]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:a.jsx(EN,{loyaltyCard:n,showActions:!1})}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("button",{onClick:()=>d(!u),className:"flex-1 bg-royal-purple text-white py-3 px-6 rounded-royal font-medium hover:bg-royal-purple-light transition-colors duration-300 flex items-center justify-center space-x-2 royal-glow",children:[a.jsx(Av,{className:"w-5 h-5"}),a.jsx("span",{children:u?"Historie ausblenden":"Historie anzeigen"})]}),a.jsx("button",{onClick:()=>t("/menu"),className:"flex-1 border-2 border-royal-purple text-royal-purple py-3 px-6 rounded-royal font-medium hover:bg-royal-purple hover:text-white transition-colors duration-300",children:"Zur Speisekarte"}),a.jsx("button",{onClick:()=>{s(null),o([]),d(!1)},className:"px-6 py-3 text-royal-charcoal/70 hover:text-royal-charcoal transition-colors duration-300",children:"Neue Suche"})]}),u&&a.jsxs(oe.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-white rounded-royal p-6 shadow-lg border border-royal-purple/20",children:[a.jsxs("h3",{className:"text-xl font-royal font-bold text-royal-purple mb-4 flex items-center space-x-2",children:[a.jsx(Av,{className:"w-5 h-5"}),a.jsx("span",{children:"Stempel-Historie"})]}),l?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx(jn,{})}):i.length>0?a.jsx("div",{className:"space-y-3",children:i.map(F=>a.jsx(oe.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:`p-4 rounded-royal border ${P(F.type)}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[x(F.type),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-royal-charcoal",children:F.description}),a.jsx("p",{className:"text-sm text-royal-charcoal/60",children:F.createdAt.toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),a.jsxs("div",{className:"text-right",children:[F.stampsChanged>0&&a.jsxs("div",{className:"text-royal-purple font-bold",children:["+",F.stampsChanged," Stempel"]}),F.type==="free_shisha_redeemed"&&a.jsxs("div",{className:"text-royal-gold font-bold",children:["-",F.shishaCount," Gratis"]}),F.type==="free_shisha_earned"&&a.jsxs("div",{className:"text-royal-purple-light font-bold",children:["+",F.shishaCount," Gratis"]})]})]})},F.id))}):a.jsxs("div",{className:"text-center py-8 text-royal-charcoal/70",children:[a.jsx(Av,{className:"w-16 h-16 mx-auto mb-4 opacity-30"}),a.jsx("p",{children:"Noch keine Transaktionen vorhanden"})]})]})]}):null]})})]})},tee=()=>{const t=[{id:"overview",title:"1. Überblick",icon:_n,content:`
        Diese Datenschutzerklärung informiert Sie über die Art, den Umfang und den Zweck der Verarbeitung personenbezogener Daten 
        durch die Royal Shisha Bar. Wir nehmen den Schutz Ihrer persönlichen Daten sehr ernst und behandeln Ihre personenbezogenen 
        Daten vertraulich und entsprechend der gesetzlichen Datenschutzvorschriften sowie dieser Datenschutzerklärung.
      `},{id:"responsible",title:"2. Verantwortlicher",icon:Aa,content:`
        Verantwortlicher im Sinne der Datenschutz-Grundverordnung (DSGVO) ist:

        Royal Shisha Bar
        [Ihre Adresse]
        [PLZ Stadt]
        Deutschland

        E-Mail: royal.waldkraiburg@gmail.com
        Telefon: [Ihre Telefonnummer]
      `},{id:"data-collection",title:"3. Datenerhebung und -verarbeitung",icon:Dh,content:`
        Wir erheben und verarbeiten personenbezogene Daten in folgenden Bereichen:

        **Benutzerkonto:**
        - Name, E-Mail-Adresse, Telefonnummer
        - Benutzername und verschlüsseltes Passwort
        - Profilbild (optional)
        - Kontoerstellungsdatum und letzte Anmeldung

        **Reservierungen:**
        - Kontaktdaten (Name, E-Mail, Telefon)
        - Reservierungsdetails (Datum, Uhrzeit, Personenanzahl)
        - Besondere Wünsche oder Anforderungen

        **Bestellungen:**
        - Bestelldetails und Warenkorbinhalt
        - Tischnummer und Bestellzeitpunkt
        - Zahlungsinformationen (nur verarbeitungsrelevante Daten)

        **Treueprogramm:**
        - Stempelkarten-ID und Sammelpunkte
        - Bestellhistorie für Treuepunkte
        - Einlösung von Belohnungen

        **Technische Daten:**
        - IP-Adresse und Browser-Informationen
        - Cookie-Präferenzen
        - Nutzungsstatistiken (anonymisiert)
      `},{id:"legal-basis",title:"4. Rechtsgrundlagen",icon:Sa,content:`
        Die Verarbeitung Ihrer personenbezogenen Daten erfolgt auf folgenden Rechtsgrundlagen:

        **Art. 6 Abs. 1 lit. a DSGVO (Einwilligung):**
        - Marketing-E-Mails und SMS
        - Nicht-notwendige Cookies
        - Datenanalyse zu Marketingzwecken

        **Art. 6 Abs. 1 lit. b DSGVO (Vertragserfüllung):**
        - Benutzerkonto-Verwaltung
        - Reservierungsabwicklung
        - Bestellungsverarbeitung
        - Treueprogramm-Teilnahme

        **Art. 6 Abs. 1 lit. f DSGVO (Berechtigte Interessen):**
        - Website-Sicherheit
        - Fraud-Prevention
        - Technische Notwendige Cookies
        - Anonyme Statistiken
      `},{id:"data-sharing",title:"5. Datenweitergabe",icon:Ca,content:`
        Eine Übermittlung Ihrer persönlichen Daten an Dritte erfolgt nur:

        **Dienstleister (Auftragsverarbeiter):**
        - Firebase (Google) - Hosting und Datenspeicherung
        - Vercel - Website-Hosting
        - Zahlungsdienstleister (für Transaktionen)
        - E-Mail-Service-Provider (für Kommunikation)

        **Gesetzliche Verpflichtungen:**
        - Bei Vorliegen einer gerichtlichen Anordnung
        - Zur Erfüllung steuerlicher Pflichten
        - Bei Verdacht auf Straftaten

        Alle Dienstleister sind vertraglich zur Einhaltung der DSGVO verpflichtet.
      `},{id:"data-retention",title:"6. Speicherdauer",icon:Rr,content:`
        Wir speichern Ihre Daten nur so lange, wie es für den jeweiligen Zweck erforderlich ist:

        **Benutzerkonto:** Bis zur Löschung des Kontos
        **Reservierungen:** 3 Jahre (steuerliche Aufbewahrungspflicht)
        **Bestellungen:** 10 Jahre (steuerliche und handelsrechtliche Aufbewahrungspflicht)
        **Treueprogramm:** Bis zur Beendigung der Teilnahme + 1 Jahr
        **Marketing-Einwilligungen:** Bis zum Widerruf
        **Technische Logs:** 30 Tage
        **Cookies:** Entsprechend Ihrer Cookie-Einstellungen

        Nach Ablauf der Speicherdauer werden die Daten automatisch gelöscht oder anonymisiert.
      `},{id:"rights",title:"7. Ihre Rechte",icon:_N,content:`
        Sie haben folgende Rechte bezüglich Ihrer personenbezogenen Daten:

        **Auskunftsrecht (Art. 15 DSGVO):**
        Recht auf Auskunft über die von uns verarbeiteten personenbezogenen Daten.

        **Berichtigungsrecht (Art. 16 DSGVO):**
        Recht auf Berichtigung unrichtiger oder unvollständiger Daten.

        **Löschungsrecht (Art. 17 DSGVO):**
        Recht auf Löschung Ihrer personenbezogenen Daten unter bestimmten Voraussetzungen.

        **Einschränkungsrecht (Art. 18 DSGVO):**
        Recht auf Einschränkung der Verarbeitung unter bestimmten Voraussetzungen.

        **Datenübertragbarkeit (Art. 20 DSGVO):**
        Recht auf Erhalt Ihrer Daten in einem strukturierten, gängigen Format.

        **Widerspruchsrecht (Art. 21 DSGVO):**
        Recht auf Widerspruch gegen die Verarbeitung aus berechtigten Interessen.

        **Widerruf von Einwilligungen:**
        Recht auf jederzeitigen Widerruf erteilter Einwilligungen.

        Zur Ausübung Ihrer Rechte wenden Sie sich an: royal.waldkraiburg@gmail.com
      `},{id:"cookies",title:"8. Cookies und Tracking",icon:Dh,content:`
        Unsere Website verwendet verschiedene Arten von Cookies:

        **Notwendige Cookies:**
        - Authentifizierung und Sicherheit
        - Warenkorb-Funktionalität
        - Session-Management
        Diese Cookies sind für das Funktionieren der Website erforderlich.

        **Funktionale Cookies:**
        - Spracheinstellungen
        - Benutzerpräferenzen
        - Chat-Support-Funktionen

        **Analyse-Cookies:**
        - Google Analytics (falls aktiviert)
        - Nutzungsstatistiken
        - Performance-Monitoring

        **Marketing-Cookies:**
        - Soziale Medien Integration
        - Werbe-Tracking
        - Remarketing-Funktionen

        Sie können Ihre Cookie-Präferenzen jederzeit in den Cookie-Einstellungen anpassen.
      `},{id:"security",title:"9. Datensicherheit",icon:_n,content:`
        Wir treffen umfangreiche Sicherheitsmaßnahmen zum Schutz Ihrer Daten:

        **Technische Maßnahmen:**
        - SSL/TLS-Verschlüsselung für alle Datenübertragungen
        - Sichere Passwort-Hashing-Verfahren
        - Regelmäßige Sicherheitsupdates
        - Firewall und Intrusion Detection
        - Backup und Recovery-Systeme

        **Organisatorische Maßnahmen:**
        - Zugriffskontrolle und Berechtigungsmanagement
        - Regelmäßige Sicherheitsschulungen
        - Datenschutz-Folgenabschätzungen
        - Incident-Response-Verfahren

        **Audit und Monitoring:**
        - Kontinuierliche Überwachung der Systeme
        - Regelmäßige Sicherheitsaudits
        - Penetrationstests
        - Compliance-Überprüfungen
      `},{id:"international",title:"10. Internationale Datenübertragungen",icon:Si,content:`
        Ihre Daten werden teilweise an Dienstleister außerhalb der EU übertragen:

        **Google Firebase (USA):**
        - Angemessenheitsbeschluss der EU-Kommission
        - Zusätzliche Schutzmaßnahmen durch Standardvertragsklauseln
        - Privacy Shield Framework (soweit anwendbar)

        **Andere US-Dienstleister:**
        - Verwendung von Standardvertragsklauseln der EU-Kommission
        - Zusätzliche technische und organisatorische Maßnahmen
        - Regelmäßige Überprüfung der Schutzmaßnahmen

        Alle internationalen Übertragungen erfolgen nur mit angemessenen Garantien für den Datenschutz.
      `},{id:"minors",title:"11. Minderjährige",icon:Aa,content:`
        Unsere Dienste richten sich nicht an Personen unter 16 Jahren. Wir erheben wissentlich keine 
        personenbezogenen Daten von Kindern unter 16 Jahren ohne die Einwilligung der Eltern oder 
        Erziehungsberechtigten.

        Falls Sie unter 16 Jahre alt sind, bitten wir Sie, keine personenbezogenen Daten über unsere 
        Website zu übermitteln, ohne vorherige Einwilligung Ihrer Eltern oder Erziehungsberechtigten.
      `},{id:"contact",title:"12. Kontakt und Beschwerden",icon:ji,content:`
        **Datenschutzbeauftragter:**
        Bei Fragen zum Datenschutz kontaktieren Sie uns unter:
        E-Mail: royal.waldkraiburg@gmail.com

        **Aufsichtsbehörde:**
        Sie haben das Recht, sich bei einer Datenschutz-Aufsichtsbehörde zu beschweren:

        Bayerisches Landesamt für Datenschutzaufsicht (BayLDA)
        Promenade 18
        91522 Ansbach
        Telefon: 0981 180093-0
        E-Mail: poststelle@lda.bayern.de

        **Widerspruch gegen Datenverarbeitung:**
        Sofern Ihre personenbezogenen Daten auf Grundlage von berechtigten Interessen verarbeitet werden, 
        haben Sie das Recht, Widerspruch gegen diese Datenverarbeitung einzulegen.
      `},{id:"changes",title:"13. Änderungen der Datenschutzerklärung",icon:Sa,content:`
        Wir behalten uns vor, diese Datenschutzerklärung bei Bedarf zu aktualisieren, um den aktuellen 
        rechtlichen Anforderungen zu entsprechen oder Änderungen unserer Leistungen umzusetzen.

        **Benachrichtigung über Änderungen:**
        - Wesentliche Änderungen werden per E-Mail mitgeteilt
        - Die aktuelle Version ist stets auf unserer Website verfügbar
        - Das Datum der letzten Aktualisierung ist am Ende dieser Erklärung vermerkt

        Wir empfehlen, diese Datenschutzerklärung regelmäßig zu überprüfen.
      `}];return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-royal-charcoal via-gray-900 to-royal-charcoal py-12",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[a.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-royal-gold mb-4",children:"Datenschutzerklärung"}),a.jsx("p",{className:"text-xl text-gray-300 max-w-3xl mx-auto",children:"Transparente Information über die Verarbeitung Ihrer personenbezogenen Daten gemäß der Datenschutz-Grundverordnung (DSGVO)"}),a.jsxs("div",{className:"mt-6 text-sm text-gray-400",children:["Letzte Aktualisierung: ",new Date().toLocaleDateString("de-DE")]})]}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-12",children:a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsx("h2",{className:"text-xl font-semibold text-royal-gold mb-4",children:"Schnellnavigation"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:t.map(e=>a.jsxs("a",{href:`#${e.id}`,className:"flex items-center gap-2 text-sm text-gray-300 hover:text-royal-gold transition-colors p-2 rounded-lg hover:bg-white/5",children:[a.jsx(e.icon,{className:"h-4 w-4"}),e.title]},e.id))})]})}),a.jsx("div",{className:"space-y-8",children:t.map((e,r)=>{const n=e.icon;return a.jsxs(oe.section,{id:e.id,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*(r+2)},className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 md:p-8 border border-white/10",children:[a.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[a.jsx("div",{className:"p-3 bg-royal-gold/20 rounded-lg",children:a.jsx(n,{className:"h-6 w-6 text-royal-gold"})}),a.jsx("div",{children:a.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:e.title})})]}),a.jsx("div",{className:"prose prose-invert max-w-none",children:e.content.split(`

`).map((s,i)=>{if(s.trim().startsWith("**")&&s.trim().endsWith("**"))return a.jsx("h3",{className:"text-lg font-semibold text-royal-gold mt-6 mb-3",children:s.replace(/\*\*/g,"")},i);if(s.trim().startsWith("- ")){const o=s.split(`
`).filter(l=>l.trim().startsWith("- "));return a.jsx("ul",{className:"list-disc list-inside space-y-2 mb-4 text-gray-300",children:o.map((l,c)=>a.jsx("li",{children:l.replace("- ","")},c))},i)}return s.trim()?a.jsx("p",{className:"text-gray-300 mb-4 leading-relaxed",children:s.split("**").map((o,l)=>l%2===1?a.jsx("strong",{className:"text-royal-gold font-semibold",children:o},l):o)},i):null})})]},e.id)})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"mt-12 text-center",children:a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsx("h3",{className:"text-xl font-semibold text-royal-gold mb-4",children:"Ihre Datenschutzrechte ausüben"}),a.jsx("p",{className:"text-gray-300 mb-6",children:"Sie können Ihre Rechte bezüglich Ihrer personenbezogenen Daten jederzeit ausüben."}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[a.jsxs(Jr,{to:"/privacy-dashboard",className:"inline-flex items-center gap-2 px-6 py-3 bg-royal-gold text-royal-charcoal font-semibold rounded-lg hover:bg-royal-gold/90 transition-colors",children:[a.jsx(Aa,{className:"h-5 w-5"}),"Datenschutz-Dashboard"]}),a.jsxs("a",{href:"mailto:royal.waldkraiburg@gmail.com",className:"inline-flex items-center gap-2 px-6 py-3 border border-royal-gold text-royal-gold font-semibold rounded-lg hover:bg-royal-gold/10 transition-colors",children:[a.jsx(ji,{className:"h-5 w-5"}),"Kontakt aufnehmen"]})]})]})})]})})},ree=()=>{var $,k,A;const{user:t}=yn(),[e,r]=M.useState(!0),[n,s]=M.useState(null),[i,o]=M.useState("overview"),[l,c]=M.useState([]),[u,d]=M.useState([]),[h,g]=M.useState([]),[m,w]=M.useState(null),[_,T]=M.useState(!1);M.useEffect(()=>{t&&v()},[t]);const v=async()=>{if(t)try{r(!0);const[I,O,S,R,C]=await Promise.all([ar.getPrivacyDashboardData(t.id),ar.getPrivacySettings(t.id),ar.getDataExportRequests(t.id),ar.getDataDeletionRequests(t.id),ar.getAuditLogs(t.id)]);s(I),w(O),c(S),d(R),g(C)}catch(I){console.error("Error loading dashboard data:",I)}finally{r(!1)}},b=async()=>{if(t)try{T(!0),await ar.requestDataExport(t.id,"complete"),await v()}catch(I){console.error("Error requesting data export:",I)}finally{T(!1)}},x=async()=>{if(!(!t||!window.confirm("Sind Sie sicher, dass Sie die Löschung Ihres Kontos beantragen möchten? Diese Aktion kann nicht rückgängig gemacht werden.")))try{T(!0),await ar.requestDataDeletion(t.id,"Benutzeranfrage"),await v()}catch(O){console.error("Error requesting data deletion:",O)}finally{T(!1)}},P=async I=>{if(!(!t||!m))try{T(!0);const O={...m,...I};await ar.updatePrivacySettings(t.id,O),w(O)}catch(O){console.error("Error updating privacy settings:",O)}finally{T(!1)}};if(!t)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-royal-charcoal via-gray-900 to-royal-charcoal flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(_N,{className:"h-16 w-16 text-royal-gold mx-auto mb-4"}),a.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Anmeldung erforderlich"}),a.jsx("p",{className:"text-gray-300",children:"Sie müssen angemeldet sein, um auf das Datenschutz-Dashboard zuzugreifen."})]})});if(e)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-royal-charcoal via-gray-900 to-royal-charcoal flex items-center justify-center",children:a.jsx(jn,{})});const F=[{id:"overview",name:"Übersicht",icon:_n},{id:"settings",name:"Einstellungen",icon:Yc},{id:"data",name:"Meine Daten",icon:Dh},{id:"requests",name:"Anfragen",icon:Ja},{id:"audit",name:"Aktivitäten",icon:Mm}];return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-royal-charcoal via-gray-900 to-royal-charcoal py-8",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-8",children:[a.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-royal-gold mb-2",children:"Datenschutz-Dashboard"}),a.jsx("p",{className:"text-gray-300",children:"Verwalten Sie Ihre Datenschutzeinstellungen und üben Sie Ihre DSGVO-Rechte aus"})]}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-8",children:a.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:F.map(I=>{const O=I.icon;return a.jsxs("button",{onClick:()=>o(I.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${i===I.id?"bg-royal-gold text-royal-charcoal":"bg-white/10 text-gray-300 hover:bg-white/20"}`,children:[a.jsx(O,{className:"h-4 w-4"}),I.name]},I.id)})})}),i==="overview"&&n&&a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(Aa,{className:"h-6 w-6 text-royal-gold"}),a.jsx("h3",{className:"text-lg font-semibold text-white",children:"Konto-Übersicht"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-400",children:"Name"}),a.jsx("p",{className:"text-white",children:(($=n.user.profile)==null?void 0:$.name)||"Nicht verfügbar"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-400",children:"E-Mail"}),a.jsx("p",{className:"text-white",children:((k=n.user.profile)==null?void 0:k.email)||"Nicht verfügbar"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-400",children:"Konto erstellt"}),a.jsx("p",{className:"text-white",children:n.user.accountCreated.toLocaleDateString("de-DE")})]})]})]}),a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(Dh,{className:"h-6 w-6 text-royal-gold"}),a.jsx("h3",{className:"text-lg font-semibold text-white",children:"Ihre Daten"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("p",{className:"text-sm text-gray-300",children:["Datenkategorien: ",n.user.dataCategories.length]}),a.jsxs("p",{className:"text-sm text-gray-300",children:["Letzter Export:"," ",n.user.lastDataExport?n.user.lastDataExport.toLocaleDateString("de-DE"):"Nie"]})]})]}),a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(Mm,{className:"h-6 w-6 text-royal-gold"}),a.jsx("h3",{className:"text-lg font-semibold text-white",children:"Schnellaktionen"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("button",{onClick:()=>o("data"),className:"w-full px-4 py-2 bg-royal-gold/20 text-royal-gold border border-royal-gold rounded-lg hover:bg-royal-gold/30 transition-colors text-sm",children:"Daten exportieren"}),a.jsx("button",{onClick:()=>o("settings"),className:"w-full px-4 py-2 bg-white/10 text-gray-300 border border-white/20 rounded-lg hover:bg-white/20 transition-colors text-sm",children:"Einstellungen"})]})]})]}),i==="settings"&&m&&a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(nP,{className:"h-6 w-6 text-royal-gold"}),a.jsx("h3",{className:"text-lg font-semibold text-white",children:"Cookie-Einstellungen"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-medium",children:"Notwendige Cookies"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Erforderlich für die Grundfunktionen der Website"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(xr,{className:"h-5 w-5 text-green-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-400",children:"Immer aktiv"})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-medium",children:"Analytics Cookies"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Helfen uns, die Website zu verbessern"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:m.cookieConsent.analytics,onChange:I=>P({cookieConsent:{...m.cookieConsent,analytics:I.target.checked}}),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-royal-gold"})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-medium",children:"Marketing Cookies"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Für personalisierte Werbung"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:m.cookieConsent.marketing,onChange:I=>P({cookieConsent:{...m.cookieConsent,marketing:I.target.checked}}),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-royal-gold"})]})]})]})]}),a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(sY,{className:"h-6 w-6 text-royal-gold"}),a.jsx("h3",{className:"text-lg font-semibold text-white",children:"Kommunikationseinstellungen"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(ji,{className:"h-5 w-5 text-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-medium",children:"E-Mail Newsletter"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Angebote und Neuigkeiten per E-Mail"})]})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:m.communicationPreferences.email,onChange:I=>P({communicationPreferences:{...m.communicationPreferences,email:I.target.checked}}),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-royal-gold"})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Hn,{className:"h-5 w-5 text-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-medium",children:"SMS Benachrichtigungen"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Wichtige Updates per SMS"})]})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:m.communicationPreferences.sms,onChange:I=>P({communicationPreferences:{...m.communicationPreferences,sms:I.target.checked}}),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-royal-gold"})]})]})]})]}),a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(_n,{className:"h-6 w-6 text-royal-gold"}),a.jsx("h3",{className:"text-lg font-semibold text-white",children:"Datenverarbeitung"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-medium",children:"Profiling für Empfehlungen"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Personalisierte Angebote basierend auf Ihren Präferenzen"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:m.dataProcessingConsent.profiling,onChange:I=>P({dataProcessingConsent:{...m.dataProcessingConsent,profiling:I.target.checked}}),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-royal-gold"})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-medium",children:"Anonymisierte Analytik"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Hilft bei der Verbesserung unserer Services"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:m.dataProcessingConsent.analytics,onChange:I=>P({dataProcessingConsent:{...m.dataProcessingConsent,analytics:I.target.checked}}),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-royal-gold"})]})]})]})]})]}),i==="data"&&n&&a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(Dh,{className:"h-6 w-6 text-royal-gold"}),a.jsx("h3",{className:"text-lg font-semibold text-white",children:"Ihre gespeicherten Daten"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.user.dataCategories.map(I=>a.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[a.jsx("p",{className:"text-white font-medium capitalize",children:I}),a.jsxs("p",{className:"text-sm text-gray-400",children:[I==="profile"&&"Name, E-Mail, Telefonnummer",I==="reservations"&&"Tischreservierungen und Präferenzen",I==="orders"&&"Bestellhistorie und Zahlungsdaten",I==="loyalty"&&"Treuepunkte und Belohnungen",I==="events"&&"Event-Teilnahmen und Vorlieben",I==="analytics"&&"Nutzungsstatistiken (anonymisiert)"]})]},I))})]}),a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(fY,{className:"h-6 w-6 text-royal-gold"}),a.jsx("h3",{className:"text-lg font-semibold text-white",children:"Daten exportieren"})]}),a.jsx("p",{className:"text-gray-300 mb-4",children:"Sie haben das Recht, eine Kopie aller Ihrer persönlichen Daten in einem strukturierten, gängigen und maschinenlesbaren Format zu erhalten."}),a.jsxs("button",{onClick:b,disabled:_,className:"flex items-center gap-2 px-6 py-3 bg-royal-gold text-royal-charcoal font-medium rounded-lg hover:bg-royal-gold/90 transition-colors disabled:opacity-50",children:[_?a.jsx(jn,{}):a.jsx(Ja,{className:"h-5 w-5"}),"Datenexport anfordern"]}),n.user.lastDataExport&&a.jsx("div",{className:"mt-4 p-4 bg-green-500/20 border border-green-500/30 rounded-lg",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(xr,{className:"h-5 w-5 text-green-500"}),a.jsxs("p",{className:"text-green-300",children:["Letzter Export:"," ",n.user.lastDataExport.toLocaleDateString("de-DE")]})]})})]}),a.jsxs("div",{className:"bg-red-500/10 backdrop-blur-sm rounded-xl p-6 border border-red-500/20",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(ml,{className:"h-6 w-6 text-red-400"}),a.jsx("h3",{className:"text-lg font-semibold text-white",children:"Konto löschen"})]}),a.jsx("p",{className:"text-gray-300 mb-4",children:'Sie haben das Recht auf Löschung ("Recht auf Vergessenwerden"). Beachten Sie, dass bestimmte Daten aus rechtlichen Gründen aufbewahrt werden müssen.'}),a.jsxs("button",{onClick:x,disabled:_,className:"flex items-center gap-2 px-6 py-3 bg-red-600 text-white font-medium rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:[_?a.jsx(jn,{}):a.jsx(Qs,{className:"h-5 w-5"}),"Löschung beantragen"]})]})]}),i==="requests"&&a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(Ja,{className:"h-6 w-6 text-royal-gold"}),a.jsx("h3",{className:"text-lg font-semibold text-white",children:"Datenexport-Anfragen"})]}),l.length===0?a.jsx("p",{className:"text-gray-400",children:"Keine Export-Anfragen vorhanden."}):a.jsx("div",{className:"space-y-3",children:l.map(I=>a.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-medium",children:I.dataCategories.join(", ")}),a.jsxs("p",{className:"text-sm text-gray-400",children:["Angefragt:"," ",I.requestedAt.toLocaleDateString("de-DE")]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[I.status==="pending"&&a.jsxs(a.Fragment,{children:[a.jsx(Rr,{className:"h-5 w-5 text-yellow-500"}),a.jsx("span",{className:"text-yellow-500",children:"Ausstehend"})]}),I.status==="processing"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-blue-500 border-t-transparent rounded-full"}),a.jsx("span",{className:"text-blue-500",children:"Bearbeitung"})]}),I.status==="completed"&&a.jsxs(a.Fragment,{children:[a.jsx(xr,{className:"h-5 w-5 text-green-500"}),a.jsx("span",{className:"text-green-500",children:"Abgeschlossen"})]}),I.status==="failed"&&a.jsxs(a.Fragment,{children:[a.jsx(gl,{className:"h-5 w-5 text-red-500"}),a.jsx("span",{className:"text-red-500",children:"Fehler"})]})]})]}),I.downloadUrl&&a.jsxs("a",{href:I.downloadUrl,download:!0,className:"inline-flex items-center gap-2 mt-3 px-4 py-2 bg-royal-gold text-royal-charcoal rounded-lg hover:bg-royal-gold/90 transition-colors text-sm",children:[a.jsx(Ja,{className:"h-4 w-4"}),"Herunterladen"]})]},I.id))})]}),a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(Qs,{className:"h-6 w-6 text-red-400"}),a.jsx("h3",{className:"text-lg font-semibold text-white",children:"Lösch-Anfragen"})]}),u.length===0?a.jsx("p",{className:"text-gray-400",children:"Keine Lösch-Anfragen vorhanden."}):a.jsx("div",{className:"space-y-3",children:u.map(I=>a.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-medium",children:"Kontolöschung"}),a.jsxs("p",{className:"text-sm text-gray-400",children:["Angefragt:"," ",I.requestedAt.toLocaleDateString("de-DE")]}),a.jsxs("p",{className:"text-sm text-gray-400",children:["Grund: ",I.reason]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[I.status==="pending"&&a.jsxs(a.Fragment,{children:[a.jsx(Rr,{className:"h-5 w-5 text-yellow-500"}),a.jsx("span",{className:"text-yellow-500",children:"Ausstehend"})]}),I.status==="processing"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-blue-500 border-t-transparent rounded-full"}),a.jsx("span",{className:"text-blue-500",children:"Bearbeitung"})]}),I.status==="completed"&&a.jsxs(a.Fragment,{children:[a.jsx(xr,{className:"h-5 w-5 text-green-500"}),a.jsx("span",{className:"text-green-500",children:"Abgeschlossen"})]}),I.status==="rejected"&&a.jsxs(a.Fragment,{children:[a.jsx(gl,{className:"h-5 w-5 text-red-500"}),a.jsx("span",{className:"text-red-500",children:"Abgelehnt"})]})]})]}),I.adminNotes&&a.jsx("div",{className:"mt-3 p-3 bg-blue-500/20 border border-blue-500/30 rounded-lg",children:a.jsxs("p",{className:"text-blue-300 text-sm",children:[a.jsx("strong",{children:"Admin-Notiz:"})," ",I.adminNotes]})})]},I.id))})]})]}),i==="audit"&&a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(Mm,{className:"h-6 w-6 text-royal-gold"}),a.jsx("h3",{className:"text-lg font-semibold text-white",children:"Datenzugriff-Protokoll"})]}),a.jsx("p",{className:"text-gray-300 mb-4",children:"Hier sehen Sie alle Zugriffe auf Ihre persönlichen Daten in den letzten 90 Tagen."}),h.length===0?a.jsx("p",{className:"text-gray-400",children:"Keine Protokolleinträge verfügbar."}):a.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:h.map(I=>a.jsx("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsxs("div",{className:"mt-1",children:[I.action==="read"&&a.jsx(Ca,{className:"h-4 w-4 text-blue-400"}),I.action==="update"&&a.jsx(Yc,{className:"h-4 w-4 text-yellow-400"}),I.action==="delete"&&a.jsx(Qs,{className:"h-4 w-4 text-red-400"}),I.action==="export"&&a.jsx(Ja,{className:"h-4 w-4 text-green-400"})]}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-white font-medium capitalize",children:[I.action==="read"&&"Datenzugriff",I.action==="update"&&"Datenaktualisierung",I.action==="delete"&&"Datenlöschung",I.action==="export"&&"Datenexport"]}),a.jsxs("p",{className:"text-sm text-gray-400",children:[I.dataCategory," -"," ",typeof I.details=="object"?JSON.stringify(I.details):I.details]}),a.jsx("p",{className:"text-xs text-gray-500",children:I.timestamp.toLocaleString("de-DE")})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"text-xs text-gray-400",children:["IP: ",I.ipAddress]}),a.jsx("p",{className:"text-xs text-gray-400",children:I.userAgent})]})]})},I.id))})]})}),!["overview","settings","data","requests","audit"].includes(i)&&a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/5 backdrop-blur-sm rounded-xl p-8 border border-white/10 text-center",children:[a.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:(A=F.find(I=>I.id===i))==null?void 0:A.name}),a.jsx("p",{className:"text-gray-300",children:"Diese Sektion wird in Kürze verfügbar sein."})]})]})})},nee=()=>{const t=[{id:"angaben",title:"Angaben gemäß § 5 TMG",icon:aY,content:`
        **Royal Shisha Bar**
        
        **Adresse:**
        Stadtpl. 2
        84478 Waldkraiburg
        Deutschland
        
        **Kontakt:**
        E-Mail: Royal.Waldkraiburg@gmail.com
        Telefon: +49 15781413767
      `},{id:"vertreter",title:"Vertreten durch",icon:Aa,content:`
        **Geschäftsführung:**
        [Name des Geschäftsführers]
        
        **Handelsregister:**
        [Registereintrag falls vorhanden]
        [Registergericht]
        [Registernummer]
        
        **Umsatzsteuer-Identifikationsnummer:**
        [USt-IdNr. gemäß §27a Umsatzsteuergesetz]
      `},{id:"verantwortlich",title:"Verantwortlich für den Inhalt nach § 55 Abs. 2 RStV",icon:Sa,content:`
        **Verantwortlicher:**
        [Name des Verantwortlichen]
        Royal Shisha Bar
        Stadtpl. 2
        84478 Waldkraiburg
        Deutschland
        
        E-Mail: Royal.Waldkraiburg@gmail.com
      `},{id:"streitschlichtung",title:"Streitschlichtung",icon:uP,content:`
        **EU-Streitschlichtung:**
        Die Europäische Kommission stellt eine Plattform zur Online-Streitbeilegung (OS) bereit: 
        https://ec.europa.eu/consumers/odr/
        
        Unsere E-Mail-Adresse finden Sie oben im Impressum.
        
        **Verbraucherstreitbeilegung/Universalschlichtungsstelle:**
        Wir sind nicht bereit oder verpflichtet, an Streitbeilegungsverfahren vor einer 
        Verbraucherschlichtungsstelle teilzunehmen.
      `},{id:"haftung-inhalte",title:"Haftung für Inhalte",icon:_n,content:`
        Als Diensteanbieter sind wir gemäß § 7 Abs.1 TMG für eigene Inhalte auf diesen Seiten nach den 
        allgemeinen Gesetzen verantwortlich. Nach §§ 8 bis 10 TMG sind wir als Diensteanbieter jedoch nicht 
        unter der Verpflichtung, übermittelte oder gespeicherte fremde Informationen zu überwachen oder nach 
        Umständen zu forschen, die auf eine rechtswidrige Tätigkeit hinweisen.
        
        Verpflichtungen zur Entfernung oder Sperrung der Nutzung von Informationen nach den allgemeinen 
        Gesetzen bleiben hiervon unberührt. Eine diesbezügliche Haftung ist jedoch erst ab dem Zeitpunkt 
        der Kenntnis einer konkreten Rechtsverletzung möglich. Bei Bekanntwerden von entsprechenden 
        Rechtsverletzungen werden wir diese Inhalte umgehend entfernen.
      `},{id:"haftung-links",title:"Haftung für Links",icon:mY,content:`
        Unser Angebot enthält Links zu externen Websites Dritter, auf deren Inhalte wir keinen Einfluss haben. 
        Deshalb können wir für diese fremden Inhalte auch keine Gewähr übernehmen. Für die Inhalte der 
        verlinkten Seiten ist stets der jeweilige Anbieter oder Betreiber der Seiten verantwortlich. 
        
        Die verlinkten Seiten wurden zum Zeitpunkt der Verlinkung auf mögliche Rechtsverstöße überprüft. 
        Rechtswidrige Inhalte waren zum Zeitpunkt der Verlinkung nicht erkennbar. Eine permanente 
        inhaltliche Kontrolle der verlinkten Seiten ist jedoch ohne konkrete Anhaltspunkte einer 
        Rechtsverletzung nicht zumutbar. Bei Bekanntwerden von Rechtsverletzungen werden wir derartige 
        Links umgehend entfernen.
      `},{id:"urheberrecht",title:"Urheberrecht",icon:Sa,content:`
        Die durch die Seitenbetreiber erstellten Inhalte und Werke auf diesen Seiten unterliegen dem 
        deutschen Urheberrecht. Die Vervielfältigung, Bearbeitung, Verbreitung und jede Art der Verwertung 
        außerhalb der Grenzen des Urheberrechtes bedürfen der schriftlichen Zustimmung des jeweiligen 
        Autors bzw. Erstellers.
        
        Downloads und Kopien dieser Seite sind nur für den privaten, nicht kommerziellen Gebrauch gestattet. 
        Soweit die Inhalte auf dieser Seite nicht vom Betreiber erstellt wurden, werden die Urheberrechte 
        Dritter beachtet. Insbesondere werden Inhalte Dritter als solche gekennzeichnet. Sollten Sie 
        trotzdem auf eine Urheberrechtsverletzung aufmerksam werden, bitten wir um einen entsprechenden 
        Hinweis. Bei Bekanntwerden von Rechtsverletzungen werden wir derartige Inhalte umgehend entfernen.
      `},{id:"datenschutz",title:"Datenschutz",icon:_n,content:`
        Der Schutz Ihrer persönlichen Daten ist uns ein wichtiges Anliegen. Wir behandeln Ihre 
        personenbezogenen Daten vertraulich und entsprechend der gesetzlichen Datenschutzvorschriften 
        sowie dieser Datenschutzerklärung.
        
        Die Nutzung unserer Website ist in der Regel ohne Angabe personenbezogener Daten möglich. 
        Soweit auf unseren Seiten personenbezogene Daten (beispielsweise Name, Anschrift oder 
        E-Mail-Adressen) erhoben werden, erfolgt dies, soweit möglich, stets auf freiwilliger Basis.
        
        Wir weisen darauf hin, dass die Datenübertragung im Internet (z.B. bei der Kommunikation per 
        E-Mail) Sicherheitslücken aufweisen kann. Ein lückenloser Schutz der Daten vor dem Zugriff 
        durch Dritte ist nicht möglich.
        
        **Ausführliche Informationen finden Sie in unserer Datenschutzerklärung.**
      `}];return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-royal-charcoal via-gray-900 to-royal-charcoal py-12",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[a.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-royal-gold mb-4",children:"Impressum"}),a.jsx("p",{className:"text-xl text-gray-300 max-w-3xl mx-auto",children:"Angaben gemäß § 5 TMG und rechtliche Hinweise für Royal Shisha Bar"}),a.jsxs("div",{className:"mt-6 text-sm text-gray-400",children:["Stand: ",new Date().toLocaleDateString("de-DE")]})]}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-8",children:a.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-xl p-4 flex items-start gap-3",children:[a.jsx(ml,{className:"h-6 w-6 text-amber-400 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-amber-300 font-semibold mb-1",children:"Rechtlicher Hinweis"}),a.jsx("p",{className:"text-amber-200/80 text-sm",children:"Dieses Impressum erfüllt die Anforderungen des deutschen Telemediengesetzes (TMG) und der Datenschutz-Grundverordnung (DSGVO)."})]})]})}),a.jsx("div",{className:"space-y-8",children:t.map((e,r)=>a.jsx(oe.div,{id:e.id,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.1+.2},className:"bg-white/5 backdrop-blur-sm rounded-xl border border-white/10 overflow-hidden",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"p-2 bg-royal-gold/20 rounded-lg",children:a.jsx(e.icon,{className:"h-6 w-6 text-royal-gold"})}),a.jsx("h2",{className:"text-xl font-semibold text-white",children:e.title})]}),a.jsx("div",{className:"prose prose-invert max-w-none",children:e.content.split(`
`).map((n,s)=>n.trim()===""?null:n.trim().startsWith("**")&&n.trim().endsWith("**")?a.jsx("h3",{className:"text-royal-gold font-semibold text-lg mt-4 mb-2",children:n.trim().slice(2,-2)},s):a.jsx("p",{className:"text-gray-300 mb-3 leading-relaxed",children:n.trim()},s))})]})},e.id))}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},className:"mt-12",children:a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsxs("h3",{className:"text-xl font-semibold text-royal-gold mb-6 flex items-center gap-3",children:[a.jsx(ji,{className:"h-6 w-6"}),"Kontakt bei rechtlichen Fragen"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Si,{className:"h-5 w-5 text-royal-gold mt-1 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-medium mb-1",children:"Adresse"}),a.jsxs("p",{className:"text-gray-300 text-sm",children:["Stadtpl. 2",a.jsx("br",{}),"84478 Waldkraiburg",a.jsx("br",{}),"Deutschland"]})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(ji,{className:"h-5 w-5 text-royal-gold mt-1 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-medium mb-1",children:"E-Mail"}),a.jsx("a",{href:"mailto:Royal.Waldkraiburg@gmail.com",className:"text-royal-gold hover:text-royal-gold/80 transition-colors text-sm",children:"Royal.Waldkraiburg@gmail.com"})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Hn,{className:"h-5 w-5 text-royal-gold mt-1 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-medium mb-1",children:"Telefon"}),a.jsx("a",{href:"tel:+4915781413767",className:"text-royal-gold hover:text-royal-gold/80 transition-colors text-sm",children:"+49 15781413767"})]})]})]}),a.jsx("div",{className:"mt-6 pt-6 border-t border-white/10",children:a.jsx("p",{className:"text-gray-400 text-sm",children:"Bei Fragen zu diesem Impressum oder anderen rechtlichen Angelegenheiten kontaktieren Sie uns gerne über die oben genannten Kontaktdaten."})})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9},className:"mt-8 text-center",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[a.jsxs(Jr,{to:"/privacy-policy",className:"inline-flex items-center gap-2 px-6 py-3 bg-royal-gold text-royal-charcoal font-semibold rounded-lg hover:bg-royal-gold/90 transition-colors",children:[a.jsx(_n,{className:"h-5 w-5"}),"Datenschutzerklärung"]}),a.jsxs(Jr,{to:"/agb",className:"inline-flex items-center gap-2 px-6 py-3 border border-royal-gold text-royal-gold font-semibold rounded-lg hover:bg-royal-gold/10 transition-colors",children:[a.jsx(Sa,{className:"h-5 w-5"}),"AGB"]})]})})]})})},see=()=>{const t=[{id:"geltungsbereich",title:"§ 1 Geltungsbereich",icon:Sa,content:`
        **1.1** Diese Allgemeinen Geschäftsbedingungen (AGB) gelten für alle Leistungen der Royal Shisha Bar, 
        Stadtpl. 2, 84478 Waldkraiburg (nachfolgend "wir" oder "Royal Shisha Bar" genannt).

        **1.2** Diese AGB gelten gegenüber Verbrauchern und Unternehmern. Verbraucher ist jede natürliche Person, 
        die ein Rechtsgeschäft zu Zwecken abschließt, die überwiegend weder ihrer gewerblichen noch ihrer 
        selbständigen beruflichen Tätigkeit zugerechnet werden können.

        **1.3** Diese AGB gelten ausschließlich. Abweichende, entgegenstehende oder ergänzende AGB des Kunden 
        werden nicht Vertragsbestandteil, es sei denn, ihrer Geltung wird ausdrücklich schriftlich zugestimmt.
      `},{id:"vertragsschluss",title:"§ 2 Vertragsschluss",icon:xr,content:`
        **2.1** Die Darstellung unserer Produkte und Dienstleistungen in der App/Website stellt kein rechtlich 
        bindendes Angebot dar, sondern einen unverbindlichen Online-Katalog.

        **2.2** Bei Reservierungen über unsere App/Website geben Sie durch Bestätigung Ihrer Reservierung ein 
        verbindliches Angebot zum Abschluss eines Vertrages ab. Der Vertrag kommt durch unsere Bestätigung 
        oder durch die tatsächliche Leistungserbringung zustande.

        **2.3** Bei Bestellungen erfolgt der Vertragsschluss mit Abgabe der Bestellung über unser Bestellsystem 
        vor Ort oder über die App.

        **2.4** Wir behalten uns vor, Verträge ohne Angabe von Gründen abzulehnen, insbesondere bei 
        Nichtverfügbarkeit von Plätzen oder bei begründeten Zweifeln an der Richtigkeit der Angaben.
      `},{id:"leistungen",title:"§ 3 Unsere Leistungen",icon:qn,content:`
        **3.1 Restaurantbetrieb:**
        - Bewirtung mit Speisen und Getränken
        - Bereitstellung von Sitzplätzen
        - Service und Bedienung

        **3.2 Shisha-Service:**
        - Bereitstellung von Wasserpfeifen und Zubehör
        - Aufbau und Vorbereitung der Shishas
        - Beratung bei der Tabakauswahl
        - Wartung während der Nutzung

        **3.3 Reservierungsservice:**
        - Tischreservierung über App/Website oder Telefon
        - Verwaltung von Gruppenbuchungen
        - Event-Planung für besondere Anlässe

        **3.4 Digitale Services:**
        - Mobile App mit Bestell- und Reservierungsfunktion
        - Treueprogramm/Stempelpass
        - Online-Menü und Preisliste
      `},{id:"preise-zahlung",title:"§ 4 Preise und Zahlung",icon:T0,content:`
        **4.1** Es gelten die zum Zeitpunkt der Bestellung/Reservierung aktuellen Preise. Alle Preise verstehen 
        sich einschließlich der gesetzlichen Mehrwertsteuer.

        **4.2** Bei Vor-Ort-Bestellungen ist die Zahlung sofort bei Erhalt der Rechnung fällig. Akzeptiert werden:
        - Barzahlung
        - EC-Karte/Girocard
        - Kreditkarten (Visa, Mastercard)
        - Kontaktlose Zahlung (NFC)

        **4.3** Bei Reservierungen können wir eine Anzahlung oder Kaution verlangen, insbesondere bei 
        Gruppenbuchungen oder besonderen Events.

        **4.4** Preisänderungen bleiben vorbehalten. Bereits bestätigte Buchungen sind von Preiserhöhungen 
        nicht betroffen.

        **4.5** Bei Nichtzahlung oder Zahlungsverzug behalten wir uns vor, vom Vertrag zurückzutreten und 
        Schadensersatz zu verlangen.
      `},{id:"reservierung-stornierung",title:"§ 5 Reservierung und Stornierung",icon:Rr,content:`
        **5.1 Reservierungen:**
        - Reservierungen sind bis zu 24 Stunden im Voraus möglich
        - Bei Verspätung von mehr als 15 Minuten ohne Benachrichtigung kann der Tisch anderweitig vergeben werden
        - Gruppenbuchungen ab 6 Personen erfordern eine telefonische Bestätigung

        **5.2 Stornierungen:**
        - Kostenlose Stornierung bis 4 Stunden vor dem Reservierungstermin
        - Stornierung zwischen 4 und 2 Stunden vorher: 50% der Mindestverzehrpflicht
        - Stornierung weniger als 2 Stunden vorher oder No-Show: 100% der Mindestverzehrpflicht

        **5.3 Mindestverzehr:**
        - Freitag und Samstag ab 19:00 Uhr: 25€ pro Person
        - Bei Gruppenbuchungen ab 8 Personen: 20€ pro Person
        - An Feiertagen und besonderen Events: nach Vereinbarung

        **5.4** Änderungen von Reservierungen sind bis 2 Stunden vor dem Termin kostenlos möglich.
      `},{id:"nutzung-shisha",title:"§ 6 Nutzung der Shisha-Lounge",icon:rY,content:`
        **6.1 Altersrestriktionen:**
        - Zutritt zur Shisha-Lounge nur für Personen ab 18 Jahren
        - Gültiger Personalausweis oder Reisepass erforderlich
        - Wir behalten uns vor, das Alter zu kontrollieren

        **6.2 Verhalten in der Lounge:**
        - Rauchverbot außerhalb der dafür vorgesehenen Bereiche
        - Leise Unterhaltung erwünscht, laute Musik oder Rufen ist untersagt
        - Respektvoller Umgang mit anderen Gästen und Personal
        - Hausordnung ist zu beachten

        **6.3 Shisha-Nutzung:**
        - Jede Shisha ist für maximal 4 Personen bestimmt
        - Weitergabe an andere Tische nicht gestattet
        - Bei Beschädigung durch unsachgemäße Nutzung wird Ersatz berechnet
        - Mitbringen eigener Tabaksorten nicht gestattet

        **6.4 Hausrecht:**
        - Wir behalten uns das Recht vor, Gäste bei Verstößen gegen die Hausordnung 
          oder unangemessenem Verhalten der Räumlichkeiten zu verweisen
        - Hausverbot kann bei wiederholten Verstößen ausgesprochen werden
      `},{id:"treueprogramm",title:"§ 7 Treueprogramm/Stempelpass",icon:Aa,content:`
        **7.1 Teilnahme:**
        - Teilnahme ist kostenlos und freiwillig
        - Registrierung über unsere App oder vor Ort erforderlich
        - Ein Account pro Person

        **7.2 Sammeln von Stempeln:**
        - 1 Stempel pro 10€ Umsatz (Speisen und Getränke)
        - Stempel werden automatisch bei Zahlung gutgeschrieben
        - Nachträgliche Gutschrift nur am Tag des Kaufs möglich

        **7.3 Einlösung von Belohnungen:**
        - Belohnungen können nur bei vollständig gesammelten Karten eingelöst werden
        - Einlösung nur bei Anwesenheit möglich, nicht übertragbar
        - Belohnungen haben keine Gültigkeit über das Kalenderjahr hinaus

        **7.4 Ausschluss:**
        - Missbrauch oder Manipulation führt zum Ausschluss vom Programm
        - Bei Ausschluss verfallen alle gesammelten Stempel ohne Entschädigung
      `},{id:"datenschutz",title:"§ 8 Datenschutz",icon:_n,content:`
        **8.1** Wir erheben, verarbeiten und nutzen personenbezogene Daten nur im Rahmen der gesetzlichen 
        Bestimmungen. Details regelt unsere separate Datenschutzerklärung.

        **8.2** Bei der Nutzung unserer App werden bestimmte Daten automatisch erfasst und gespeichert. 
        Dies dient der ordnungsgemäßen Abwicklung unserer Dienstleistungen.

        **8.3** Ihre Einwilligung zur Datenverarbeitung können Sie jederzeit widerrufen. Dies berührt 
        nicht die Rechtmäßigkeit der bis zum Widerruf erfolgten Verarbeitung.

        **8.4** Sie haben das Recht auf Auskunft, Berichtigung, Löschung und Einschränkung der 
        Verarbeitung Ihrer personenbezogenen Daten.
      `},{id:"haftung",title:"§ 9 Haftung und Haftungsausschluss",icon:uP,content:`
        **9.1** Wir haften nur für Schäden, die auf einer vorsätzlichen oder grob fahrlässigen 
        Pflichtverletzung unsererseits oder unserer Erfüllungsgehilfen beruhen.

        **9.2** Bei der Verletzung wesentlicher Vertragspflichten haften wir auch für leichte Fahrlässigkeit, 
        jedoch begrenzt auf den vertragstypischen, vorhersehbaren Schaden.

        **9.3** Die Haftung für Schäden an mitgebrachten Gegenständen ist ausgeschlossen, soweit diese 
        nicht in unsere Obhut gegeben wurden.

        **9.4** Für Diebstahl oder Beschädigung persönlicher Gegenstände übernehmen wir keine Haftung. 
        Wir empfehlen, Wertsachen nicht sichtbar liegen zu lassen.

        **9.5** Die Haftung auf Schadensersatz für leicht fahrlässige Pflichtverletzungen ist auf den 
        typischen, vorhersehbaren Schaden begrenzt.

        **9.6** Die Haftung für entgangenen Gewinn, mittelbare Schäden und Folgeschäden ist ausgeschlossen, 
        soweit nicht gesetzlich zwingend gehaftet wird.
      `},{id:"widerruf",title:"§ 10 Widerrufsrecht für Verbraucher",icon:zy,content:`
        **10.1** Verbraucher haben bei Fernabsatzverträgen grundsätzlich ein 14-tägiges Widerrufsrecht. 
        
        **10.2** Das Widerrufsrecht erlischt bei:
        - Dienstleistungen, wenn wir mit der Ausführung vor Ende der Widerrufsfrist begonnen haben
        - Reservierungen für einen bestimmten Zeitpunkt
        - Speisen und Getränken, die bereits konsumiert wurden

        **10.3** Widerrufsbelehrung:**
        Sie haben das Recht, binnen vierzehn Tagen ohne Angabe von Gründen diesen Vertrag zu widerrufen.
        Die Widerrufsfrist beträgt vierzehn Tage ab dem Tag des Vertragsschlusses.

        **10.4** Widerruf erfolgt durch eindeutige Erklärung an:
        Royal Shisha Bar, Stadtpl. 2, 84478 Waldkraiburg
        E-Mail: Royal.Waldkraiburg@gmail.com
      `},{id:"schlussbestimmungen",title:"§ 11 Schlussbestimmungen",icon:Sa,content:`
        **11.1** Es gilt deutsches Recht unter Ausschluss des UN-Kaufrechts.

        **11.2** Gerichtsstand für alle Streitigkeiten ist, soweit gesetzlich zulässig, Waldkraiburg.

        **11.3** Sollten einzelne Bestimmungen dieser AGB unwirksam sein oder werden, berührt dies 
        nicht die Wirksamkeit der übrigen Bestimmungen.

        **11.4** Änderungen und Ergänzungen dieser AGB bedürfen der Schriftform. Dies gilt auch für 
        die Änderung dieser Schriftformklausel.

        **11.5** Wir sind berechtigt, diese AGB mit angemessener Frist zu ändern. Sie gelten als 
        genehmigt, wenn Sie nicht innerhalb von 4 Wochen nach Zugang der Änderungsmitteilung widersprechen.

        **11.6** Bei wiederholten Verstößen gegen diese AGB behalten wir uns vor, das Vertragsverhältnis 
        zu kündigen und ein Hausverbot auszusprechen.
      `}];return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-royal-charcoal via-gray-900 to-royal-charcoal py-12",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[a.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-royal-gold mb-4",children:"Allgemeine Geschäftsbedingungen"}),a.jsx("p",{className:"text-xl text-gray-300 max-w-3xl mx-auto",children:"Geschäftsbedingungen für die Nutzung der Services der Royal Shisha Bar"}),a.jsxs("div",{className:"mt-6 text-sm text-gray-400",children:["Stand: ",new Date().toLocaleDateString("de-DE")," | Version 1.0"]})]}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-8",children:a.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-xl p-4 flex items-start gap-3",children:[a.jsx(zy,{className:"h-6 w-6 text-blue-400 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-blue-300 font-semibold mb-1",children:"Wichtiger Hinweis"}),a.jsx("p",{className:"text-blue-200/80 text-sm",children:"Mit der Nutzung unserer Services erklären Sie sich mit diesen Geschäftsbedingungen einverstanden. Bitte lesen Sie diese sorgfältig durch."})]})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"mb-12",children:a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsx("h2",{className:"text-xl font-semibold text-royal-gold mb-4",children:"Schnellnavigation"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:t.map(e=>a.jsxs("a",{href:`#${e.id}`,className:"flex items-center gap-2 text-sm text-gray-300 hover:text-royal-gold transition-colors p-2 rounded-lg hover:bg-white/5",children:[a.jsx(e.icon,{className:"h-4 w-4"}),e.title]},e.id))})]})}),a.jsx("div",{className:"space-y-8",children:t.map((e,r)=>a.jsx(oe.div,{id:e.id,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.1+.3},className:"bg-white/5 backdrop-blur-sm rounded-xl border border-white/10 overflow-hidden",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"p-2 bg-royal-gold/20 rounded-lg",children:a.jsx(e.icon,{className:"h-6 w-6 text-royal-gold"})}),a.jsx("h2",{className:"text-xl font-semibold text-white",children:e.title})]}),a.jsx("div",{className:"prose prose-invert max-w-none",children:e.content.split(`
`).map((n,s)=>n.trim()===""?null:n.trim().startsWith("**")&&n.trim().endsWith("**")?a.jsx("h4",{className:"text-royal-gold font-semibold text-base mt-3 mb-2",children:n.trim().slice(2,-2)},s):n.trim().startsWith("- ")?a.jsx("li",{className:"text-gray-300 mb-1 ml-4 list-disc",children:n.trim().slice(2)},s):a.jsx("p",{className:"text-gray-300 mb-3 leading-relaxed",children:n.trim()},s))})]})},e.id))}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1},className:"mt-12",children:a.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[a.jsxs("h3",{className:"text-xl font-semibold text-royal-gold mb-4 flex items-center gap-3",children:[a.jsx(ji,{className:"h-6 w-6"}),"Fragen zu den AGB?"]}),a.jsx("p",{className:"text-gray-300 mb-4",children:"Bei Fragen zu diesen Geschäftsbedingungen oder unseren Services kontaktieren Sie uns gerne:"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("a",{href:"mailto:Royal.Waldkraiburg@gmail.com",className:"inline-flex items-center gap-2 px-6 py-3 bg-royal-gold text-royal-charcoal font-semibold rounded-lg hover:bg-royal-gold/90 transition-colors",children:[a.jsx(ji,{className:"h-5 w-5"}),"E-Mail senden"]}),a.jsxs("a",{href:"tel:+4915781413767",className:"inline-flex items-center gap-2 px-6 py-3 border border-royal-gold text-royal-gold font-semibold rounded-lg hover:bg-royal-gold/10 transition-colors",children:[a.jsx(qn,{className:"h-5 w-5"}),"Anrufen"]})]})]})}),a.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.1},className:"mt-8 text-center",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[a.jsxs(Jr,{to:"/privacy-policy",className:"inline-flex items-center gap-2 px-6 py-3 border border-royal-gold text-royal-gold font-semibold rounded-lg hover:bg-royal-gold/10 transition-colors",children:[a.jsx(_n,{className:"h-5 w-5"}),"Datenschutzerklärung"]}),a.jsxs(Jr,{to:"/impressum",className:"inline-flex items-center gap-2 px-6 py-3 border border-royal-gold text-royal-gold font-semibold rounded-lg hover:bg-royal-gold/10 transition-colors",children:[a.jsx(Sa,{className:"h-5 w-5"}),"Impressum"]})]})})]})})},iee=({cartItems:t,customerPhone:e="",customerName:r="",onLoyaltyApplied:n,onLoyaltyUpdated:s,showInOrderFlow:i=!0})=>{const[o,l]=M.useState(null),[c,u]=M.useState(!1),[d,h]=M.useState(e),[g,m]=M.useState(r),[w,_]=M.useState(!1),[T,v]=M.useState(0),[b,x]=M.useState(""),[P,F]=M.useState(!1),[$,k]=M.useState(!1),A=ks.countShishaItems(t),I=A>0,O=()=>Math.floor(1e5+Math.random()*9e5).toString(),S=()=>{navigator.clipboard.writeText(b)},R=()=>t.filter(Y=>Y.category.toLowerCase()==="shisha"||Y.category.toLowerCase()==="tobacco"),C=Y=>{const Q=R();let se=0,Se=Y;for(const U of Q){if(Se<=0)break;const J=Math.min(U.quantity,Se);se+=U.price*J,Se-=J}return se};M.useEffect(()=>{d&&d.trim()&&G(d.trim())},[d]);const G=async Y=>{u(!0);try{const Q=await ks.searchLoyaltyCardByPhone(Y);l(Q)}catch(Q){console.error("Error loading loyalty card:",Q)}finally{u(!1)}},de=async()=>{if(!(!d.trim()||!g.trim())){u(!0);try{const Y=await ks.getOrCreateLoyaltyCard(d.trim(),g.trim());l(Y),_(!1),s&&s(Y)}catch(Y){console.error("Error creating loyalty card:",Y)}finally{u(!1)}}},ne=async(Y=1)=>{if(!o||o.freeShishaEarned<Y)return;const Q=C(Y),se=O();v(Q),x(se),k(!0),n&&n(Q,o.id,se),F(!0),setTimeout(()=>F(!1),3e3)},X=()=>Math.min(A,5);return!i&&!I?null:a.jsxs("div",{className:"space-y-4",children:[o?a.jsxs("div",{className:"space-y-4",children:[a.jsx(EN,{loyaltyCard:o,showActions:!1}),I&&a.jsxs("div",{className:"bg-royal-gold/10 rounded-royal p-4 border border-royal-gold/30",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(zn,{className:"w-5 h-5 text-royal-gold"}),a.jsxs("span",{className:"font-medium text-gray-900",children:["Diese Bestellung enthält ",A," Shisha",A>1?"s":""]})]}),a.jsxs("p",{className:"text-sm text-gray-700 font-medium",children:["Sie erhalten ",X()," Stempel für diese Bestellung"]})]}),o.freeShishaEarned>0&&I&&T===0&&a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-green-50 rounded-royal p-4 border border-green-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Ki,{className:"w-5 h-5 text-green-600"}),a.jsxs("span",{className:"font-medium text-green-800",children:[o.freeShishaEarned," Gratis Shisha",o.freeShishaEarned>1?"s":""," verfügbar!"]})]}),a.jsxs("div",{className:"flex items-center space-x-1 bg-royal-purple text-white px-2 py-1 rounded-full text-xs",children:[a.jsx(Et,{className:"w-3 h-3"}),a.jsx("span",{children:"Loyalty"})]})]}),a.jsx("div",{className:"space-y-2",children:Array.from({length:Math.min(o.freeShishaEarned,A)},(Y,Q)=>a.jsx("button",{onClick:()=>ne(Q+1),className:"w-full text-left p-2 bg-green-100 hover:bg-green-200 rounded-royal transition-colors duration-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"text-green-800 font-medium",children:[Q+1," Gratis Shisha",Q>0?"s":""," einlösen"]}),a.jsxs("span",{className:"text-green-600 font-bold",children:["-",C(Q+1).toFixed(2),"€"]})]})},Q))})]}),T>0&&a.jsxs(oe.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-royal-purple/10 rounded-royal p-4 border border-royal-purple/30",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(xr,{className:"w-5 h-5 text-royal-purple"}),a.jsxs("span",{className:"font-medium text-royal-purple",children:["Gratis Shisha eingelöst! Rabatt: -",T.toFixed(2),"€"]})]}),a.jsxs("div",{className:"flex items-center space-x-1 bg-royal-purple text-white px-2 py-1 rounded-full text-xs",children:[a.jsx(Et,{className:"w-3 h-3"}),a.jsx("span",{children:"Loyalty"})]})]}),$&&a.jsxs("div",{className:"bg-royal-purple/5 rounded-royal p-3 border border-royal-purple/20",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(_n,{className:"w-4 h-4 text-royal-purple"}),a.jsx("span",{className:"text-sm font-medium text-royal-purple",children:"Bestätigungscode für Personal:"})]}),a.jsx("button",{onClick:S,className:"text-royal-purple hover:text-royal-purple-light",title:"Code kopieren",children:a.jsx(dY,{className:"w-4 h-4"})})]}),a.jsx("div",{className:"mt-2 text-center",children:a.jsx("span",{className:"text-2xl font-bold text-royal-purple bg-white px-4 py-2 rounded-royal border-2 border-royal-purple font-mono",children:b})}),a.jsx("p",{className:"text-xs text-gray-700 font-medium mt-2 text-center",children:"Zeigen Sie diesen Code dem Personal zur Bestätigung"})]})]})]}):a.jsxs("div",{className:"bg-royal-cream rounded-royal p-4 border border-royal-gold/30",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsx(Et,{className:"w-5 h-5 text-royal-gold"}),a.jsx("span",{className:"font-medium text-gray-900",children:"Royal Stempelpass"})]}),I&&a.jsx("div",{className:"mb-3 p-3 bg-royal-gold/10 rounded-royal",children:a.jsxs("p",{className:"text-sm text-gray-800 font-medium",children:[a.jsxs("strong",{children:["Diese Bestellung enthält ",A," Shisha",A>1?"s":"","!"]}),a.jsx("br",{}),"Erstellen Sie einen Stempelpass und sammeln Sie Punkte für gratis Shishas."]})}),w?a.jsxs("div",{className:"space-y-3",children:[a.jsx("input",{type:"tel",value:d,onChange:Y=>h(Y.target.value),placeholder:"Telefonnummer",className:"w-full px-3 py-2 border border-gray-300 rounded-royal bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-royal-purple focus:border-royal-purple transition-colors"}),a.jsx("input",{type:"text",value:g,onChange:Y=>m(Y.target.value),placeholder:"Ihr Name",className:"w-full px-3 py-2 border border-gray-300 rounded-royal bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-royal-purple focus:border-royal-purple transition-colors"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:de,disabled:c||!d.trim()||!g.trim(),className:"flex-1 bg-royal-gold text-royal-charcoal py-2 rounded-royal hover:bg-royal-gold/90 disabled:opacity-50",children:c?a.jsx(jn,{size:"sm"}):"Erstellen"}),a.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 border border-royal-gold text-royal-gold rounded-royal hover:bg-royal-gold/10",children:"Abbrechen"})]})]}):a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Hn,{className:"w-4 h-4 text-gray-600"}),a.jsx("input",{type:"tel",value:d,onChange:Y=>h(Y.target.value),placeholder:"Telefonnummer eingeben",className:"flex-1 px-3 py-2 border border-gray-300 rounded-royal bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-royal-purple focus:border-royal-purple transition-colors",onKeyPress:Y=>Y.key==="Enter"&&d.trim()&&G(d.trim())}),a.jsx("button",{onClick:()=>d.trim()&&G(d.trim()),disabled:c||!d.trim(),className:"px-4 py-2 bg-royal-gold text-royal-charcoal rounded-royal hover:bg-royal-gold/90 disabled:opacity-50",children:c?a.jsx(jn,{size:"sm"}):"Suchen"})]}),a.jsx("button",{onClick:()=>_(!0),className:"w-full text-center text-royal-purple hover:text-royal-purple/80 text-sm font-medium",children:"Neuen Stempelpass erstellen"})]})]}),a.jsx(po,{children:P&&a.jsx(oe.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"fixed top-20 left-1/2 transform -translate-x-1/2 z-50 bg-green-100 text-green-800 px-6 py-3 rounded-royal shadow-lg border border-green-300",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(xr,{className:"w-5 h-5"}),a.jsx("span",{className:"font-medium",children:"Gratis Shisha erfolgreich eingelöst!"})]})})})]})},aee=({isOpen:t,onClose:e})=>{const{state:r,removeItem:n,updateQuantity:s,clearCart:i,setTableNumber:o,setCustomerInfo:l,setSpecialInstructions:c,getTotalAmount:u}=Z5(),{user:d}=yn(),[h,g]=M.useState(!1),[m,w]=M.useState(!1),[_,T]=M.useState(null),[v,b]=M.useState(0),[x,P]=M.useState(null),[F,$]=M.useState(!1),[k,A]=M.useState(!1);M.useEffect(()=>{(async()=>{if(!(!d||!t||k)){$(!0),A(!0);try{const X=await Qr.getUserActiveReservation(d.id);if(X){const Y={reservation:X,customerInfo:{name:X.customerName||"",email:X.customerEmail||"",phone:X.customerPhone||""},preOrderItems:X.preOrderItems||[]};P(Y),o(X.tableNumber),l(X.customerName,X.customerPhone),_t.success(`Automatisch verbunden mit Ihrer Reservierung für Tisch ${X.tableNumber}!`)}}catch(X){console.error("Error checking user reservation:",X)}finally{$(!1)}}})()},[d,t,k,o,l]);const I=(ne,X)=>{X<=0?n(ne):s(ne,X)},O=(ne,X,Y)=>{const Q={amount:ne,loyaltyCardId:X,customerPhone:r.customerPhone,freeShishasRedeemed:1,verificationCode:Y,isVerified:!1,appliedAt:new Date};T(Q),b(ne)},S=()=>Math.max(0,u()-v),R=async ne=>{var X;if(!ne||ne<=0){P(null);return}$(!0);try{const Y=await $y.getTableContextForOrdering(ne);Y.hasActiveReservation&&Y.reservationInfo?(P(Y.reservationInfo),Y.suggestedCustomerInfo&&l(Y.suggestedCustomerInfo.name,Y.suggestedCustomerInfo.phone),_t.success(`Reservierung gefunden für ${(X=Y.suggestedCustomerInfo)==null?void 0:X.name}! Kundendaten wurden automatisch ausgefüllt.`)):P(null)}catch(Y){console.error("Error checking for reservation:",Y),P(null)}finally{$(!1)}},C=ne=>{o(ne),R(ne)},G=async()=>{if(!r.tableNumber){_t.error("Bitte geben Sie eine Tischnummer ein");return}if(r.items.length===0){_t.error("Ihr Warenkorb ist leer");return}g(!0);try{const ne={tableNumber:r.tableNumber,items:r.items,totalAmount:S(),status:"pending",orderType:x?"reservation":"walk-in",payment:{status:"unpaid",amount:S()}};r.customerName&&r.customerName.trim()&&(ne.customerName=r.customerName.trim()),r.customerPhone&&r.customerPhone.trim()&&(ne.customerPhone=r.customerPhone.trim()),x&&x.customerInfo.email&&x.customerInfo.email.trim()&&(ne.customerEmail=x.customerInfo.email.trim()),r.specialInstructions&&r.specialInstructions.trim()&&(ne.specialInstructions=r.specialInstructions.trim()),_&&(ne.loyaltyDiscount=_),await $y.createOrderWithReservation(ne,x==null?void 0:x.reservation.id);const X=x?`Bestellung erfolgreich für Reservierung von ${x.customerInfo.name} aufgegeben!`:"Bestellung erfolgreich aufgegeben!";_t.success(X),i(),w(!1),T(null),b(0),e()}catch(ne){console.error("Error submitting order:",ne),_t.error("Fehler beim Aufgeben der Bestellung. Bitte versuchen Sie es erneut.")}finally{g(!1)}},de=ne=>{ne.key==="Escape"&&e()};return a.jsx(po,{children:t&&a.jsxs(oe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4",onClick:e,children:[a.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),a.jsxs(oe.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"relative bg-white rounded-royal shadow-2xl w-full max-w-md max-h-[90vh] overflow-hidden",onClick:ne=>ne.stopPropagation(),onKeyDown:de,children:[a.jsxs("div",{className:"bg-royal-gradient-gold p-4 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(of,{className:"w-6 h-6 text-royal-charcoal"}),a.jsx("h2",{className:"text-xl font-royal font-bold text-royal-charcoal",children:"Warenkorb"})]}),a.jsx("button",{onClick:e,className:"p-2 hover:bg-royal-charcoal/20 rounded-full transition-colors",children:a.jsx(Zi,{className:"w-5 h-5 text-royal-charcoal"})})]}),a.jsx("div",{className:"p-4 space-y-4 max-h-[60vh] overflow-y-auto",children:r.items.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(of,{className:"w-16 h-16 mx-auto text-gray-500 mb-4"}),a.jsx("p",{className:"text-gray-700 font-medium mb-2",children:"Ihr Warenkorb ist leer"}),x&&a.jsxs(oe.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-royal-purple/10 border border-royal-purple/20 rounded-royal p-3 mt-4",children:[a.jsxs("div",{className:"flex items-center justify-center space-x-2 text-royal-purple",children:[a.jsx(Et,{className:"w-4 h-4"}),a.jsxs("span",{className:"text-sm font-medium",children:["Bereit für Tisch"," ",x.reservation.tableNumber]})]}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Fügen Sie Artikel aus dem Menü hinzu, um Ihre Bestellung zu starten"})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"space-y-3",children:r.items.map(ne=>a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-royal-charcoal/5 rounded-royal p-3 border border-royal-gold/20",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:ne.name}),(ne.category.toLowerCase()==="shisha"||ne.category.toLowerCase()==="tobacco")&&a.jsxs("div",{className:"flex items-center space-x-1 bg-royal-purple text-white px-2 py-1 rounded-full text-xs",children:[a.jsx(Et,{className:"w-3 h-3"}),a.jsx("span",{children:"Loyalty"})]})]}),a.jsx("p",{className:"text-sm text-gray-700 font-medium",children:ne.category}),ne.specialInstructions&&a.jsxs("p",{className:"text-xs text-royal-gold mt-1",children:["Anweisung: ",ne.specialInstructions]})]}),a.jsx("button",{onClick:()=>n(ne.id),className:"p-1 hover:bg-red-100 rounded-full transition-colors ml-2",children:a.jsx(Qs,{className:"w-4 h-4 text-red-500"})})]}),a.jsxs("div",{className:"flex items-center justify-between mt-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>I(ne.id,ne.quantity-1),className:"w-6 h-6 rounded-full bg-royal-gold/20 text-royal-gold hover:bg-royal-gold/30 flex items-center justify-center",children:a.jsx(lP,{className:"w-3 h-3"})}),a.jsx("span",{className:"font-semibold text-gray-900 w-8 text-center",children:ne.quantity}),a.jsx("button",{onClick:()=>I(ne.id,ne.quantity+1),className:"w-6 h-6 rounded-full bg-royal-gold/20 text-royal-gold hover:bg-royal-gold/30 flex items-center justify-center",children:a.jsx(Ai,{className:"w-3 h-3"})})]}),a.jsxs("span",{className:"font-bold text-royal-gold",children:[(ne.price*ne.quantity).toFixed(2),"€"]})]})]},ne.id))}),a.jsxs("div",{className:"border-t border-royal-gold/20 pt-4",children:[a.jsx(iee,{cartItems:r.items,customerPhone:r.customerPhone,customerName:r.customerName,onLoyaltyApplied:O,showInOrderFlow:m}),a.jsxs("div",{className:"space-y-2 mt-4",children:[a.jsxs("div",{className:"flex justify-between items-center text-gray-800 font-medium",children:[a.jsx("span",{children:"Zwischensumme:"}),a.jsxs("span",{children:[u().toFixed(2),"€"]})]}),v>0&&a.jsxs("div",{className:"flex justify-between items-center text-royal-purple font-medium",children:[a.jsx("span",{children:"Loyalty Rabatt:"}),a.jsxs("span",{children:["-",v.toFixed(2),"€"]})]}),a.jsxs("div",{className:"flex justify-between items-center text-lg font-bold text-gray-900 border-t border-royal-gold/20 pt-2",children:[a.jsx("span",{children:"Gesamt:"}),a.jsxs("span",{className:"text-royal-gold",children:[S().toFixed(2),"€"]})]})]})]}),m?a.jsx(oe.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"space-y-4 border-t border-royal-gold/20 pt-4",children:x?a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Bestellung für Ihre Reservierung"}),a.jsx(oe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-royal-purple/10 border border-royal-purple/20 rounded-royal p-4",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(Et,{className:"w-5 h-5 text-royal-purple mt-0.5 flex-shrink-0"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"text-base font-semibold text-royal-purple",children:x.customerInfo.name}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 text-sm text-gray-600",children:[a.jsxs("div",{children:["📅"," ",new Date(x.reservation.date).toLocaleDateString("de-DE")]}),a.jsxs("div",{children:["🕐"," ",x.reservation.startTime," -"," ",x.reservation.endTime]}),a.jsxs("div",{children:["👥"," ",x.reservation.partySize," ","Personen"]}),a.jsxs("div",{children:["🪑 Tisch"," ",x.reservation.tableNumber]})]})]})]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-gray-800",children:"Besondere Wünsche (optional)"}),a.jsx("textarea",{value:r.specialInstructions,onChange:ne=>c(ne.target.value),className:"w-full p-3 border border-gray-300 rounded-royal bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-royal-purple focus:border-royal-purple transition-colors resize-none",rows:3,placeholder:"Zusätzliche Anweisungen für Ihre Bestellung..."}),a.jsx("p",{className:"text-xs text-gray-500",children:'z.B. "Extra scharf", "Ohne Zwiebeln", "Getränke zuerst servieren"'})]})]}):a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Bestelldetails"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center space-x-2 text-sm font-medium text-gray-800",children:[a.jsx(sP,{className:"w-4 h-4"}),a.jsx("span",{children:"Tischnummer *"}),F&&a.jsx("div",{className:"w-4 h-4 border-2 border-royal-gold border-t-transparent rounded-full animate-spin"})]}),a.jsx("input",{type:"number",min:"1",max:"50",value:r.tableNumber||"",onChange:ne=>C(parseInt(ne.target.value)||0),className:"w-full p-3 border border-gray-300 rounded-royal bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-royal-purple focus:border-royal-purple transition-colors",placeholder:"z.B. 5",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center space-x-2 text-sm font-medium text-gray-800",children:[a.jsx(Aa,{className:"w-4 h-4"}),a.jsx("span",{children:"Name (optional)"})]}),a.jsx("input",{type:"text",value:r.customerName,onChange:ne=>l(ne.target.value,r.customerPhone),className:"w-full p-3 border border-gray-300 rounded-royal bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-royal-purple focus:border-royal-purple transition-colors",placeholder:"Ihr Name"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center space-x-2 text-sm font-medium text-gray-800",children:[a.jsx(Hn,{className:"w-4 h-4"}),a.jsx("span",{children:"Telefon (optional)"})]}),a.jsx("input",{type:"tel",value:r.customerPhone,onChange:ne=>l(r.customerName,ne.target.value),className:"w-full p-3 border border-gray-300 rounded-royal bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-royal-purple focus:border-royal-purple transition-colors",placeholder:"+49 15781413767"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-gray-800",children:"Spezielle Anweisungen (optional)"}),a.jsx("textarea",{value:r.specialInstructions,onChange:ne=>c(ne.target.value),className:"w-full p-3 border border-gray-300 rounded-royal bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-royal-purple focus:border-royal-purple transition-colors resize-none",rows:3,placeholder:"Zusätzliche Anweisungen für Ihre Bestellung..."})]})]})}):a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:()=>w(!0),className:"flex-1 bg-royal-gradient-gold text-royal-charcoal font-royal font-bold py-3 px-6 rounded-royal royal-glow hover:shadow-lg transition-all duration-300",children:"Bestellen"}),a.jsx("button",{onClick:()=>{i(),P(null),A(!1)},className:"px-4 py-3 border border-red-500 text-red-500 hover:bg-red-500 hover:text-white rounded-royal transition-all duration-300",children:a.jsx(Qs,{className:"w-5 h-5"})})]}),m&&a.jsx(oe.button,{initial:{opacity:0},animate:{opacity:1},onClick:G,disabled:h||!r.tableNumber,className:"w-full bg-royal-gradient-gold text-royal-charcoal font-royal font-bold py-4 px-6 rounded-royal royal-glow hover:shadow-lg transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Bestellung wird aufgegeben...":"Bestellung aufgeben"})]})})]})]})})},oee=()=>{const{user:t,logout:e}=yn(),{getTotalItems:r}=Z5(),n=Ap(),{isAuthenticated:s,userRole:i,canAccessAdmin:o,getSessionInfo:l}=jP(),[c,u]=M.useState(!1),[d,h]=M.useState(!1),[g,m]=M.useState(!1),w=M.useRef(null);M.useEffect(()=>{s&&console.log("🍪 Header session info:",l())},[s,l]);const _=async()=>{try{e(),_t.success("Successfully logged out!"),h(!1),n("/")}catch{_t.error("Logout failed. Please try again.")}},T=()=>{m(!0),u(!1)},v=[{name:"Startseite",path:"/"},{name:"Menü",path:"/menu"},{name:"Reservierungen",path:"/reservations"},{name:"Stempelpass",path:"/loyalty"},{name:"Events",path:"/events"},{name:"Kontakt",path:"/contact"}];return M.useEffect(()=>{const b=x=>{w.current&&!w.current.contains(x.target)&&h(!1)};return document.addEventListener("mousedown",b),()=>{document.removeEventListener("mousedown",b)}},[]),a.jsxs(a.Fragment,{children:[a.jsx(oe.header,{className:"fixed top-0 left-0 right-0 z-50 transition-all duration-300 bg-royal-charcoal-dark shadow-lg",initial:{y:-100},animate:{y:0},transition:{duration:.5},children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"flex items-center justify-between h-20",children:[a.jsx(Jr,{to:"/",className:"flex-shrink-0",children:a.jsx("img",{className:"h-10 w-10 md:h-16 md:w-16 rounded-full border border-royal-gold object-cover",src:SN,alt:"Royal Shisha Logo"})}),a.jsx("nav",{className:"hidden md:flex space-x-8",children:v.map(b=>a.jsx(vO,{to:b.path,className:({isActive:x})=>`royal-nav-link text-lg font-medium transition-all duration-300 hover:text-royal-gold ${x?"text-royal-gold":"text-royal-cream"}`,children:b.name},b.name))}),a.jsxs("div",{className:"hidden md:flex items-center space-x-4",children:[a.jsxs(oe.button,{onClick:T,className:"relative bg-royal-gradient-gold text-royal-charcoal p-3 rounded-lg royal-glow hover:shadow-lg transition-all duration-300",whileHover:{scale:1.05},whileTap:{scale:.95},children:[a.jsx(of,{className:"w-5 h-5"}),r()>0&&a.jsx(oe.div,{initial:{scale:0},animate:{scale:1},className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center",children:r()>99?"99+":r()})]}),s?a.jsxs("div",{className:"relative",ref:w,children:[a.jsxs(oe.button,{onClick:()=>h(!d),className:"flex items-center space-x-2 bg-royal-gradient-gold text-royal-charcoal px-4 py-2 rounded-lg hover:shadow-lg transition-all duration-200 royal-hover-glow",whileHover:{scale:1.02},whileTap:{scale:.98},children:[a.jsx(Et,{className:"w-4 h-4"}),a.jsx("span",{className:"font-medium",children:(t==null?void 0:t.name)||"Royal Member"}),a.jsx(rP,{className:`w-4 h-4 transition-transform duration-200 ${d?"rotate-180":""}`})]}),a.jsx(po,{children:d&&a.jsx(oe.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},className:"absolute right-0 mt-2 w-64 bg-royal-charcoal-dark border border-royal-gold/30 rounded-lg shadow-xl royal-glow",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-4 pb-4 border-b border-royal-gold/20",children:[a.jsx("div",{className:"w-10 h-10 bg-royal-gradient-gold rounded-full flex items-center justify-center",children:a.jsx(Aa,{className:"w-5 h-5 text-royal-charcoal"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-royal-cream font-medium",children:t==null?void 0:t.name}),a.jsx("p",{className:"text-royal-cream-light text-sm",children:t==null?void 0:t.email})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center space-x-2 text-royal-cream-light text-sm",children:[a.jsx(Et,{className:"w-4 h-4 text-royal-gold"}),a.jsxs("span",{children:["Role: ",i||"Loading..."]})]}),o()&&a.jsxs(Jr,{to:"/admin",onClick:()=>h(!1),className:"w-full flex items-center space-x-2 px-3 py-2 text-royal-cream hover:text-royal-gold hover:bg-royal-charcoal rounded-md transition-all duration-200",children:[a.jsx(_n,{className:"w-4 h-4"}),a.jsx("span",{children:"Admin-Bereich"})]}),a.jsxs(oe.button,{onClick:_,className:"w-full flex items-center space-x-2 px-3 py-2 text-royal-cream hover:text-royal-gold hover:bg-royal-charcoal rounded-md transition-all duration-200",whileHover:{scale:1.02},whileTap:{scale:.98},children:[a.jsx(y3,{className:"w-4 h-4"}),a.jsx("span",{children:"Abmelden"})]})]})]})})})]}):a.jsx(oe.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:a.jsx(Jr,{to:"/auth",className:"bg-royal-gradient-gold text-royal-charcoal px-6 py-2 rounded-lg font-semibold royal-glow hover:shadow-lg transition-all duration-300",children:"Anmelden"})})]}),a.jsx("div",{className:"md:hidden",children:a.jsx(oe.button,{onClick:()=>u(!c),className:"text-royal-cream hover:text-royal-gold p-2",whileTap:{scale:.9},children:c?a.jsx(Zi,{className:"w-6 h-6"}):a.jsx(xY,{className:"w-6 h-6"})})})]}),a.jsx(po,{children:c&&a.jsx(oe.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"md:hidden border-t border-royal-gold/20",children:a.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1",children:[v.map(b=>a.jsx(Jr,{to:b.path,onClick:()=>u(!1),className:"block px-3 py-2 text-royal-cream hover:text-royal-gold hover:bg-royal-charcoal rounded-md transition-all duration-200",children:b.name},b.name)),a.jsxs(oe.button,{onClick:T,className:"w-full flex items-center space-x-3 px-3 py-2 text-royal-cream hover:text-royal-gold hover:bg-royal-charcoal rounded-md transition-all duration-200",whileHover:{scale:1.02},whileTap:{scale:.98},children:[a.jsx(of,{className:"w-5 h-5"}),a.jsx("span",{children:"Warenkorb"}),r()>0&&a.jsx("span",{className:"bg-royal-gold text-royal-charcoal rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold",children:r()})]}),s?a.jsxs("div",{className:"mt-6 pt-6 border-t border-royal-gold/20 space-y-3",children:[a.jsx("div",{className:"px-4 py-3 text-royal-cream-light text-sm royal-glass rounded-lg",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-royal-gradient-gold rounded-full flex items-center justify-center",children:a.jsx(Et,{className:"w-4 h-4 text-royal-charcoal"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-royal-cream",children:t==null?void 0:t.name}),a.jsx("p",{className:"text-xs",children:t==null?void 0:t.email}),a.jsxs("p",{className:"text-xs",children:["Role: ",i]})]})]})}),o()&&a.jsxs(Jr,{to:"/admin",onClick:()=>u(!1),className:"w-full flex items-center space-x-3 px-4 py-3 text-royal-cream hover:text-royal-gold hover:bg-royal-charcoal rounded-lg transition-all duration-200",children:[a.jsx(_n,{className:"w-4 h-4"}),a.jsx("span",{children:"Admin-Bereich"})]}),a.jsxs(oe.button,{onClick:()=>{_(),u(!1)},className:"w-full flex items-center space-x-3 px-4 py-3 text-royal-cream hover:text-royal-gold hover:bg-royal-charcoal rounded-lg transition-all duration-200",whileHover:{scale:1.02},whileTap:{scale:.98},children:[a.jsx(y3,{className:"w-4 h-4"}),a.jsx("span",{children:"Abmelden"})]})]}):a.jsx(Jr,{to:"/auth",onClick:()=>u(!1),className:"block mx-3 mt-6 px-4 py-3 bg-royal-gradient-gold text-royal-charcoal text-center rounded-lg font-medium hover:shadow-lg transition-all duration-200",children:"Anmelden"})]})})})]})}),a.jsx(aee,{isOpen:g,onClose:()=>m(!1)})]})},lee=()=>{const t=[{name:"Startseite",path:"/"},{name:"Menü",path:"/menu"},{name:"Events",path:"/events"},{name:"Kontakt",path:"/contact"}],e=[{icon:iP,href:"https://www.instagram.com/royal.waldkraiburg/",label:"Instagram"}];return a.jsxs("footer",{className:"bg-royal-charcoal-dark text-royal-cream-light royal-gradient-top-border relative overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 z-0",children:[a.jsx(oe.div,{animate:{scale:[1,1.1,1],opacity:[.1,.2,.1]},transition:{duration:8,repeat:1/0,ease:"easeInOut"},className:"absolute top-10 left-10 w-20 h-20 bg-royal-gold/10 rounded-full blur-xl"}),a.jsx(oe.div,{animate:{scale:[1.1,1,1.1],opacity:[.1,.2,.1]},transition:{duration:10,repeat:1/0,ease:"easeInOut",delay:2},className:"absolute bottom-10 right-10 w-24 h-24 bg-royal-purple/10 rounded-full blur-xl"})]}),a.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[a.jsxs(oe.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},className:"space-y-4",children:[a.jsxs(Jr,{to:"/",className:"flex items-center space-x-3 group",children:[a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:SN,alt:"Royal Shisha Logo",className:"h-12 w-12 rounded-full border-2 border-royal-gold group-hover:border-royal-gold-light transition-colors duration-300"}),a.jsx(oe.div,{animate:{scale:[1,1.1,1],opacity:[.5,1,.5]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},className:"absolute inset-0 rounded-full border-2 border-royal-gold/30 royal-glow"})]}),a.jsx("span",{className:"text-2xl font-royal text-white group-hover:text-royal-gold transition-colors duration-300",children:"Royal Shisha"})]}),a.jsx("p",{className:"text-sm leading-relaxed",children:"Erleben Sie die ultimative königliche Hookah-Lounge in Deutschland mit Premium-Qualität und exklusivem Service."}),a.jsxs("div",{className:"flex items-center space-x-2 text-royal-gold",children:[a.jsx(Et,{className:"w-4 h-4"}),a.jsx("span",{className:"text-xs font-medium",children:"Premium Experience"})]})]}),a.jsxs(oe.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.1},viewport:{once:!0},children:[a.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[a.jsx(Et,{className:"w-4 h-4 mr-2 text-royal-gold"}),"Navigation"]}),a.jsx("ul",{className:"space-y-2",children:t.map((r,n)=>a.jsx(oe.li,{initial:{opacity:0,x:-10},whileInView:{opacity:1,x:0},transition:{duration:.3,delay:n*.1},viewport:{once:!0},children:a.jsxs(Jr,{to:r.path,className:"hover:text-royal-gold transition-all duration-200 flex items-center group",children:[a.jsx("span",{className:"w-0 group-hover:w-2 h-0.5 bg-royal-gold transition-all duration-300 mr-2"}),r.name]})},r.name))})]}),a.jsxs(oe.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.2},viewport:{once:!0},children:[a.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[a.jsx(Si,{className:"w-4 h-4 mr-2 text-royal-gold"}),"Kontakt"]}),a.jsxs("address",{className:"not-italic space-y-3 text-sm",children:[a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx(Si,{className:"w-4 h-4 text-royal-gold mt-0.5 flex-shrink-0"}),a.jsx("p",{children:"Stadtpl. 2, 84478 Waldkraiburg"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ji,{className:"w-4 h-4 text-royal-gold flex-shrink-0"}),a.jsx("a",{href:"mailto:Royal.Waldkraiburg@gmail.com",className:"text-royal-cream-light hover:text-royal-gold transition-colors",children:"Royal.Waldkraiburg@gmail.com"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Hn,{className:"w-4 h-4 text-royal-gold flex-shrink-0"}),a.jsx("a",{href:"tel:+4915781413767",className:"text-royal-cream-light hover:text-royal-gold transition-colors",children:"+49 15781413767"})]})]})]}),a.jsxs(oe.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.3},viewport:{once:!0},children:[a.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[a.jsx(Et,{className:"w-4 h-4 mr-2 text-royal-gold"}),"Folgen Sie uns"]}),a.jsx("div",{className:"flex space-x-4",children:e.map((r,n)=>a.jsx(oe.a,{href:r.href,target:"_blank",rel:"noopener noreferrer",initial:{opacity:0,scale:.8},whileInView:{opacity:1,scale:1},transition:{duration:.3,delay:n*.1},viewport:{once:!0},whileHover:{scale:1.1,y:-2},className:"text-royal-cream-light hover:text-royal-gold transition-all duration-200 p-2 rounded-lg hover:bg-royal-charcoal royal-hover-glow","aria-label":r.label,children:a.jsx(r.icon,{size:24})},n))}),a.jsx("div",{className:"mt-4 p-3 bg-royal-charcoal/50 rounded-lg border border-royal-gold/20",children:a.jsx("p",{className:"text-xs text-royal-cream-light/80",children:"Erhalten Sie exklusive Angebote und Event-Updates"})})]})]}),a.jsxs(oe.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.4},viewport:{once:!0},className:"mt-8 pt-8 border-t border-royal-gold/20 text-center text-sm",children:[a.jsxs("p",{className:"text-royal-cream-light/80",children:["© ",new Date().getFullYear()," Royal Shisha. Alle Rechte vorbehalten."]}),a.jsxs("div",{className:"mt-2 flex justify-center space-x-4 text-xs text-royal-cream-light/60",children:[a.jsx(Jr,{to:"/privacy-policy",className:"hover:text-royal-gold transition-colors duration-200",children:"Datenschutz"}),a.jsx(Jr,{to:"/impressum",className:"hover:text-royal-gold transition-colors duration-200",children:"Impressum"}),a.jsx(Jr,{to:"/agb",className:"hover:text-royal-gold transition-colors duration-200",children:"AGB"})]})]})]})]})},Uv=({children:t,requireAuth:e=!0,requireRole:r,redirectTo:n="/auth"})=>{const{user:s,isAuthenticated:i}=yn(),o=fd();return e&&!i?a.jsx(G1,{to:n,state:{from:o},replace:!0}):r&&(s==null?void 0:s.role)!==r?a.jsx(G1,{to:"/",replace:!0}):i&&o.pathname==="/auth"?a.jsx(G1,{to:"/",replace:!0}):a.jsx(a.Fragment,{children:t})},cee=()=>{const[t,e]=M.useState(null),[r,n]=M.useState(!1);if(M.useEffect(()=>{},[]),!r||!t)return null;const s=i=>i<1e3?"text-green-600":i<3e3?"text-yellow-600":"text-red-600";return a.jsxs("div",{className:"fixed bottom-4 right-4 bg-black bg-opacity-75 text-white p-4 rounded-lg text-xs z-50",children:[a.jsx("div",{className:"font-bold mb-2",children:"Performance Monitor (Dev)"}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{children:["Load Time:"," ",a.jsxs("span",{className:s(t.loadTime),children:[t.loadTime.toFixed(0),"ms"]})]}),a.jsxs("div",{children:["DOM Ready:"," ",a.jsxs("span",{className:s(t.domContentLoaded),children:[t.domContentLoaded.toFixed(0),"ms"]})]}),a.jsxs("div",{children:["First Paint:"," ",a.jsxs("span",{className:s(t.firstPaint),children:[t.firstPaint.toFixed(0),"ms"]})]}),a.jsxs("div",{children:["FCP:"," ",a.jsxs("span",{className:s(t.firstContentfulPaint),children:[t.firstContentfulPaint.toFixed(0),"ms"]})]})]}),a.jsx("button",{onClick:()=>n(!1),className:"mt-2 text-gray-400 hover:text-white",children:"Hide"})]})},uee=[{number:1,seats:2,location:"Innenbereich",isActive:!0},{number:2,seats:4,location:"Innenbereich",isActive:!0},{number:3,seats:4,location:"Innenbereich",isActive:!0},{number:4,seats:6,location:"Innenbereich",isActive:!0},{number:5,seats:2,location:"Innenbereich",isActive:!0},{number:6,seats:4,location:"Innenbereich",isActive:!0},{number:7,seats:8,location:"Innenbereich",isActive:!0},{number:8,seats:4,location:"Innenbereich",isActive:!0},{number:9,seats:6,location:"Innenbereich",isActive:!0},{number:10,seats:2,location:"Innenbereich",isActive:!0},{number:11,seats:4,location:"Außenbereich",isActive:!0},{number:12,seats:6,location:"Außenbereich",isActive:!0},{number:13,seats:4,location:"Außenbereich",isActive:!0},{number:14,seats:8,location:"Außenbereich",isActive:!0},{number:15,seats:2,location:"Außenbereich",isActive:!0}],dee=[{slot:"17:00-19:00",displayName:"17:00 - 19:00",isActive:!0,maxDuration:120},{slot:"17:30-19:30",displayName:"17:30 - 19:30",isActive:!0,maxDuration:120},{slot:"18:00-20:00",displayName:"18:00 - 20:00",isActive:!0,maxDuration:120},{slot:"18:30-20:30",displayName:"18:30 - 20:30",isActive:!0,maxDuration:120},{slot:"19:00-21:00",displayName:"19:00 - 21:00",isActive:!0,maxDuration:120},{slot:"19:30-21:30",displayName:"19:30 - 21:30",isActive:!0,maxDuration:120},{slot:"20:00-22:00",displayName:"20:00 - 22:00",isActive:!0,maxDuration:120},{slot:"20:30-22:30",displayName:"20:30 - 22:30",isActive:!0,maxDuration:120},{slot:"21:00-23:00",displayName:"21:00 - 23:00",isActive:!0,maxDuration:120},{slot:"21:30-23:30",displayName:"21:30 - 23:30",isActive:!0,maxDuration:120},{slot:"22:00-00:00",displayName:"22:00 - 00:00",isActive:!0,maxDuration:120},{slot:"22:30-00:30",displayName:"22:30 - 00:30",isActive:!0,maxDuration:120},{slot:"23:00-01:00",displayName:"23:00 - 01:00",isActive:!0,maxDuration:120},{slot:"23:30-01:30",displayName:"23:30 - 01:30",isActive:!0,maxDuration:120},{slot:"00:00-02:00",displayName:"00:00 - 02:00",isActive:!0,maxDuration:120},{slot:"00:30-02:30",displayName:"00:30 - 02:30",isActive:!0,maxDuration:120},{slot:"01:00-03:00",displayName:"01:00 - 03:00",isActive:!0,maxDuration:120}],iR=async()=>{try{const t=Ce(),e=Be(t,"tables");if((await st(e)).size>0){_t.success("Tables already exist");return}const n=uee.map(s=>xo(e,{...s,createdAt:ft(),updatedAt:ft()}));await Promise.all(n),console.log("Sample tables initialized")}catch(t){throw console.error("Error initializing sample tables:",t),t}},aR=async()=>{try{const t=Ce(),e=Be(t,"timeSlots");if((await st(e)).size>0){_t.success("Time slots already exist");return}const n=dee.map(s=>xo(e,{...s,createdAt:ft(),updatedAt:ft()}));await Promise.all(n),console.log("Sample time slots initialized")}catch(t){throw console.error("Error initializing sample time slots:",t),t}},hee=async()=>{try{const t=Ce();(await st(Be(t,"tables"))).empty&&await iR(),(await st(Be(t,"timeSlots"))).empty&&await aR()}catch(t){console.error("Error auto-initializing reservation data:",t)}},fee=()=>{const{user:t}=yn(),[e,r]=M.useState(!1),[n,s]=M.useState(!1);if(!t||t.role!=="admin")return null;const i=async()=>{try{s(!0),await iR(),_t.success("Tables initialized successfully!")}catch(l){console.error("Tables initialization failed:",l),_t.error("Tables initialization failed")}finally{s(!1)}},o=async()=>{try{s(!0),await aR(),_t.success("Time slots initialized successfully!")}catch(l){console.error("Time slots initialization failed:",l),_t.error("Time slots initialization failed")}finally{s(!1)}};return a.jsx("div",{className:"fixed bottom-4 left-4 z-50",children:a.jsxs(oe.div,{initial:{scale:0},animate:{scale:1},className:"relative",children:[a.jsx(oe.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>r(!e),className:"w-14 h-14 bg-royal-gradient-gold rounded-full flex items-center justify-center text-royal-charcoal royal-glow shadow-lg",children:a.jsx(Yc,{className:"w-6 h-6"})}),e&&a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"absolute bottom-16 left-0 bg-royal-charcoal-dark rounded-lg p-4 shadow-xl border border-royal-gold/30 w-64",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[a.jsx(Et,{className:"w-5 h-5 text-royal-gold"}),a.jsx("span",{className:"text-royal-cream font-semibold",children:"Admin Setup"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("button",{onClick:i,disabled:n,className:"w-full flex items-center space-x-2 px-3 py-2 bg-royal-charcoal hover:bg-royal-charcoal-light rounded-lg text-royal-cream transition-colors disabled:opacity-50",children:[a.jsx(Un,{className:"w-4 h-4"}),a.jsx("span",{children:"Initialize Tables"})]}),a.jsxs("button",{onClick:o,disabled:n,className:"w-full flex items-center space-x-2 px-3 py-2 bg-royal-charcoal hover:bg-royal-charcoal-light rounded-lg text-royal-cream transition-colors disabled:opacity-50",children:[a.jsx(Un,{className:"w-4 h-4"}),a.jsx("span",{children:"Initialize Time Slots"})]})]})]})]})})},mee=({duration:t=8e3,showEventNotifications:e=!0})=>{const[r,n]=M.useState(!1),[s,i]=M.useState(null),[o,l]=M.useState(0),[c,u]=M.useState([]),[d,h]=M.useState(!1);M.useEffect(()=>(console.log("LivePopup: showEventNotifications =",e),e?(console.log("LivePopup: Setting up popup listener"),Xa.onActivePopupsChange(x=>{console.log("LivePopup: Received popups:",x.length,x),u(x),x.length>0&&!r&&!d?(console.log("LivePopup: Showing first popup"),i(x[0]),l(0),n(!0)):x.length===0&&r&&(console.log("LivePopup: No active popups, hiding popup"),n(!1),i(null))})):void 0),[t,e,r,d]),M.useEffect(()=>{if(c.length>0&&r){const b=setTimeout(()=>{const x=(o+1)%c.length;l(x),i(c[x])},t);return()=>clearTimeout(b)}},[c,o,r,t]);const g=()=>{console.log("LivePopup: Close button clicked"),console.log("LivePopup: Closing popup"),n(!1),h(!0)},m=b=>{b.preventDefault(),b.stopPropagation(),console.log("LivePopup: Close button clicked with event"),g()};M.useEffect(()=>{const b=x=>{x.key==="Escape"&&r&&(console.log("LivePopup: Escape key pressed, closing popup"),g())};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[r]);const w=()=>{if(c.length>1){const b=(o+1)%c.length;l(b),i(c[b])}},_=()=>{if(c.length>1){const b=o===0?c.length-1:o-1;l(b),i(c[b])}},T=b=>{var A,I;const x=b.eventData;if(!x)return null;let P;x.date?typeof x.date=="object"&&"toDate"in x.date?P=x.date.toDate():x.date instanceof Date?P=x.date:P=((I=(A=x.date)==null?void 0:A.toDate)==null?void 0:I.call(A))||new Date(x.date):P=new Date,isNaN(P.getTime())&&(console.warn("Invalid event date:",x.date),P=new Date);const F=new Date,$=P.getTime()-F.getTime(),k=Math.ceil($/(1e3*60*60*24));return a.jsx("div",{className:"w-full",children:a.jsxs("div",{className:"flex items-start gap-3",children:[x.imageUrl&&a.jsx("img",{src:x.imageUrl,alt:x.title,className:"w-16 h-16 rounded-lg object-cover flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-bold text-royal-charcoal text-lg leading-tight mb-1",children:b.title}),a.jsx("p",{className:"text-royal-charcoal/80 text-sm mb-2",children:b.message}),a.jsxs("div",{className:"space-y-1 text-xs text-royal-charcoal/70",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Un,{className:"w-3 h-3"}),a.jsx("span",{children:Lr(P,"MMM dd, yyyy")})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Rr,{className:"w-3 h-3"}),a.jsx("span",{children:x.time})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Si,{className:"w-3 h-3"}),a.jsx("span",{className:"truncate",children:x.location})]}),x.category&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(zn,{className:"w-3 h-3"}),a.jsx("span",{children:x.category})]})]}),k<=1&&a.jsx("div",{className:"mt-2",children:a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:k===0?"TONIGHT!":"TOMORROW!"})})]})]})})},v=b=>a.jsx("div",{className:"w-full",children:a.jsx("div",{className:"flex items-start gap-3",children:a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-bold text-royal-charcoal text-lg leading-tight mb-1",children:b.title}),a.jsx("p",{className:"text-royal-charcoal/80 text-sm mb-2",children:b.message}),a.jsx("div",{className:"mt-2",children:a.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${b.type==="promotion"?"bg-green-100 text-green-800":b.type==="alert"?"bg-red-100 text-red-800":b.type==="event"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:b.type==="promotion"?"🏷️ Promotion":b.type==="alert"?"📢 Announcement":b.type==="event"?"📅 Event":"ℹ️ Info"})})]})})});return console.log("LivePopup: Rendering, isVisible =",r,"currentPopup =",s),a.jsx(po,{children:r&&s&&a.jsx(oe.div,{initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:50,scale:.9},transition:{duration:.4,ease:"easeOut"},className:"fixed top-20 right-4 md:bottom-1/3 md:left-1/2 md:transform md:-translate-x-1/2 md:right-auto md:top-auto z-40 max-w-sm md:max-w-md",children:a.jsxs("div",{className:"bg-royal-gradient-gold text-royal-charcoal px-4 py-3 md:px-6 md:py-4 rounded-royal shadow-lg royal-glow border border-royal-gold/30 backdrop-blur-sm w-full",onClick:b=>{b.target===b.currentTarget&&g()},children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-1",children:s&&(s.type==="event"&&s.eventData?T(s):v(s))}),c.length>1&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:_,className:"p-1 hover:bg-royal-charcoal/20 rounded-full transition-colors",title:"Previous notification",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),a.jsxs("span",{className:"text-xs text-royal-charcoal/60 px-1",children:[o+1,"/",c.length]}),a.jsx("button",{onClick:w,className:"p-1 hover:bg-royal-charcoal/20 rounded-full transition-colors",title:"Next notification",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),a.jsx("button",{onClick:m,className:"p-2 hover:bg-royal-charcoal/20 rounded-full transition-colors flex-shrink-0 cursor-pointer z-10 relative",title:"Close notification","aria-label":"Close notification",children:a.jsx(Zi,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"mt-3 w-full bg-royal-charcoal/20 rounded-full h-1",children:a.jsx(oe.div,{className:"bg-royal-charcoal h-1 rounded-full",initial:{width:"100%"},animate:{width:"0%"},transition:{duration:t/1e3,ease:"linear"}})})]})})})},pee=()=>{const[t,e]=M.useState(navigator.onLine);return M.useEffect(()=>{const r=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",r),window.addEventListener("offline",n),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}},[]),t?null:a.jsxs("div",{className:"fixed top-20 left-1/2 transform -translate-x-1/2 z-50 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg flex items-center space-x-2",children:[a.jsx(DY,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:"Offline Mode"})]})};class cA extends M.Component{constructor(r){super(r);Dr(this,"handleReset",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});Dr(this,"handleReload",()=>{window.location.reload()});this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){console.error("ErrorBoundary caught an error:",r,n),this.setState({error:r,errorInfo:n})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:a.jsx("div",{className:"min-h-screen bg-royal-gradient-cream flex items-center justify-center p-4",children:a.jsx(oe.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"max-w-md w-full bg-white rounded-royal p-8 shadow-xl border border-royal-gold/30",children:a.jsxs("div",{className:"text-center",children:[a.jsx(oe.div,{initial:{rotate:0},animate:{rotate:[0,-10,10,0]},transition:{duration:.5,repeat:2},className:"w-16 h-16 mx-auto mb-6 bg-red-100 rounded-full flex items-center justify-center",children:a.jsx(ml,{className:"w-8 h-8 text-red-600"})}),a.jsx("h1",{className:"text-2xl font-royal font-bold text-royal-charcoal mb-4",children:"Etwas ist schiefgelaufen"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Es ist ein unerwarteter Fehler aufgetreten. Wir entschuldigen uns für die Unannehmlichkeiten."}),!1,a.jsxs("div",{className:"space-y-3",children:[a.jsxs("button",{onClick:this.handleReset,className:"w-full bg-royal-gradient-gold text-royal-charcoal font-semibold py-3 px-6 rounded-royal hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",children:[a.jsx(Nr,{className:"w-4 h-4"}),a.jsx("span",{children:"Erneut versuchen"})]}),a.jsxs("button",{onClick:this.handleReload,className:"w-full bg-royal-charcoal text-white font-semibold py-3 px-6 rounded-royal hover:bg-royal-charcoal-dark transition-all duration-300 flex items-center justify-center space-x-2",children:[a.jsx(Nr,{className:"w-4 h-4"}),a.jsx("span",{children:"Seite neu laden"})]}),a.jsxs("button",{onClick:()=>window.location.href="/",className:"w-full text-royal-purple hover:text-royal-purple-dark font-medium py-2 transition-colors flex items-center justify-center space-x-2",children:[a.jsx(Ab,{className:"w-4 h-4"}),a.jsx("span",{children:"Zur Startseite"})]})]})]})})}):this.props.children}}const gee=()=>{const t=M.useRef(Date.now()),e=M.useRef(null);return M.useEffect(()=>{const r=["mousedown","mousemove","keypress","scroll","touchstart","click"],n=()=>{t.current=Date.now()};r.forEach(i=>{document.addEventListener(i,n,!0)});const s=()=>{const i=Date.now(),o=i-t.current,l=30*60*1e3;if(o<l){const c=Mt.loadSession();if(c){const u=c.sessionExpiry-i,d=2*60*60*1e3;u<d&&(console.log("🍪 Extending session due to user activity"),Mt.extendSession())}}};return e.current=setInterval(s,10*60*1e3),()=>{r.forEach(i=>{document.removeEventListener(i,n,!0)}),e.current&&clearInterval(e.current)}},[]),null},yee=({onConsentChange:t})=>{const[e,r]=M.useState(!1),[n,s]=M.useState(!1),[i,o]=M.useState({necessary:!0,analytics:!1,marketing:!1,functional:!1,consentDate:new Date,version:"1.0"});M.useEffect(()=>{const m=ar.getCookieConsent();m?o(m):r(!0)},[]);const l=async()=>{await d({necessary:!0,analytics:!0,marketing:!0,functional:!0,consentDate:new Date,version:"1.0"})},c=async()=>{const m={...i,consentDate:new Date,version:"1.0"};await d(m)},u=async()=>{await d({necessary:!0,analytics:!1,marketing:!1,functional:!1,consentDate:new Date,version:"1.0"})},d=async m=>{try{await ar.saveCookieConsent(m),o(m),r(!1),s(!1),t&&t(m),_t.success("Cookie-Einstellungen gespeichert"),h(m)}catch(w){console.error("Error saving cookie consent:",w),_t.error("Fehler beim Speichern der Einstellungen")}},h=m=>{m.analytics?window.gtag&&window.gtag("consent","update",{analytics_storage:"granted"}):window.gtag&&window.gtag("consent","update",{analytics_storage:"denied"}),m.marketing?window.gtag&&window.gtag("consent","update",{ad_storage:"granted"}):window.gtag&&window.gtag("consent","update",{ad_storage:"denied"}),localStorage.setItem("royal_cookie_consent",JSON.stringify(m))},g=[{id:"necessary",name:"Notwendige Cookies",description:"Diese Cookies sind für das Funktionieren der Website erforderlich und können nicht deaktiviert werden.",icon:_n,required:!0,examples:["Authentifizierung","Sicherheit","Warenkorb"]},{id:"functional",name:"Funktionale Cookies",description:"Diese Cookies ermöglichen verbesserte Funktionalität und Personalisierung.",icon:OY,required:!1,examples:["Spracheinstellungen","Benutzerpräferenzen","Chat-Support"]},{id:"analytics",name:"Analyse-Cookies",description:"Diese Cookies helfen uns zu verstehen, wie Besucher mit unserer Website interagieren.",icon:nY,required:!1,examples:["Google Analytics","Besuchsstatistiken","Performance-Tracking"]},{id:"marketing",name:"Marketing-Cookies",description:"Diese Cookies werden verwendet, um Ihnen relevante Werbung zu zeigen.",icon:yY,required:!1,examples:["Werbe-Tracking","Soziale Medien","Remarketing"]}];return e?a.jsx(po,{children:a.jsx(oe.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},className:"fixed bottom-0 left-0 right-0 z-50 bg-white shadow-2xl border-t border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto p-6",children:n?a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Cookie-Einstellungen"}),a.jsx("button",{onClick:()=>s(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(Zi,{className:"h-5 w-5"})})]}),a.jsx("div",{className:"space-y-6 mb-6",children:g.map(m=>{const w=m.icon,_=i[m.id];return a.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[a.jsx(w,{className:"h-5 w-5 text-royal-gold mt-1 flex-shrink-0"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:m.name}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:m.description}),a.jsxs("div",{className:"text-xs text-gray-500",children:[a.jsx("span",{className:"font-medium",children:"Beispiele: "}),m.examples.join(", ")]})]})]}),a.jsx("div",{className:"ml-4",children:m.required?a.jsx("span",{className:"px-3 py-1 text-xs font-medium text-gray-600 bg-gray-100 rounded-full",children:"Erforderlich"}):a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:_,onChange:T=>{o(v=>({...v,[m.id]:T.target.checked}))},className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-royal-gold/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-royal-gold"})]})})]})},m.id)})}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-end",children:[a.jsx("button",{onClick:u,className:"px-6 py-2 text-sm font-medium text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Nur notwendige"}),a.jsx("button",{onClick:c,className:"px-6 py-2 text-sm font-medium text-white bg-royal-gold hover:bg-royal-gold/90 rounded-lg transition-colors",children:"Auswahl speichern"}),a.jsx("button",{onClick:l,className:"px-6 py-2 text-sm font-medium text-white bg-royal-gold hover:bg-royal-gold/90 rounded-lg transition-colors",children:"Alle akzeptieren"})]}),a.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:a.jsxs("p",{className:"text-xs text-gray-500",children:["Weitere Informationen finden Sie in unserer"," ",a.jsx(Jr,{to:"/privacy-policy",className:"text-royal-gold hover:underline",children:"Datenschutzerklärung"})," ","und unseren"," ",a.jsx("a",{href:"/cookie-policy",className:"text-royal-gold hover:underline",children:"Cookie-Richtlinien"}),"."]})})]}):a.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[a.jsx(nP,{className:"h-8 w-8 text-royal-gold flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Wir verwenden Cookies"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Wir verwenden Cookies, um Ihnen die beste Erfahrung auf unserer Website zu bieten. Einige sind notwendig für das Funktionieren der Website, andere helfen uns bei der Verbesserung."})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full md:w-auto",children:[a.jsxs("button",{onClick:()=>s(!0),className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800 transition-colors",children:[a.jsx(Yc,{className:"h-4 w-4"}),"Einstellungen"]}),a.jsx("button",{onClick:u,className:"px-6 py-2 text-sm font-medium text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Nur notwendige"}),a.jsx("button",{onClick:l,className:"px-6 py-2 text-sm font-medium text-white bg-royal-gold hover:bg-royal-gold/90 rounded-lg transition-colors",children:"Alle akzeptieren"})]})]})})})}):null},Fu=class Fu{constructor(){Dr(this,"notificationInterval",null);Dr(this,"lastNotificationTime",null);Dr(this,"NOTIFICATION_COOLDOWN",30*60*1e3)}static getInstance(){return Fu.instance||(Fu.instance=new Fu),Fu.instance}startPeriodicNotifications(){this.notificationInterval||(this.notificationInterval=setInterval(async()=>{await this.checkAndCreateUpcomingEventNotification()},5*60*1e3),this.checkAndCreateUpcomingEventNotification())}stopPeriodicNotifications(){this.notificationInterval&&(clearInterval(this.notificationInterval),this.notificationInterval=null)}async checkAndCreateUpcomingEventNotification(){try{const e=new Date;if(this.lastNotificationTime&&e.getTime()-this.lastNotificationTime.getTime()<this.NOTIFICATION_COOLDOWN)return;const r=await ds.getUpcomingEvents(3);if(r.length>0){const n=r[0],i=new Date(n.date).getTime()-e.getTime();Math.ceil(i/(1e3*60*60*24))<=7&&(await ds.createUpcomingEventNotification(),this.lastNotificationTime=e,console.log("Upcoming event notification created"))}}catch(e){console.warn("Error checking for upcoming event notifications:",e)}}async triggerUpcomingEventNotification(){try{await ds.createUpcomingEventNotification(),this.lastNotificationTime=new Date,console.log("Manual upcoming event notification triggered")}catch(e){console.error("Error triggering upcoming event notification:",e)}}async createTestEventNotification(){try{console.log("EventNotificationManager: Creating test event notification");const e={id:"test-event",title:"Test Event",description:"This is a test event",date:new Date(Date.now()+24*60*60*1e3),time:"20:00",location:"Royal Shisha Bar",imageUrl:"",price:25,capacity:50,isActive:!0,createdBy:"test-admin",createdAt:new Date,updatedAt:new Date,attendees:[],category:"Live Music",tags:["test","music"]};console.log("EventNotificationManager: Test event data:",e),await Xa.createEventNotification(e),console.log("EventNotificationManager: Test event notification created successfully")}catch(e){throw console.error("EventNotificationManager: Error creating test event notification:",e),e}}};Dr(Fu,"instance");let $b=Fu;const xee=$b.getInstance();typeof window<"u"&&setTimeout(()=>{xee.startPeriodicNotifications()},1e3);function vee(){const{initializeFromCookie:t}=yn();return M.useEffect(()=>{t(),hee()},[t]),a.jsx(cA,{children:a.jsx(gO,{children:a.jsx(Mq,{children:a.jsx(Uq,{children:a.jsxs("div",{className:"flex flex-col min-h-screen bg-royal-charcoal",children:[a.jsx(oee,{}),a.jsx(pee,{}),a.jsx("main",{className:"flex-grow",children:a.jsx(cA,{children:a.jsxs(lO,{children:[a.jsx(hi,{path:"/",element:a.jsx(VY,{})}),a.jsx(hi,{path:"/menu",element:a.jsx(cJ,{})}),a.jsx(hi,{path:"/events",element:a.jsx(aJ,{})}),a.jsx(hi,{path:"/contact",element:a.jsx(uJ,{})}),a.jsx(hi,{path:"/reservations",element:a.jsx(ZZ,{})}),a.jsx(hi,{path:"/loyalty",element:a.jsx(eee,{})}),a.jsx(hi,{path:"/privacy-policy",element:a.jsx(tee,{})}),a.jsx(hi,{path:"/impressum",element:a.jsx(nee,{})}),a.jsx(hi,{path:"/agb",element:a.jsx(see,{})}),a.jsx(hi,{path:"/privacy-dashboard",element:a.jsx(Uv,{requireAuth:!0,redirectTo:"/auth",children:a.jsx(ree,{})})}),a.jsx(hi,{path:"/auth",element:a.jsx(Uv,{requireAuth:!1,redirectTo:"/",children:a.jsx(UY,{})})}),a.jsx(hi,{path:"/admin",element:a.jsx(Uv,{requireAuth:!0,requireRole:"admin",redirectTo:"/auth",children:a.jsx(YZ,{})})})]})})}),a.jsx(lee,{}),a.jsx(mee,{}),a.jsx(fee,{}),a.jsx(cee,{}),a.jsx(gee,{}),a.jsx(yee,{}),a.jsx(C$,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#1a1b23",color:"#f7f3e3",border:"1px solid #d4af37"}}})]})})})})})}zv.createRoot(document.getElementById("root")).render(a.jsx(Lc.StrictMode,{children:a.jsx(vee,{})}));export{or as _,wee as c,uA as g};
//# sourceMappingURL=index-5af09b95.js.map
